<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Application Development Guide :: Documentation</title>
    <link rel="canonical" href="https://docs.dirx.solutions/dirx-identity-docs/latest/appl-dev-guide/pdf-src/appl-dev-guide.html">
    <meta name="generator" content="Antora 3.1.9">
    <link rel="stylesheet" href="../../../../_/css/site.css">
    <link rel="icon" href="../../../../_/img/favicon.ico" type="image/x-icon">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://docs.dirx.solutions">
        <div class="navbar-item logo"></div>
        Documentation
      </a>
      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <input id="search-input" type="text" placeholder="Search the docs">
        </div>
      </div>
      <button class="navbar-burger" aria-controls="topbar-nav" aria-expanded="false" aria-label="Toggle main menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="./">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">DirX Access</a>
            <a class="navbar-item" href="#">DirX Audit</a>
            <a class="navbar-item" href="../../../../dirx-directory-docs/latest/index.html">DirX Directory</a>
            <a class="navbar-item" href="../../index.html">DirX Identity</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="dirx-identity-docs" data-version="9.0.0">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title"><a href="../../index.html">DirX Identity</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">General</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../index.html">About this Documentation</a>
  </li>
</ul>
  </li>
  <li class="nav-item is-current-page" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="appl-dev-guide.html">Application Development Guide</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../copyright.html#_copyright">Copyright</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../preface.html#_preface">Preface</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../ch1_applsref.html#_understanding_the_default_application_workflow_technology">Understanding the Default Application Workflow Technology</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ch1_applsref.html#_understanding_request_workflows">Understanding Request Workflows</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ch1_applsref.html#_understanding_java_based_workflows">Understanding Java-based Workflows</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ch1_applsref.html#_understanding_tcl_based_workflows">Understanding Tcl-based Workflows</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../ch2_reqWFs.html#_using_request_workflows">Using Request Workflows</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ch2_reqWFs.html#_understanding_creation_workflows">Understanding Creation Workflows</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ch2_reqWFs.html#_understanding_modification_workflows">Understanding Modification Workflows</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ch2_reqWFs.html#_understanding_assignment_workflows">Understanding Assignment Workflows</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ch2_reqWFs.html#_understanding_deletion_workflows">Understanding Deletion Workflows</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ch2_reqWFs.html#_understanding_certification_workflows">Understanding Certification Workflows</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ch2_reqWFs.html#_understanding_service_management_workflows">Understanding Service Management Workflows</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../ch3_configScen.html#_configuring_custom_scenarios">Configuring Custom Scenarios</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ch3_configScen.html#_creating_the_new_scenario">Creating the New Scenario</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ch3_configScen.html#_refining_the_scenario">Refining the Scenario</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ch3_configScen.html#_creating_the_identity_creation_workflows">Creating the Identity Creation Workflows</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ch3_configScen.html#_creating_cluster_target_systems">Creating Cluster Target Systems</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../ch4_defappls.html#_using_the_default_connectivity_applications">Using the Default Connectivity Applications</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ch4_defappls.html#_working_with_default_connectivity_application_objects">Working with Default Connectivity Application Objects</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ch4_defappls.html#_working_with_default_connectivity_scenario">Working with the Default Connectivity Scenario</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../ch5_sourceWFs.html#_using_the_source_workflows">Using the Source Workflows</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ch5_sourceWFs.html#_understanding_the_java_based_source_workflows">Understanding the Java-based Source Workflows</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ch5_sourceWFs.html#_understanding-the-tcl-based-source-workflows">Understanding the Tcl-based Source Workflows</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../ch6_maintWFs.html#_using_the_maintenance_workflows">Using the Maintenance Workflows</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ch6_maintWFs.html#_understanding_java_based_maintenance_workflows">Understanding the Java-based Maintenance Workflows</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ch6_maintWFs.html#_understanding_tcl_based_maintenance_workflows">Understanding the Tcl-based Maintenance Workflows</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../ch7_targetWFs.html#_using_the_target_system_provisioning_workflows">Using the Target System (Provisioning) Workflows</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ch7_targetWFs.html#_understanding_java_based_target_system_workflows">Understanding Java-based Target System Workflows</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ch7_targetWFs.html#_understanding_tcl_based_target_system_workflows">Understanding Tcl-based Target System Workflows</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../appa_depr.html#_deprecated_features">Deprecated Features</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../appa_depr.html#_ads_provisioning_workflows">ADS Provisioning Workflows</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../appa_depr.html#_dashboard_workflow">Dashboard Workflow</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../appa_depr.html#_dirx_access_workflows">DirX Access Workflows</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../appa_depr.html#_jdbc_provisioning_workflows">JDBC Provisioning Workflows</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../appa_depr.html#_ldap_provisioning_workflows">LDAP Provisioning Workflows</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../appa_depr.html#_ldap_xxl_provisioning_workflows">LDAP XXL Provisioning Workflows</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../appa_depr.html#_lotus_notes_provisioning_workflows">Lotus Notes Provisioning Workflows</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../appa_depr.html#_unix_pam_provisioning_workflows">UNIX PAM Provisioning Workflows</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../appa_depr.html#_unix_pam_workflows">UNIX PAM Workflows</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">DirX Identity</span>
    <span class="version">9.0.0</span>
  </div>
  <ul class="components">
    <li class="component">
      <div class="title"><a href="../../../../dirx-directory-docs/latest/index.html">DirX Directory</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../dirx-directory-docs/latest/index.html">9.1.0</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <div class="title"><a href="../../index.html">DirX Identity</a></div>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../index.html">9.0.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../index.html">DirX Identity</a></li>
    <li><a href="appl-dev-guide.html">Application Development Guide</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Application Development Guide</h1>
<div class="sect1">
<h2 id="_copyright"><a class="anchor" href="#_copyright"></a><a class="link" href="#_copyright">Copyright</a></h2>
<div class="sectionbody">
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p>All product names quoted are trademarks or registered trademarks of the manufacturers concerned.</p>
</div>
<div class="paragraph">
<p>Â© 2024 Eviden</p>
</div>
<div class="paragraph">
<p>All Rights Reserved</p>
</div>
<div class="paragraph">
<p>Distribution and reproduction not permitted without the consent of Eviden.</p>
</div>
</div>
</div>
<div style="page-break-after: always;"></div>
<div id="toc" class="toc">
<div id="toctitle" class="title">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_copyright">Copyright</a></li>
<li><a href="#_preface">Preface</a>
<ul class="sectlevel2">
<li><a href="#_prf_dirx_identity_documentation">DirX Identity Documentation</a>
<ul class="sectlevel3">
<li><a href="#_dirx_identity_document_set">DirX Identity Document Set</a></li>
<li><a href="#_notation_conventions">Notation Conventions</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_understanding_the_default_application_workflow_technology">1. Understanding the Default Application Workflow Technology</a>
<ul class="sectlevel2">
<li><a href="#_understanding_request_workflows">1.1. Understanding Request Workflows</a>
<ul class="sectlevel3">
<li><a href="#_ch1_request_workflow_architecture">1.1.1. Request Workflow Architecture</a>
<ul class="sectlevel4">
<li><a href="#_ch1_understanding_activity_types">1.1.1.1. Understanding Activity Types</a></li>
<li><a href="#_ch1_about_the_activity_sub_structure">1.1.1.2. About the Activity Sub-Structure</a></li>
<li><a href="#_ch1_understanding_notifications">1.1.1.3. Understanding Notifications</a></li>
<li><a href="#_ch1_html_notifications">1.1.1.4. HTML Notifications</a></li>
<li><a href="#_ch1_understanding_request_workflow_states">1.1.1.5. Understanding Request Workflow States</a>
<ul class="sectlevel5">
<li><a href="#_ch1_types_of_request_workflow_states">1.1.1.5.1. Types of Request Workflow States</a></li>
<li><a href="#_ch1_understanding_request_workflow_activity_states">1.1.1.5.2. Understanding Request Workflow Activity States</a></li>
</ul>
</li>
<li><a href="#_ch1_understanding_the_full_checker">1.1.1.6. Understanding the Full Checker</a>
<ul class="sectlevel5">
<li><a href="#_ch1_full_check_for_expired_workflows_and_activities">1.1.1.6.1. Full Check for Expired Workflows and Activities</a></li>
<li><a href="#_ch1_full_check_for_all_running_workflows">1.1.1.6.2. Full Check for All Running Workflows</a></li>
<li><a href="#_ch1_full_checker_configuration">1.1.1.6.3. Full Checker Configuration</a></li>
</ul>
</li>
<li><a href="#_ch1_request_workflow_error_handling">1.1.1.7. Request Workflow Error Handling</a></li>
<li><a href="#_ch1_nationalizing_request_workflows">1.1.1.8. Nationalizing Request Workflows</a>
<ul class="sectlevel5">
<li><a href="#_ch1_understanding_request_workflow_nationalization">1.1.1.8.1. Understanding Request Workflow Nationalization</a></li>
<li><a href="#_ch1_using_the_nationalization_wizard">1.1.1.8.2. Using the Nationalization Wizard</a></li>
<li><a href="#_ch1_organizing_message_topics">1.1.1.8.3. Organizing Message Topics</a></li>
<li><a href="#_ch1_customizing_request_workflow_nationalization">1.1.1.8.4. Customizing Request Workflow Nationalization</a></li>
<li><a href="#_ch1_using_an_external_nationalization_editor">1.1.1.8.5. Using an External Nationalization Editor</a></li>
<li><a href="#_ch1_determining_the_language">1.1.1.8.6. Determining the Language</a></li>
<li><a href="#_ch1_handling_message_items_during_runtime">1.1.1.8.7. Handling Message Items during Runtime</a></li>
</ul>
</li>
<li><a href="#_ch1_selecting_request_workflows">1.1.1.9. Selecting Request Workflows</a>
<ul class="sectlevel5">
<li><a href="#_ch1_creation_workflow_selection">1.1.1.9.1. Creation Workflow Selection</a></li>
<li><a href="#_ch1_modification_workflow_selection">1.1.1.9.2. Modification Workflow Selection</a></li>
<li><a href="#_ch1_assignment_workflow_selection">1.1.1.9.3. Assignment Workflow Selection</a></li>
</ul>
</li>
<li><a href="#_ch1_executing_request_workflows">1.1.1.10. Executing Request Workflows</a></li>
</ul>
</li>
<li><a href="#_ch1_customizing_request_workflows">1.1.2. Customizing Request Workflows</a>
<ul class="sectlevel4">
<li><a href="#_ch1_using_variable_substitution">1.1.2.1. Using Variable Substitution</a>
<ul class="sectlevel5">
<li><a href="#_ch1_elements">1.1.2.1.1. Elements</a></li>
<li><a href="#_ch1_structures">1.1.2.1.2. Structures</a></li>
<li><a href="#_ch1_server_variables">1.1.2.1.3. Server Variables</a></li>
<li><a href="#_ch1_workflow_instance">1.1.2.1.4. Workflow Instance</a></li>
<li><a href="#_ch1_activity_instance">1.1.2.1.5. Activity Instance</a></li>
<li><a href="#_ch1_control_structures">1.1.2.1.6. Control Structures</a></li>
<li><a href="#_ch1_reduced_run_time_activities">1.1.2.1.7. Reduced Run-time Activities</a></li>
<li><a href="#_ch1_filling_the_address_fields">1.1.2.1.8. Filling the Address Fields</a></li>
<li><a href="#_ch1_participant_calculation">1.1.2.1.9. Participant Calculation</a></li>
<li><a href="#_ch1_tips_and_tricks">1.1.2.1.10. Tips and Tricks</a></li>
</ul>
</li>
<li><a href="#_ch1_implementing_a_new_activity">1.1.2.2. Implementing a New Activity</a>
<ul class="sectlevel5">
<li><a href="#_ch1_defining_configuration_parameters">1.1.2.2.1. Defining Configuration Parameters</a></li>
<li><a href="#_ch1_supplying_a_component_description">1.1.2.2.2. Supplying a Component Description</a></li>
<li><a href="#_ch1_implementing_the_job">1.1.2.2.3. Implementing the Job</a></li>
<li><a href="#_ch1_reading_the_job_configuration">1.1.2.2.4. Reading the Job Configuration</a></li>
<li><a href="#_ch1_reading_the_workflow_instance_data">1.1.2.2.5. Reading the Workflow Instance Data</a></li>
<li><a href="#_ch1_modifying_the_workflow_instance_data">1.1.2.2.6. Modifying the Workflow Instance Data</a></li>
<li><a href="#_ch1_read_and_write_context_properties">1.1.2.2.7. Read and Write Context Properties</a></li>
<li><a href="#_ch1_reading_and_changing_orders">1.1.2.2.8. Reading and Changing Orders</a></li>
<li><a href="#_ch1_deploying_the_job">1.1.2.2.9. Deploying the Job</a></li>
<li><a href="#_ch1_obtaining_a_connection_to_the_identity_domain">1.1.2.2.10. Obtaining a Connection to the Identity Domain</a></li>
<li><a href="#_ch1_implementing_a_job_with_access_to_the_identity_domain">1.1.2.2.11. Implementing a Job with access to the Identity Domain</a></li>
<li><a href="#_ch1_using_the_domainsessionaccessor_method">1.1.2.2.12. Using the DomainSessionAccessor Method</a></li>
<li><a href="#_ch1_implementing_a_user_hook_for_an_applychange_activity">1.1.2.2.13. Implementing a User Hook for an applyChange Activity</a></li>
</ul>
</li>
<li><a href="#_ch1_implementing_a_socketed_job_framework_based_activity">1.1.2.3. Implementing a Socketed Job Framework-based Activity</a>
<ul class="sectlevel5">
<li><a href="#_ch1_adding_the_new_socketed_job_framework_activity">1.1.2.3.1. Adding the New Socketed Job Framework Activity</a></li>
<li><a href="#_ch1_specifying_predefined_configuration_parameters">1.1.2.3.2. Specifying Predefined Configuration Parameters</a></li>
<li><a href="#_ch1_implementing_the_job_2">1.1.2.3.3. Implementing the Job</a></li>
<li><a href="#_ch1_reading_the_job_configuration_2">1.1.2.3.4. Reading the Job Configuration</a></li>
<li><a href="#_ch1_reading_the_workflow_instance_data_2">1.1.2.3.5. Reading the Workflow Instance Data</a></li>
<li><a href="#_ch1_modifying_the_workflow_instance_data_2">1.1.2.3.6. Modifying the Workflow Instance Data</a></li>
<li><a href="#_ch1_read_and_write_context_properties_2">1.1.2.3.7. Read and Write Context Properties</a></li>
<li><a href="#_ch1_reading_and_changing_orders_2">1.1.2.3.8. Reading and Changing Orders</a></li>
<li><a href="#_ch1_deploying_the_job_2">1.1.2.3.9. Deploying the Job</a></li>
</ul>
</li>
<li><a href="#_ch1_implementing_a_java_class_for_finding_participants">1.1.2.4. Implementing a Java Class for Finding Participants</a>
<ul class="sectlevel5">
<li><a href="#_ch1_defining_configuration_parameters_2">1.1.2.4.1. Defining Configuration Parameters</a></li>
<li><a href="#_ch1_implementing_the_java_class">1.1.2.4.2. Implementing the Java Class</a></li>
<li><a href="#_ch1_deploying_the_java_class">1.1.2.4.3. Deploying the Java Class</a></li>
</ul>
</li>
<li><a href="#_ch1_implementing_participant_filters_and_constraints">1.1.2.5. Implementing Participant Filters and Constraints</a>
<ul class="sectlevel5">
<li><a href="#_ch1_implementing_a_participants_filter">1.1.2.5.1. Implementing a Participants Filter</a></li>
<li><a href="#_ch1_implementing_participant_constraints">1.1.2.5.2. Implementing Participant Constraints</a></li>
<li><a href="#_ch1_configuring_a_joblet">1.1.2.5.3. Configuring a Joblet</a></li>
<li><a href="#_ch1_implementing_a_joblet">1.1.2.5.4. Implementing a Joblet</a></li>
<li><a href="#_ch1_deploying_filters_and_constraints">1.1.2.5.5. Deploying Filters and Constraints</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_ch1_testing_request_workflows">1.1.3. Testing Request Workflows</a></li>
</ul>
</li>
<li><a href="#_understanding_java_based_workflows">1.2. Understanding Java-based Workflows</a>
<ul class="sectlevel3">
<li><a href="#_ch1_java_based_workflow_architecture">1.2.1. Java-based Workflow Architecture</a>
<ul class="sectlevel4">
<li><a href="#_ch1_full_delta_and_event_based_workflows">1.2.1.1. Full, Delta and Event-based Workflows</a></li>
<li><a href="#_ch1_location_of_delta_state">1.2.1.2. Location of Delta State</a></li>
<li><a href="#_ch1_java_based_workflow_structure">1.2.1.3. Java-based Workflow Structure</a></li>
<li><a href="#_ch1_controller_types">1.2.1.4. Controller Types</a></li>
<li><a href="#_ch1_channels_and_mapping">1.2.1.5. Channels and Mapping</a></li>
<li><a href="#_ch1_cross_memberships">1.2.1.6. Cross-Memberships</a></li>
<li><a href="#_ch1_starting_java_based_workflows">1.2.1.7. Starting Java-based Workflows</a>
<ul class="sectlevel5">
<li><a href="#_ch1_event_based_workflows">1.2.1.7.1. Event-Based Workflows</a></li>
<li><a href="#_ch1_scheduled_workflows">1.2.1.7.2. Scheduled Workflows</a></li>
<li><a href="#_ch1_starting_a_workflow_manually">1.2.1.7.3. Starting a Workflow Manually</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_ch1_customizing_java_based_workflows">1.2.2. Customizing Java-based Workflows</a>
<ul class="sectlevel4">
<li><a href="#_ch1_using_user_hooks">1.2.2.1. Using User Hooks</a>
<ul class="sectlevel5">
<li><a href="#_ch1_configuring_a_user_hook">1.2.2.1.1. Configuring a User Hook</a></li>
<li><a href="#_ch1_implementing_a_global_user_hook">1.2.2.1.2. Implementing a Global User Hook</a></li>
<li><a href="#_ch1_implementing_a_channel_user_hook">1.2.2.1.3. Implementing a Channel User Hook</a></li>
<li><a href="#_ch1_implementing_a_user_hook_for_email_notifications">1.2.2.1.4. Implementing a User Hook for Email Notifications</a></li>
<li><a href="#_ch1_deploying_a_user_hook">1.2.2.1.5. Deploying a User Hook</a></li>
<li><a href="#_ch1_running_executables_from_a_user_hook">1.2.2.1.6. Running Executables from a User Hook</a></li>
</ul>
</li>
<li><a href="#_ch1_mapping_with_java_classes">1.2.2.2. Mapping with Java Classes</a>
<ul class="sectlevel5">
<li><a href="#_ch1_identifier_mapping">1.2.2.2.1. Identifier Mapping</a></li>
<li><a href="#_ch1_attribute_mapping">1.2.2.2.2. Attribute Mapping</a></li>
<li><a href="#_ch1_post_mapping">1.2.2.2.3. Post Mapping</a></li>
<li><a href="#_ch1_deploying_the_mapping_class">1.2.2.2.4. Deploying the Mapping Class</a></li>
<li><a href="#_ch1_evaluating_a_mapping_entry">1.2.2.2.5. Evaluating a Mapping Entry</a></li>
<li><a href="#_ch1_handling_environment_properties">1.2.2.2.6. Handling Environment Properties</a></li>
<li><a href="#_ch1_handling_the_mapped_entry">1.2.2.2.7. Handling the Mapped Entry</a></li>
<li><a href="#_ch1_setting_the_map_result">1.2.2.2.8. Setting the Map Result</a></li>
<li><a href="#_ch1_logging">1.2.2.2.9. Logging</a></li>
</ul>
</li>
<li><a href="#_ch1_testing_the_real_time_workflow_mapping_classes">1.2.2.3. Testing the Real-Time Workflow Mapping Classes</a>
<ul class="sectlevel5">
<li><a href="#_ch1_about_the_mapping_test">1.2.2.3.1. About the Mapping Test</a></li>
<li><a href="#_ch1_about_the_mapping_test_structure">1.2.2.3.2. About the Mapping Test Structure</a></li>
<li><a href="#_ch1_testing_the_ldap_channel_configuration">1.2.2.3.3. Testing the LDAP Channel Configuration</a></li>
</ul>
</li>
<li><a href="#_ch1_using_connector_filters">1.2.2.4. Using Connector Filters</a>
<ul class="sectlevel5">
<li><a href="#_ch1_configuring_a_connector_filter">1.2.2.4.1. Configuring a Connector Filter</a></li>
<li><a href="#_ch1_deploying_a_connector_filter">1.2.2.4.2. Deploying a Connector Filter</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_ch1_customizing_password_synchronization_workflows">1.2.3. Customizing Password Synchronization Workflows</a>
<ul class="sectlevel4">
<li><a href="#_ch1_configuring_a_password_user_hook">1.2.3.1. Configuring a Password User Hook</a></li>
<li><a href="#_ch1_implementing_a_password_user_hook">1.2.3.2. Implementing a Password User Hook</a></li>
<li><a href="#_ch1_deploying_a_password_user_hook">1.2.3.3. Deploying a Password User Hook</a></li>
</ul>
</li>
<li><a href="#_ch1_customizing_event_based_maintenance_workflows">1.2.4. Customizing Event-based Maintenance Workflows</a>
<ul class="sectlevel4">
<li><a href="#_ch1_configuring_a_user_hook_for_an_event_based_maintenance_workflow">1.2.4.1. Configuring a User Hook for an Event-based Maintenance Workflow</a></li>
<li><a href="#_ch1_implementing_a_user_hook_for_an_event_based_maintenance_workflow">1.2.4.2. Implementing a User Hook for an Event-based Maintenance Workflow</a></li>
<li><a href="#_ch1_using_event_contexts">1.2.4.3. Using Event Contexts</a></li>
<li><a href="#_ch1_deploying_a_user_hook_for_an_event_based_maintenance_workflow">1.2.4.4. Deploying a User Hook for an Event-based Maintenance Workflow</a></li>
</ul>
</li>
<li><a href="#_ch1_using_combined_workflows">1.2.5. Using Combined Workflows</a></li>
</ul>
</li>
<li><a href="#_understanding_tcl_based_workflows">1.3. Understanding Tcl-based Workflows</a>
<ul class="sectlevel3">
<li><a href="#_ch1_tcl_based_connectivity_architecture">1.3.1. Tcl-based Connectivity Architecture</a>
<ul class="sectlevel4">
<li><a href="#_ch1_connectivity_standard_script_structure">1.3.1.1. Connectivity Standard Script Structure</a>
<ul class="sectlevel5">
<li><a href="#_ch1_connectivity_standard_script_logical_structure">1.3.1.1.1. Connectivity Standard Script Logical Structure</a></li>
<li><a href="#_ch1_connectivity_standard_script_physical_structure">1.3.1.1.2. Connectivity Standard Script Physical Structure</a></li>
</ul>
</li>
<li><a href="#_ch1_provisioning_workflow_script_structure">1.3.1.2. Provisioning Workflow Script Structure</a></li>
<li><a href="#_ch1_connectivity_standard_script_operation">1.3.1.3. Connectivity Standard Script Operation</a>
<ul class="sectlevel5">
<li><a href="#_ch1_control_script_operation">1.3.1.3.1. Control Script Operation</a></li>
<li><a href="#_ch1_profile_script_operation">1.3.1.3.2. Profile Script Operation</a></li>
</ul>
</li>
<li><a href="#_ch1_connectivity_standard_script_switches_and_parameters">1.3.1.4. Connectivity Standard Script Switches and Parameters</a>
<ul class="sectlevel5">
<li><a href="#_ch1_switches_for_operational_control">1.3.1.4.1. Switches for Operational Control</a></li>
<li><a href="#_ch1_switches_for_notification_control">1.3.1.4.2. Switches for Notification Control</a></li>
<li><a href="#_ch1_switches_for_guid_generation">1.3.1.4.3. Switches for GUID Generation</a></li>
<li><a href="#_ch1_switches_for_trace_control">1.3.1.4.4. Switches for Trace Control</a></li>
<li><a href="#_ch1_source_directory_parameters">1.3.1.4.5. Source Directory Parameters</a></li>
<li><a href="#_ch1_input_channel_parameters">1.3.1.4.6. Input Channel Parameters</a></li>
<li><a href="#_ch1_target_directory_parameters">1.3.1.4.7. Target Directory Parameters</a></li>
<li><a href="#_ch1_output_channel_parameters">1.3.1.4.8. Output Channel Parameters</a></li>
<li><a href="#_ch1_switches_for_pre_configured_operational_attribute_handling">1.3.1.4.9. Switches for Pre-Configured Operational Attribute Handling</a></li>
</ul>
</li>
<li><a href="#_ch1_references_in_the_default_connectivity_applications">1.3.1.5. References in the Default Connectivity Applications</a>
<ul class="sectlevel5">
<li><a href="#_ch1_base_object_references">1.3.1.5.1. Base Object References</a></li>
<li><a href="#_ch1_references_in_filter_expressions">1.3.1.5.2. References in Filter Expressions</a></li>
</ul>
</li>
<li><a href="#_ch1_object_class_handling">1.3.1.6. Object Class Handling</a></li>
<li><a href="#_ch1_global_unique_identifier_guid_generation">1.3.1.7. Global Unique Identifier (GUID) Generation</a>
<ul class="sectlevel5">
<li><a href="#_ch1_local_guid_generation">1.3.1.7.1. Local GUID Generation</a></li>
<li><a href="#_ch1_central_guid_generation">1.3.1.7.2. Central GUID Generation</a></li>
<li><a href="#_ch1_user_defined_guid_generation">1.3.1.7.3. User-Defined GUID Generation</a></li>
</ul>
</li>
<li><a href="#_ch1_multi_mastered_attributes">1.3.1.8. Multi-Mastered Attributes</a></li>
<li><a href="#_ch1_naming_and_scopes">1.3.1.9. Naming and Scopes</a></li>
<li><a href="#_ch1_user_hooks">1.3.1.10. User Hooks</a>
<ul class="sectlevel5">
<li><a href="#_ch1_central_tcl_interfaces">1.3.1.10.1. Central Tcl Interfaces</a></li>
<li><a href="#_ch1_default_user_hook_tcl_interfaces">1.3.1.10.2. Default User Hook Tcl Interfaces</a></li>
<li><a href="#_ch1_post_join_mapping_tcl_interfaces">1.3.1.10.3. Post-Join Mapping Tcl Interfaces</a></li>
</ul>
</li>
<li><a href="#_ch1_global_tcl_variables">1.3.1.11. Global Tcl Variables</a>
<ul class="sectlevel5">
<li><a href="#_ch1_control_script_variables">1.3.1.11.1. Control Script Variables</a></li>
<li><a href="#_ch1_profile_script_variables">1.3.1.11.2. Profile Script Variables</a></li>
</ul>
</li>
<li><a href="#_ch1_meta_handles">1.3.1.12. Meta Handles</a></li>
</ul>
</li>
<li><a href="#_ch1_understanding_delta_handling">1.3.2. Understanding Delta Handling</a>
<ul class="sectlevel4">
<li><a href="#_ch1_types_of_delta_handling">1.3.2.1. Types of Delta handling</a>
<ul class="sectlevel5">
<li><a href="#_ch1_date_oriented_delta_handling">1.3.2.1.1. Date-Oriented Delta Handling</a></li>
<li><a href="#_ch1_client_side_handling">1.3.2.1.2. Client-Side Handling</a></li>
<li><a href="#_ch1_workflow_side_handling">1.3.2.1.3. Workflow-Side Handling</a></li>
<li><a href="#_ch1_client_side_delta_handling">1.3.2.1.4. Client-Side Delta Handling</a></li>
<li><a href="#_ch1_workflow_side_delta_handling">1.3.2.1.5. Workflow-Side Delta Handling</a></li>
<li><a href="#_ch1_usn_oriented_delta_handling">1.3.2.1.6. USN-Oriented Delta Handling</a></li>
<li><a href="#_ch1_file_oriented_delta_handling">1.3.2.1.7. File-Oriented Delta Handling</a></li>
</ul>
</li>
<li><a href="#_ch1_delta_handling_control">1.3.2.2. Delta Handling Control</a>
<ul class="sectlevel5">
<li><a href="#_ch1_how_to_control_delta_runs">1.3.2.2.1. How to Control Delta Runs</a></li>
<li><a href="#_ch1_configuring_delta_handling">1.3.2.2.2. Configuring Delta Handling</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_ch1_customizing_tcl_based_workflows">1.3.3. Customizing Tcl-based Workflows</a>
<ul class="sectlevel4">
<li><a href="#_ch1_customizing_identity_store_export_workflows">1.3.3.1. Customizing Identity Store Export Workflows</a>
<ul class="sectlevel5">
<li><a href="#_ch1_attribute_mapping_2">1.3.3.1.1. Attribute Mapping</a></li>
<li><a href="#_ch1_base_object_export_properties_tab">1.3.3.1.2. Base Object (Export Properties Tab)</a></li>
<li><a href="#_ch1_filter_export_properties_tab">1.3.3.1.3. Filter (Export Properties Tab)</a></li>
<li><a href="#_ch1_tracing">1.3.3.1.4. Tracing</a></li>
</ul>
</li>
<li><a href="#_ch1_customizing_identity_store_import_workflows">1.3.3.2. Customizing Identity Store Import Workflows</a>
<ul class="sectlevel5">
<li><a href="#_ch1_mapping_and_selected_attributes">1.3.3.2.1. Mapping and Selected Attributes</a></li>
<li><a href="#_ch1_base_object_import_properties_tab">1.3.3.2.2. Base Object (Import Properties tab)</a></li>
<li><a href="#_ch1_import_mode_import_properties_tab">1.3.3.2.3. Import Mode (Import Properties Tab)</a></li>
<li><a href="#_ch1_filters_for_merge_replace_import_properties_tab">1.3.3.2.4. Filters for Merge / Replace (Import Properties Tab)</a></li>
<li><a href="#_ch1_entry_handling_properties_tab">1.3.3.2.5. Entry Handling Properties Tab</a></li>
<li><a href="#_ch1_tracing_2">1.3.3.2.6. Tracing</a></li>
<li><a href="#_ch1_page_mode">1.3.3.2.7. Page Mode</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#_using_request_workflows">2. Using Request Workflows</a>
<ul class="sectlevel2">
<li><a href="#_understanding_creation_workflows">2.1. Understanding Creation Workflows</a>
<ul class="sectlevel3">
<li><a href="#_ch2_user_self_registration_workflows">2.1.1. User Self Registration Workflows</a></li>
<li><a href="#_ch2_create_user_workflows">2.1.2. Create User Workflows</a></li>
<li><a href="#_ch2_create_persona_workflows">2.1.3. Create Persona Workflows</a></li>
<li><a href="#_ch2_create_user_facet_workflows">2.1.4. Create User Facet Workflows</a></li>
<li><a href="#_ch2_create_functional_user_workflows">2.1.5. Create Functional User Workflows</a></li>
<li><a href="#_ch2_create_privilege_workflows">2.1.6. Create Privilege Workflows</a></li>
</ul>
</li>
<li><a href="#_understanding_modification_workflows">2.2. Understanding Modification Workflows</a>
<ul class="sectlevel3">
<li><a href="#_ch2_user_modification_workflows">2.2.1. User Modification Workflows</a></li>
</ul>
</li>
<li><a href="#_understanding_assignment_workflows">2.3. Understanding Assignment Workflows</a>
<ul class="sectlevel3">
<li><a href="#_ch2_how_approval_works">2.3.1. How Approval Works</a>
<ul class="sectlevel4">
<li><a href="#_ch2_4_eye_approval">2.3.1.1. 4-Eye Approval</a></li>
<li><a href="#_ch2_automatic_notification_only_approval">2.3.1.2. Automatic (Notification Only) Approval</a></li>
<li><a href="#_ch2_risk_approval">2.3.1.3. Risk Approval</a></li>
</ul>
</li>
<li><a href="#_ch2_understanding_assignment_operation_types">2.3.2. Understanding Assignment Operation Types</a></li>
<li><a href="#_ch2_guidelines_for_approving_privilege_assignments">2.3.3. Guidelines for Approving Privilege Assignments</a></li>
<li><a href="#_ch2_guidelines_for_re_approving_privilege_assignments">2.3.4. Guidelines for Re-Approving Privilege Assignments</a></li>
</ul>
</li>
<li><a href="#_understanding_deletion_workflows">2.4. Understanding Deletion Workflows</a>
<ul class="sectlevel3">
<li><a href="#_ch2_deletion_procedure">2.4.1. Deletion Procedure</a></li>
<li><a href="#_ch2_supported_object_types">2.4.2. Supported Object Types</a></li>
<li><a href="#_ch2_role_deletion_workflow">2.4.3. Role Deletion Workflow</a></li>
</ul>
</li>
<li><a href="#_understanding_certification_workflows">2.5. Understanding Certification Workflows</a>
<ul class="sectlevel3">
<li><a href="#_ch2_certification_campaign_workflows">2.5.1. Certification Campaign Workflows</a></li>
</ul>
</li>
<li><a href="#_understanding_service_management_workflows">2.6. Understanding Service Management Workflows</a>
<ul class="sectlevel3">
<li><a href="#_ch2_manual_provisioning_workflows">2.6.1. Manual Provisioning Workflows</a></li>
<li><a href="#_ch2_process_ticket_workflows">2.6.2. Process Ticket Workflows</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_configuring_custom_scenarios">3. Configuring Custom Scenarios</a>
<ul class="sectlevel2">
<li><a href="#_creating_the_new_scenario">3.1. Creating the New Scenario</a></li>
<li><a href="#_refining_the_scenario">3.2. Refining the Scenario</a></li>
<li><a href="#_creating_the_identity_creation_workflows">3.3. Creating the Identity Creation Workflows</a></li>
<li><a href="#_creating_cluster_target_systems">3.4. Creating Cluster Target Systems</a></li>
</ul>
</li>
<li><a href="#_using_the_default_connectivity_applications">4. Using the Default Connectivity Applications</a>
<ul class="sectlevel2">
<li><a href="#_working_with_default_connectivity_application_objects">4.1. Working with Default Connectivity Application Objects</a></li>
<li><a href="#_working_with_default_connectivity_scenario">4.2. Working with the Default Connectivity Scenario</a></li>
</ul>
</li>
<li><a href="#_using_the_source_workflows">5. Using the Source Workflows</a>
<ul class="sectlevel2">
<li><a href="#_understanding_the_java_based_source_workflows">5.1. Understanding the Java-based Source Workflows</a>
<ul class="sectlevel3">
<li><a href="#_ch5_active_directory_ads_user_import_workflow">5.1.1. Active Directory (ADS) User Import Workflow</a>
<ul class="sectlevel4">
<li><a href="#_ch5_ads_user_import_workflow_prerequisites">5.1.1.1. ADS User Import Workflow Prerequisites</a></li>
<li><a href="#_ch5_ads_user_import_workflow_configuration">5.1.1.2. ADS User Import Workflow Configuration</a></li>
<li><a href="#_ch5_ads_user_import_workflow_and_activities">5.1.1.3. ADS User Import Workflow and Activities</a></li>
<li><a href="#_ch5_ads_user_import_workflow_ports">5.1.1.4. ADS User Import Workflow Ports</a></li>
<li><a href="#_ch5_ads_user_import_workflow_channels">5.1.1.5. ADS User Import Workflow Channels</a>
<ul class="sectlevel5">
<li><a href="#_ch5_ts_port">5.1.1.5.1. TS Port</a></li>
<li><a href="#_ch5_identity_port">5.1.1.5.2. Identity Port</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_ch5_relational_database_user_import_workflow">5.1.2. Relational Database User Import Workflow</a>
<ul class="sectlevel4">
<li><a href="#_ch5_relational_database_user_import_workflow_prerequisites">5.1.2.1. Relational Database User Import Workflow Prerequisites</a></li>
<li><a href="#_ch5_relational_database_user_import_workflow_configuration">5.1.2.2. Relational Database User Import Workflow Configuration</a>
<ul class="sectlevel5">
<li><a href="#_ch5_jdbc_connector_and_connected_directory_configuration">5.1.2.2.1. JDBC Connector and Connected Directory Configuration</a></li>
<li><a href="#_ch5_ts_port_filter_configuration">5.1.2.2.2. TS Port Filter Configuration</a></li>
</ul>
</li>
<li><a href="#_ch5_relational_database_user_import_workflow_channel_configuration">5.1.2.3. Relational Database User Import Workflow Channel Configuration</a>
<ul class="sectlevel5">
<li><a href="#_ch5_user_channel_at_the_ts_port">5.1.2.3.1. User Channel at the TS Port</a></li>
<li><a href="#_ch5_user_roles_channel_at_the_ts_port">5.1.2.3.2. User-roles Channel at the TS Port</a></li>
<li><a href="#_ch5_user_channel_at_the_identity_store_port">5.1.2.3.3. User Channel at the Identity Store Port</a></li>
<li><a href="#_ch5_user_roles_channel_at_the_identity_store_port">5.1.2.3.4. User-roles Channel at the Identity Store Port</a></li>
<li><a href="#_ch5_setpassword_channel_at_the_identity_store_port">5.1.2.3.5. setPassword Channel at the Identity Store Port</a></li>
</ul>
</li>
<li><a href="#_ch5_importing_database_users_without_their_role_assignments">5.1.2.4. Importing Database Users without their Role Assignments</a></li>
</ul>
</li>
<li><a href="#_ch5_role_import_workflow">5.1.3. Role Import Workflow</a>
<ul class="sectlevel4">
<li><a href="#_ch5_role_import_workflow_prerequisites">5.1.3.1. Role Import Workflow Prerequisites</a></li>
<li><a href="#_ch5_role_import_workflow_configuration">5.1.3.2. Role Import Workflow Configuration</a>
<ul class="sectlevel5">
<li><a href="#_ch5_configuring_the_jdbc_source">5.1.3.2.1. Configuring the JDBC Source</a></li>
<li><a href="#_ch5_configuring_the_role_import_workflow">5.1.3.2.2. Configuring the Role Import Workflow</a></li>
<li><a href="#_ch5_deploying_the_identity_web_services">5.1.3.2.3. Deploying the Identity Web Services</a></li>
</ul>
</li>
<li><a href="#_ch5_role_import_workflow_and_activities">5.1.3.3. Role Import Workflow and Activities</a></li>
<li><a href="#_ch5_role_import_workflow_ports">5.1.3.4. Role Import Workflow Ports</a></li>
<li><a href="#_ch5_role_import_workflow_channels">5.1.3.5. Role Import Workflow Channels</a>
<ul class="sectlevel5">
<li><a href="#_ch5_ts_port_2">5.1.3.5.1. TS Port</a></li>
<li><a href="#_ch5_identity_port_2">5.1.3.5.2. Identity Port</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_ch5_ldif_user_import_workflow">5.1.4. LDIF User Import Workflow</a>
<ul class="sectlevel4">
<li><a href="#_ch5_ldif_user_import_workflow_prerequisites">5.1.4.1. LDIF User Import Workflow Prerequisites</a></li>
<li><a href="#_ch5_ldif_user_import_workflow_configuration">5.1.4.2. LDIF User Import Workflow Configuration</a></li>
<li><a href="#_ch5_ldif_user_import_workflow_and_activities">5.1.4.3. LDIF User Import Workflow and Activities</a></li>
<li><a href="#_ch5_ldif_user_import_workflow_ports">5.1.4.4. LDIF User Import Workflow Ports</a></li>
<li><a href="#_ch5_ldif_user_import_workflow_channels">5.1.4.5. LDIF User Import Workflow Channels</a>
<ul class="sectlevel5">
<li><a href="#_ch5_users_channel_at_ts_port">5.1.4.5.1. Users Channel at TS Port</a></li>
<li><a href="#_ch5_users_channel_at_identity_port">5.1.4.5.2. Users Channel at Identity Port</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_ch5_ldif_user_export_workflow">5.1.5. LDIF User Export Workflow</a>
<ul class="sectlevel4">
<li><a href="#_ch5_ldif_user_export_workflow_prerequisites">5.1.5.1. LDIF User Export Workflow Prerequisites</a></li>
<li><a href="#_ch5_ldif_user_export_workflow_configuration">5.1.5.2. LDIF User Export Workflow Configuration</a></li>
<li><a href="#_ch5_ldif_user_export_workflow_and_activities">5.1.5.3. LDIF User Export Workflow and Activities</a></li>
<li><a href="#_ch5_ldif_user_export_workflow_ports">5.1.5.4. LDIF User Export Workflow Ports</a></li>
<li><a href="#_ch5_ldif_user_export_workflow_channels">5.1.5.5. LDIF User Export Workflow Channels</a>
<ul class="sectlevel5">
<li><a href="#_ch5_users_channel_at_identity_port_2">5.1.5.5.1. Users Channel at Identity Port</a></li>
<li><a href="#_ch5_users_channel_at_ts_port_2">5.1.5.5.2. Users Channel at TS Port</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_ch5_csv_workflows">5.1.6. CSV Workflows</a>
<ul class="sectlevel4">
<li><a href="#_ch5_csv_user_import_workflow">5.1.6.1. CSV User Import Workflow</a>
<ul class="sectlevel5">
<li><a href="#_ch5_csv_user_import_workflow_prerequisites">5.1.6.1.1. CSV User Import Workflow Prerequisites</a></li>
<li><a href="#_ch5_csv_user_import_workflow_configuration">5.1.6.1.2. CSV User Import Workflow Configuration</a></li>
<li><a href="#_ch5_csv_user_import_workflow_and_activities">5.1.6.1.3. CSV User Import Workflow and Activities</a></li>
<li><a href="#_ch5_csv_user_import_workflow_ports">5.1.6.1.4. CSV User Import Workflow Ports</a></li>
<li><a href="#_ch5_csv_user_import_workflow_channels">5.1.6.1.5. CSV User Import Workflow Channels</a></li>
<li><a href="#_ch5_customizing_the_workflow_to_handle_files_without_a_dn_column">5.1.6.1.6. Customizing the Workflow to Handle Files without a DN Column</a></li>
</ul>
</li>
<li><a href="#_ch5_csv_user_export_workflow">5.1.6.2. CSV User Export Workflow</a>
<ul class="sectlevel5">
<li><a href="#_ch5_csv_user_export_workflow_prerequisites">5.1.6.2.1. CSV User Export Workflow Prerequisites</a></li>
<li><a href="#_ch5_csv_user_export_workflow_configuration">5.1.6.2.2. CSV User Export Workflow Configuration</a></li>
<li><a href="#_ch5_csv_user_export_workflow_and_activities">5.1.6.2.3. CSV User Export Workflow and Activities</a></li>
<li><a href="#_ch5_csv_user_export_workflow_ports">5.1.6.2.4. CSV User Export Workflow Ports</a></li>
<li><a href="#_ch5_csv_user_export_workflow_channels">5.1.6.2.5. CSV User Export Workflow Channels</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_ch5_remote_ad_workflow">5.1.7. Remote AD Workflow</a></li>
<li><a href="#_ch5_external_ldap_user_import_workflows">5.1.8. External LDAP User Import Workflows</a>
<ul class="sectlevel4">
<li><a href="#_ch5_external_ldap_user_full_import_workflow">5.1.8.1. External LDAP User Full Import Workflow</a>
<ul class="sectlevel5">
<li><a href="#_ch5_external_ldap_user_full_import_workflow_prerequisites">5.1.8.1.1. External LDAP User Full Import Workflow Prerequisites</a></li>
<li><a href="#_ch5_external_ldap_user_full_import_workflow_configuration">5.1.8.1.2. External LDAP User Full Import Workflow Configuration</a></li>
<li><a href="#_ch5_external_ldap_user_full_import_workflow_and_activities">5.1.8.1.3. External LDAP User Full Import Workflow and Activities</a></li>
<li><a href="#_ch5_external_ldap_user_full_import_workflow_ports">5.1.8.1.4. External LDAP User Full Import Workflow Ports</a></li>
<li><a href="#_ch5_external_ldap_user_full_import_workflow_channels">5.1.8.1.5. External LDAP User Full Import Workflow Channels</a></li>
</ul>
</li>
<li><a href="#_ch5_external_ldap_user_import_workflow">5.1.8.2. External LDAP User Import Workflow</a>
<ul class="sectlevel5">
<li><a href="#_ch5_external_ldap_user_import_workflow_prerequisites">5.1.8.2.1. External LDAP User Import Workflow Prerequisites</a></li>
<li><a href="#_ch5_external_ldap_user_import_workflow_configuration">5.1.8.2.2. External LDAP User Import Workflow Configuration</a></li>
<li><a href="#_ch5_external_ldap_user_import_workflow_and_activities">5.1.8.2.3. External LDAP User Import Workflow and Activities</a></li>
<li><a href="#_ch5_external_ldap_user_import_workflow_ports">5.1.8.2.4. External LDAP User Import Workflow Ports</a></li>
<li><a href="#_ch5_external_ldap_user_import_workflow_channels">5.1.8.2.5. External LDAP User Import Workflow Channels</a></li>
</ul>
</li>
<li><a href="#_ch5_sending_events_to_synchronize_external_users">5.1.8.3. Sending Events to Synchronize External Users</a>
<ul class="sectlevel5">
<li><a href="#_ch5_event_types">5.1.8.3.1. Event Types</a></li>
<li><a href="#_ch5_identifier_and_requestid">5.1.8.3.2. Identifier and requestID</a></li>
<li><a href="#_ch5_name_and_source">5.1.8.3.3. Name and Source</a></li>
<li><a href="#_ch5_a_complete_sample_event">5.1.8.3.4. A Complete Sample Event</a></li>
<li><a href="#_ch5_sent_event_with_metacp">5.1.8.3.5. Sent Event with metacp</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#_understanding-the-tcl-based-source-workflows">5.2. Understanding the Tcl-based Source Workflows</a>
<ul class="sectlevel3">
<li><a href="#_ch5_configuring_the_corporate_directory_workflow">5.2.1. Configuring the Corporate Directory Workflow</a></li>
<li><a href="#_ch5_configuring_the_dirx_ldif_directory_workflow">5.2.2. Configuring the DirX LDIF Directory Workflow</a></li>
<li><a href="#_ch5_configuring_the_dirxdelta_workflow">5.2.3. Configuring the DirXdelta Workflow</a>
<ul class="sectlevel4">
<li><a href="#_ch5_dirxdelta_ldif_agreement_rules">5.2.3.1. DirXdelta LDIF Agreement Rules</a></li>
<li><a href="#_ch5_setting_up_the_ldif_agreement">5.2.3.2. Setting Up the LDIF Agreement</a>
<ul class="sectlevel5">
<li><a href="#_ch5_sample_scripts_to_handle_the_sample_agreement">5.2.3.2.1. Sample Scripts to Handle the Sample Agreement</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_ch5_configuring_the_file_based_source_workflows">5.2.4. Configuring the File-Based Source Workflows</a></li>
<li><a href="#_ch5_configuring_the_relational_database_workflows">5.2.5. Configuring the Relational Database Workflows</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_using_the_maintenance_workflows">6. Using the Maintenance Workflows</a>
<ul class="sectlevel2">
<li><a href="#_understanding_java_based_maintenance_workflows">6.1. Understanding the Java-based Maintenance Workflows</a>
<ul class="sectlevel3">
<li><a href="#_ch6_entry_change_workflows">6.1.1. Entry Change Workflows</a>
<ul class="sectlevel4">
<li><a href="#_ch6_accounts">6.1.1.1. Accounts</a>
<ul class="sectlevel5">
<li><a href="#_ch6_configuring_the_event_based_maintenance_workflow_for_accounts">6.1.1.1.1. Configuring the Event-based Maintenance Workflow for Accounts</a></li>
<li><a href="#_ch6_event_based_maintenance_workflow_operation_for_accounts">6.1.1.1.2. Event-based Maintenance Workflow Operation for Accounts</a></li>
</ul>
</li>
<li><a href="#_ch6_organizations">6.1.1.2. Organizations</a>
<ul class="sectlevel5">
<li><a href="#_ch6_configuring_the_event_based_maintenance_workflow_for_organizations">6.1.1.2.1. Configuring the Event-based Maintenance Workflow for Organizations</a></li>
<li><a href="#_ch6_event_based_maintenance_workflow_operation_for_organizations">6.1.1.2.2. Event-based Maintenance Workflow Operation for Organizations</a></li>
</ul>
</li>
<li><a href="#_ch6_organizational_units">6.1.1.3. Organizational Units</a>
<ul class="sectlevel5">
<li><a href="#_ch6_configuring_the_event_based_maintenance_workflow_for_organizational_units">6.1.1.3.1. Configuring the Event-based Maintenance Workflow for Organizational Units</a></li>
<li><a href="#_ch6_event_based_maintenance_workflow_operation_for_organizational_units">6.1.1.3.2. Event-based Maintenance Workflow Operation for Organizational Units</a></li>
</ul>
</li>
<li><a href="#_ch6_context_objects">6.1.1.4. Context Objects</a>
<ul class="sectlevel5">
<li><a href="#_ch6_configuring_the_event_based_maintenance_workflow_for_context_objects">6.1.1.4.1. Configuring the Event-based Maintenance Workflow for Context Objects</a></li>
<li><a href="#_ch6_event_based_maintenance_workflow_operation_for_context_objects">6.1.1.4.2. Event-based Maintenance Workflow Operation for Context Objects</a></li>
</ul>
</li>
<li><a href="#_ch6_location_objects">6.1.1.5. Location Objects</a>
<ul class="sectlevel5">
<li><a href="#_ch6_configuring_the_event_based_maintenance_workflow_for_location_objects">6.1.1.5.1. Configuring the Event-based Maintenance Workflow for Location Objects</a></li>
<li><a href="#_ch6_event_based_maintenance_workflow_operation_for_location_objects">6.1.1.5.2. Event-based Maintenance Workflow Operation for Location Objects</a></li>
</ul>
</li>
<li><a href="#_ch6_cost_unit_objects">6.1.1.6. Cost Unit Objects</a>
<ul class="sectlevel5">
<li><a href="#_ch6_configuring_the_event_based_maintenance_workflow_for_cost_unit_objects">6.1.1.6.1. Configuring the Event-based Maintenance Workflow for Cost Unit Objects</a></li>
<li><a href="#_ch6_event_based_maintenance_workflow_operation_for_cost_unit_objects">6.1.1.6.2. Event-based Maintenance Workflow Operation for Cost Unit Objects</a></li>
</ul>
</li>
<li><a href="#_ch6_project_objects">6.1.1.7. Project Objects</a>
<ul class="sectlevel5">
<li><a href="#_ch6_configuring_the_event_based_maintenance_workflow_for_project_objects">6.1.1.7.1. Configuring the Event-based Maintenance Workflow for Project Objects</a></li>
<li><a href="#_ch6_event_based_maintenance_workflow_operation_for_projects">6.1.1.7.2. Event-based Maintenance Workflow Operation for Projects</a></li>
</ul>
</li>
<li><a href="#_ch6_users">6.1.1.8. Users</a>
<ul class="sectlevel5">
<li><a href="#_ch6_configuring_the_event_based_user_resolution_workflow">6.1.1.8.1. Configuring the Event-based User Resolution Workflow</a></li>
<li><a href="#_ch6_event_based_user_resolution_workflow_operation">6.1.1.8.2. Event-based User Resolution Workflow Operation</a></li>
</ul>
</li>
<li><a href="#_ch6_personas">6.1.1.9. Personas</a></li>
<li><a href="#_ch6_functional_users">6.1.1.10. Functional Users</a></li>
<li><a href="#_ch6_generic_objects">6.1.1.11. Generic Objects</a>
<ul class="sectlevel5">
<li><a href="#_ch6_configuring_the_generic_event_based_processing_workflow">6.1.1.11.1. Configuring the Generic Event-based Processing Workflow</a></li>
<li><a href="#_ch6_generic_event_based_processing_workflow_operation">6.1.1.11.2. Generic Event-based Processing Workflow Operation</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_ch6_process_tickets_internal_workflow">6.1.2. Process Tickets Internal Workflow</a>
<ul class="sectlevel4">
<li><a href="#_ch6_configuring_the_process_tickets_internal_workflow">6.1.2.1. Configuring the Process Tickets Internal Workflow</a></li>
<li><a href="#_ch6_process_tickets_internal_workflow_operation">6.1.2.2. Process Tickets Internal Workflow Operation</a></li>
</ul>
</li>
<li><a href="#_ch6_account_password_manager_workflow">6.1.3. Account Password Manager Workflow</a>
<ul class="sectlevel4">
<li><a href="#_ch6_configuring_the_account_password_manager_workflow">6.1.3.1. Configuring the Account Password Manager Workflow</a></li>
<li><a href="#_ch6_account_password_manager_workflow_operation">6.1.3.2. Account Password Manager Workflow Operation</a></li>
</ul>
</li>
<li><a href="#_ch6_reset_account_passwords_workflow">6.1.4. Reset Account Passwords Workflow</a>
<ul class="sectlevel4">
<li><a href="#_ch6_configuring_the_reset_account_passwords_workflow">6.1.4.1. Configuring the Reset Account Passwords Workflow</a></li>
<li><a href="#_ch6_reset_account_passwords_workflow_operation">6.1.4.2. Reset Account Passwords Workflow Operation</a></li>
</ul>
</li>
<li><a href="#_ch6_reset_password_if_displayed_workflow">6.1.5. Reset Password If Displayed Workflow</a>
<ul class="sectlevel4">
<li><a href="#_ch6_configuring_the_reset_password_if_displayed_workflow">6.1.5.1. Configuring the Reset Password If Displayed Workflow</a></li>
<li><a href="#_ch6_reset_password_if_displayed_operation">6.1.5.2. Reset Password If Displayed Operation</a></li>
</ul>
</li>
<li><a href="#_ch6_user_password_event_manager_workflow">6.1.6. User Password Event Manager Workflow</a>
<ul class="sectlevel4">
<li><a href="#_ch6_configuring_the_user_password_event_manager_workflow">6.1.6.1. Configuring the User Password Event Manager Workflow</a></li>
</ul>
</li>
<li><a href="#_ch6_user_password_expiration_notification_workflow">6.1.7. User Password Expiration Notification Workflow</a>
<ul class="sectlevel4">
<li><a href="#_ch6_configuring_the_user_password_expiration_notification_workflow">6.1.7.1. Configuring the User Password Expiration Notification Workflow</a></li>
<li><a href="#_ch6_user_password_expiration_notification_workflow_operation">6.1.7.2. User Password Expiration Notification Workflow Operation</a></li>
</ul>
</li>
<li><a href="#_ch6_transport_workflows">6.1.8. Transport Workflows</a>
<ul class="sectlevel4">
<li><a href="#_ch6_export_connectivity_collections">6.1.8.1. Export Connectivity Collections</a></li>
<li><a href="#_ch6_import_connectivity_collections">6.1.8.2. Import Connectivity Collections</a></li>
<li><a href="#_ch6_export_provisioning_collections">6.1.8.3. Export Provisioning Collections</a></li>
<li><a href="#_ch6_import_provisioning_collections">6.1.8.4. Import Provisioning Collections</a></li>
</ul>
</li>
<li><a href="#_ch6_joint_backup_workflow">6.1.9. Joint Backup Workflow</a>
<ul class="sectlevel4">
<li><a href="#_ch6_configuring_the_joint_backup_workflow">6.1.9.1. Configuring the Joint Backup Workflow</a></li>
</ul>
</li>
<li><a href="#_ch6_consistency_management_workflows">6.1.10. Consistency Management Workflows</a>
<ul class="sectlevel4">
<li><a href="#_ch6_check_consistency_workflow">6.1.10.1. Check Consistency Workflow</a>
<ul class="sectlevel5">
<li><a href="#_ch6_configuring_the_check_consistency_workflow">6.1.10.1.1. Configuring the Check Consistency Workflow</a></li>
<li><a href="#_ch6_check_consistency_workflow_operation">6.1.10.1.2. Check Consistency Workflow Operation</a></li>
</ul>
</li>
<li><a href="#_ch6_mark_affected_users_workflow">6.1.10.2. Mark Affected Users Workflow</a>
<ul class="sectlevel5">
<li><a href="#_ch6_configuring_the_mark_affected_users_workflow">6.1.10.2.1. Configuring the Mark Affected Users Workflow</a></li>
<li><a href="#_ch6_mark_affected_users_workflow_operation">6.1.10.2.2. Mark Affected Users Workflow Operation</a></li>
</ul>
</li>
<li><a href="#_ch6_user_resolution_workflow">6.1.10.3. User Resolution Workflow</a>
<ul class="sectlevel5">
<li><a href="#_ch6_configuring_the_user_resolution_workflow">6.1.10.3.1. Configuring the User Resolution Workflow</a></li>
<li><a href="#_ch6_user_resolution_workflow_operation">6.1.10.3.2. User Resolution Workflow Operation</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#_understanding_tcl_based_maintenance_workflows">6.2. Understanding the Tcl-based Maintenance Workflows</a>
<ul class="sectlevel3">
<li><a href="#_ch6_cleanup_objects_workflow">6.2.1. Cleanup Objects Workflow</a>
<ul class="sectlevel4">
<li><a href="#_ch6_configuring_the_cleanup_objects_workflow">6.2.1.1. Configuring the Cleanup Objects Workflow</a></li>
</ul>
</li>
<li><a href="#_ch6_consistency_check_workflow">6.2.2. Consistency Check Workflow</a>
<ul class="sectlevel4">
<li><a href="#_ch6_configuring_the_consistency_check_workflow">6.2.2.1. Configuring the Consistency Check Workflow</a></li>
<li><a href="#_ch6_service_agent_configuration_file">6.2.2.2. Service Agent Configuration File</a></li>
<li><a href="#_ch6_time_format_syntax">6.2.2.3. Time Format Syntax</a></li>
<li><a href="#_ch6_consistency_check_workflow_operation">6.2.2.4. Consistency Check Workflow Operation</a></li>
<li><a href="#_ch6_consistency_check_workflow_optimization">6.2.2.5. Consistency Check Workflow Optimization</a></li>
</ul>
</li>
<li><a href="#_ch6_extract_audit_trail_workflow">6.2.3. Extract Audit Trail Workflow</a>
<ul class="sectlevel4">
<li><a href="#_ch6_configuring_the_extract_audit_trail_workflow">6.2.3.1. Configuring the Extract Audit Trail Workflow</a></li>
</ul>
</li>
<li><a href="#_ch6_full_sod_check_workflow">6.2.4. Full SoD Check Workflow</a>
<ul class="sectlevel4">
<li><a href="#_ch6_configuring_the_full_sod_check_workflow">6.2.4.1. Configuring the Full SoD Check Workflow</a></li>
</ul>
</li>
<li><a href="#_ch6_initialize_re_approval_workflow">6.2.5. Initialize Re-approval Workflow</a>
<ul class="sectlevel4">
<li><a href="#_ch6_configuring_the_initialize_re_approval_workflow">6.2.5.1. Configuring the Initialize Re-approval Workflow</a></li>
</ul>
</li>
<li><a href="#_ch6_password_expiration_notification_workflow">6.2.6. Password Expiration Notification Workflow</a>
<ul class="sectlevel4">
<li><a href="#_ch6_configuring_the_password_expiration_notification_workflow">6.2.6.1. Configuring the Password Expiration Notification Workflow</a></li>
<li><a href="#_ch6_password_expiration_notification_workflow_operation">6.2.6.2. Password Expiration Notification Workflow Operation</a></li>
</ul>
</li>
<li><a href="#_ch6_policy_execution_workflow">6.2.7. Policy Execution Workflow</a>
<ul class="sectlevel4">
<li><a href="#_ch6_configuring_the_policy_execution_workflow">6.2.7.1. Configuring the Policy Execution Workflow</a></li>
<li><a href="#_ch6_policy_execution_workflow_optimization">6.2.7.2. Policy Execution Workflow Optimization</a></li>
</ul>
</li>
<li><a href="#_ch6_privilege_resolution_workflow">6.2.8. Privilege Resolution Workflow</a>
<ul class="sectlevel4">
<li><a href="#_ch6_configuring_the_privilege_resolution_workflow">6.2.8.1. Configuring the Privilege Resolution Workflow</a></li>
<li><a href="#_ch6_privilege_resolution_workflow_operation">6.2.8.2. Privilege Resolution Workflow Operation</a></li>
<li><a href="#_ch6_privilege_resolution_workflow_optimization">6.2.8.3. Privilege Resolution Workflow Optimization</a></li>
</ul>
</li>
<li><a href="#_ch6_run_workflow_externally_workflow">6.2.9. Run Workflow Externally Workflow</a>
<ul class="sectlevel4">
<li><a href="#_ch6_configuring_the_run_workflow_externally_workflow">6.2.9.1. Configuring the Run Workflow Externally Workflow</a></li>
</ul>
</li>
<li><a href="#_ch6_start_re_approval_workflow">6.2.10. Start Re-approval Workflow</a>
<ul class="sectlevel4">
<li><a href="#_ch6_configuring_the_start_reapproval_workflow">6.2.10.1. Configuring the Start Reapproval Workflow</a></li>
</ul>
</li>
<li><a href="#_ch6_status_report_generation_workflow">6.2.11. Status Report Generation Workflow</a>
<ul class="sectlevel4">
<li><a href="#_ch6_configuring_the_status_report_generation_workflow_for_the_provisioning_view">6.2.11.1. Configuring the Status Report Generation Workflow for the Provisioning View</a></li>
<li><a href="#_ch6_configuring_the_status_report_generation_workflow_for_the_connectivity_view">6.2.11.2. Configuring the Status Report Generation Workflow for the Connectivity View</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#_using_the_target_system_provisioning_workflows">7. Using the Target System (Provisioning) Workflows</a>
<ul class="sectlevel2">
<li><a href="#extending_the_schema_for_target_system_workflows">7.1. Extending the Schema for the Target System Workflows</a>
<ul class="sectlevel3">
<li><a href="#_ch7_customizing_the_ldif_schema_files">7.1.1. Customizing the LDIF Schema Files</a></li>
<li><a href="#_ch7_installing_the_ldif_schema_extensions">7.1.2. Installing the LDIF Schema Extensions</a></li>
</ul>
</li>
<li><a href="#_understanding_java_based_target_system_workflows">7.2. Understanding the Java-based Target System Workflows</a>
<ul class="sectlevel3">
<li><a href="#_ch7_general_information">7.2.1. General Information</a>
<ul class="sectlevel4">
<li><a href="#_ch7_superior_folder_creation">7.2.1.1. Superior Folder Creation</a>
<ul class="sectlevel5">
<li><a href="#_ch7_in_the_connected_system">7.2.1.1.1. In the Connected System</a></li>
<li><a href="#_ch7_in_the_identity_store">7.2.1.1.2. In the Identity Store</a></li>
</ul>
</li>
<li><a href="#_ch7_http_proxy_server_configuration">7.2.1.2. HTTP Proxy Server Configuration</a></li>
</ul>
</li>
<li><a href="#_ch7_active_directory_ads_workflows">7.2.2. Active Directory (ADS) Workflows</a>
<ul class="sectlevel4">
<li><a href="#_ch7_ads_workflow_prerequisites_and_limitations">7.2.2.1. ADS Workflow Prerequisites and Limitations</a></li>
<li><a href="#_ch7_connecting_to_active_directory">7.2.2.2. Connecting to Active Directory</a></li>
<li><a href="#_ch7_configuring_the_ads_target_system">7.2.2.3. Configuring the ADS Target System</a>
<ul class="sectlevel5">
<li><a href="#_ch7_setting_match_properties">7.2.2.3.1. Setting Match Properties</a></li>
<li><a href="#_ch7_special_attributes">7.2.2.3.2. Special Attributes</a></li>
<li><a href="#_ch7_setting_account_and_group_root_in_ts">7.2.2.3.3. Setting Account- and Group Root in TS</a></li>
<li><a href="#_ch7_setting_exchange_base_properties">7.2.2.3.4. Setting Exchange Base Properties</a></li>
<li><a href="#_ch7_enabling_user_mailboxes">7.2.2.3.5. Enabling User Mailboxes</a></li>
<li><a href="#_ch7_creating_shared_room_and_equipment_mailboxes">7.2.2.3.6. Creating Shared, Room and Equipment Mailboxes</a></li>
<li><a href="#_ch7_enabling_share_room_and_equipment_mailboxes">7.2.2.3.7. Enabling Share, Room and Equipment Mailboxes</a></li>
<li><a href="#_ch7_setting_lync_base_properties">7.2.2.3.8. Setting Lync Base Properties</a></li>
<li><a href="#_ch7_lync_enabling">7.2.2.3.9. Lync Enabling</a></li>
</ul>
</li>
<li><a href="#_ch7_ads_workflows_and_activities">7.2.2.4. ADS Workflows and Activities</a></li>
<li><a href="#_ch7_ads_workflow_ports">7.2.2.5. ADS Workflow Ports</a></li>
<li><a href="#_ch7_ads_workflow_channels">7.2.2.6. ADS Workflow Channels</a>
<ul class="sectlevel5">
<li><a href="#_ch7_account_and_group_channels">7.2.2.6.1. Account and Group Channels</a></li>
<li><a href="#_ch7_password_channel">7.2.2.6.2. Password Channel</a></li>
</ul>
</li>
<li><a href="#_ch7_customizing_the_ads_workflows">7.2.2.7. Customizing the ADS Workflows</a>
<ul class="sectlevel5">
<li><a href="#_ch7_ads_delta_workflows">7.2.2.7.1. ADS Delta Workflows</a></li>
<li><a href="#_ch7_configuring_exchange">7.2.2.7.2. Configuring Exchange</a></li>
<li><a href="#_ch7_running_powershell_scripts">7.2.2.7.3. Running PowerShell Scripts</a></li>
<li><a href="#_ch7_specifying_powershell_script_names_in_the_standard_ads_workflows">7.2.2.7.4. Specifying PowerShell Script Names in the Standard ADS Workflows</a></li>
<li><a href="#_ch7_remote_folder_management">7.2.2.7.5. Remote Folder Management</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_ch7_citrix_sharefile_workflows">7.2.3. Citrix ShareFile Workflows</a>
<ul class="sectlevel4">
<li><a href="#_ch7_citrix_sharefile_prerequisites_and_limitations">7.2.3.1. Citrix ShareFile Prerequisites and Limitations</a></li>
<li><a href="#_ch7_connecting_to_citrix_sharefile">7.2.3.2. Connecting to Citrix ShareFile</a></li>
<li><a href="#_ch7_configuring_the_citrix_sharefile_target_system">7.2.3.3. Configuring the Citrix ShareFile Target System</a></li>
<li><a href="#_ch7_citrix_sharefile_workflow_and_activities">7.2.3.4. Citrix ShareFile Workflow and Activities</a></li>
<li><a href="#_ch7_citrix_sharefile_ports">7.2.3.5. Citrix ShareFile Ports</a></li>
</ul>
</li>
<li><a href="#_ch7_dirx_access_workflows">7.2.4. DirX Access Workflows</a>
<ul class="sectlevel4">
<li><a href="#_ch7_using_the_target_system">7.2.4.1. Using the Target System</a></li>
<li><a href="#_ch7_using_ldap_connectivity">7.2.4.2. Using LDAP Connectivity</a></li>
</ul>
</li>
<li><a href="#_ch7_evidian_esso_workflow">7.2.5. Evidian ESSO Workflow</a>
<ul class="sectlevel4">
<li><a href="#_ch7_evidian_esso_workflow_prerequisites_and_limitations">7.2.5.1. Evidian ESSO Workflow Prerequisites and Limitations</a></li>
<li><a href="#_ch7_setting_up_the_evidian_esso_workflow">7.2.5.2. Setting up the Evidian ESSO Workflow</a></li>
<li><a href="#_ch7_connecting_to_evidian_esso">7.2.5.3. Connecting to Evidian ESSO</a></li>
<li><a href="#_ch7_evidian_esso_workflow_and_activities">7.2.5.4. Evidian ESSO Workflow and Activities</a></li>
<li><a href="#_ch7_esso_workflow">7.2.5.5. ESSO Workflow</a></li>
<li><a href="#_ch7_evidian_esso_workflow_ports">7.2.5.6. Evidian ESSO Workflow Ports</a></li>
<li><a href="#_ch7_evidian_esso_workflow_channels">7.2.5.7. Evidian ESSO Workflow Channels</a>
<ul class="sectlevel5">
<li><a href="#_ch7_common_aspects">7.2.5.7.1. Common Aspects</a></li>
<li><a href="#_ch7_user_hook">7.2.5.7.2. User Hook</a></li>
<li><a href="#_ch7_exportjoin">7.2.5.7.3. Export/Join</a></li>
<li><a href="#_ch7_id_mapping">7.2.5.7.4. ID Mapping</a></li>
<li><a href="#_ch7_post_mapping">7.2.5.7.5. Post Mapping</a></li>
<li><a href="#_ch7_application">7.2.5.7.6. Application</a></li>
</ul>
</li>
<li><a href="#_ch7_customizing_the_evidian_esso_workflow">7.2.5.8. Customizing the Evidian ESSO Workflow</a>
<ul class="sectlevel5">
<li><a href="#_ch7_using_a_different_enable_sso_flag">7.2.5.8.1. Using a Different Enable-SSO Flag</a></li>
<li><a href="#_ch7_exporting_the_search_base_on_the_identity_side">7.2.5.8.2. Exporting the Search Base on the Identity Side</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_ch7_google_apps_workflows">7.2.6. Google Apps Workflows</a>
<ul class="sectlevel4">
<li><a href="#_ch7_google_apps_workflow_prerequisites_and_limitations">7.2.6.1. Google Apps Workflow Prerequisites and Limitations</a></li>
<li><a href="#_ch7_connecting_to_google_apps">7.2.6.2. Connecting to Google Apps</a></li>
<li><a href="#_ch7_configuring_the_google_apps_target_system">7.2.6.3. Configuring the Google Apps Target System</a></li>
<li><a href="#_ch7_google_apps_workflow_and_activities">7.2.6.4. Google Apps Workflow and Activities</a></li>
<li><a href="#_ch7_google_apps_ports">7.2.6.5. Google Apps Ports</a></li>
<li><a href="#_ch7_google_apps_account_channel_mapping">7.2.6.6. Google Apps Account-Channel Mapping</a></li>
<li><a href="#_ch7_google_apps_group_channel_mapping">7.2.6.7. Google Apps Group-Channel Mapping</a></li>
<li><a href="#_ch7_google_apps_member_channel_mapping">7.2.6.8. Google Apps Member-Channel Mapping</a></li>
<li><a href="#_ch7_google_apps_setpassword_channel_mapping">7.2.6.9. Google Apps SetPassword-Channel Mapping</a></li>
</ul>
</li>
<li><a href="#_ch7_imprivata_workflows">7.2.7. Imprivata Workflows</a>
<ul class="sectlevel4">
<li><a href="#_ch7_imprivata_workflow_prerequisites_and_limitations">7.2.7.1. Imprivata Workflow Prerequisites and Limitations</a></li>
<li><a href="#_ch7_connecting_to_imprivata">7.2.7.2. Connecting to Imprivata</a></li>
<li><a href="#_ch7_configuring_the_imprivata_target_system">7.2.7.3. Configuring the Imprivata Target System</a></li>
<li><a href="#_ch7_imprivata_workflow_and_activities">7.2.7.4. Imprivata Workflow and Activities</a></li>
<li><a href="#_ch7_imprivata_ports">7.2.7.5. Imprivata Ports</a></li>
<li><a href="#_ch7_imprivata_channels">7.2.7.6. Imprivata Channels</a>
<ul class="sectlevel5">
<li><a href="#_ch7_common_aspects_2">7.2.7.6.1. Common Aspects</a></li>
<li><a href="#_ch7_subscriber">7.2.7.6.2. Subscriber</a></li>
<li><a href="#_ch7_account">7.2.7.6.3. Account</a></li>
<li><a href="#_ch7_group">7.2.7.6.4. Group</a></li>
<li><a href="#_ch7_password_channel_2">7.2.7.6.5. Password Channel</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_ch7_jdbc_workflow">7.2.8. JDBC Workflow</a>
<ul class="sectlevel4">
<li><a href="#_ch7_jdbc_workflow_prerequisites_and_limitations">7.2.8.1. JDBC Workflow Prerequisites and Limitations</a></li>
<li><a href="#_ch7_connecting_to_jdbc">7.2.8.2. Connecting to JDBC</a></li>
<li><a href="#_ch7_configuring_the_jdbc_target_system">7.2.8.3. Configuring the JDBC Target System</a>
<ul class="sectlevel5">
<li><a href="#_ch7_attribute_correlation">7.2.8.3.1. Attribute Correlation</a></li>
</ul>
</li>
<li><a href="#_ch7_jdbc_workflow_and_activities">7.2.8.4. JDBC Workflow and Activities</a></li>
<li><a href="#_ch7_jdbc_workflow_ports">7.2.8.5. JDBC Workflow Ports</a></li>
<li><a href="#_ch7_jdbc_workflow_channels">7.2.8.6. JDBC Workflow Channels</a>
<ul class="sectlevel5">
<li><a href="#_ch7_common_aspects_3">7.2.8.6.1. Common Aspects</a></li>
<li><a href="#_ch7_membership">7.2.8.6.2. Membership</a></li>
<li><a href="#_ch7_setpassword">7.2.8.6.3. SetPassword</a></li>
</ul>
</li>
<li><a href="#_ch7_customizing_the_jdbc_workflows">7.2.8.7. Customizing the JDBC Workflows</a>
<ul class="sectlevel5">
<li><a href="#_ch7_adapting_the_database_scheme">7.2.8.7.1. Adapting the Database Scheme</a></li>
<li><a href="#_ch7_calling_stored_procedures">7.2.8.7.2. Calling Stored Procedures</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_ch7_ldap_workflows">7.2.9. LDAP Workflows</a>
<ul class="sectlevel4">
<li><a href="#_ch7_ldap_workflow_prerequisites_and_limitations">7.2.9.1. LDAP Workflow Prerequisites and Limitations</a></li>
<li><a href="#_ch7_configuring_the_connection_to_ldap">7.2.9.2. Configuring the Connection to LDAP</a></li>
<li><a href="#_ch7_configuring_the_ldap_target_system">7.2.9.3. Configuring the LDAP Target System</a></li>
<li><a href="#_ch7_ldap_workflow_and_activities">7.2.9.4. LDAP Workflow and Activities</a></li>
<li><a href="#_ch7_ldap_workflow_ports">7.2.9.5. LDAP Workflow Ports</a></li>
<li><a href="#_ch7_ldap_workflow_channels">7.2.9.6. LDAP Workflow Channels</a>
<ul class="sectlevel5">
<li><a href="#_ch7_account_and_group_channels_in_both_directions">7.2.9.6.1. Account and Group Channels in both Directions</a></li>
<li><a href="#_ch7_password_channel_3">7.2.9.6.2. Password Channel</a></li>
<li><a href="#_ch7_case_sensitive_rename">7.2.9.6.3. Case-Sensitive Rename</a></li>
</ul>
</li>
<li><a href="#_ch7_ldap_delta_workflows">7.2.9.7. LDAP Delta Workflows</a></li>
</ul>
</li>
<li><a href="#_ch7_ibm_notes_workflows">7.2.10. IBM Notes Workflows</a>
<ul class="sectlevel4">
<li><a href="#_ch7_notes_workflow_prerequisites_and_limitations">7.2.10.1. Notes Workflow Prerequisites and Limitations</a></li>
<li><a href="#_ch7_configuring_the_notes_workflow">7.2.10.2. Configuring the Notes Workflow</a></li>
<li><a href="#_ch7_configuring_the_notes_target_system">7.2.10.3. Configuring the Notes Target System</a></li>
<li><a href="#_ch7_notes_workflow_and_activities">7.2.10.4. Notes Workflow and Activities</a></li>
<li><a href="#_ch7_notes_workflow_ports">7.2.10.5. Notes Workflow Ports</a></li>
<li><a href="#_ch7_notes_workflow_channels">7.2.10.6. Notes Workflow Channels</a>
<ul class="sectlevel5">
<li><a href="#_ch7_direction_identity_store_ibm_notes">7.2.10.6.1. Direction: Identity Store &#8594; IBM Notes</a></li>
<li><a href="#_ch7_direction_ibm_notes_identity_store">7.2.10.6.2. Direction: IBM Notes &#8594; Identity Store</a></li>
<li><a href="#_ch7_password_channel_4">7.2.10.6.3. Password Channel</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_ch7_medico_workflows">7.2.11. Medico Workflows</a>
<ul class="sectlevel4">
<li><a href="#_ch7_medico_workflow_prerequisites_and_limitations">7.2.11.1. Medico Workflow Prerequisites and Limitations</a></li>
<li><a href="#_ch7_configuring_the_medico_workflow">7.2.11.2. Configuring the Medico Workflow</a></li>
<li><a href="#_ch7_configuring_the_medico_target_system">7.2.11.3. Configuring the Medico Target System</a></li>
<li><a href="#_ch7_medico_workflow_and_activities">7.2.11.4. Medico Workflow and Activities</a></li>
<li><a href="#_ch7_medico_workflow_ports">7.2.11.5. Medico Workflow Ports</a></li>
<li><a href="#_ch7_medico_workflow_channels">7.2.11.6. Medico Workflow Channels</a>
<ul class="sectlevel5">
<li><a href="#_ch7_common_aspects_4">7.2.11.6.1. Common Aspects</a></li>
<li><a href="#_ch7_person">7.2.11.6.2. Person</a></li>
<li><a href="#_ch7_login">7.2.11.6.3. Login</a></li>
<li><a href="#_ch7_password_channel_5">7.2.11.6.4. Password Channel</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_ch7_office_365_workflows">7.2.12. Office 365 Workflows</a>
<ul class="sectlevel4">
<li><a href="#_ch7_office_365_workflow_prerequisites_and_limitations">7.2.12.1. Office 365 Workflow Prerequisites and Limitations</a></li>
<li><a href="#_ch7_connecting_to_office_365">7.2.12.2. Connecting to Office 365</a></li>
<li><a href="#_ch7_configuring_the_office_365_target_system">7.2.12.3. Configuring the Office 365 Target System</a></li>
<li><a href="#_ch7_office_365_workflow_and_activities">7.2.12.4. Office 365 Workflow and Activities</a></li>
<li><a href="#_ch7_office_365_workflow_ports">7.2.12.5. Office 365 Workflow Ports</a></li>
<li><a href="#_ch7_office_365_workflow_channels">7.2.12.6. Office 365 Workflow Channels</a>
<ul class="sectlevel5">
<li><a href="#_ch7_accounts">7.2.12.6.1. Accounts</a></li>
<li><a href="#_ch7_groups">7.2.12.6.2. Groups</a></li>
<li><a href="#_ch7_roles">7.2.12.6.3. Roles</a></li>
<li><a href="#_ch7_service_plans">7.2.12.6.4. Service Plans</a></li>
<li><a href="#_ch7_password_channel_6">7.2.12.6.5. Password Channel</a></li>
<li><a href="#_ch7_member_channel">7.2.12.6.6. Member Channel</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_ch7_openicf_windows_local_accounts_workflows">7.2.13. OpenICF Windows Local Accounts Workflows</a>
<ul class="sectlevel4">
<li><a href="#_ch7_openicf_windows_local_accounts_workflow_prerequisites_and_limitations">7.2.13.1. OpenICF Windows Local Accounts Workflow Prerequisites and Limitations</a></li>
<li><a href="#_ch7_connecting_to_the_windows_local_accounts_system">7.2.13.2. Connecting to the Windows Local Accounts System</a></li>
<li><a href="#_ch7_configuring_the_openicf_windows_local_accounts_target_system">7.2.13.3. Configuring the OpenICF Windows Local Accounts Target System</a></li>
<li><a href="#_ch7_openicf_windows_local_accounts_workflow_and_activities">7.2.13.4. OpenICF Windows Local Accounts Workflow and Activities</a></li>
<li><a href="#_ch7_openicf_windows_local_accounts_workflow_ports">7.2.13.5. OpenICF Windows Local Accounts Workflow Ports</a></li>
<li><a href="#_ch7_openicf_windows_local_accounts_workflow_channels">7.2.13.6. OpenICF Windows Local Accounts Workflow Channels</a>
<ul class="sectlevel5">
<li><a href="#_ch7_accounts_2">7.2.13.6.1. Accounts</a></li>
<li><a href="#_ch7_groups_2">7.2.13.6.2. Groups</a></li>
<li><a href="#_ch7_members">7.2.13.6.3. Members</a></li>
<li><a href="#_ch7_setpassword_2">7.2.13.6.4. setPassword</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_ch7_racf_workflows">7.2.14. RACF Workflows</a>
<ul class="sectlevel4">
<li><a href="#_ch7_prerequisites_and_limitations">7.2.14.1. Prerequisites and Limitations</a></li>
<li><a href="#_ch7_configuring_the_racf_target_system">7.2.14.2. Configuring the RACF Target System</a></li>
<li><a href="#_ch7_configuring_the_connection_to_racf">7.2.14.3. Configuring the Connection to RACF</a></li>
<li><a href="#_ch7_configuring_the_connected_directory">7.2.14.4. Configuring the Connected Directory</a></li>
<li><a href="#_ch7_racf_workflow_ports">7.2.14.5. RACF Workflow Ports</a></li>
<li><a href="#_ch7_racf_workflow_channels">7.2.14.6. RACF Workflow Channels</a>
<ul class="sectlevel5">
<li><a href="#_ch7_accounts_channel">7.2.14.6.1. Accounts Channel</a></li>
<li><a href="#_ch7_groups_channel">7.2.14.6.2. Groups Channel</a></li>
<li><a href="#_ch7_members_channel">7.2.14.6.3. Members Channel</a></li>
<li><a href="#_ch7_setpassword_channel">7.2.14.6.4. SetPassword Channel</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_ch7_salesforce_workflows">7.2.15. Salesforce Workflows</a>
<ul class="sectlevel4">
<li><a href="#_ch7_salesforce_workflow_prerequisites_and_limitations">7.2.15.1. Salesforce Workflow Prerequisites and Limitations</a>
<ul class="sectlevel5">
<li><a href="#_ch7_registering_the_remote_access_application">7.2.15.1.1. Registering the Remote Access Application</a></li>
<li><a href="#_ch7_creating_the_statusinfo_c_attribute">7.2.15.1.2. Creating the StatusInfo__c Attribute</a></li>
<li><a href="#_ch7_salesforce_workflow_limitations">7.2.15.1.3. Salesforce Workflow Limitations</a></li>
</ul>
</li>
<li><a href="#_ch7_configuring_the_salesforce_workflows">7.2.15.2. Configuring the Salesforce Workflows</a></li>
<li><a href="#_ch7_configuring_the_salesforce_target_system">7.2.15.3. Configuring the Salesforce Target System</a></li>
<li><a href="#_ch7_salesforce_workflow_and_activities">7.2.15.4. Salesforce Workflow and Activities</a></li>
<li><a href="#_ch7_salesforce_workflow_ports">7.2.15.5. Salesforce Workflow Ports</a></li>
<li><a href="#_ch7_account_channel_mapping_for_sf_users">7.2.15.6. Account-Channel Mapping for SF Users</a></li>
<li><a href="#_ch7_group_channel_mapping_for_sf_permissionsets">7.2.15.7. Group-Channel Mapping for SF PermissionSets</a></li>
<li><a href="#_ch7_group_channel_mapping_for_sf_profiles">7.2.15.8. Group-Channel Mapping for SF Profiles</a></li>
<li><a href="#_ch7_channel_mapping_for_sf_accounts">7.2.15.9. Channel Mapping for SF Accounts</a></li>
<li><a href="#_ch7_channel_mapping_for_sf_contacts">7.2.15.10. Channel Mapping for SF Contacts</a></li>
<li><a href="#_ch7_member_channel_mapping_for_sf_users">7.2.15.11. Member-Channel Mapping for SF Users</a></li>
<li><a href="#_ch7_setpassword_channel_mapping_for_sf_users">7.2.15.12. SetPassword-Channel Mapping for SF Users</a></li>
<li><a href="#_ch7_account_channel_mapping_for_identity_store_accounts">7.2.15.13. Account-Channel Mapping for Identity Store Accounts</a></li>
<li><a href="#_ch7_group_channel_mapping_for_identity_store_profiles">7.2.15.14. Group-Channel Mapping for Identity Store Profiles</a></li>
<li><a href="#_ch7_group_channel_mapping_for_identity_store_permissionsets">7.2.15.15. Group-Channel Mapping for Identity Store PermissionSets</a></li>
<li><a href="#_ch7_channel_mapping_for_identity_store_organizations_sf_accounts">7.2.15.16. Channel Mapping for Identity Store Organizations (SF Accounts)</a></li>
<li><a href="#_ch7_channel_mapping_for_identity_store_users_sf_contacts">7.2.15.17. Channel Mapping for Identity Store Users (SF Contacts)</a></li>
</ul>
</li>
<li><a href="#_ch7_sap_ecc_r3_um_workflows">7.2.16. SAP ECC (R/3) UM Workflows</a>
<ul class="sectlevel4">
<li><a href="#_ch7_sap_r3_um_workflow_prerequisites_and_limitations">7.2.16.1. SAP R/3 UM Workflow Prerequisites and Limitations</a></li>
<li><a href="#_ch7_configuring_the_sap_r3_um_target_system">7.2.16.2. Configuring the SAP R/3 UM Target System</a></li>
<li><a href="#_ch7_sap_r3_um_workflow_and_activities">7.2.16.3. SAP R/3 UM Workflow and Activities</a></li>
<li><a href="#_ch7_sap_r3_um_workflow_ports">7.2.16.4. SAP R/3 UM Workflow Ports</a></li>
<li><a href="#_ch7_sap_r3_um_workflow_channels">7.2.16.5. SAP R/3 UM Workflow Channels</a>
<ul class="sectlevel5">
<li><a href="#_ch7_common_aspects_5">7.2.16.5.1. Common Aspects</a></li>
<li><a href="#_ch7_accounts_3">7.2.16.5.2. Accounts</a></li>
<li><a href="#_ch7_groups_3">7.2.16.5.3. Groups</a></li>
<li><a href="#_ch7_memberships">7.2.16.5.4. Memberships</a></li>
<li><a href="#_ch7_password_channel_7">7.2.16.5.5. Password Channel</a></li>
</ul>
</li>
<li><a href="#_ch7_customizing_the_sap_r3_um_workflows">7.2.16.6. Customizing the SAP R/3 UM Workflows</a></li>
</ul>
</li>
<li><a href="#_ch7_service_management_workflows">7.2.17. Service Management Workflows</a>
<ul class="sectlevel4">
<li><a href="#_ch7_service_management_workflow_prerequisites_and_limitations">7.2.17.1. Service Management Workflow Prerequisites and Limitations</a></li>
<li><a href="#_ch7_configuring_service_management_workflows">7.2.17.2. Configuring Service Management Workflows</a></li>
<li><a href="#_ch7_configuring_the_service_management_target_system">7.2.17.3. Configuring the Service Management Target System</a></li>
<li><a href="#_ch7_service_management_workflows_and_activities">7.2.17.4. Service Management Workflows and Activities</a></li>
<li><a href="#_ch7_service_management_workflow_ports">7.2.17.5. Service Management Workflow Ports</a></li>
<li><a href="#_ch7_service_management_workflow_channels">7.2.17.6. Service Management Workflow Channels</a>
<ul class="sectlevel5">
<li><a href="#_ch7_common_aspects_6">7.2.17.6.1. Common Aspects</a></li>
<li><a href="#_ch7_account_2">7.2.17.6.2. Account</a></li>
<li><a href="#_ch7_group_2">7.2.17.6.3. Group</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_ch7_sharepoint_workflows">7.2.18. SharePoint Workflows</a>
<ul class="sectlevel4">
<li><a href="#_ch7_sharepoint_workflow_prerequisites_and_limitations">7.2.18.1. SharePoint Workflow Prerequisites and Limitations</a></li>
<li><a href="#_ch7_configuring_the_sharepoint_clusters_workflows_and_connection">7.2.18.2. Configuring the SharePoint Clusters, Workflows and Connection</a>
<ul class="sectlevel5">
<li><a href="#_ch7_creating_clustered_sharepoint_target_systems">7.2.18.2.1. Creating Clustered SharePoint Target Systems</a></li>
<li><a href="#_ch7_configuring_sharepoint_workflows">7.2.18.2.2. Configuring SharePoint Workflows</a></li>
<li><a href="#_ch7_configuring_sharepoint_ssl_connections">7.2.18.2.3. Configuring SharePoint SSL Connections</a></li>
</ul>
</li>
<li><a href="#_ch7_configuring_the_sharepoint_target_system">7.2.18.3. Configuring the SharePoint Target System</a></li>
<li><a href="#_ch7_sharepoint_workflow_and_activities">7.2.18.4. SharePoint Workflow and Activities</a></li>
<li><a href="#_ch7_sharepoint_workflow_ports">7.2.18.5. SharePoint Workflow Ports</a></li>
<li><a href="#_ch7_sharepoint_workflow_channels">7.2.18.6. SharePoint Workflow Channels</a>
<ul class="sectlevel5">
<li><a href="#_ch7_aspects_common_to_all_channels_and_synchronization_directions">7.2.18.6.1. Aspects Common to All Channels and Synchronization Directions</a></li>
<li><a href="#_ch7_groups_4">7.2.18.6.2. Groups</a></li>
<li><a href="#_ch7_member_channel_2">7.2.18.6.3. Member Channel</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_ch7_unify_office_workflows">7.2.19. Unify Office Workflows</a>
<ul class="sectlevel4">
<li><a href="#_ch7_prerequisites_and_limitations_2">7.2.19.1. Prerequisites and Limitations</a></li>
<li><a href="#_ch7_connecting_to_unify_office">7.2.19.2. Connecting to Unify Office</a></li>
<li><a href="#_ch7_configuring_the_unify_office_target_system">7.2.19.3. Configuring the Unify Office Target System</a></li>
<li><a href="#_ch7_workflow_and_activities">7.2.19.4. Workflow and Activities</a></li>
<li><a href="#_ch7_workflow_ports">7.2.19.5. Workflow Ports</a></li>
<li><a href="#_ch7_workflow_channels">7.2.19.6. Workflow Channels</a>
<ul class="sectlevel5">
<li><a href="#_ch7_accounts_4">7.2.19.6.1. Accounts</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_ch7_unix_openicf_workflows">7.2.20. UNIX-OpenICF Workflows</a>
<ul class="sectlevel4">
<li><a href="#_ch7_unix_openicf_prerequisites_and_limitations">7.2.20.1. UNIX-OpenICF Prerequisites and Limitations</a></li>
<li><a href="#_ch7_connecting_to_the_unix_system">7.2.20.2. Connecting to the UNIX System</a>
<ul class="sectlevel5">
<li><a href="#_ch7_setting_up_the_java_based_openicf_connector_server">7.2.20.2.1. Setting up the Java-based OpenICF Connector Server</a></li>
<li><a href="#_ch7_configuring_the_connection_to_the_openicf_connector_server">7.2.20.2.2. Configuring the Connection to the OpenICF Connector Server</a></li>
</ul>
</li>
<li><a href="#_ch7_configuring_the_unix_openicf_target_system">7.2.20.3. Configuring the UNIX-OpenICF Target System</a></li>
<li><a href="#_ch7_unix_openicf_workflow_and_activities">7.2.20.4. UNIX-OpenICF Workflow and Activities</a></li>
<li><a href="#_ch7_unix_openicf_workflow_ports">7.2.20.5. UNIX-OpenICF Workflow Ports</a></li>
<li><a href="#_ch7_unix_openicf_workflow_channels">7.2.20.6. UNIX-OpenICF Workflow Channels</a>
<ul class="sectlevel5">
<li><a href="#_ch7_common_aspects_7">7.2.20.6.1. Common Aspects</a></li>
<li><a href="#_ch7_accounts_5">7.2.20.6.2. Accounts</a></li>
<li><a href="#_ch7_groups_5">7.2.20.6.3. Groups</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#_understanding_tcl_based_target_system_workflows">7.3. Understanding the Tcl-based Target System Workflows</a>
<ul class="sectlevel3">
<li><a href="#_ch7_target_system_workflow_types">7.3.1. Target System Workflow Types</a></li>
<li><a href="#_ch7_object_identification_and_group_to_account_references">7.3.2. Object Identification and Group-to-Account References</a>
<ul class="sectlevel4">
<li><a href="#_ch7_workflows_for_the_hierarchical_target_systems">7.3.2.1. Workflows for the Hierarchical Target Systems</a>
<ul class="sectlevel5">
<li><a href="#_ch7_general_information_2">7.3.2.1.1. General Information</a></li>
<li><a href="#_ch7_referencing_information">7.3.2.1.2. Referencing Information</a></li>
<li><a href="#_ch7_joining_information">7.3.2.1.3. Joining Information</a></li>
</ul>
</li>
<li><a href="#_ch7_workflows_for_the_non_hierarchical_target_systems">7.3.2.2. Workflows for the Non-Hierarchical Target Systems</a>
<ul class="sectlevel5">
<li><a href="#_ch7_referencing_and_joining">7.3.2.2.1. Referencing and Joining</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_ch7_target_system_reference_and_join_summary">7.3.3. Target System Reference and Join Summary</a></li>
<li><a href="#_ch7_hipath_workflow">7.3.4. HiPath Workflow</a>
<ul class="sectlevel4">
<li><a href="#_ch7_prerequisites_and_limitations_3">7.3.4.1. Prerequisites and Limitations</a></li>
<li><a href="#_ch7_configuring_the_ident_hipath_workflow">7.3.4.2. Configuring the Ident_HiPath Workflow</a></li>
<li><a href="#_ch7_activity_ident2hipath_hipath_meta_directory_export">7.3.4.3. Activity Ident2HiPath_HiPath (meta directory export)</a>
<ul class="sectlevel5">
<li><a href="#_ch7_general_features_and_prerequisites">7.3.4.3.1. General Features and Prerequisites</a></li>
<li><a href="#_ch7_basic_operation">7.3.4.3.2. Basic Operation</a></li>
<li><a href="#_ch7_control_of_the_remote_hipath_system">7.3.4.3.3. Control of the Remote HiPath System</a></li>
</ul>
</li>
<li><a href="#_ch7_activity_hipath2ident_hipath_meta_directory_import">7.3.4.4. Activity HiPath2Ident_HiPath (meta directory import)</a>
<ul class="sectlevel5">
<li><a href="#_ch7_general_features_and_prerequisites_2">7.3.4.4.1. General Features and Prerequisites</a></li>
<li><a href="#_ch7_basic_operation_2">7.3.4.4.2. Basic Operation</a></li>
</ul>
</li>
<li><a href="#_ch7_multiple_entry_handling">7.3.4.5. Multiple Entry Handling</a></li>
<li><a href="#_ch7_setting_up_the_hipath_environment">7.3.4.6. Setting up the HiPath Environment</a>
<ul class="sectlevel5">
<li><a href="#_ch7_user_creation_directives_for_hipath_4000_manager_v3_1">7.3.4.6.1. User Creation Directives for HiPath 4000 Manager V3.1</a></li>
<li><a href="#_ch7_enable_hipath_environment_for_rsh_and_rcp">7.3.4.6.2. Enable HiPath Environment for rsh and rcp</a></li>
<li><a href="#_ch7_hipath_environment_setup_for_ssh_and_scp">7.3.4.6.3. HiPath Environment Setup for ssh and scp</a></li>
</ul>
</li>
<li><a href="#_ch7_export_traces">7.3.4.7. Export Traces</a>
<ul class="sectlevel5">
<li><a href="#_ch7_meta_directory_entry_section">7.3.4.7.1. Meta Directory Entry Section</a></li>
<li><a href="#_ch7_hipath_entry_section">7.3.4.7.2. HiPath Entry Section</a></li>
<li><a href="#_ch7_derived_hipath_updates_section">7.3.4.7.3. Derived HiPath Updates Section</a></li>
<li><a href="#_ch7_hipath_update_statistics">7.3.4.7.4. HiPath Update Statistics</a></li>
</ul>
</li>
<li><a href="#_ch7_customizing_the_hipath_workflow">7.3.4.8. Customizing the HiPath Workflow</a>
<ul class="sectlevel5">
<li><a href="#_ch7_job_authentication">7.3.4.8.1. Job Authentication</a></li>
<li><a href="#_ch7_ident2hipath_target_selected_attributes_and_hipath2ident_source_selected_attributes">7.3.4.8.2. Ident2HiPath Target Selected Attributes and HiPath2Ident Source Selected Attributes</a></li>
<li><a href="#_ch7_ident2hipath_attribute_mapping">7.3.4.8.3. Ident2HiPath Attribute Mapping</a></li>
<li><a href="#_ch7_ident2hipath_export_properties">7.3.4.8.4. Ident2HiPath Export Properties</a></li>
<li><a href="#_ch7_hipath2ident_attribute_mapping">7.3.4.8.5. HiPath2Ident Attribute Mapping</a></li>
</ul>
</li>
<li><a href="#_ch7_hipath_tables">7.3.4.9. HiPath Tables</a>
<ul class="sectlevel5">
<li><a href="#_ch7_hdms_3_1_conversion_table">7.3.4.9.1. HDMS 3.1 Conversion Table</a></li>
<li><a href="#_ch7_hdms_3_6_conversion_table">7.3.4.9.2. HDMS 3.6 Conversion Table</a></li>
<li><a href="#_ch7_hdms_5_2_conversion_table">7.3.4.9.3. HDMS 5.2 Conversion Table</a></li>
<li><a href="#_ch7_hipath_4000_manager_v1_0_conversion_table">7.3.4.9.4. HiPath 4000 Manager V1.0 Conversion Table</a></li>
<li><a href="#_ch7_hipath_4000_manager_v3_1_conversion_table">7.3.4.9.5. HiPath 4000 Manager V3.1 Conversion Table</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_ch7_odbc_workflows">7.3.5. ODBC Workflows</a>
<ul class="sectlevel4">
<li><a href="#_ch7_prerequisites_and_limitations_4">7.3.5.1. Prerequisites and Limitations</a></li>
<li><a href="#_ch7_odbc_workflow_concepts">7.3.5.2. ODBC Workflow Concepts</a>
<ul class="sectlevel5">
<li><a href="#_ch7_attribute_correlation_2">7.3.5.2.1. Attribute Correlation</a></li>
<li><a href="#_ch7_attribute_configuration">7.3.5.2.2. Attribute Configuration</a></li>
<li><a href="#_ch7_identity_multi_valued_attribute_to_odbc_multi_record_transformation">7.3.5.2.3. Identity Multi-Valued Attribute to ODBC Multi-Record Transformation</a></li>
</ul>
</li>
<li><a href="#_ch7_odbc_validation_workflow">7.3.5.3. ODBC Validation Workflow</a>
<ul class="sectlevel5">
<li><a href="#_ch7_workflow_activities">7.3.5.3.1. Workflow Activities</a></li>
<li><a href="#_ch7_dirx_identity_groupsmemberships_handling">7.3.5.3.2. DirX Identity-Groups/Memberships Handling</a></li>
</ul>
</li>
<li><a href="#_ch7_odbc_synchronization_workflow">7.3.5.4. ODBC Synchronization Workflow</a>
<ul class="sectlevel5">
<li><a href="#_ch7_workflow_activities_2">7.3.5.4.1. Workflow Activities</a></li>
<li><a href="#_ch7_workflow_tasks_without_stored_procedures">7.3.5.4.2. Workflow Tasks without Stored Procedures</a></li>
<li><a href="#_ch7_workflow_tasks_with_stored_procedures">7.3.5.4.3. Workflow Tasks with Stored Procedures</a></li>
</ul>
</li>
<li><a href="#_ch7_customizing_the_odbc_workflows">7.3.5.5. Customizing the ODBC Workflows</a>
<ul class="sectlevel5">
<li><a href="#_ch7_using_additional_attributes">7.3.5.5.1. Using Additional Attributes</a></li>
<li><a href="#_ch7_using_structurally_different_odbc_databases">7.3.5.5.2. Using Structurally Different ODBC Databases</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_ch7_racf_workflows_2">7.3.6. RACF Workflows</a></li>
<li><a href="#_ch7_sipass_workflows">7.3.7. SiPass Workflows</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_deprecated_features">Appendix A: Deprecated Features</a>
<ul class="sectlevel2">
<li><a href="#_ads_provisioning_workflows">A.1. ADS Provisioning Workflows</a>
<ul class="sectlevel3">
<li><a href="#_apx_exchange_server_2007_provisioning_workflow">A.1.1. Exchange Server 2007 Provisioning Workflow</a></li>
</ul>
</li>
<li><a href="#_dashboard_workflow">A.2. Dashboard Workflow</a>
<ul class="sectlevel3">
<li><a href="#_apx_dashboard_workflow_general_issues">A.2.1. Dashboard Workflow: General Issues</a></li>
<li><a href="#_apx_prerequisites_and_limitations">A.2.2. Prerequisites and Limitations</a></li>
<li><a href="#_apx_dashboard_workflow_operational_features">A.2.3. Dashboard Workflow: Operational Features</a></li>
<li><a href="#_apx_dashboard_password_synchronization">A.2.4. Dashboard Password Synchronization</a></li>
</ul>
</li>
<li><a href="#_dirx_access_workflows">A.3. DirX Access Workflows</a>
<ul class="sectlevel3">
<li><a href="#_apx_dirx_access_prerequisites_and_limitations">A.3.1. DirX Access Prerequisites and Limitations</a></li>
<li><a href="#_apx_configuring_dirx_access_workflows">A.3.2. Configuring DirX Access Workflows</a></li>
<li><a href="#_apx_configuring_the_dirx_access_target_system">A.3.3. Configuring the DirX Access Target System</a></li>
<li><a href="#_apx_dirx_access_workflows_and_activities">A.3.4. DirX Access Workflows and Activities</a></li>
<li><a href="#_apx_dirx_access_ports">A.3.5. DirX Access Ports</a></li>
<li><a href="#_apx_dirx_access_channels">A.3.6. DirX Access Channels</a>
<ul class="sectlevel4">
<li><a href="#_apx_common_aspects">A.3.6.1. Common Aspects</a></li>
<li><a href="#_apx_accounts">A.3.6.2. Accounts</a></li>
<li><a href="#_apx_groups">A.3.6.3. Groups</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_jdbc_provisioning_workflows">A.4. JDBC Provisioning Workflows</a>
<ul class="sectlevel3">
<li><a href="#_apx_general_information_about_the_jdbc_workflows">A.4.1. General Information about the JDBC Workflows</a></li>
<li><a href="#_apx_jdbc_system_table_layout">A.4.2. JDBC System Table Layout</a></li>
<li><a href="#_apx_jdbc_workflow_configuration">A.4.3. JDBC Workflow Configuration</a></li>
<li><a href="#_apx_jdbc_agent_operations">A.4.4. JDBC Agent Operations</a></li>
<li><a href="#_apx_adddelete_membership_lists">A.4.5. Add/Delete Membership Lists</a></li>
</ul>
</li>
<li><a href="#_ldap_provisioning_workflows">A.5. LDAP Provisioning Workflows</a>
<ul class="sectlevel3">
<li><a href="#_apx_ldap_provisioning_workflow_concepts">A.5.1. LDAP Provisioning Workflow Concepts</a>
<ul class="sectlevel4">
<li><a href="#_apx_empty_groups">A.5.1.1. Empty Groups</a></li>
<li><a href="#_apx_enable_disable_of_accounts">A.5.1.2. Enable / Disable of Accounts</a></li>
</ul>
</li>
<li><a href="#_apx_ldap_provisioning_workflow_configuration">A.5.2. LDAP Provisioning Workflow Configuration</a>
<ul class="sectlevel4">
<li><a href="#_apx_empty_groups_2">A.5.2.1. Empty Groups</a></li>
<li><a href="#_apx_enable_disable_of_accounts_2">A.5.2.2. Enable / Disable of Accounts</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_ldap_xxl_provisioning_workflows">A.6. LDAP XXL Provisioning Workflows</a>
<ul class="sectlevel3">
<li><a href="#_apx_ldap_xxl_general_information">A.6.1. LDAP XXL General Information</a></li>
<li><a href="#_apx_ldapxxl_workflow_concepts">A.6.2. LDAPXXL Workflow Concepts</a>
<ul class="sectlevel4">
<li><a href="#_apx_new_common_procedures">A.6.2.1. New Common Procedures</a></li>
<li><a href="#_apx_workflow_integration">A.6.2.2. Workflow Integration</a></li>
</ul>
</li>
<li><a href="#_apx_detailed_customization">A.6.3. Detailed Customization</a></li>
</ul>
</li>
<li><a href="#_lotus_notes_provisioning_workflows">A.7. Lotus Notes Provisioning Workflows</a>
<ul class="sectlevel3">
<li><a href="#_apx_tcl_based_lotus_notes_provisioning_workflows">A.7.1. Tcl-based Lotus Notes Provisioning Workflows</a></li>
</ul>
</li>
<li><a href="#_unix_pam_provisioning_workflows">A.8. UNIX PAM Provisioning Workflows</a>
<ul class="sectlevel3">
<li><a href="#_apx_how_pam_works">A.8.1. How PAM Works</a></li>
<li><a href="#_apx_setting_up_pam_provisioning_workflows">A.8.2. Setting Up PAM Provisioning Workflows</a></li>
</ul>
</li>
<li><a href="#_unix_pam_workflows">A.9. UNIX-PAM Workflows</a>
<ul class="sectlevel3">
<li><a href="#_apx_unix_pam_workflow_prerequisites_and_limitations">A.9.1. UNIX-PAM Workflow Prerequisites and Limitations</a></li>
<li><a href="#_apx_configuring_unix_pam_workflows">A.9.2. Configuring UNIX-PAM Workflows</a></li>
<li><a href="#_apx_configuring_the_unix_pam_target_system">A.9.3. Configuring the UNIX-PAM Target System</a></li>
<li><a href="#_apx_unix_pam_workflow_and_activities">A.9.4. UNIX-PAM Workflow and Activities</a></li>
<li><a href="#_apx_unix_pam_ports">A.9.5. UNIX-PAM Ports</a></li>
<li><a href="#_apx_unix_pam_channels">A.9.6. UNIX-PAM Channels</a>
<ul class="sectlevel4">
<li><a href="#_apx_common_aspects_2">A.9.6.1. Common Aspects</a></li>
<li><a href="#_apx_accounts_2">A.9.6.2. Accounts</a></li>
<li><a href="#_apx_groups_2">A.9.6.3. Groups</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1">
<h2 id="_preface"><a class="anchor" href="#_preface"></a><a class="link" href="#_preface">Preface</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>This manual provides the information necessary to understand the DirX Identity default Connectivity applications and how to configure and extend them.It consists of the following chapters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="../ch1_applsref.html" class="xref page">Chapter 1</a> describes the different workflow architectures used in the default applications and how to customize these types.</p>
</li>
<li>
<p><a href="../ch2_reqWFs.html" class="xref page">Chapter 2</a> provides information about the request workflows available in the <strong>Provisioning</strong> view that support user self-registration and delegated administration activities.</p>
</li>
<li>
<p><a href="../ch3_configScen.html" class="xref page">Chapter 3</a> describes how to setup consistent custom scenarios both in the Provisioning configuration and Connectivity configuration.</p>
</li>
<li>
<p><a href="../ch4_defappls.html" class="xref page">Chapter 4</a> describes how to reuse the default applications in the Connectivity configuration.</p>
</li>
<li>
<p><a href="../ch5_sourceWFs.html" class="xref page">Chapter 5</a> describes Identity source workflows available in the <strong>Connectivity</strong> view that synchronize information from existing sources to the Identity Store.</p>
</li>
<li>
<p><a href="../ch6_maintWFs.html" class="xref page">Chapter 6</a> describes Identity maintenance workflows available in the <strong>Connectivity</strong> view that help to maintain your identity system to ensure consistent and current data of high quality.</p>
</li>
<li>
<p><a href="../ch7_targetWFs.html" class="xref page">Chapter 7</a> describes Identity target system workflows available in the <strong>Connectivity</strong> view that synchronize information from connected systems with the DirX Identity Store.</p>
</li>
<li>
<p><a href="../appa_depr.html" class="xref page">Appendix A</a> describes features that still work but should no longer be used because better features are available.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_prf_dirx_identity_documentation"><a class="anchor" href="#_prf_dirx_identity_documentation"></a><a class="link" href="#_prf_dirx_identity_documentation">DirX Identity Documentation</a></h3>
<div class="paragraph">
<p>DirX Identity provides a powerful set of pre-configured default applications that you can use to create your identity management environment. The default applications are intended for use as templates and are primarily designed to interact with the user, account and group objects in the Identity Store and the source and connected systems.</p>
</div>
<div class="sect3">
<h4 id="_dirx_identity_document_set"><a class="anchor" href="#_dirx_identity_document_set"></a><a class="link" href="#_dirx_identity_document_set">DirX Identity Document Set</a></h4>
<div class="paragraph">
<p>The DirX Identity document set consists of the following manuals:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>DirX Identity Introduction.</em> Use this book to obtain a description of DirX Identity architecture and components.</p>
</li>
<li>
<p><em>DirX Identity Tutorial</em>. Use this book to get familiar quickly with your DirX Identity installation.</p>
</li>
<li>
<p><em>DirX Identity Provisioning Administration Guide.</em> Use this book to obtain a description of DirX Identity provisioning architecture and components and to understand the basic tasks of DirX Identity provisioning administration using DirX Identity Manager.</p>
</li>
<li>
<p><em>DirX Identity Connectivity Administration Guide.</em> Use this book to obtain a description of DirX Identity connectivity architecture and components and to understand the basic tasks of DirX Identity connectivity administration using DirX Identity Manager.</p>
</li>
<li>
<p><em>DirX Identity User Interfaces Guide.</em> Use this book to obtain a description of the user interfaces provided with DirX Identity.</p>
</li>
<li>
<p><a href="../preface.html" class="xref page"><em>DirX Identity Application Development Guide</em></a>. Use this book to obtain information how to extend DirX Identity and to use the default applications.</p>
</li>
<li>
<p><em>DirX Identity Customization Guide</em>. Use this book to customize your DirX Identity environment.</p>
</li>
<li>
<p><em>DirX Identity Integration Framework</em>. Use this book to understand the DirX Identity framework and to obtain a description how to extend DirX Identity.</p>
</li>
<li>
<p><em>DirX Identity Web Center Reference</em>. Use this book to obtain reference information about the DirX Identity Web Center.</p>
</li>
<li>
<p><em>DirX Identity Web Center Customization Guide</em>. Use this book to obtain information how to customize the DirX Identity Web Center.</p>
</li>
<li>
<p><em>DirX Identity Meta Controller Reference</em>. Use this book to obtain reference information about the DirX Identity meta controller and its associated command-line programs and files.</p>
</li>
<li>
<p><em>DirX Identity Connectivity Reference</em>. Use this book to obtain reference information about the DirX Identity agent programs, scripts, and files.</p>
</li>
<li>
<p><em>DirX IdentityTroubleshooting Guide</em>. Use this book to track down and solve problems in your DirX Identity installation.</p>
</li>
<li>
<p><em>DirX Identity Installation Guide</em>. Use this book to install DirX Identity.</p>
</li>
<li>
<p><em>DirX Identity Migration Guide</em>. Use this book to migrate from previous versions.</p>
</li>
<li>
<p><em>DirX Identity Release Notes</em>. Use this book to understand the features and limitations of the current release. This document is shipped with the DirX Identity installation as the file <strong>Readme.txt</strong> or <strong>Readme.doc</strong>.</p>
</li>
<li>
<p><em>DirX Identity History of Changes</em>. Use this book to understand the features of previous releases. This document is shipped with the DirX Identity installation as the file <strong>HistoryOfChanges.txt</strong> or <strong>HistoryOfChanges.doc</strong>.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_notation_conventions"><a class="anchor" href="#_notation_conventions"></a><a class="link" href="#_notation_conventions">Notation Conventions</a></h4>
<div class="paragraph">
<p><strong>Boldface type</strong><br>
In command syntax, bold words and characters represent commands or keywords that must be entered exactly as shown.</p>
</div>
<div class="paragraph">
<p>In examples, bold words and characters represent user input.</p>
</div>
<div class="paragraph">
<p><em>Italic type</em><br>
In command syntax, italic words and characters represent placeholders for information that you must supply.</p>
</div>
<div class="paragraph">
<p>[ ]<br>
In command syntax, square braces enclose optional items.</p>
</div>
<div class="paragraph">
<p>{ }<br>
In command syntax, braces enclose a list from which you must choose one item.</p>
</div>
<div class="paragraph">
<p>In Tcl syntax, you must actually type in the braces, which will appear in boldface type.</p>
</div>
<div class="paragraph">
<p>|<br>
In command syntax, the vertical bar separates items in a list of choices.</p>
</div>
<div class="paragraph">
<p>...<br>
In command syntax, ellipses indicate that the previous item can be repeated.</p>
</div>
<div class="paragraph">
<p><em>install_path</em><br>
The exact name of the root of the directory where DirX Identity programs and files are installed. The default installation directory is <em>userID_home_directory</em>*/DirX Identity* on UNIX systems and <strong>C:\Program Files\DirX\Identity</strong> on Windows systems. During installation the installation directory can be specified. In this manual, the installation-specific portion of pathnames is represented by the notation <em>install_path</em>.</p>
</div>
<div class="paragraph">
<p><em>dxi_java_home</em><br>
The exact name of the root directory of the Java for DirX Identity. This location is defined during product installation. For details, see the sections "Installation" and "The Java for DirX Identity" in the <em>DirX Identity Installation Guide</em>.</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_understanding_the_default_application_workflow_technology"><a class="anchor" href="#_understanding_the_default_application_workflow_technology"></a><a class="link" href="#_understanding_the_default_application_workflow_technology">1. Understanding the Default Application Workflow Technology</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The default applications are constructed from three different workflow architectures:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Request workflows, which handle self-service and delegated administration requests that may require authorization by one or more human approvers.Request workflows operate inside the DirX Identity Store and allow you to define processes like creating a new user or modifying a user&#8217;s attributes and manage the approvals that are often required as part of these processes.Request workflows can work with any DirX Identity object type, for example, roles or policies.Request workflows can automatically trigger Java-based or Tcl-based workflows to provision the resulting identity data updates to the connected systems.The default request workflows provided with DirX Identity are available in the DirX Identity Manager&#8217;s <strong>Provisioning</strong> view group.</p>
</li>
<li>
<p>Java-based workflows, which handle both real-time and scheduled provisioning and synchronization.Java-based workflows work mainly with the user, account and group objects in the Identity Store and the source and connected systems.They operate primarily outside of the Identity Store and perform the provisioning / synchronization of identity data between source systems and the Identity Store and between connected systems and the Identity Store.(Note that it is possible to build Java-based workflows that work from the Identity Store to the Identity Store; the DirX Identity maintenance workflows are representatives of this type.) The runtime environment for Java-based workflows is provided by the Java-based Identity Server (IdS-J).The default Java-based workflows provided with DirX Identity are available in Identity Manager&#8217;s <strong>Connectivity</strong> view group</p>
</li>
<li>
<p>Tcl-based workflows, which handle scheduled provisioning and synchronization using the DirX Identity meta controller (<strong>metacp</strong>) and agents.Like the Java-based workflows, Tcl-based workflows work mainly with the user, account and group objects in the Identity Store and the source and connected systems, operate primarily outside of the Identity Store (the maintenance workflows are the exception) and provision and synchronize between the source systems, connected systems, and Identity Store.The runtime environment for Tcl-based workflows is provided by the C++-based Identity Server (IdS-C).Like the Java-based workflows, the default Tcl-based workflows provided with DirX Identity are available in Identity Manager&#8217;s <strong>Connectivity</strong> view group.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This chapter provides the following information about these workflows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>"Understanding Request Workflows" describes the architecture used for request workflows and how to customize them to your requirements.</p>
</li>
<li>
<p>"Understanding Java-based Workflows" describes the architecture used for the Java-based default connectivity workflows and how to customize them to your requirements.</p>
</li>
<li>
<p>"Understanding Tcl-based Workflows" describes the architecture used for the Tcl-based default connectivity workflows and how to customize them to your requirements.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_understanding_request_workflows"><a class="anchor" href="#_understanding_request_workflows"></a><a class="link" href="#_understanding_request_workflows">1.1. Understanding Request Workflows</a></h3>
<div class="paragraph">
<p>This section provides information about Java-based workflows, including information about:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Request workflow architecture</p>
</li>
<li>
<p>Customizing request workflows</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_ch1_request_workflow_architecture"><a class="anchor" href="#_ch1_request_workflow_architecture"></a><a class="link" href="#_ch1_request_workflow_architecture">1.1.1. Request Workflow Architecture</a></h4>
<div class="paragraph">
<p>You can use request workflows for a variety of tasks, including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Controlling user self registration</p>
</li>
<li>
<p>Creating objects (users, roles, and so on) with or without approval</p>
</li>
<li>
<p>Modifying objects (users, roles, and so on) and approving object attribute changes</p>
</li>
<li>
<p>Approving privilege assignment changes</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>DirX Identity Provisioning handles request workflows of any complexity with a wide variety of features, including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Graphical workflow configuration with multiple steps</p>
</li>
<li>
<p>Static, dynamic, group-based and rule-based approver list generation</p>
</li>
<li>
<p>Filters to help reduce or adapt a list of approvers</p>
</li>
<li>
<p>Constraints to specify, for example, minimum requirements on the number of participants</p>
</li>
<li>
<p>Dynamic activity generation based on lists</p>
</li>
<li>
<p>Sequential and parallel activity execution</p>
</li>
<li>
<p>Conditions like "All must succeed" or "Only one may decide"</p>
</li>
<li>
<p>WhenApplicable rules to restrict the application of a specific workflow template</p>
</li>
<li>
<p>Start conditions for activities, including AND and OR</p>
</li>
<li>
<p>Timeout definition for workflow and activities</p>
</li>
<li>
<p>Easy setup of e-mail notification</p>
</li>
<li>
<p>An unlimited number of escalation steps for each activity</p>
</li>
<li>
<p>An "active" flag to prohibit the execution of incomplete rules</p>
</li>
<li>
<p>Lifetime definition for workflow instances including automatic removal</p>
</li>
<li>
<p>Auditing</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The next section discusses the application of request workflows and provides some examples that explain the features in more detail.</p>
</div>
<div class="sect4">
<h5 id="_ch1_understanding_activity_types"><a class="anchor" href="#_ch1_understanding_activity_types"></a><a class="link" href="#_ch1_understanding_activity_types">1.1.1.1. Understanding Activity Types</a></h5>
<div class="paragraph">
<p>Request workflows consist of steps that we call "activities". Three basic types of request workflow activity exist:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>People activities</strong> - activities executed by one or more persons, which we call "participants". This type of activity needs some time (from several seconds to days).</p>
</li>
<li>
<p><strong>Error activities</strong> - activities that handle error conditions. These activities generally send e-mail to well-defined administrators.</p>
</li>
<li>
<p><strong>Automatic activities</strong> - activities executed by automated procedures. Examples of these activities include creating a global unique ID (GUID) for a user and creating the LDAP entry upon creation approval and sending an e-mail message.</p>
</li>
<li>
<p><strong>Conditional activities</strong> - activities that wait for some event. An example is the completion of a sub-workflow.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>DirX Identity supplies the following default <strong>people activities</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Approve assignment</strong>, which asks a participant to approve a specific user-to-privilege assignment. You define the participants and optionally the escalation steps. You typically set up an e-mail notification to inform the participants about this task.</p>
</li>
<li>
<p><strong>Approve delete</strong>, which asks a participant to approve an object deletion.</p>
</li>
<li>
<p><strong>Approve modification</strong>, which asks a participant to approve an object modification.</p>
</li>
<li>
<p><strong>Approve object</strong>, which presents a list of attributes to a participant that he must approve. You define the list and the sequence of attributes, the participants and optionally the escalation steps. You typically set up an e-mail notification to inform the participants about this task.</p>
</li>
<li>
<p><strong>Enter</strong> a<strong>ttributes</strong>, which allows a participant to enter a set of attributes for a new object. You define the list of attributes, their display name and whether they are optional or mandatory.</p>
</li>
<li>
<p><strong>Request privileges</strong>, which allows a participant to assign privileges. You can define the types of privileges (role, permission, group).</p>
</li>
<li>
<p><strong>Certification</strong> <strong>Campaigns</strong>, which allows a participant to certify a subject: a privilege or a user. For example, he can verify all manually assigned users of a role or manually assigned roles of a user.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>DirX Identity supplies the following default <strong>error activities</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>General Error</strong>, which sends an e-mail notification to someone who can analyze and solve the problem. This activity is discussed in more detail in the section "Request Workflow Error Handling".</p>
</li>
<li>
<p><strong>Error Handler</strong>, which sends an e-mail notification to someone if the workflow ran on timeout (status FAILED.EXPIRED).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>DirX Identity supplies the following default <strong>automatic activities</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Apply approved privileges</strong>, which implements a privilege assignment after approval was performed. It performs a privilege resolution and starts the necessary updates by creating update events (but only if <strong>Enable Real-time Provisioning</strong> is set at the target system).</p>
</li>
<li>
<p><strong>Apply object</strong>, which either creates the object if it does not yet exist or it performs all attribute changes as defined in the corresponding subject order (created by previous activity steps or workflows).<br>
<strong>Creation</strong> - can be used for all objects besides users. For users, use <strong>the Apply User With Assignments</strong> activity instead.<br>
<strong>Modification</strong> - can be used for all objects. It adds new attributes and modifies or deletes existing attributes. If the target object is a user, the activity checks whether one or more attributes are permission parameters and performs a privilege resolution if true. Privilege resolution may result in the creation of events for real-time synchronization workflows.</p>
</li>
<li>
<p><strong>Apply orders from ticket</strong>, which applies the subject order (if the flag is selected) that can be either a creation or a modification request for an object. In case of a user object it additionally evaluates assignments and starts (if required) approval workflows as child workflows.<br>
In conjunction with a <strong>Wait for child workflows</strong> activity the parent workflow is notified when the child workflow(s) are complete.<br>
If you use the <strong>Track changes in child</strong> workflows flag then all child workflows propagate their provisioning changes to the parent workflow. You can use the <strong>Wait for completed provisioning</strong> activity to check for completed provisioning of accounts and groups.</p>
</li>
<li>
<p><strong>Apply user with assignments</strong>, which either creates the user if it does not yet exist or it performs all attribute changes as defined in the corresponding subject order (created by previous activity steps or workflows). Additionally it evaluates all assignments as defined in the corresponding resource orders (created by previous activity steps or workflows).<br>
If an assignment requires approval, it starts an independent approval workflow. Otherwise, it performs a privilege resolution and starts the necessary updates by creating update events (but only if <strong>Enable Real-time Provisioning</strong> is set at the target system).</p>
</li>
<li>
<p><strong>Acknowledge update</strong>, used in manual provisioning workflows to set the states according to the performed action. Note that this activity cannot verify whether the administrator performed the action correctly. This activity sets the <strong>TS State</strong> account or group states as defined by the <strong>State</strong> attribute and the membership states as defined by DirX Identity.</p>
</li>
<li>
<p><strong>Calculate VMID GUID</strong>, which calculates a VMID global unique identifier and adds the calculated value into a definable object attribute.</p>
</li>
<li>
<p><strong>Calculate Siemens GUID</strong>, which calls the Siemens internal GUID generator web service to calculate a global unique identifier and adds the calculated value into a definable object attribute. The activity provides a new GUID value for an identity or an error message if the request is not sufficient or the identity already exists. An optional search can be configured that retrieves the existing GUID if the GUID generation failed because the identity already exists.</p>
</li>
<li>
<p><strong>Calculate Risk</strong>, used in risk approval workflows to compute the risk level that a requested privilege assignment would have if it was approved. For new/deleted group assignments, the activity calculates the risk and then merges these new risks with the risk values that have already been calculated to define the new possible risk level. This new risk level is stored in the application state and in the workflow context (name: <strong>risklevel</strong>). Values of 0, 1, 2 and 3 are possible, where 3 indicates high risk. The user&#8217;s old risk level is stored in the workflow context (name: <strong>oldrisklevel</strong>). If risk checking is not active at the domain, nothing is done and the activity succeeds. If risk checking is active but there is no active risk policy, the activity generates an error. You can use the parameter <strong>Force An Error If no actual RiskLevel</strong> is available to control how the activity functions when risk is active but risk values have not already been computed for a given user. If this parameter is unchecked, the value 0 is used as the risk level and is stored in the application state and the workflow context. You can configure your workflow&#8217;s start conditions to respond to this value in a particular way; otherwise, an error is generated. You can also use the workflow&#8217;s <strong>risklevel</strong> or <strong>oldrisklevel</strong> context variables for the start conditions of other activities to respond to special values.</p>
</li>
<li>
<p><strong>Check SoD</strong>, which checks for SoD violations and automatically starts approval workflows if an SoD violation is detected.</p>
</li>
<li>
<p><strong>Map attributes</strong>, which lets you define additional attributes or recalculate existing ones (in this workflow order). You can use it to set constants or to combine attributes to fill another attribute (for example 'cn=${sn} + " " + ${givenName}').</p>
</li>
<li>
<p><strong>Send e-mail</strong>, which sends an e-mail notification. Use this type of activity if the e-mail notification is conditional; that is, it&#8217;s only executed if a specific workflow application state (see the section "Handling Request Workflow States") or state of the previous activity occurs. Activities of this type are visible in the graphical workflow structure.</p>
</li>
<li>
<p><strong>Split order</strong>, which delivers an Application State attribute according to the order type. Valid values are <strong>Add</strong>, <strong>Modify</strong> or <strong>Delete</strong>.</p>
</li>
<li>
<p><strong>Wait for completed provisioning</strong>, which is a conditional activity that waits for the completion of all related provisioning steps that were initiated by the parent workflow and all child workflows. The activity polls for the expected provisioning results. On completion, the workflow proceeds and the results are available in the workflow context. If some provisioning results are pending, the activity uses the retry mechanism to wait for some period of time before performing the next check. Configure the retry mechanism - for example, for 500 retries of 5 minutes - to be sure that provisioning has enough time to complete.<br>
This activity requires correct settings of previous activities:</p>
</li>
<li>
<p>All apply activities have the flag <strong>Track changes</strong>. If you set it, all resulting provisioning actions of this activity are noted in a list in the workflow context.</p>
</li>
<li>
<p>The <strong>Apply Order</strong> activity also has the flag <strong>Track Changes in Child Workflow</strong>. When set, it enforces the child workflows to propagate all resulting provisioning actions to the parent workflow. They are integrated into the list in the workflow context.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The filled list is then used by the <strong>Wait for completed provisioning</strong> activity to check the results.</p>
</div>
<div class="paragraph">
<p>DirX Identity supplies the following default <strong>conditional activities</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Wait for child workflows</strong> is a conditional activity that waits for completion of child workflows. It checks whether child workflows are started. If so, it stops further execution of the workflow. If a child workflow finishes, it notifies this activity about its completion, its states, and the changes it performed if the flag <strong>Track Changes in Child Workflow</strong> was checked at the preceding Apply Order activity. Parent and child workflows must be correctly and consistently configured. In the parent workflow, the <strong>Wait for child workflows</strong> activity requires a preceding <strong>Apply Order</strong> activity where you can set the aforementioned flag. If all child workflows are finished, workflow execution continues.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch1_about_the_activity_sub_structure"><a class="anchor" href="#_ch1_about_the_activity_sub_structure"></a><a class="link" href="#_ch1_about_the_activity_sub_structure">1.1.1.2. About the Activity Sub-Structure</a></h5>
<div class="paragraph">
<p>Request workflow activities have a fixed sub-structure that makes workflow design easier and keeps workflow definitions simple. The following figure illustrates this sub-structure:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch1_applsref/image1.png" alt="Activity Sub-structure">
</div>
<div class="title">Figure 1. Activity Sub-structure</div>
</div>
<div class="paragraph">
<p>Activity sub-structure elements are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Pre step</strong> - an optional step that typically contains a notification to the participants of the main step. Note that failure of this step is logged but has no effect on the state of the activity.</p>
</li>
<li>
<p><strong>Main step</strong> - the main part of the activity, for example, an approval step. This step sets the state and application state values for the entire activity.</p>
</li>
<li>
<p><strong>Post step</strong> - an optional step that typically contains a notification after the main activity is completed. Note that failure of this step is logged but has no effect on the state of the activity.</p>
</li>
<li>
<p><strong>Error</strong> <strong>step</strong> - an optional definition of the error notification to be sent to the administrator if the main step fails. If this sub activity is not configured, the activity goes to state <strong>Failed</strong> and the <strong>General</strong> <strong>Error</strong> activity is activated. See the section "Request Workflow Error Handling" for more details.</p>
</li>
<li>
<p><strong>Escalations</strong> <strong>step</strong> - an optional definition of escalation steps. If escalations are defined, the complete activity is re-calculated with the escalation definition and run again. The previous activity remains in state <strong>Failed</strong>.<strong>Expired</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The main step is always present and must be defined. All other steps are optional. You can activate and deactivate them as required. An active step is shown in yellow, while an inactive step is shown in gray.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch1_understanding_notifications"><a class="anchor" href="#_ch1_understanding_notifications"></a><a class="link" href="#_ch1_understanding_notifications">1.1.1.3. Understanding Notifications</a></h5>
<div class="paragraph">
<p>You can define explicit or implicit notifications:</p>
</div>
<div class="paragraph">
<p><strong>Explicit notifications</strong> are directly visible in the graphical workflow structure. You use an explicit notification for conditional e-mail notification; for example, an e-mail to be sent if an approval is rejected or if a previous activity fails.</p>
</div>
<div class="paragraph">
<p><strong>Implicit notifications</strong> are part of the (fixed) sub-structure of an activity (see the section "About the Activity Sub-Structure" for details). You can activate or deactivate this type of activity. Use an implicit notification if it is closely related to the activity&#8217;s main task. Typical uses are a notification request to the participants of an approval task or an informational notification after a task has been performed.</p>
</div>
<div class="paragraph">
<p>In some cases, it is up to you to choose between an explicit or implicit notification. Implicit notifications help to keep workflow definitions simple by reducing superfluous or recurring information.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch1_html_notifications"><a class="anchor" href="#_ch1_html_notifications"></a><a class="link" href="#_ch1_html_notifications">1.1.1.4. HTML Notifications</a></h5>
<div class="paragraph">
<p>You can send notifications in plain text or in HTML format.</p>
</div>
<div class="paragraph">
<p>Most of the request workflow templates delivered with DirX Identity are set up as plain text mails. One example is set up as HTML mail.</p>
</div>
<div class="paragraph">
<p>Default &#8594; Assignments &#8594; Manager Nomination &#8594; Approval by Company Head (notifyBefore)</p>
</div>
<div class="paragraph">
<p>In this example, we did not set up nationalization to show the HTML code in one piece.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-html hljs" data-lang="html">&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"&gt;
&lt;HTML&gt;
&lt;HEAD&gt;
&lt;META http-equiv=Content-Type content="text/html; charset=iso-8859-1"&gt;
&lt;STYLE type=text/css&gt;P.generalquestions {
BORDER-RIGHT: #bcd 1px solid; BORDER-TOP: #bcd 1px solid; FONT-SIZE: 10px; BORDER-LEFT: #bcd 1px solid; COLOR: #039; BORDER-BOTTOM: #bcd 1px solid; FONT-FAMILY: Arial,sans-serif}
&lt;/STYLE&gt;
&lt;META content="MSHTML 6.00.6000.17102" name=GENERATOR&gt;
&lt;/HEAD&gt;
&lt;BODY&gt;
&lt;B&gt;
&lt;? if ${to.gender} == "W" ?&gt;
Dear Mrs. ${to.sn},
&lt;? else ?&gt;
Dear Mr. ${to.sn},
&lt;? endif ?&gt;
&lt;/B&gt;
&lt;P&gt;&lt;/P&gt;
&lt;P&gt;Please approve the following privilege assignment:
&lt;BR&gt;User: &lt;B&gt;${workflow.subject.cn}&lt;/B&gt;
&lt;BR&gt;Privilege: &lt;B&gt;${workflow.resources[0].dxrassignto@cn}&lt;/B&gt; &lt;/P&gt;
&lt;P&gt;To approve, follow the link: &lt;A href="${workflow.approvalLink}"&gt;Web Center&lt;/A&gt; &lt;/P&gt;
&lt;P&gt;&lt;I&gt;This is an automatically generated mail. Please do not reply.&lt;/I&gt; &lt;/P&gt;
&lt;P class=generalquestions&gt;For general questions about this workflow please contact:
&lt;I&gt;&lt;A href="mailto:${workflow.owner.mail}"&gt;Pitton Lavina&lt;/A&gt;&lt;/I&gt;
&lt;BR&gt;Workflow: ${workflow.path}
&lt;BR&gt;Activity: ${name} &lt;/P&gt;
&lt;/BODY&gt;
&lt;/HTML&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The SendMail workflow recognizes the HTML format from the DOCTYPE statement at the very beginning. The example shows that you can integrate variables (for example ${workflow.subject.cn}) and conditional statements (here the &lt;? if ?&gt; statement) without any problems. Read more about using variables and conditional statements in the section "Using Variable Substitution".</p>
</div>
<div class="paragraph">
<p>Although you can separate pieces of this code into nationalization items, we recommend setting up the whole HTML code first, testing it and then dividing it into nationalization items that you can then reuse.</p>
</div>
<div class="paragraph">
<p>To play with this example, for example, in the My-Company sample domain:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Copy the workflow and activate it.</p>
</li>
<li>
<p>Restart the Java-based Server or perform <strong>Load IdS-J Configuration</strong>.</p>
</li>
<li>
<p>Assign the workflow to any privilege directly.</p>
</li>
<li>
<p>Assign the privilege to a user.</p>
</li>
<li>
<p>An approval workflow should be started and the mail should be sent.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch1_understanding_request_workflow_states"><a class="anchor" href="#_ch1_understanding_request_workflow_states"></a><a class="link" href="#_ch1_understanding_request_workflow_states">1.1.1.5. Understanding Request Workflow States</a></h5>
<div class="paragraph">
<p>The states of the request workflow and its activities are closely related. This section describes request workflow states and activity states.</p>
</div>
<div class="sect5">
<h6 id="_ch1_types_of_request_workflow_states"><a class="anchor" href="#_ch1_types_of_request_workflow_states"></a><a class="link" href="#_ch1_types_of_request_workflow_states">1.1.1.5.1. Types of Request Workflow States</a></h6>
<div class="paragraph">
<p>A request workflow object has two types of state:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A workflow state, which indicates the general state of the workflow and has fixed values such as <strong>Succeeded</strong> or <strong>Failed</strong>. DirX Identity&#8217;s request workflow service automatically sets this state.</p>
</li>
<li>
<p>A workflow application state, which is a programmable state that is controlled by the specific workflow definition. For approval workflows, the possible values for the workflow application state are <strong>Accepted</strong> or <strong>Rejected</strong>. DirX Identity customers can define their own states, and if there are no special states defined, the application state value can also be empty.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following figure illustrates request workflow states:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch1_applsref/image2.png" alt="Request Workflow States">
</div>
<div class="title">Figure 2. Request Workflow States</div>
</div>
<div class="paragraph">
<p>Workflow states are:</p>
</div>
<div class="paragraph">
<p><strong>(None)</strong> - the Java-based Identity Server is aware of the workflow definition (because it is flagged as active) but instances of the workflow do not yet exist.</p>
</div>
<div class="paragraph">
<p><strong>Running</strong> - the request workflow service has started an instance of this workflow definition after receiving an appropriate event.</p>
</div>
<div class="paragraph">
<p><strong>Succeeded</strong> - the run of the workflow instance is formally successful; that is, a final activity has succeeded. If this activity contains an application state, the workflow instance inherits it. The request workflow service takes the application state from the calculated value of the final activity or, if there is no value there, the display name of the start condition. If the display name is empty, the application state will be empty, too.</p>
</div>
<div class="paragraph">
<p>*Failed.*<em>state</em> - the run of the workflow instance has failed. Check the activity states to see the details. <em>state</em> indicates the following special states:</p>
</div>
<div class="paragraph">
<p><strong>Failed.Prepare</strong> - the state inherited from the relevant activity, which is the activity that an administrator or the request workflow service (for example, by retries) could not resolve before it reached its defined timeout value and entered an error condition.</p>
</div>
<div class="paragraph">
<p><strong>Failed.Incomplete</strong> - the request workflow service discovered a structural error in the workflow definition but the workflow has not yet completed because:<br>
- a startable activity no longer exists<br>
- a running activity no longer exists<br>
- a finished final activity is not available</p>
</div>
<div class="paragraph">
<p><strong>Failed.Expired</strong> - there was either a timeout inherited by the relevant activity or a timeout of the complete workflow.</p>
</div>
<div class="paragraph">
<p><strong>Failed.Aborted</strong> - either a user has cancelled this workflow instance or the timeout was inherited from the relevant activity (a user has cancelled this activity). If a user cancels the workflow, all activities that are still running go to status Failed.Aborted, too.<br>
<br>
If parallel activities must all succeed, this state is also reached if one of the parallel activities goes to state REJECTED.</p>
</div>
<div class="paragraph">
<p><strong>Failed</strong> - any other error inherited from the relevant activity</p>
</div>
<div class="paragraph">
<p>See the section "Request Workflow Error Handling" for more information.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_understanding_request_workflow_activity_states"><a class="anchor" href="#_ch1_understanding_request_workflow_activity_states"></a><a class="link" href="#_ch1_understanding_request_workflow_activity_states">1.1.1.5.2. Understanding Request Workflow Activity States</a></h6>
<div class="paragraph">
<p>The following figure illustrates the request workflow activity states:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch1_applsref/image3.png" alt="Request Workflow Activities">
</div>
<div class="title">Figure 3. Request Workflow Activities</div>
</div>
<div class="paragraph">
<p>Activity states are:</p>
</div>
<div class="paragraph">
<p><strong>(None)</strong> - the activity instance exists but the start condition is not yet satisfied.</p>
</div>
<div class="paragraph">
<p><strong>Running</strong> - the activity instance is running due to a satisfied start condition.</p>
</div>
<div class="paragraph">
<p><strong>Succeeded</strong> - the run of this activity instance was successful.</p>
</div>
<div class="paragraph">
<p><strong>Failed.Prepare</strong> - an exception occurred during the participant constraint calculation that is not ConstraintViolationException.</p>
</div>
<div class="paragraph">
<p><strong>Failed.Temporary</strong> - the activity determined that the error that occurred is only temporary (for example, the network is temporarily unavailable). If retries are configured for this activity, the request workflow service starts the activity after the <strong>Wait before retry</strong> period to resolve the error. If no retries remain, the activity goes to status <strong>Failed.Expired</strong>.</p>
</div>
<div class="paragraph">
<p><strong>Failed</strong> - the run of this activity instance failed due to a non recoverable error and no <strong>Error</strong> sub activity is configured.</p>
</div>
<div class="paragraph">
<p><strong>WaitInError</strong> - the run of this activity instance failed due to a non-recoverable error and an <strong>Error</strong> sub activity is configured. This error activity is used to send a notification to the administrator, who can resolve the problem and resume the workflow, or cancel the workflow if he cannot resolve the problem.</p>
</div>
<div class="paragraph">
<p><strong>Failed.Aborted</strong> - a user cancelled this activity.</p>
</div>
<div class="paragraph">
<p><strong>Cancelled</strong> - the request workflow service canceled this (parallel) activity because another user approved this step.</p>
</div>
<div class="paragraph">
<p><strong>Failed.Expired</strong> - the run of this activity instance failed due to a timeout or a <strong>Failed.Temporary</strong> condition. In this case, the request workflow service checks whether retries are configured. If they are, it restarts the activity. If the activity sub-structure contains a pre-step, it reminds the relevant user that there is still a task to do. If retries are not configured, the workflow engine sets the activity state to <strong>Failed.Expired</strong> and determines whether an escalations step is configured and still available. If no, the activity is completed and remains in the <strong>Failed</strong>.<strong>Expired</strong> state. If yes, the escalation definition is evaluated and a new activity is started.</p>
</div>
<div class="paragraph">
<p>See also the section "Request Workflow Error Handling" for more information.</p>
</div>
<div class="paragraph">
<p>The workflow calculates participants in an activity by evaluating:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The configured participant calculation mechanism; for example, a static list or access policies.</p>
</li>
<li>
<p>The participants filter (it removes, for example, the initiator of this workflow).</p>
</li>
<li>
<p>The participants constraints, as follows:</p>
</li>
<li>
<p>If participant constraints are not defined and no approver is retrieved, the request workflow service assumes a correct approval (activity state = <strong>Succeeded</strong>, application state = <strong>Accepted</strong>).</p>
</li>
<li>
<p>If participant constraints are defined and the exception thrown is <strong>ConstraintViolationException</strong>, the routine (Java class) that the workflow designer has written to calculate the constraints can set the state and application state to any value and return it to the workflow engine. Thus in this case, the workflow designer has complete control over these values.</p>
</li>
<li>
<p>If participant constraints are defined and the exception thrown is <em>not</em> <strong>ConstraintViolationException</strong>, the workflow&#8217;s General Error activity starts and sets this activity and the workflow state to <strong>Failed.Prepare</strong> to indicates a serious error.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch1_understanding_the_full_checker"><a class="anchor" href="#_ch1_understanding_the_full_checker"></a><a class="link" href="#_ch1_understanding_the_full_checker">1.1.1.6. Understanding the Full Checker</a></h5>
<div class="paragraph">
<p>The full checker is a built-in service to handle running request workflow instances. It runs on a regular basis and checks all entries that are still in a "running" state for special conditions.</p>
</div>
<div class="paragraph">
<p>The full check that works on all running workflows is no longer needed, thus the checkallinterval is set to 0 to disable it by default.</p>
</div>
<div class="sect5">
<h6 id="_ch1_full_check_for_expired_workflows_and_activities"><a class="anchor" href="#_ch1_full_check_for_expired_workflows_and_activities"></a><a class="link" href="#_ch1_full_check_for_expired_workflows_and_activities">1.1.1.6.1. Full Check for Expired Workflows and Activities</a></h6>
<div class="paragraph">
<p>Checks for expired workflows and activities.</p>
</div>
<div class="paragraph">
<p>The filter for workflow instances is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ldap hljs" data-lang="ldap">|(&amp;(dxrExpirationDate&lt;=__current_date__)(dxrState="RUNNING"))(dxrState="UNDERCONSTRUCTION")(dxrState=RUNNABLE)</code></pre>
</div>
</div>
<div class="paragraph">
<p>The filter for activity instances is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ldap hljs" data-lang="ldap">|(&amp;(dxrExpirationDate&lt;=__current_date__)(dxrState="RUNNING"))(dxrState=RETRY)(dxrState=WAITINERROR)(dxrState=RUNNABLE)</code></pre>
</div>
</div>
<div class="paragraph">
<p>This type of the full checker runs every 30 minutes by default.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_full_check_for_all_running_workflows"><a class="anchor" href="#_ch1_full_check_for_all_running_workflows"></a><a class="link" href="#_ch1_full_check_for_all_running_workflows">1.1.1.6.2. Full Check for All Running Workflows</a></h6>
<div class="paragraph">
<p>Checks all instances in state running for these conditions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Determines whether a timeout condition occurred. If yes, it handles the timeout (see the section "Understanding Request Workflow States" for details).</p>
</li>
<li>
<p>Checks whether there are running workflows and/or activities that have expired. If such workflows or activities are detected, the corresponding workflows are forwarded to the workflow engine, which will calculate the next activities.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The filter to search for these instances is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ldap hljs" data-lang="ldap">|(dxrState="RUNNABLE")(dxrState="RUNNING")(dxrState="UNDERCONSTRUCTION")(!(dxrState=*))</code></pre>
</div>
</div>
<div class="paragraph">
<p>By default, this type of the full checker is disabled. If it is enabled, it is started automatically about 1 minute after server start.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_full_checker_configuration"><a class="anchor" href="#_ch1_full_checker_configuration"></a><a class="link" href="#_ch1_full_checker_configuration">1.1.1.6.3. Full Checker Configuration</a></h6>
<div class="paragraph">
<p>You can change the full checker intervals in the <strong>server.xml</strong> for request workflows under this path:</p>
</div>
<div class="paragraph">
<p><em>install_path</em>*\ids-j-<strong><em>domain</em></strong>-S*<em>n</em>*\extensions\com.siemens.idm.requestworkflow\server.xml*</p>
</div>
<div class="paragraph">
<p>where <em>domain</em> is the domain for which the IdS-J server is running and <strong>S*<em>n</em> is the server number (counts per domain). For example, *ids-j-My-Company-S1</strong>. See the section on "Naming Schemes" in the section "Managing Java-based Servers" in the <em>DirX Identity Connectivity Administration Guide</em> for a discussion of the naming schemes used for DirX Identity services.</p>
</div>
<div class="paragraph">
<p>Search for the <code>&lt;schedules&gt;</code> tag:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;schedules&gt;
&lt;RequestWorkflowFullCheck&gt;
&lt;class&gt;com.siemens.idm.requestworkflow.tasks.FullCheck&lt;/class&gt;
&lt;start&gt;0&lt;/start&gt;
&lt;!-- interval when all expired workflows and activities are checked (in msec) --&gt;
&lt;period&gt;**1800000**&lt;/period&gt;
&lt;singleton&gt;true&lt;/singleton&gt;
&lt;!-- interval when all (running) workflows are checked (in msec) --&gt;
&lt;checkallinterval&gt;**0**&lt;/checkallinterval&gt;
&lt;/RequestWorkflowFullCheck&gt;
&lt;/schedules&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can set the full check interval for expiration checks with the parameter &lt;period&gt; in milliseconds. By default, 1800 000 ms = 30 min are set.</p>
</div>
<div class="paragraph">
<p>You can also set the full check interval for all running workflows with the parameter &lt;checkallinterval&gt; in milliseconds. By default, this mode is disabled.</p>
</div>
<div class="paragraph">
<p>If you want to run with a large number of running workflows, we recommend using these settings:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;period&gt;3600000&lt;/period&gt; &lt;!-- 60 minutes --&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>and</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;checkallinterval&gt;0&lt;/checkallinterval&gt; &lt;!-- service disabled --&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch1_request_workflow_error_handling"><a class="anchor" href="#_ch1_request_workflow_error_handling"></a><a class="link" href="#_ch1_request_workflow_error_handling">1.1.1.7. Request Workflow Error Handling</a></h5>
<div class="paragraph">
<p>The request workflow service handles various types of errors. See the section "Understanding Request Workflow States" for details.</p>
</div>
<div class="paragraph">
<p>For each request workflow activity, you can configure an <strong>Error</strong> sub-structure element that allows you to define a specific error notification to be sent to the administrator if the activity&#8217;s main step fails (see the section "About the Activity Sub-Structure" for details). If a non-recoverable error occurs in an activity, it goes to state <strong>WaitInError</strong>. If the <strong>Error</strong> sub-activity is not defined, the activity goes to state <strong>Failed</strong> and the default error activity <strong>General</strong> <strong>Error</strong> takes control.</p>
</div>
<div class="paragraph">
<p>For each workflow, the <strong>General Error</strong> activity is configured by default as Error Activity, which sends a notification to the workflow initiator that something is wrong. You can create your own workflow-specific or workflow group-specific error activities and link them to a workflow or a group of workflows to implement special behavior.</p>
</div>
<div class="paragraph">
<p>The request workflow service calls the <strong>General</strong> <strong>Error</strong> activity once during each workflow re-calculation (either triggered by an internal status change event from an activity or by a full check from the workflow engine itself). The <strong>General</strong> <strong>Error</strong> activity:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Checks all activities to determine whether they are in a <strong>Failed</strong>.<em>state</em> that is not <strong>Failed</strong>.<strong>Expired</strong> or <strong>Failed</strong>.<strong>Temporary</strong>.</p>
</li>
<li>
<p>For activities that meet this determination, the request workflow service aborts the workflow and sets the workflow state and application state to the states of the failed activity. If several activities in a workflow meet the determination, the request workflow service selects one at random and uses its states.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can configure an <strong>ErrorHandler</strong> for workflow timeout (status FAILED.EXPIRED). Simply add this activity to your workflow definition. It should not be connected to any other activity. It sends an e-mail if the workflow times out.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch1_nationalizing_request_workflows"><a class="anchor" href="#_ch1_nationalizing_request_workflows"></a><a class="link" href="#_ch1_nationalizing_request_workflows">1.1.1.8. Nationalizing Request Workflows</a></h5>
<div class="paragraph">
<p>People activities within request workflows create dynamic pages in Web Center. For complete nationalization of Web Center pages, you need to</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use the Web Center&#8217;s nationalization feature for all static pages (see the chapter "Adding Languages" in the <em>Identity Web Center Customization Guide</em>).</p>
</li>
<li>
<p>Use the Request Workflow&#8217;s nationalization feature for all dynamic pages.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The next section describes the nationalization concept for dynamic pages.</p>
</div>
<div class="paragraph">
<p>Note that DirX Identity is delivered by default with message items in the locales <strong>en</strong> and <strong>de</strong>.</p>
</div>
<div class="sect5">
<h6 id="_ch1_understanding_request_workflow_nationalization"><a class="anchor" href="#_ch1_understanding_request_workflow_nationalization"></a><a class="link" href="#_ch1_understanding_request_workflow_nationalization">1.1.1.8.1. Understanding Request Workflow Nationalization</a></h6>
<div class="paragraph">
<p>DirX Identity&#8217;s concept for nationalization of dynamic Web Pages and also mail content is based on the Java concept for nationalization. A text element can keep one or more message items that are replaced during runtime with text that corresponds to the user&#8217;s requested language.</p>
</div>
<div class="paragraph">
<p>An example for a mail body within a request workflow activity is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">#{Request Workflows/Assignment Workflows.AssignmentOfPrivilegeRejected_body}

#{Common Text.ContactPersonsThatRejected}

&lt;? for activity in ${workflow.activities} ?&gt;
&lt;? if ${activity.applicationState} == "REJECTED" ?&gt;
&lt;? for participant in ${activity.approvers} ?&gt;
#{Request Workflows/Assignment Workflows.AssignmentOfPrivilegeRejected_loopline}
&lt;? endfor ?&gt;
&lt;? endif ?&gt;
&lt;? endfor ?&gt;

#{Common Text.AutomaticGeneratedMail}

#{Common Text.GeneralQuestions}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the English language is requested, this generic text definition is resolved as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">The assignment of privilege ${workflow.resources[0].dxrassignto@cn} to user ${workflow.subject.cn} was rejected.

Please contact the persons that rejected the request:

&lt;? for activity in ${workflow.activities} ?&gt;
&lt;? if ${activity.applicationState} == "REJECTED" ?&gt;
&lt;? for participant in ${activity.approvers} ?&gt;
- Activity step: '${activity.name}': User ${participant.cn} with reason: ${activity.reason}
&lt;? endfor ?&gt;
&lt;? endif ?&gt;
&lt;? endfor ?&gt;

This is an automatically generated mail. Please do not reply.

For general questions about this workflow please contact: ${workflow.owner.mail} +
Workflow: ${workflow.path} +
Activity: ${name}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For example, the definition</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">#{Common Text.AutomaticGeneratedMail}</code></pre>
</div>
</div>
<div class="paragraph">
<p>is resolved to</p>
</div>
<div class="paragraph">
<p>This is an automatically generated mail. Please do not reply.</p>
</div>
<div class="paragraph">
<p>Note that message items can contain variables, for example ${workflow.subject.cn} that are replaced during runtime with the corresponding value, in this case the common name of the subject. For more information about this concept, see the section "Using Variable Substitution" in the <em>DirX Identity Application Development Guide</em>.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_using_the_nationalization_wizard"><a class="anchor" href="#_ch1_using_the_nationalization_wizard"></a><a class="link" href="#_ch1_using_the_nationalization_wizard">1.1.1.8.2. Using the Nationalization Wizard</a></h6>
<div class="paragraph">
<p>Some fields within DirX Identity support nationalization. Typical fields are the subject or the body of a mail definition.</p>
</div>
<div class="paragraph">
<p>To determine whether a field supports nationalization, use the Identity Manager to view the description of the individual field in the online help. Alternatively, you can click in a field and view the context menu, which may show you the menu items of the nationalization wizard.</p>
</div>
<div class="paragraph">
<p>In read mode, one menu item is available:</p>
</div>
<div class="paragraph">
<p><strong>Show resolved text</strong> - click this item to resolve all message items to the language definitions defined by the <strong>Default Language</strong> field in the domain object.</p>
</div>
<div class="paragraph">
<p>In edit mode, these menu items are visible:</p>
</div>
<div class="paragraph">
<p><strong>Insert a message</strong> - the nationalization wizard opens and presents the central message item tree under Configuration &#8594; Nationalization. Select a message item object in the language of your choice and then select a message from the list of message items. The wizard inserts the corresponding message item at the cursor location.</p>
</div>
<div class="paragraph">
<p><strong>Insert a message relative</strong> - the nationalization wizard opens and presents the local message items for this workflow. Select a message item object in the language of your choice and then select a message from the list of message items. The wizard inserts the corresponding message item at the cursor location.</p>
</div>
<div class="paragraph">
<p><strong>Show resolved text</strong> - click this item to resolve all message items to the language definitions defined by the <strong>Default Language</strong> field in the domain object.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_organizing_message_topics"><a class="anchor" href="#_ch1_organizing_message_topics"></a><a class="link" href="#_ch1_organizing_message_topics">1.1.1.8.3. Organizing Message Topics</a></h6>
<div class="paragraph">
<p>To optimize nationalization message management, you can define messages at two locations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>You can define more common message items in the central Nationalization folder in the Domain Configuration, which allows you to reuse messages in many objects. Message references to these items can be seen as absolute references.</p>
</li>
<li>
<p>You can define specific message items together with your configuration object, for example, the request workflow definition. Message references to these items can be seen as relative references. If you copy this type of configuration object, the message items are also copied and the references are still valid and point to your copied configuration object.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Use both methods to structure your message catalog. Try to reuse messages as much as possible.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_customizing_request_workflow_nationalization"><a class="anchor" href="#_ch1_customizing_request_workflow_nationalization"></a><a class="link" href="#_ch1_customizing_request_workflow_nationalization">1.1.1.8.4. Customizing Request Workflow Nationalization</a></h6>
<div class="paragraph">
<p>DirX Identity provides three methods for customizing request workflow nationalization:</p>
</div>
<div class="paragraph">
<p><strong>Local message items</strong> - you can copy a request workflow together with its local nationalization items. You can change the local items because they are copies of the original objects. You can also extend them with other locales.</p>
</div>
<div class="paragraph">
<p><strong>Central default message items</strong> (under the path <strong>Nationalization</strong>) - you can extend the existing default message items with additional locales but you cannot change the delivered default message items.</p>
</div>
<div class="paragraph">
<p><strong>Custom default message items</strong> (under the path <strong>Nationalization &#8594; Customer Extensions</strong>) - if you need additional central message item definitions, define them under this folder. Use folders to structure the items accordingly. Set up items for all required locales.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_using_an_external_nationalization_editor"><a class="anchor" href="#_ch1_using_an_external_nationalization_editor"></a><a class="link" href="#_ch1_using_an_external_nationalization_editor">1.1.1.8.5. Using an External Nationalization Editor</a></h6>
<div class="paragraph">
<p>You can use the built-in features of the Identity Manager to create and maintain message items, particularly if you create new workflow definitions with the corresponding message items in the primary language.</p>
</div>
<div class="paragraph">
<p>Use an external nationalization editor primarily to</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Check the consistency of a large number of message items</p>
</li>
<li>
<p>Add a new language</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The export file format is comma-separated values (CSV). You can use any tools that allow you to edit CSV files correctly.</p>
</div>
<div class="paragraph">
<p>The following sections explain how to export and import nationalization information and how to edit the items with Microsoft Excel.</p>
</div>
<div class="paragraph">
<p>Exporting Nationalization Information</p>
</div>
<div class="paragraph">
<p>You can export the complete nationalization information into one file or you can select specific parts of the information:</p>
</div>
<div class="paragraph">
<p><strong>File &#8594; Export Nationalization Items</strong> - use this menu item from the menu bar to export all nationalization information into one file. A file selection dialog asks for the file location and name.</p>
</div>
<div class="paragraph">
<p><strong>Export Nationalization Items</strong> - use this context menu item at a message item folder or message item to export a subtree or a single item into a file. A file selection dialog asks for the file location and name.</p>
</div>
<div class="paragraph">
<p>You can specify the delimiter that is used with the parameter <strong>nationalization.csv.delimiter</strong> in the file <strong>dxi.cfg</strong>. By default, we use a semicolon ';'. Note: after changing this file, you must restart the Identity Manager.</p>
</div>
<div class="paragraph">
<p>The format of the file looks like this if two languages are exported (Excel representation):</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 26%;">
<col style="width: 22%;">
<col style="width: 27%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>path</strong></th>
<th class="tableblock halign-left valign-top"><strong>key</strong></th>
<th class="tableblock halign-left valign-top"><strong>de</strong></th>
<th class="tableblock halign-left valign-top"><strong>en</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Prov:Configuration/Nat&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">dxrStartDate</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Start Datum</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Start Date</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">mobile</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mobiltelefonnummer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mobile</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Prov:Configuration/Nat&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RequestApproval_body</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bitte genehmigen Sie die folgende Anforderung:<br>
Benutzer : ${workflow.subject.cn}<br>
Berechtigung: ${workflow.resources[0].dxrassignto@cn}"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Please approve the following request:<br>
User: ${workflow.subject.cn}<br>
Resource: ${workflow.resources[0].dxrassignto@cn}"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The first line is the header line. The field definitions are as follows:</p>
</div>
<div class="paragraph">
<p>path - the object path of this message item (for example, "Conn:Configuration/Nationalization/Attribute Descriptions"). The last part is the name of the message item (here "Attribute Descriptions").</p>
</div>
<div class="paragraph">
<p>key - the key in the file (for example, mobile).</p>
</div>
<div class="paragraph">
<p><em>language</em> - a column for each language in alphabetical order.</p>
</div>
<div class="paragraph">
<p>The next lines contain collections of message items (the key and the information for each language). The first line contains the path, while the last line is empty and serves as a separator.</p>
</div>
<div class="paragraph">
<p>Editing in an External Editor</p>
</div>
<div class="paragraph">
<p>You can use any editor that allows editing of CSV files. Examples are Microsoft Excel or Microsoft Access.</p>
</div>
<div class="paragraph">
<p>Before you start editing a large amount of data the first time, we recommend that you test the editor with a small amount of data. Perform an export, edit the data and then import it into DirX Identity. You should then check the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Were national characters handled correctly?</p>
</li>
<li>
<p>Did the editor handle multi line message items correctly?</p>
</li>
<li>
<p>Could you create a new key with no problems (result should be new message items)?</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If all these issues worked well, you can start editing.</p>
</div>
<div class="paragraph">
<p>We tested with Microsoft Excel. Here are some hints on how to work with it:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use a colon ';' or a comma ',' as a delimiter for the export. For ease of handling, you should use the default Excel delimiter, which depends on your language settings. The colon is the default delimiter.</p>
</li>
<li>
<p>Double-click the CSV file. Excel should open it with correctly populated columns. If not, you used the wrong delimiter.</p>
</li>
<li>
<p>Now you can edit the file with all Excel features.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can perform these operations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Change an existing language information field. This action changes the corresponding line in the message item.</p>
</li>
<li>
<p>Populate an empty field (translate it from another language). Copy the language item (for example, in the English language) to the empty field.<br>
After import, this operation populates the corresponding line in the message item.</p>
</li>
<li>
<p>Add a new line with a key and language information.<br>
After import, this operation adds a new line to the corresponding message item.</p>
</li>
<li>
<p>Delete a line with key and language information.<br>
After import this removes the line from the corresponding message item.</p>
</li>
<li>
<p>Add a new column to add a new language. Write the language code in the header line (for example 'it').<br>
After import this creates the new message items.</p>
</li>
<li>
<p>You can reorder the language columns for easier editing but do not touch the path or key columns.</p>
</li>
<li>
<p>You can check easily if cells for a specific language are not filled correctly.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There are some restrictions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Do not destroy the structure of the file. In particular, do not remove or reorder the <strong>path</strong> or <strong>key</strong> columns. These columns must be the first two columns.</p>
</li>
<li>
<p>If you created a new language column and during import the option "Create empty objects" is set, a large number of empty objects may be created. There is no way to remove these objects as a whole.</p>
</li>
<li>
<p>If you change the language code in the header, no rename is performed. Instead all objects are created with the new name. The old objects with the old name persist and must be manually removed.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Importing Nationalization Information</p>
</div>
<div class="paragraph">
<p>To import exported and edited nationalization information files:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Back up the database to be able to revert to the previous state (optional).</p>
</li>
<li>
<p>Select <strong>File</strong> &#8594; <strong>Import Nationalization Items</strong> from the menu bar within in the Identity Manager.</p>
</li>
<li>
<p>A file selection dialog asks for the file location and name of the file to import. It also contains these parameters:</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Create empty objects</strong> - setting this option will create menu items that contain only keys but no language data. This option is useful for creating empty message items that you populate later on in the Identity Manager.</p>
</div>
<div class="paragraph">
<p><strong>Report object creation as error</strong> - setting this option will cause all object creations to be reported as errors. This option is useful if you made changes only in your nationalization information and you want to be warned if you destroyed something.</p>
</div>
<div class="paragraph">
<p>Note that the import method automatically calculates the delimiter from the header line in the file.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_determining_the_language"><a class="anchor" href="#_ch1_determining_the_language"></a><a class="link" href="#_ch1_determining_the_language">1.1.1.8.6. Determining the Language</a></h6>
<div class="paragraph">
<p>The process used to determine the correct language to use differs depending on the DirX Identity feature.</p>
</div>
<div class="paragraph">
<p>Web Center Pages</p>
</div>
<div class="paragraph">
<p>The language in which a Web Center page is displayed (this is valid for static and dynamic pages) is calculated in this sequence:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The user can select a language from the Web Center language selection. This value is stored in a cookie and is used during the next login.<br>
Note: if you delete the cookie, the language setting must be repeated.</p>
</li>
<li>
<p>After login of a user, the configured browser language is used.<br>
Note: if SSO with NetWeaver is configured, NetWeaver passes the language setting to Web Center.</p>
</li>
<li>
<p>If the language cannot be evaluated or the evaluated language cannot be resolved (no nationalization text available), English is used by default.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Notification Resolution</p>
</div>
<div class="paragraph">
<p>The language that is used to resolve a defined notification object is calculated in this sequence:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The Language field of the notification object is evaluated. If this field resolves to a valid language, this language is used. Keep in mind that the resolved message text is shown as <strong>???*<em>original text</em></strong>???* if nationalized messages are not available for that language or if the <em>original text</em> for that language doesnât exist.</p>
</li>
<li>
<p>If the language cannot be evaluated and resolves to null, English is used by default.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_handling_message_items_during_runtime"><a class="anchor" href="#_ch1_handling_message_items_during_runtime"></a><a class="link" href="#_ch1_handling_message_items_during_runtime">1.1.1.8.7. Handling Message Items during Runtime</a></h6>
<div class="paragraph">
<p>DirX Identity handles message items during runtime as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>During the Java-based Server startup, all message items are read and resolved to Java resource files.</p>
</li>
<li>
<p>If you request a re-load of the server configuration (Load IdS-J Configuration), all message items are re-loaded.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The load procedure resolves message items to absolute paths in a pre-defined folder structure:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The common path for all message items starts with<em><br>
install_path</em>*\ids-j-<strong><em>domain</em></strong>-S*<em>n</em>*\tmp\nat\classes\*</p>
</li>
<li>
<p>Message items for request workflows are located under <strong>rqwfs</strong>.</p>
</li>
<li>
<p>Global items are resolved to the sub-folder <strong>gen</strong>.</p>
</li>
<li>
<p>Local items are resolved to the sub-folder <strong>wfs</strong>.</p>
</li>
<li>
<p>Under the global and workflow paths, the items are located in the corresponding item structure.</p>
</li>
<li>
<p>You will find message files for all locations under this path. The file name is:*<br>
messages_*<em>locale</em>*.properties*</p>
</li>
<li>
<p>The content appears as follows if it is identical to the message item content:<br></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">#
#Sun Feb 15 12:51:48 CET 2009
RequestWasRejected_body=We regret to inform you that your self-registration request was rejected.
DearUser_body=Dear User,</code></pre>
</div>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The local definitions of the Customer Self Registration message items reside beneath the path Definitions &#8594; Default &#8594; Users &#8594; Customer Self Registration &#8594; _Nationalization.</p>
</li>
<li>
<p>After loading, the path is:_<br>
install_path_*ids-j-*<em>domain</em>*-S*<em>n</em>*\tmp\nat\classes\rqwfs\wfs\Default\Users\Customer Self Registration\_Nationalization*</p>
</li>
<li>
<p>You will find the files messages_en.properties and messages_de.properties</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Load Effort for Nationalization</p>
</div>
<div class="paragraph">
<p>Reading and processing the nationalization information during startup or during <strong>Load IdS-J Configuration</strong> of the Java-based Server requires some additional time. You can measure this overhead with the following procedure:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Open the Web Admin</p>
</li>
<li>
<p>Select the logging configuration section.</p>
</li>
<li>
<p>Add the Java Class <strong>com.siemens.idm.server.nationalization</strong> and set the logging to <strong>Finest</strong>.</p>
</li>
<li>
<p>Restart the Java-based Server.</p>
</li>
<li>
<p>Check in the server log files for this string:<br>
"Loading resource files takes â¦ ms"</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch1_selecting_request_workflows"><a class="anchor" href="#_ch1_selecting_request_workflows"></a><a class="link" href="#_ch1_selecting_request_workflows">1.1.1.9. Selecting Request Workflows</a></h5>
<div class="paragraph">
<p>Selection of request workflows is different for creation, modification and assignment workflows and also depends on the calling source (Web Center, Manager or Web Services). The next sections describe request workflow selection for:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Creation workflows</p>
</li>
<li>
<p>Modification workflows</p>
</li>
<li>
<p>Assignment workflows</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="_ch1_creation_workflow_selection"><a class="anchor" href="#_ch1_creation_workflow_selection"></a><a class="link" href="#_ch1_creation_workflow_selection">1.1.1.9.1. Creation Workflow Selection</a></h6>
<div class="paragraph">
<p>The selection methods for creation workflows depend on the calling client:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Web Center</p>
</li>
<li>
<p>Identity Manager</p>
</li>
<li>
<p>Web Services</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Workflow Selection from Web Center</p>
</div>
<div class="paragraph">
<p>Workflow selection depends on the type of license you have.</p>
</div>
<div class="paragraph">
<p>If you have a <strong>Business Suite</strong> license, you cannot run request workflows. In this case, the ability to create a user depends on the creation access policies established for this user. For more information, see the section "Policies for Object Creation" in "Managing Access Policies" in "Delegated Administration" in the "Managing Policies" chapter of the <em>DirX Identity Provisioning Administration Guide</em>.</p>
</div>
<div class="paragraph">
<p>If you have the <strong>Professional Suite</strong> license, you can create objects in three ways (note that you can set up a mix of these methods within one Web Center application):</p>
</div>
<div class="paragraph">
<p>a. Object creation via request workflows (default):</p>
</div>
<div class="paragraph">
<p>If you click, for example, the "Add user"' menu item, the Web Center application retrieves all workflows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>that the logged-in user is allowed to execute (this depends on the access policies established for this user)</p>
</li>
<li>
<p>that have the <strong>Type</strong> field in the When Applicable section of the workflow set to <strong>Create</strong></p>
</li>
<li>
<p>that have the <strong>Subject</strong> field set to <strong>User</strong></p>
</li>
<li>
<p>and that have an empty <strong>Resources</strong> field</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If more than one creation workflow is found, the list is presented to the user for further selection. If only one workflow is found, this workflow is started immediately. If no workflow is found, an error is returned to the user that he is not allowed to execute any creation workflows.</p>
</div>
<div class="paragraph">
<p>The same algorithm is applied if the creation for a different object type is requested (for example, a <strong>Role</strong>).</p>
</div>
<div class="paragraph">
<p>b. Object creation via the Create user by request workflow flag feature:</p>
</div>
<div class="paragraph">
<p>You can customize Web Center to use the <strong>Create user by request workflow</strong> flag feature. Collect all necessary information to create an object (for example, user attributes, assignment of privileges) and then save the user object. This results in a start of a request workflow that stores the object later on.</p>
</div>
<div class="paragraph">
<p>Setting the <strong>Create user by request workflow</strong> flag at the domain object influences the save operation of the object. Instead of saving the object directly, the save operation is converted to a request workflow start where the entered data is transferred as input parameters in the form of an order object. The corresponding activity of the request workflows defines when to store the object (typically this activity is named <strong>Apply changes</strong>).</p>
</div>
<div class="paragraph">
<p>c. Object creation via Creation Access Policies</p>
</div>
<div class="paragraph">
<p>You can customize Web Center to use Creation access policies. For examples, see the pages set up for the Business Suite license.</p>
</div>
<div class="paragraph">
<p>Workflow Selection from Identity Manager</p>
</div>
<div class="paragraph">
<p>Workflow selection depends upon the type of license you have.</p>
</div>
<div class="paragraph">
<p>If you have a <strong>Business Suite</strong> license, you cannot run request workflows. In this case, objects are always stored directly when pressing the <strong>Save</strong> button.</p>
</div>
<div class="paragraph">
<p>If you have a <strong>Professional Suite</strong> license, the creation depends on the <strong>Create user by request workflow</strong> flag at the domain object:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the flag is not set, an object is created directly when clicking the <strong>Save</strong> button.</p>
</li>
<li>
<p>If the flag is set, the system tries to start a corresponding request workflow when clicking the <strong>Save</strong> button.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example, if a user object is to be created, the Identity services retrieve all workflows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>that the logged in user is allowed to execute (this depends on the set up access policies for this user)</p>
</li>
<li>
<p>that have the <strong>Type</strong> field in the <strong>When Applicable</strong> section of the workflow set to <strong>Create</strong></p>
</li>
<li>
<p>that have the <strong>Subject</strong> field set to <strong>User</strong></p>
</li>
<li>
<p>and that have an empty <strong>Resources</strong> field</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If only one workflow is found, this workflow is started immediately. If more than one workflow or no workflow is found, an error is returned to the user if the <strong>Create user directly if no workflow available</strong> flag is not set. Otherwise the user entry is created directly.</p>
</div>
<div class="paragraph">
<p>The same algorithm is applied if the creation for a different object type is requested (for example, a <strong>Role</strong>).</p>
</div>
<div class="paragraph">
<p>Workflow Selection from Web Services</p>
</div>
<div class="paragraph">
<p>Workflow selection depends on the <strong>Create user by request workflow</strong> flag at the domain object:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the flag is not set, an object is created directly when executing an Add Object operation.</p>
</li>
<li>
<p>If the flag is set, the system tries to start a corresponding request workflow when executing an Add Object operation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example, if a user object is to be created, the Identity services retrieve all workflows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>that the requesting service is allowed to execute (this depends on the access policies established for the user account that is used by the service to authenticate)</p>
</li>
<li>
<p>that have the <strong>Type</strong> field in the When Applicable section of the workflow set to <strong>Create</strong></p>
</li>
<li>
<p>that have the <strong>Subject</strong> field set to <strong>User</strong></p>
</li>
<li>
<p>and that have an empty <strong>Resources</strong> field</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If only one workflow is found, this workflow is started immediately. If more than one workflow or no workflow is found, an error is returned to the service if the <strong>Create user directly if no workflow available</strong> flag is not set. Otherwise, the user entry is created directly.</p>
</div>
<div class="paragraph">
<p>The same algorithm is applied if the creation for a different object type is requested (for example, a <strong>Role</strong>).</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_modification_workflow_selection"><a class="anchor" href="#_ch1_modification_workflow_selection"></a><a class="link" href="#_ch1_modification_workflow_selection">1.1.1.9.2. Modification Workflow Selection</a></h6>
<div class="paragraph">
<p>This section describes the request workflow selection methods for modification workflows.</p>
</div>
<div class="paragraph">
<p>You can set up <strong>Attribute Policies</strong> for any object type to define the request workflows for attribute modification. (See the section "Attribute Policies for Users" in "Managing Attribute Policies" in the chapter "Managing Policies" in the <em>DirX Identity Provisioning Administration Guide</em> for details.</p>
</div>
<div class="paragraph">
<p>If an attribute of an object is changed, the service layer checks the change against the defined attribute policies:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It retrieves all attribute policies for the relevant object type (for example dxrUser).</p>
</li>
<li>
<p>It checks whether the changed attribute is part of the Selected list in the Configuration tab of the attribute policy.</p>
</li>
<li>
<p>If no policy matches, the attribute is changed directly.</p>
</li>
<li>
<p>If a policy matches, the configured approval workflow is started.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If more than one policy is configured for an object type (for example, one for mail changes and one for department changes), and both attributes are changed, for each affected policy one workflow is started.</p>
</div>
<div class="paragraph">
<p>If a workflow link is set at the attribute policy, the referenced workflow is started. If no link is set, the workflow being started is selected by evaluating the <strong>When</strong> <strong>Applicable</strong> section of all workflows.</p>
</div>
<div class="paragraph">
<p>This mechanism is performed independently for each affected policy. If no matching workflow is found for a policy when saving the object, an error message is displayed.</p>
</div>
<div class="paragraph">
<p>If an attribute policy contains multiple attributes and several of them are changed, only one approval workflow is started.</p>
</div>
<div class="paragraph">
<p>Note that Java-based workflows do not evaluate attribute policies due to performance reasons. They only send events if enabled for an object type.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_assignment_workflow_selection"><a class="anchor" href="#_ch1_assignment_workflow_selection"></a><a class="link" href="#_ch1_assignment_workflow_selection">1.1.1.9.3. Assignment Workflow Selection</a></h6>
<div class="paragraph">
<p>DirX Identity provides two mechanisms to select the correct workflow for a specific privilege:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Direct workflow selection</strong> - sets a direct link from the privilege to the workflow</p>
</li>
<li>
<p><strong>Rule-based workflow selection</strong> - sets up <strong>When</strong> <strong>Applicable</strong> at each workflow definition</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The algorithm is slightly different depending on the assignment environment. We distinguish between these types for user-to-privilege assignments:</p>
</div>
<div class="paragraph">
<p>User-to-Privilege assignment - assignment, modification or removal of a privilege to or from a user (the corresponding operations for the assignment are create, modify, delete)</p>
</div>
<div class="paragraph">
<p>Segregation of duties (SoD) - an SoD policy requests an approval workflow for a user-to-privilege assignment</p>
</div>
<div class="paragraph">
<p>Re-approval - requires regular starts of re-approval workflows for a user-to-privilege assignment</p>
</div>
<div class="paragraph">
<p>Selection of approval for approval of links between privileges is handled in a similar way.</p>
</div>
<div class="paragraph">
<p>Workflow Selection Algorithm for User-to-Privilege Assignments</p>
</div>
<div class="paragraph">
<p>The calculation mechanism for workflow selection works as follows:</p>
</div>
<div class="paragraph">
<p>Calculate all workflows the logged-in user is allowed to execute. You can define the number of workflows for a specific user via access policies. (See the section "Managing Access Policies" in the section "Delegated Administration" in the chapter "Managing Policies" in the <em>DirX Identity Administration Guide</em> for details.)</p>
</div>
<div class="paragraph">
<p>The next steps depend on the direct workflow assignments at the privilege and the rule definitions in the <strong>When Applicable</strong> tab of the request workflow definitions:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If a privilege is flagged with "Requires Approval", the service evaluates the type of operation (create, modify or delete) and request from the request workflow engine (running in the Java-based Server) to start a request workflow.</p>
</li>
<li>
<p>The request workflow engine checks whether a direct link to a workflow is set for this privilege and for this type of operation.</p>
</li>
<li>
<p>If yes, it takes this workflow and starts it.</p>
</li>
<li>
<p>If no, it selects all workflows that fit with the defined <strong>Type</strong> (the operation), the <strong>Subject type</strong> and the <strong>Resource type(s)</strong>.</p>
</li>
<li>
<p>If an optional <strong>Condition</strong> is set, it filters the list of workflows accordingly.</p>
</li>
<li>
<p>If the list still contains multiple workflows, it takes the workflow with the highest priority and starts it.</p>
</li>
<li>
<p>If there are several workflows with the highest priority, it takes one by random.</p>
</li>
<li>
<p>If the list is empty and operation type is <strong>create</strong>, an error is returned to the calling routine.</p>
</li>
<li>
<p>Otherwise it tries to use the workflow for create &#8594; start again with step 2 and type <strong>create</strong>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Workflow Selection Algorithm for SoD</p>
</div>
<div class="paragraph">
<p>The calculation mechanism for workflow selection works as follows:</p>
</div>
<div class="paragraph">
<p>Calculate all workflows the logged in user is allowed to execute. You can define the amount of workflows for a specific user via access policies. (See subsection "Managing Access Policies" in section "Delegated Administration" in chapter "Managing Policies" in the <em>DirX Identity Administration Guide</em> for details.)</p>
</div>
<div class="paragraph">
<p>The next steps depend on the direct workflow assignments at the privilege and the rule definitions in the tab <strong>When Applicable</strong> of the request workflow definitions:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The service sets the operation to <strong>SoD</strong> and request from the request workflow engine (running in the Java-based Server) to start a request workflow.</p>
</li>
<li>
<p>The request workflow engine checks whether the direct workflow link for SoD is set for this privilege.</p>
</li>
<li>
<p>If yes, it takes this workflow and starts it.</p>
</li>
<li>
<p>If no, it selects all workflows that fit for operation type SoD, the <strong>Subject type</strong> and the <strong>Resource type(s)</strong>.</p>
</li>
<li>
<p>If an optional <strong>Condition</strong> is set, it filters the list of workflows accordingly.</p>
</li>
<li>
<p>If the list still contains multiple workflows, it takes the workflow with the highest priority and starts it.</p>
</li>
<li>
<p>If there are several workflows with the highest priority, it takes one by random.</p>
</li>
<li>
<p>If the list is empty, it tries to use the workflow for create &#8594; start again with step 2 and type <strong>create</strong>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Workflow Selection Algorithm for Re-Approval</p>
</div>
<div class="paragraph">
<p>The calculation mechanism for workflow selection works as follows:</p>
</div>
<div class="paragraph">
<p>Calculate all workflows the logged-in user is allowed to run. You can define the number of workflows for a specific user via access policies. (See the subsection "Managing Access Policies" in the section "Delegated Administration" in the chapter "Managing Policies" in the <em>DirX Identity Administration Guide</em> for details.)</p>
</div>
<div class="paragraph">
<p>The next steps depend on the direct workflow assignments at the privilege and the rule definitions in the tab <strong>When Applicable</strong> of the request workflow definitions:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The service sets the operation to <strong>re-approve</strong> and request from the request workflow engine (running in the Java-based Server) to start a request workflow.</p>
</li>
<li>
<p>The request workflow engine checks whether the direct workflow link for re-approval is set for this privilege.</p>
</li>
<li>
<p>If yes, it takes this workflow and starts it.</p>
</li>
<li>
<p>If no, it selects all workflows that fit for operation type <strong>re-approval</strong>, the <strong>Subject type</strong> and the <strong>Resource type(s)</strong>.</p>
</li>
<li>
<p>If an optional <strong>Condition</strong> is set, it filters the list of workflows accordingly.</p>
</li>
<li>
<p>If the list still contains multiple workflows, it takes the workflow with the highest priority and starts it.</p>
</li>
<li>
<p>If there are several workflows with the highest priority it takes one by random.</p>
</li>
<li>
<p>If the list is empty it tries to use the workflow for create &#8594; start again with step 2 and type <strong>create</strong>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Workflow Selection Algorithm for Approval of Links between Privileges</p>
</div>
<div class="paragraph">
<p>The calculation mechanism for workflow selection works as follows:</p>
</div>
<div class="paragraph">
<p>Calculate all workflows the logged in user is allowed to run. You can define the number of workflows for a specific user via access policies. (See the subsection "Managing Access Policies" in the section "Delegated Administration" in the chapter "Managing Policies" in the <em>DirX Identity Administration Guide</em> for details.)</p>
</div>
<div class="paragraph">
<p>The next steps depend on the direct workflow assignments at the privilege and the rule definitions in the tab <strong>When Applicable</strong> of the request workflow definitions:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If a privilege is flagged with "Requires Approval" in the section <strong><em>Privilege</em></strong> <strong>Assignment Configuration</strong>, the service evaluates the type of operation (assign or remove) and request from the request workflow engine (running in the Java-based server) to start a request workflow.</p>
</li>
<li>
<p>The request workflow engine checks whether a direct link to a workflow is set for this privilege and for this type of operation.</p>
</li>
<li>
<p>If yes, it takes this workflow and starts it.</p>
</li>
<li>
<p>If no, it selects all workflows that fit with the defined <strong>Type</strong> (the operation), the <strong>Subject type</strong> and the <strong>Resource type(s)</strong>.</p>
</li>
<li>
<p>If an optional <strong>Condition</strong> is set, it filters the list of workflows accordingly.</p>
</li>
<li>
<p>If the list still contains multiple workflows, it takes the workflow with the highest priority and starts it.</p>
</li>
<li>
<p>If there are several workflows with the highest priority, it takes one at random.</p>
</li>
<li>
<p>If the list is empty and operation type is <strong>create</strong>, an error is returned to the calling routine.</p>
</li>
<li>
<p>Otherwise, it tries to use the workflow for create &#8594; start again with step 2 and type <strong>create</strong>.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch1_executing_request_workflows"><a class="anchor" href="#_ch1_executing_request_workflows"></a><a class="link" href="#_ch1_executing_request_workflows">1.1.1.10. Executing Request Workflows</a></h5>
<div class="paragraph">
<p>To execute a request workflow, the services calculate the URL to which the HTTP request is to be sent. The steps are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The service performs a search for the related IdS-J server. The filter used is:<br></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ldap hljs" data-lang="ldap">(&amp;(objectClass=dxmIDMServer)(!(dxmType=workerContainer))(dxmDomain=&lt;domain&gt;))</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>If no server configuration object is found for the domain, the search is repeated with the following filter:<br></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ldap hljs" data-lang="ldap">(&amp;(objectClass=dxmIDMServer)(!(dxmType=workerContainer))(!(dxmDomain=*)))</code></pre>
</div>
</div>
<div class="paragraph">
<p>This filter is applied for compatibility reasons, to find a server if no domain is explicitly configured.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The link to the service (dxmService-DN) defines as set of attributes:<br>
dxmSpecificAttributes(ssl) - an SSL connection is established if this value is 'true'.<br>
dxmDataPort - this port number is used if SSL is not enabled.<br>
dxmSecurePort - this port number is used if SSL is enabled.</p>
</li>
<li>
<p>The link to the system object (dxmSystem-DN) defines the host address. If the host address at the system object is empty, the host field of the service object is taken.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The resulting URL is as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If SSL is not enabled:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-url hljs" data-lang="url">http://$(dxmAddress):$(dxmDataPort)//RequestWorkflow/reqwfsvc</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>If SSL is enabled:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-url hljs" data-lang="url">https://$(dxmAddress):$(dxmSecurePort)//RequestWorkflow/reqwfsvc</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch1_customizing_request_workflows"><a class="anchor" href="#_ch1_customizing_request_workflows"></a><a class="link" href="#_ch1_customizing_request_workflows">1.1.2. Customizing Request Workflows</a></h4>
<div class="paragraph">
<p>DirX Identity comes with a set of default request workflows that are sufficient for many purposes. Nevertheless, details must be adapted to the customer environment or new workflows should be created. The following sections explain how to customize the default request workflows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Working with Variable substitution</p>
</li>
<li>
<p>Implementing an activity</p>
</li>
<li>
<p>Implementing a Java class for finding participants</p>
</li>
<li>
<p>Implementing participant filters and constraints</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For a discussion of request workflow management, see the chapter "Managing Request Workflows" in the <em>DirX Identity Provisioning Administration Guide</em>.</p>
</div>
<div class="sect4">
<h5 id="_ch1_using_variable_substitution"><a class="anchor" href="#_ch1_using_variable_substitution"></a><a class="link" href="#_ch1_using_variable_substitution">1.1.2.1. Using Variable Substitution</a></h5>
<div class="paragraph">
<p>DirX Identity provides an easy-to-use variable substitution mechanism that can be used to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>define variable text sections for e-mails to be substituted during runtime. A typical application of this mechanism is e-mail texts. You can use variables in all text fields like From, To, Subject and Body. You can use simple variables to insert small text pieces like an e-mail address, or you can use control-flow statements with included variables to create more complex structures such as several lines of text coming from lists of objects (for example, a list of all workflow participants).</p>
</li>
<li>
<p>calculate participants for approval activities according to a dynamic specification.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Here is an example that shows how the mechanism works within e-mails:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>User <code>'${workflow.initiatorEntry.cn}'</code> launched the workflow <code>'${workflow.name}'</code> for <code>'${workflow.subject.cn}'</code>.
This request was rejected.</p>
</div>
<div class="paragraph">
<p>Please contact the persons that rejected the request:</p>
</div>
<div class="paragraph">
<p><code>&lt;? for activity in ${workflow.activities} ?&gt;</code><br>
<code>&lt;? if ${activity.applicationState} == "REJECTED" ?&gt;</code><br>
<code>&lt;? for participant in ${activity.approvers} ?&gt;</code><br>
- User <code>${participant.givenName} ${participant.sn}</code> rejected with reason: <code>${workflow.activity.reason}</code><br>
<code>&lt;? endfor ?&gt;</code><br>
<code>&lt;? endif ?&gt;</code><br>
<code>&lt;? endfor ?&gt;</code></p>
</div>
<div class="paragraph">
<p>This is an automatically generated mail. Please do not reply.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>At runtime, this template is expanded to:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>User 'Donegan Mark 1234' launched the workflow 'Create User' for 'Sober Marietta 9876'.
This request was rejected.</p>
</div>
<div class="paragraph">
<p>Please contact the persons that rejected the request:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>User Fred Strober rejected with reason: Not the right person.</p>
</li>
<li>
<p>User Donald Duck rejected with reason: Do not like him.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This is an automatically generated mail. Please do not reply.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>Read the next sections for details about e-mail text variables.</p>
</div>
<div class="paragraph">
<p>Here are several examples that apply to participant calculation:</p>
</div>
<div class="paragraph">
<p>${workflow.subject.manager} - retrieves the manager(s) of the subject (uses the manager link to look up the manager DNs)
${workflow.subject.owner} - retrieves all owner of the subject (uses the owner link to look up the owner DNs)
${workflow.subject.manager.manager} - retrieves the manager of the subject&#8217;s manager (useful for escalation)
${workflow.subject.dxrLocationLink.manager} - retrieves the manager of the location the subject is assigned to
${previousParticipants.manager} - retrieves the manager(s) of the previous activity during an escalation</p>
</div>
<div class="paragraph">
<p>Use the static selection of the Participants tab of an approval definition to setup such definitions. For a detailed description see the section Participant Calculation below.</p>
</div>
<div class="sect5">
<h6 id="_ch1_elements"><a class="anchor" href="#_ch1_elements"></a><a class="link" href="#_ch1_elements">1.1.2.1.1. Elements</a></h6>
<div class="paragraph">
<p>A variable definition looks like this:</p>
</div>
<div class="exampleblock">
<div class="content">
<code>${root.object.object&#8230;&#8203;object.attribute}</code>
</div>
</div>
<div class="paragraph">
<p>It starts with a root object that can be composed of many sub-objects. The last element must be an attribute.</p>
</div>
<div class="paragraph">
<p><strong>Root element</strong></p>
</div>
<div class="paragraph">
<p>Root elements are:</p>
</div>
<div class="paragraph">
<p><strong>server</strong> - provides some general variables of the Java-based Server.</p>
</div>
<div class="paragraph">
<p><strong>workflow</strong> - represents the start element of the current workflow instance. From here you can access sub elements and structures.</p>
</div>
<div class="paragraph">
<p>&lt;empty&gt; - if nothing is specified, the current activity is assumed.</p>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="exampleblock">
<div class="content">
<code>$(workflow.subject.mail)</code>
</div>
</div>
<div class="paragraph">
<p>This statement retrieves the mail attribute of the subject this workflow handles.</p>
</div>
<div class="exampleblock">
<div class="content">
<code>$(workflow.subject.manager.mail)</code>
</div>
</div>
<div class="paragraph">
<p>This statement retrieves the mail attribute of the subject&#8217;s manager.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_structures"><a class="anchor" href="#_ch1_structures"></a><a class="link" href="#_ch1_structures">1.1.2.1.2. Structures</a></h6>
<div class="paragraph">
<p>This section explains the structures that can occur within request workflows. This has to do with the orders that such a workflow contains.</p>
</div>
<div class="paragraph">
<p>The general structure is:</p>
</div>
<div class="paragraph">
<p><strong>Workflow &#8594; One subject order &#8594; Zero or more resource orders</strong></p>
</div>
<div class="paragraph">
<p>Note that the resource orders are about assignments and not the objects itself. From here you can access the subject and the real resources:</p>
</div>
<div class="paragraph">
<p><strong>${workflow.resources[0].dxrassignfrom@&#8230;&#8203;}</strong> - allows accessing the subject (so this is equivalent to the workflow.subject construct).*<br>
${workflow.resources[0].dxrassignto@&#8230;&#8203;}* - allows accessing the resources.</p>
</div>
<div class="paragraph">
<p>Examples and how to access information:</p>
</div>
<div class="paragraph">
<p><strong>User modification: Workflow &#8594; User</strong><br>
${workflow.subject.cn} - name of the user<br>
${workflow.subject.mail} - mail address of the user<br>
${workflow.subject.manager.mail} - mail address of the user&#8217;s manager<br>
${workflow.subject.dxrLocationLink.manager.sn} - the surname of the location manager</p>
</div>
<div class="paragraph">
<p><strong>Privilege assignment: Workflow &#8594; User &#8594; Assignment</strong><br>
${workflow.resources[0].dxrStartDate} - the start date of the assignment<br>
${workflow.resources[0].roleParameter_Project@value} - the value of the role parameter Project.<br>
${workflow.resources[0].roleParameter_Project@oldvalue} - the value of the role parameter Project.<br>
${workflow.resources[0].roleParameter_Project@modified} - indicates the modification of the Project role parameter. The value is either TRUE or FALSE.<br>
${workflow.resources[0].dxrassignfrom@mail} - the mail address of the user (you can use workflow.subject.mail instead).<br>
${workflow.resources[0].dxrassignto@cn} - the name of the privilege.<br>
${workflow.resources[0].<a href="mailto:dxrassignto@owner.mail">dxrassignto@owner.mail</a>} - the mail address of the privilege owner.<br>
${workflow.resources[0].<a href="mailto:dxrassignto@owner.manager.mail">dxrassignto@owner.manager.mail</a>} - the mail address of the privilege owner&#8217;s manager.</p>
</div>
<div class="paragraph">
<p><strong>Multiple privilege assignments: Workflow &#8594; User &#8594; Assignments</strong><br>
You can use the same definitions as shown for one assignment if you define the index with control constructs.</p>
</div>
<div class="paragraph">
<p><strong>Access certification: Workflow &#8594; Privilege &#8594; Users</strong><br>
${workflow.resources[0].dxrStartDate} - the start date of the assignment<br>
${workflow.resources[0].roleParameter_Project@value} - the value of the role parameter Project.<br>
${workflow.resources[0].roleParameter_Project@oldvalue} - the value of the role parameter Project.<br>
${workflow.resources[0].roleParameter_Project@modified} - indicates the modification of the Project role parameter. The value is either TRUE or FALSE.<br>
${workflow.resources[0].dxrassignfrom@description} - the description of the privilege (you can use workflow.subject.description instead).<br>
${workflow.resources[0].dxrassignto@sn} - the surname of the user.<br>
${workflow.resources[0].dxrassignto@mail} - the mail address of the user.<br>
${workflow.resources[0].<a href="mailto:dxrassignto@manager.mail">dxrassignto@manager.mail</a>} - the mail address of the user&#8217;s manager.<br>
${workflow.resources[0].<a href="mailto:dxrassignto@dxrLocationLink.manager.sn">dxrassignto@dxrLocationLink.manager.sn</a>} - the surname of the location manager.</p>
</div>
<div class="paragraph">
<p>Note that in the examples we access a specific object if multiple objects are available (resources[0]). Use control structures to evaluate complete lists of objects.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_server_variables"><a class="anchor" href="#_ch1_server_variables"></a><a class="link" href="#_ch1_server_variables">1.1.2.1.3. Server Variables</a></h6>
<div class="paragraph">
<p>The Java-based Server reads some variables at startup. The following attributes are available:</p>
</div>
<div class="paragraph">
<p><strong>Domain</strong> - the domain name for which this server works</p>
</div>
<div class="paragraph">
<p><strong>TechnicalDomain</strong> - the technical domain name for which this server works</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_workflow_instance"><a class="anchor" href="#_ch1_workflow_instance"></a><a class="link" href="#_ch1_workflow_instance">1.1.2.1.4. Workflow Instance</a></h6>
<div class="paragraph">
<p>The available attributes of a workflow instance are:</p>
</div>
<div class="paragraph">
<p><strong>absoluteDisplayName</strong> (string) - the path of the workflow instance. It contains the display name and all preceding folder names separated by "/" . See <strong>path</strong> for the display name of the workflow definition.</p>
</div>
<div class="paragraph">
<p><strong>activities</strong> (list of objects) - the list of activities.</p>
</div>
<div class="paragraph">
<p><strong>applicationState</strong> (string) - the instance&#8217;s (application) logical state. This state is calculated at the end of a workflow run depending on the final or erroneous activity.</p>
</div>
<div class="paragraph">
<p><strong>context</strong> (map) - a hash list of customer-defined variables (name / value pairs). Can be empty.</p>
</div>
<div class="paragraph">
<p><strong>contextAttributes</strong> (map) - a hash list of customer-defined variables (name / value pairs). Can be empty. Note that this is just an alternative to using âcontextâ.</p>
</div>
<div class="paragraph">
<p>Keep in mind that all (string) context variables are stored as specific attributes in LDAP, too (LDAP attribute: dxmSpecificAttributes). Context variables that are added or modified are in sync with the LDAP attribute. Variables that are deleted from the context are not synchronized to the LDAP attribute. Therefore when deleting a variable from the context you additionally should create an own variable indicating that the original variable is deleted. Then this new variable can easily be processed using "dxmSpecificAttributes".</p>
</div>
<div class="paragraph">
<p><strong>displayName</strong> (string) - the human-readable name of this workflow instance.</p>
</div>
<div class="paragraph">
<p><strong>endTime</strong> (string) - the date and time in ms (calculated from 1.1.1970) at which the workflow run finished.</p>
</div>
<div class="paragraph">
<p><strong>expirationTime</strong> (string) - the date and time at which the workflow instance expires. This is the workflows start time plus the configured timeout value.</p>
</div>
<div class="paragraph">
<p><strong>initiator</strong> (string) - the user that initiated this workflow.</p>
</div>
<div class="paragraph">
<p><strong>initiatorEntry</strong> (object) - the initiator object with all attributes.</p>
</div>
<div class="paragraph">
<p><strong>path</strong> (string) - the path of the workflow definition. It contains the display name and all preceding folder names separated by "/". See <strong>absoluteDisplayName</strong> for the display name of the workflow definition.</p>
</div>
<div class="paragraph">
<p><strong>resources</strong> (list of objects) - the list of resource objects<br>
Examples: roles, permissions, groups, users.<br>
You can access specific attributes of user to privilege assignments:</p>
</div>
<div class="paragraph">
<p>Access to a new role parameter value:*<br>
${workflow.resources[0].roleParameter_*<em>name</em>*@value}*</p>
</div>
<div class="paragraph">
<p>For modifications, you can also access the old value:<br>
<strong>${workflow.resources[0].roleParameter_*<em>name</em></strong>@oldvalue}*<br>
Please keep in mind that this expression only works in emails that are sent before the object has been changed in an âApply Changesâ activity.</p>
</div>
<div class="paragraph">
<p>This flag allows recognition whether the value was changed (you can use it for conditions):*<br>
${workflow.resources[0].roleParameter_*<em>name</em>*@modified}*<br>
The delivered value is either TRUE or FALSE.</p>
</div>
<div class="paragraph">
<p>Example for role parameter <strong>Project</strong>:<br>
${workflow.resources[0].roleParameter_Project@value}</p>
</div>
<div class="paragraph">
<p>You can access specific parameters of accounts (works only if the assignment is of type group):</p>
</div>
<div class="paragraph">
<p><strong>${workflow.resources[0].dxrassignto@account_*<em>name</em></strong>}*</p>
</div>
<div class="paragraph">
<p>Example for the description attribute:<br>
${workflow.resources[0].dxrassignto@account_description}</p>
</div>
<div class="paragraph">
<p>This definition retrieves the description attribute of the primary account.</p>
</div>
<div class="paragraph">
<p>You can access specific parameters of a target system (works only if the assignment is of type group):</p>
</div>
<div class="paragraph">
<p><strong>${workflow.resources[0].dxrassignto@targetsystem_*<em>name</em></strong>}*</p>
</div>
<div class="paragraph">
<p>Example for the description attribute:<br>
${workflow.resources[0].dxrassignto@targetsystem_description}</p>
</div>
<div class="paragraph">
<p>This definition retrieves the description attribute of the target system.</p>
</div>
<div class="paragraph">
<p>You can access specific parameters of an assignment:</p>
</div>
<div class="paragraph">
<p><strong>${workflow.resources[0].controllerLink.</strong>attribute<strong>}<br>
</strong>Example: <strong>${workflow.resources[0].controllerLink.mail}</strong><br>
This definition retrieves the DN of the person(s) that performed the access certification approval.</p>
</div>
<div class="paragraph">
<p><strong>${workflow.resources[0].userInfo}</strong><br>
This definition retrieves the flag that can be set by the approver during an access certification to indicate that this user shall be informed via e-mail.</p>
</div>
<div class="paragraph">
<p><strong>${workflow.resources[0].typeOfOrder}</strong><br>
This definition retrieves the type of the order. The possible values are ADD, MODIFY or DELETE.</p>
</div>
<div class="paragraph">
<p><strong>subject</strong> (object) - the subject object of this workflow<br>
Examples: the user to be created, the user to assign a privilege, &#8230;&#8203;</p>
</div>
<div class="paragraph">
<p><strong>startTime</strong> (string) - the date and time in ms (calculated from 1.1.1970) when the workflow run was started.</p>
</div>
<div class="paragraph">
<p><strong>state</strong> - the workflow state (SUCCEEDED, FAILED, &#8230;&#8203;).</p>
</div>
<div class="paragraph">
<p><strong>UID</strong> (string) - the workflow instance&#8217;s unique ID.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_activity_instance"><a class="anchor" href="#_ch1_activity_instance"></a><a class="link" href="#_ch1_activity_instance">1.1.2.1.5. Activity Instance</a></h6>
<div class="paragraph">
<p>The available attributes of an activity instance are:</p>
</div>
<div class="paragraph">
<p><strong>activityType</strong> (string) - the type of activity, for example: applyChange, enterAttributes, approveCreate, e-mail etc.</p>
</div>
<div class="paragraph">
<p><strong>activitySubType</strong> (string) - currently equal to the activityType.</p>
</div>
<div class="paragraph">
<p><strong>applicationState</strong> (string) - the instance&#8217;s (application&#8217;s) logical state (for example REJECTED or ACCEPTED).</p>
</div>
<div class="paragraph">
<p><strong>approvalResult</strong> (string) - the approval result of the activity (for example REJECTED or ACCEPTED).</p>
</div>
<div class="paragraph">
<p><strong>approvers</strong> (list of objects) - the list of participants for this activity that really approved/rejected. This attribute represents a list of users. You can access all existing user attributes.</p>
</div>
<div class="paragraph">
<p><strong>category</strong> (string) - one of the categories "operational" or "errorhandler".</p>
</div>
<div class="paragraph">
<p><strong>context</strong> (map) - a hash list of customer-defined variables (name / value pairs). This attribute can be empty.<br>
Example: ${workflow.context.myVar}<br>
retrieves the value of the context variable myVar for further processing.</p>
</div>
<div class="paragraph">
<p>Keep in mind that all (string) context variables are stored as specific attributes in LDAP, too (LDAP attribute: dxmSpecificAttributes). Context variables that are added or modified are in sync with the LDAP attribute. Variables that are deleted from the context are not synchronized to the LDAP attribute. Therefore when deleting a variable from the context you additionally should create an own variable indicating that the original variable is deleted. Then this new variable can easily be processed using "dxmSpecificAttributes".</p>
</div>
<div class="paragraph">
<p><strong>endTime</strong> (string) - the date and time in milliseconds (ms) (calculated from 1.1.1970) at which the workflow run finished.</p>
</div>
<div class="paragraph">
<p><strong>escalationLevel</strong> (integer) - current escalation level.</p>
</div>
<div class="paragraph">
<p><strong>0</strong> escalation not yet started<br>
<strong>&gt; 0</strong> level of escalation</p>
</div>
<div class="paragraph">
<p><strong>expirationTime</strong> (string) - the date and time at which the workflow instance expires. This is the workflows start time plus the configured timeout value.</p>
</div>
<div class="paragraph">
<p><strong>immutableJob</strong> (object) - the job definition of this activity. It contains these attributes:</p>
</div>
<div class="paragraph">
<p><strong>baseName</strong> (string) - the base name at which the job&#8217;s classes and lib directory reside.</p>
</div>
<div class="paragraph">
<p><strong>className</strong> (string) - the class name of the associated job implementation.</p>
</div>
<div class="paragraph">
<p><strong>extensionsName</strong> (string) - the name of the server-extensions where the job resides.</p>
</div>
<div class="paragraph">
<p><strong>name</strong> (string) - the job name.</p>
</div>
<div class="paragraph">
<p><strong>params</strong> (map) - name/value pairs of job-specific information.</p>
</div>
<div class="paragraph">
<p><strong>interactiveTaskDescription</strong> (list of interactiveAttributes) - defines the user task to be performed at the Web interface (for example, to enter attributes). Attributes for interactiveAttributes are:</p>
</div>
<div class="paragraph">
<p><strong>description</strong> - the display name of this attribute at the Web interface.</p>
</div>
<div class="paragraph">
<p><strong>mandatory</strong> - defines mandatory attributes if set to true. Otherwise the value is false.</p>
</div>
<div class="paragraph">
<p><strong>name</strong> - the name of this attribute (typically the LDAP name).</p>
</div>
<div class="paragraph">
<p><strong>master</strong> (string) - the master activity. When calculating approvers and <em>n</em> approvers are found, the master activity is expanded to <em>n</em> activities.</p>
</div>
<div class="paragraph">
<p><strong>name</strong> (string) - identifies the activity within the workflow.</p>
</div>
<div class="paragraph">
<p><strong>participantEntries</strong> (list of objects) - the list of participants for this activity. This attribute represents a list of users. You can access all existing user attributes.</p>
</div>
<div class="paragraph">
<p><strong>reason</strong> (string) - the reason why the approver accepted or rejected the approval request.</p>
</div>
<div class="paragraph">
<p><strong>startTime</strong> (string) - the date and time in ms (calculated from 1.1.1970) at which the workflow run started.</p>
</div>
<div class="paragraph">
<p><strong>state</strong> (string) - the activity state (SUCCEEDED, FAILED, &#8230;&#8203;).</p>
</div>
<div class="paragraph">
<p><strong>timeout</strong> (string) - the timeout of this activity in milliseconds (ms) (calculated from 1.1.1970).</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_control_structures"><a class="anchor" href="#_ch1_control_structures"></a><a class="link" href="#_ch1_control_structures">1.1.2.1.6. Control Structures</a></h6>
<div class="paragraph">
<p>Control structures allow you to generate more complex text structures. Controls are surrounded by &lt;? <em>statement</em> ?&gt;, where the blank between &lt;? and <em>statement</em> is mandatory. Control structures consist of if/else statements for condition handling, for statements for loop handling, and Java statements for defining your own text structures.</p>
</div>
<div class="paragraph">
<p>If/Else Statement</p>
</div>
<div class="paragraph">
<p>The if/else statement allows you to handle conditions. The syntax is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">&lt;? if condition ?&gt;
â¦
&lt;? else ?&gt;
â¦
&lt;? endif ?&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <em>condition</em> compares two values, the overall syntax is</p>
</div>
<div class="paragraph">
<p><em>operand1 comparator operand2</em></p>
</div>
<div class="paragraph">
<p>The <em>comparator</em> is one of:</p>
</div>
<div class="paragraph">
<p><strong>== | eq | equals</strong> - compares whether the two operands are equal.</p>
</div>
<div class="paragraph">
<p><strong>!= | ne | notequals</strong> - compares whether the two operands are not equal.</p>
</div>
<div class="paragraph">
<p><strong>&lt; | lt</strong> - checks whether the first operand is smaller than the second one.</p>
</div>
<div class="paragraph">
<p><strong>&gt; | gt</strong> - checks whether the first operand is greater than the second one.</p>
</div>
<div class="paragraph">
<p><strong>&#8656; | le</strong> - checks whether the first operand is smaller than the second one or equal to the second one.</p>
</div>
<div class="paragraph">
<p><strong>&gt;= | ge</strong> - checks whether the first operand is greater than the second one or equal to the second one.</p>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">&lt;? if ${to.gender} != null ?&gt;
&lt;? if ${to.gender} == âWâ ?&gt;
Dear Mrs. ${to.sn},
&lt;? else ?&gt;
Dear Mr. ${to.sn},
&lt;? endif ?&gt;
&lt;? else ?&gt;
Dear Mrs./Mr. ${to.sn},
&lt;? endif ?&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The previous statement tests whether the gender attribute of the participant is filled. If yes, it defines the correct salutation for male and female participants. If not, it defines a more general salutation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">&lt;? if ${name} == âjoeâ ?&gt;
...
&lt;? endif ?&gt;

&lt;? if ${name} != âjoeâ ?&gt;
... +
&lt;? endif ?&gt;

&lt;? if ${value} lt 1 ?&gt;
...
&lt;? endif ?&gt;

&lt;? if ${name} gt âabcâ ?&gt;
...
&lt;? endif ?&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>For Statement</strong></p>
</div>
<div class="paragraph">
<p>The for statement allows you to handle loops. The syntax is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">&lt;? for variable in list ?&gt;
â¦
&lt;? endfor ?&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>where <em>variable</em> is the name of a placeholder which can be subsequently used and <em>list</em> a list of â â delimited values (either constants or delivered by a placeholder whose type is a list).</p>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">&lt;? for activity in ${workflow.activities} ?&gt;
&lt;? if ${activity.approvalResult} == "REJECTED" ?&gt;
&lt;? for participant in ${activity.approvers} ?&gt;
- User ${participant.cn} rejected with reason: ${activity.reason}
&lt;? endfor ?&gt;
&lt;? endif ?&gt;
&lt;? endfor ?&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>which could result in</p>
</div>
<div class="ulist">
<ul>
<li>
<p>User Huber Fritz rejected with reason: Do not like this person<br></p>
</li>
<li>
<p>User Berner Hans rejected with reason: Maybe a security risk?</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that the line "- User ${participant.cn} rejected with reason: ${activity.reason}" acts like a template. You can also define several lines as template text.</p>
</div>
<div class="paragraph">
<p><strong>Java Statement</strong></p>
</div>
<div class="paragraph">
<p>The Java statement allows you to define your own text structures. The syntax is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">&lt;? Java class1 class2 ... classN ?&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>where <em>classX</em> represent Java classes that must implement the interface JavaPlugin.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">&lt;? java placeholder.TestPlugin placeholder.TestPlugin ?&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>is resolved to</p>
</div>
<div class="paragraph">
<p>Hello here I am!<br>
Hello here I am!</p>
</div>
<div class="paragraph">
<p>where placeholder.TestPlugin is defined as</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package placeholder;
import java.io.PrintWriter;
import com.siemens.idm.text.parser.JavaPlugin;
import com.siemens.idm.text.parser.ParserException;
import com.siemens.idm.text.parser.TextParser;
public class TestPlugin implements JavaPlugin {
    public void execute(TextParser parser, PrintWriter out) throws ParserException {
        out.println("Hello here I am!");
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Java Function</strong></p>
</div>
<div class="paragraph">
<p>The Java statement allows you to define your own text structures. The syntax is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">&lt;? JavaFunction class input ?&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>where</p>
</div>
<div class="paragraph">
<p><em>class</em> - represents a Java classname that must implement the interface JavaPluginExt.</p>
</div>
<div class="paragraph">
<p>input - is a string / an expression that is passed to the specified Java class (execute method).</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">&lt;? JavaFunction com.siemens.idm.jini.util.GeneralizedTime2ISO8601 ${workflow.initiatorEntry.dayOfBirth} ?&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>If input = ${workflow.initiatorEntry.dayOfBirth} and dayOfBirth has the value 19700218230000Z the function retrieves 1970-02-19 as result.</p>
</div>
<div class="paragraph">
<p>The class com.siemens.idm.jini.util.GeneralizedTime2ISO8601 is defined as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package com.siemens.idm.jini.util;
import java.io.PrintWriter;
import java.text.SimpleDateFormat;
import com.siemens.date.GeneralizedTime;
import com.siemens.idm.text.parser.JavaPluginExt;
import com.siemens.idm.text.parser.ParserException;
import com.siemens.idm.text.parser.TextParser;

public class GeneralizedTime2ISO8601 implements JavaPluginExt {
    /**
    * transforms given string from generalizedTime format to yyyy-MM-dd format.
    * @param parser the parser
    * @param toBeProcessed the string to be transformed
    * @param out write transformed string to the PrintWriter
    * @return transformed string; &lt;code&gt;NULL&lt;/code&gt; if toBeProcessed == null or &lt;code&gt;not a GeneralizedTime&lt;/code&gt; if invalid format
    */
    public void execute(TextParser parser, String toBeProcessed, PrintWriter out) throws ParserException {
        String res = toBePocessed;
        if (res == null) {
            out.println("NULL");
        }
        //out.println("String: " + res);
        GeneralizedTime t;
        try {
            t = new GeneralizedTime(s);
        } catch (Exception e) {
            // error
            out.println("not a GeneralizedTime");
            return;
        }
        SimpleDateFormat dateFormat = new SimpleDateFormat("yyyy-MM-dd");
        String result = dateFormat.format(t.getDate());
        out.println(result); // result
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_reduced_run_time_activities"><a class="anchor" href="#_ch1_reduced_run_time_activities"></a><a class="link" href="#_ch1_reduced_run_time_activities">1.1.2.1.7. Reduced Run-time Activities</a></h6>
<div class="paragraph">
<p>For approval activities, DirX Identity can run in two modes that depend on the setting of the <strong>Reduce Runtime Activities</strong> flag that is visible in the <strong>Participants</strong> tab of a request workflow definition. The meaning of the values is:</p>
</div>
<div class="paragraph">
<p><strong>false</strong> (default) - besides the original master activity one activity for each approver is created. This mode is compatible with versions prior to 8.2A.</p>
</div>
<div class="paragraph">
<p><strong>true</strong> - besides the original master activity it keeps only one common activity that handles all approvers together.</p>
</div>
<div class="paragraph">
<p>Use the corresponding variables in your mail text to guarantee correct resolution during runtime. For additional information how to fill the address fields see the section Filling the Address Fields.</p>
</div>
<div class="paragraph">
<p>Reduce Runtime Activities = false</p>
</div>
<div class="paragraph">
<p>Use the following variable references in mails:</p>
</div>
<div class="paragraph">
<p><strong>To</strong> - use <strong>${participantEntries[0].mail}</strong> to send the mail to the (single) participant.</p>
</div>
<div class="paragraph">
<p><strong>Language</strong> - use <strong>${participantEntries[0].preferredLanguage}</strong> to select the language for the resulting mail text if you use e-mail nationalization.</p>
</div>
<div class="paragraph">
<p><strong>Body</strong> - use for example <strong>${participantEntries[0].sn}</strong> to include the surname of the participant into the mail text.</p>
</div>
<div class="paragraph">
<p>You can also use these settings with the same result:</p>
</div>
<div class="paragraph">
<p><strong>To</strong> - use <strong>${participantEntries.mail}</strong> to send the mail to the (single) participant.</p>
</div>
<div class="paragraph">
<p><strong>Language</strong> - use <strong>${to.preferredLanguage}</strong> to select the language for the resulting mail text if you use e-mail nationalization.</p>
</div>
<div class="paragraph">
<p><strong>Body</strong> - use for example <strong>${to.sn}</strong> to include the surname of the participant into the mail text.</p>
</div>
<div class="paragraph">
<p>This allows you to use the same mail text fragments for workflows with Reduce Run-time Activities set or not set.</p>
</div>
<div class="paragraph">
<p>Reduce Runtime Activities = true / Separate mails = false</p>
</div>
<div class="paragraph">
<p>This mode creates only one activity for all approvers. Use the following variable references in mails:</p>
</div>
<div class="paragraph">
<p><strong>To</strong> - use <strong>${participantEntries.mail}</strong> to add all participants of this activity into this field.</p>
</div>
<div class="paragraph">
<p><strong>Language</strong> - use <strong>${participantEntries[0].preferredLanguage}</strong> to select the language for the resulting mail text if you use e-mail nationalization.<br>
Note: if the definition resolves to several languages, English is taken per default.</p>
</div>
<div class="paragraph">
<p><strong>Body</strong> - use for example <strong>${participantEntries.sn}</strong> to include all surnames separated with blanks into the mail text. Alternatively you can use the variable <strong>${to.sn}</strong> to obtain the same result. If you use <strong>${to[0].sn}</strong> you will obtain the sn of the first participant. Use the for statement (for example with the loop variable 'i') and <strong>${to[i].sn}</strong> to process all participants as you need it.</p>
</div>
<div class="paragraph">
<p>Reduce Runtime Activities = true / Separate mails = true</p>
</div>
<div class="paragraph">
<p>A more comfortable solution is to send separate mails to each of the participants. In this case set the <strong>Separate mails</strong> flag and use these settings:</p>
</div>
<div class="paragraph">
<p><strong>To</strong> - use <strong>${participantEntries.mail}</strong> to add all participants of this activity into this field.</p>
</div>
<div class="paragraph">
<p><strong>Language</strong> - use <strong>${to.preferredLanguage}</strong> to select the language for the resulting mail text if you use e-mail nationalization.</p>
</div>
<div class="paragraph">
<p><strong>Body</strong> - use for example <strong>${to.sn}</strong> to include the surname into the mail text. You can address any other attribute of the participant here, for example <strong>${to.givenName}</strong>.<br>
Using <strong>${to.gender}</strong> allows distinguishing text for men and women, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">&lt;? if ${to.gender} == âWâ ?&gt;
Dear Mrs. ${to.sn},
&lt;? else ?&gt;
Dear Mr. ${to.sn},
&lt;? endif ?&gt;</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_filling_the_address_fields"><a class="anchor" href="#_ch1_filling_the_address_fields"></a><a class="link" href="#_ch1_filling_the_address_fields">1.1.2.1.8. Filling the Address Fields</a></h6>
<div class="paragraph">
<p>There are various methods to fill the address fields of a mail template (From, To, CC, BCC). This section explains the features and provides some examples.</p>
</div>
<div class="paragraph">
<p>Read also the section Reduced Run-time Activities because this flag influences mail generation.</p>
</div>
<div class="paragraph">
<p>Some general rules apply for the field calculation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>You can send a mail to several persons only in one language. Set the <strong>Language</strong> field accordingly.</p>
</li>
<li>
<p>Users with no mail address do not lead to an error as long as there are other mail addresses available.</p>
</li>
<li>
<p>An error is generated if after calculating the From or To field no mail address is available.</p>
</li>
<li>
<p>There are specific errors (To field only) returned from the mail server that result in a send error (for example "550 Relaying denied to &lt;<a href="mailto:tester@alphabeta.com">tester@alphabeta.com</a>&gt;"). In this case the mail is also not sent to the other members of the To field.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Addressing a Single User</p>
</div>
<div class="paragraph">
<p>In many cases you send the e-mail to exactly one person. In this case you can use the expression:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">${participantEntries[0].mail}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the mail attribute contains only one value, it retrieves a single mail address, for example: <a href="mailto:Nik.Taspatch@My-Company.com">Nik.Taspatch@My-Company.com</a></p>
</div>
<div class="paragraph">
<p>If the mail attribute contains multiple mail addresses, the result is for example: <a href="mailto:Nik.Taspatch@My-Company.com">Nik.Taspatch@My-Company.com</a> <a href="mailto:Niki@gmx.com">Niki@gmx.com</a></p>
</div>
<div class="paragraph">
<p>Note that the addresses are separated by blanks.</p>
</div>
<div class="paragraph">
<p>If this expression is set in the To field, the user might get multiple instances of the same mail.</p>
</div>
<div class="paragraph">
<p>If this expression is set in the From field, the first address is taken, the others are ignored (depends also on the mail server type).</p>
</div>
<div class="paragraph">
<p>If you want to enforce only one value, you can use the expression:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">${participantEntries[0].mail[0]}</code></pre>
</div>
</div>
<div class="paragraph">
<p>There is no way to define which value is taken from the list.</p>
</div>
<div class="paragraph">
<p>Addressing Multiple Users</p>
</div>
<div class="paragraph">
<p>You can use the expression</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">${participantEntries.mail}</code></pre>
</div>
</div>
<div class="paragraph">
<p>to retrieve the mail addresses of all participants. The resulting string could be for example:</p>
</div>
<div class="paragraph">
<p><a href="mailto:Nik.Taspatch@My-Company.com">Nik.Taspatch@My-Company.com</a> <a href="mailto:Niki@gmx.com">Niki@gmx.com</a>; <a href="mailto:Lavina.Pitton@My-Company.com">Lavina.Pitton@My-Company.com</a> ; <a href="mailto:Retha.Wagner@My-Company.com">Retha.Wagner@My-Company.com</a> ;</p>
</div>
<div class="paragraph">
<p>The addresses of one user are separated by blanks (here for Nik Taspatch), the users are separated by semicolon.</p>
</div>
<div class="paragraph">
<p>If you use this definition in the To field, you can work with the <strong>to</strong> variable in conjunction with the <strong>Separate mail</strong> flag. See the section Reduced Run-time Activities for more information.</p>
</div>
<div class="paragraph">
<p>You can use semicolon to define multiple expressions in one line, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">${participantEntries[0].mail};${workflow.subject.mail}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Defining Conditional Addresses</p>
</div>
<div class="paragraph">
<p>In some cases you might want to define conditional addresses. This is for example useful in privilege access certification workflows where you want to inform only the users that their privilege assignment is removed. Define a conditional expression:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">&lt;? for res in ${workflow.resources} ?&gt;&lt;? if ${res.userInfo} == "true" ?&gt;${res.dxrassignto@mail};&lt;? endif ?&gt;&lt;? endfor ?&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>which is a loop that filters all assignments where the userInfo flag is set to true:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">&lt;? for res in ${workflow.resources} ?&gt;
&lt;? if ${res.userInfo} == "true" ?&gt;
${res.dxrassignto@mail};
&lt;? endif ?&gt;
&lt;? endfor ?&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The mail addresses are separated by a semicolon.</p>
</div>
<div class="paragraph">
<p>Using the âToâ Variable</p>
</div>
<div class="paragraph">
<p>If you use expressions in the <strong>To</strong> address field that include the substrings â.mailâ or â@mailâ then a <strong>to</strong> variable (representing user objects) is set internally. This <strong>to</strong> variable can then be used in other expressions, too.</p>
</div>
<div class="paragraph">
<p>For example, in the message body:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">&lt;? if ${to.gender} != null ?&gt;
&lt;? if ${to.gender} == "W" ?&gt;
Dear Mrs. ${to.sn},
&lt;? else ?&gt;
Dear Mr. ${to.sn},
&lt;? endif ?&gt;
&lt;? else ?&gt;
Dear Mrs./Mr. ${to.sn},
&lt;? endif ?&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Keep in mind that this kind of approach only works if the <strong>Separate mails</strong> flag is turned on.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_participant_calculation"><a class="anchor" href="#_ch1_participant_calculation"></a><a class="link" href="#_ch1_participant_calculation">1.1.2.1.9. Participant Calculation</a></h6>
<div class="paragraph">
<p>You can define participants in many ways. The method described here is easy to understand, powerful and well suited to a directory object structure that works with links.</p>
</div>
<div class="paragraph">
<p>Select the <strong>static</strong> method from the drop-down selection in a <strong>Participants</strong> tab in approval activities. Here you can define a mix of</p>
</div>
<div class="ulist">
<ul>
<li>
<p>static participant definitions (for example cn=Berner Hans,ou=Human Resources,o=My-Company,cn=Users,cn=My-Company</p>
</li>
<li>
<p>or dynamic participant definitions (for example ${workflow.subject.manager} which retrieves the manager of the subject this workflow is for).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If an attribute (for example ${workflow.subject.owner}) contains several links, all are used as participants.</p>
</div>
<div class="paragraph">
<p>Start Objects</p>
</div>
<div class="paragraph">
<p>There are several start objects for dynamic participant definitions:</p>
</div>
<div class="paragraph">
<p><strong>workflow.subject</strong> - the subject of the request workflow (for example a user, a privilege or a business object)</p>
</div>
<div class="paragraph">
<p><strong>workflow.resources.dxrassignto</strong> - the resource(s) of the request workflow</p>
</div>
<div class="paragraph">
<p><strong>workflow.initiatorEntry</strong> - the initiator of the workflow</p>
</div>
<div class="paragraph">
<p><strong>previousParticipants</strong> - the previous participant (can be used during escalations). Note that you cannot use the participantEntries start object because this is the one that is in calculation.</p>
</div>
<div class="paragraph">
<p>Methods to set up dynamic definitions are:</p>
</div>
<div class="paragraph">
<p>One-level Definitions</p>
</div>
<div class="paragraph">
<p>These definitions use a link attribute at the start object.</p>
</div>
<div class="paragraph">
<p>${workflow.subject.manager} - retrieves the manager(s) of the subject (uses the manager link to look up the manager DNs)<br>
${workflow.subject.owner} - retrieves all owner of the subject (uses the owner link to look up the owner DNs)<br>
${workflow.initiatorEntry.manager} - retrieves the initiator&#8217;s manager.<br>
${workflow.resources.dxrassignto@owner} - retrieves the privilege owner(s).<br>
${workflow.resources.dxrassignto@owner.manager} - retrieves the manager(s) of the privilege owner(s).</p>
</div>
<div class="paragraph">
<p>Multi-level Definitions</p>
</div>
<div class="paragraph">
<p>Definitions of this type use a link chain to get the attribute where to retrieve the participants from.</p>
</div>
<div class="paragraph">
<p>${workflow.subject.manager.manager} - retrieves the manager of the subject&#8217;s manager (useful for escalation)<br>
${workflow.subject.dxrLocationLink.manager} - retrieves the manager of the location the subject is assigned to</p>
</div>
<div class="paragraph">
<p>Relative Definitions</p>
</div>
<div class="paragraph">
<p>During escalation you can refer to the previous participant(s) of an approval activity.</p>
</div>
<div class="paragraph">
<p>${previousParticipants.manager} - retrieves the manager(s) of all participants of the previous activity during an escalation<br>
${previousParticipants[0].manager} - gets the manager of the first participant of the previous activity during an escalation</p>
</div>
<div class="paragraph">
<p>Multiple Definitions</p>
</div>
<div class="paragraph">
<p>To retrieve participants from different links, use multiple lines in the <strong>static</strong> table of the <strong>Participants</strong> tab, for example:</p>
</div>
<div class="paragraph">
<p>${workflow.subject.manager} - retrieves the manager<br>
${workflow.subject.secretary} - additionally retrieves the secretary<br>
${workflow.subject.sponsor} - and finally evaluates the sponsor link</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_tips_and_tricks"><a class="anchor" href="#_ch1_tips_and_tricks"></a><a class="link" href="#_ch1_tips_and_tricks">1.1.2.1.10. Tips and Tricks</a></h6>
<div class="paragraph">
<p>This section provides some examples of variable substitution as well as valuable tips and tricks.</p>
</div>
<div class="paragraph">
<p>Representing Fields and Strings</p>
</div>
<div class="paragraph">
<p>The syntax you use in field and string representations depends on the internal representation of a requested field (whether it is a string or an array of strings) and the location where the field is used.</p>
</div>
<div class="paragraph">
<p>Example 1:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">Dear Mr. ${workflow.subject.sn}</code></pre>
</div>
</div>
<div class="paragraph">
<p>might be resolved to</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">Dear Mr. Smith</code></pre>
</div>
</div>
<div class="paragraph">
<p>Example 2:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">&lt;? if ${workflow.subject.sn[0]} == "Smith" ?&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>is resolved to true if sn = "Smith"</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">If you are in doubt try both variants.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Evaluating the Resource Order Type</p>
</div>
<div class="paragraph">
<p>Use the attribute <strong>typeOfOrder</strong> to determine the resource order type for privilege assignments, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">&lt;? if ${workflow.resources[0].typeOfOrder} == "ADD" ?&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The possible values are ADD, MODIFY or DELETE.</p>
</div>
<div class="paragraph">
<p>Creating Correct Salutations in Email</p>
</div>
<div class="paragraph">
<p>You can create correct salutation with these statements:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">&lt;? if ${participantEntries[0].dxrSalutation[0]} == Herr ?&gt; Sehr geehrter Herr ${participantEntries[0].sn}, &lt;? endif ?&gt;
&lt;? if ${participantEntries[0].dxrSalutation[0]} == Frau ?&gt; Sehr geehrte Frau ${participantEntries[0].sn}, &lt;? endif ?&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In an international environment, you may want to include the preferredLanguage attribute for correct salutation.</p>
</div>
<div class="paragraph">
<p>Creating Escalation Specific Bodies in Email</p>
</div>
<div class="paragraph">
<p>You can create escalation specific mail bodies by evaluating the variable <strong>${escalationLevel}</strong>, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">&lt;? if ${escalationLevel} == "0" ?&gt;
... body without escalation ...
&lt;? else ?&gt;
&lt;? if ${escalationLevel} &gt; "1" ?&gt;
... body for levels &gt; 1 ...
&lt;? else ?&gt;
... body for level = 1
&lt;? endif ?&gt;
&lt;? endif ?&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch1_implementing_a_new_activity"><a class="anchor" href="#_ch1_implementing_a_new_activity"></a><a class="link" href="#_ch1_implementing_a_new_activity">1.1.2.2. Implementing a New Activity</a></h5>
<div class="paragraph">
<p>The preferred way to create a customized job implementation is to leverage the socketed job framework for automatic activities (see the chapter "Implementing a Socketed Job Framework-based Activity" for more details). You only need to define a brand-new activity if the socketed job framework is not sufficient for your needs. This section describes the general steps necessary to define and implement such an activity.</p>
</div>
<div class="paragraph">
<p>To create your own job implementation, you must:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Define configuration parameters</p>
</li>
<li>
<p>Supply a component description</p>
</li>
<li>
<p>Implement the job as a Java class</p>
</li>
<li>
<p>Read the job configuration</p>
</li>
<li>
<p>Read the workflow instance data</p>
</li>
<li>
<p>Modify the workflow instance data</p>
</li>
<li>
<p>Read and change orders</p>
</li>
<li>
<p>Deploy your job implementation</p>
</li>
<li>
<p>Obtain a connection to the Identity domain</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For the API documentation, consult the following folder on your DVD:</p>
</div>
<div class="paragraph">
<p><strong>Documentation\DirXIdentity\RequestWorkflows\index.html</strong>.</p>
</div>
<div class="paragraph">
<p>For sample sources, see the following folder on your DVD:</p>
</div>
<div class="paragraph">
<p><strong>Additions\RequestWorkflows\samples</strong>.</p>
</div>
<div class="sect5">
<h6 id="_ch1_defining_configuration_parameters"><a class="anchor" href="#_ch1_defining_configuration_parameters"></a><a class="link" href="#_ch1_defining_configuration_parameters">1.1.2.2.1. Defining Configuration Parameters</a></h6>
<div class="paragraph">
<p>The entire workflow configuration is passed to the server as an XML document. The configuration parameters for the job are part of this document. When the server starts the job, it passes am XML configuration object with the &lt;job&gt; element as the parent node. It should conform to the following structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;job&gt;
&lt;basename&gt;myjob&lt;/basename&gt;
&lt;class&gt;com.mycompany.myorg.MyJobImpl&lt;/class&gt;
&lt;params&gt;
&lt;param name="param1" value="value1"/&gt;
&lt;param name="param2" value="value2"/&gt;
&lt;/params&gt;
&lt;/job&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>basename:</p>
</div>
<div class="paragraph">
<p>The basename string value tells the server&#8217;s class loader the name of the folder in which to search for your job classes. It must be a folder underneath</p>
</div>
<div class="paragraph">
<p><em>install_path</em>*/ids-j-<strong><em>domain</em></strong>-S*<em>n</em>/<strong>confdb/jobs</strong>.</p>
</div>
<div class="paragraph">
<p>In the above sample, the server assumes your classes are in the following folder:</p>
</div>
<div class="paragraph">
<p><em>install_path</em>*/ids-j-<strong><em>domain</em></strong>-S*<em>n</em>*/confdb/jobs/myjob*.</p>
</div>
<div class="paragraph">
<p>class:</p>
</div>
<div class="paragraph">
<p>The full class name of your job implementation; that is, the class that implements the interface</p>
</div>
<div class="paragraph">
<p>com.siemens.idm.api.Job.</p>
</div>
<div class="paragraph">
<p>params:</p>
</div>
<div class="paragraph">
<p>The &lt;params&gt; element contains a list of &lt;param&gt; sub-elements with your configuration parameters. For each parameter, you specify its name and the value. It&#8217;s the responsibility of your job implementation to evaluate them.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_supplying_a_component_description"><a class="anchor" href="#_ch1_supplying_a_component_description"></a><a class="link" href="#_ch1_supplying_a_component_description">1.1.2.2.2. Supplying a Component Description</a></h6>
<div class="paragraph">
<p>To allow Identity Manager to configure an activity with your job, you must supply a component description. The component description extends an abstract object description of an activity. The activity creation wizard searches for activity component descriptions and presents them in a list.</p>
</div>
<div class="paragraph">
<p>Adding the Component Description LDAP Entry</p>
</div>
<div class="paragraph">
<p>You must add your component description LDAP entry underneath the workflow configuration folder in the Identity domain:</p>
</div>
<div class="paragraph">
<p>cn=Activity Types,cn=Configuration,cn=wfRoot,cn=&lt;your domain&gt;.</p>
</div>
<div class="paragraph">
<p>We recommend that you create your own subfolder (for example, "cn=Customer Extensions") to clearly separate your configurations from configurations installed with DirX Identity.</p>
</div>
<div class="paragraph">
<p>Please supply values for the following LDAP attributes. They help to present your activity appropriately in the wizard.</p>
</div>
<div class="paragraph">
<p>objectclass - needs the values <strong>dxmComponentDescription</strong> and <strong>top</strong>.</p>
</div>
<div class="paragraph">
<p>cn - the naming attribute.</p>
</div>
<div class="paragraph">
<p>dxmComponentType - needs the value <strong>activity</strong> for the activity creation wizard, which only presents component descriptions with this attribute value.</p>
</div>
<div class="paragraph">
<p>dxmType - categorizes the basic activity type. The following values are supported:</p>
</div>
<div class="paragraph">
<p><strong>automatic</strong>: an activity that runs automatically without any human interaction. It is started by the server as soon as the start conditions of the activity evaluate to true. Typically, this is the value you should provide.</p>
</div>
<div class="paragraph">
<p><strong>notify</strong>: an activity that can be used for notifications, especially in case of errors or at the end of a workflow. DirX Identity already supplies e-mail notifications.</p>
</div>
<div class="paragraph">
<p><strong>people</strong>: an activity that requires human interaction. It is not applicable for your job implementation.</p>
</div>
<div class="paragraph">
<p>dxmActivityType - a string value that helps to further categorize the activity. It is displayed in the selection page of the create activity wizard.</p>
</div>
<div class="paragraph">
<p>description - the description that is displayed in the selection page of the create activity wizard.</p>
</div>
<div class="paragraph">
<p>dxmContent - the XML document that represents the component description.</p>
</div>
<div class="paragraph">
<p>Creating the Component Description XML Document</p>
</div>
<div class="paragraph">
<p>Use the following template for your own component description:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;componentDescription
name="Name of your component"
componentCategory="activity"
&gt;
&lt;extendsComponentDescription&gt;automaticActivity&lt;/extendsComponentDescription&gt;
&lt;rootelement&gt;activity&lt;/rootelement&gt;
&lt;element name="activity" extends="activity"&gt;
&lt;properties&gt;
&lt;property name="dxmActivityType" &gt;
&lt;value&gt;applyChange&lt;/value&gt;
&lt;/property&gt;
&lt;/properties&gt;
&lt;element ref="job" minOccurs="1" maxOccurs="1"/&gt;
&lt;/element&gt;
&lt;element name="job" extends="job"&gt;
&lt;properties&gt;
&lt;property name="basename" xmlNotation="SimpleElementProperty"
elementname="basename" &gt;
&lt;value&gt;**Your Job classes folder**&lt;/value&gt;
&lt;/property&gt;
&lt;property name="class" xmlNotation="SimpleElementProperty"
elementname="class" &gt;
&lt;value&gt;**com.mycompany.myorg.MyJobImpl**&lt;/value&gt;
&lt;/property&gt;
&lt;/properties&gt;
&lt;element ref="params" minOccurs="1" maxOccurs="1"/&gt;
&lt;/element&gt;
&lt;element name="params" extends="params"&gt;
&lt;properties&gt;
&lt;property name="*param1*" xmlNotation="NameValueProperty"
elementname="param" type="java.lang.Boolean"&gt;
&lt;value&gt;false&lt;/value&gt;
&lt;/property&gt;
&lt;property name="*param2*" xmlNotation="NameValueProperty"
elementname="param" type="java.lang.String"&gt;
&lt;value default="true"&gt;the default value&lt;/value&gt;
&lt;value&gt;value2&lt;/value&gt;
&lt;/property&gt;
&lt;/properties&gt;
&lt;/element&gt;
&lt;presentationDescription&gt;
&lt;propertypage name="JobTab"
insertafter="GeneralTab"
class="siemens.dxr.manager.nodes.customizer.GenericPropertyPage"
title="Parameters"
layout="properties: *job/params/param1,job/params/param2*"
/&gt;
&lt;propertyPresentations&gt;
&lt;property name="*job/params/param1*"&gt;
&lt;label&gt;**Param 1**&lt;/label&gt;
&lt;/property&gt;
&lt;property name="*job/params/param2*" &gt;
&lt;label&gt;**Param 2**&lt;/label&gt;
&lt;/property&gt;
&lt;/propertyPresentations&gt;
&lt;/presentationDescription&gt;

&lt;/componentDescription&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Leave most of the template unchanged. You only need to insert the name of your component, your job class folder, the class name of your job implementation and for each configuration parameter, a description of the property and its presentation. See also "Defining Configuration Parameters".</p>
</div>
<div class="paragraph">
<p>Element &lt;componentDescription&gt;, attribute name:</p>
</div>
<div class="paragraph">
<p>The name of your component description as it is displayed in the column "component" in the selection page of the activity creation wizard.</p>
</div>
<div class="paragraph">
<p>In the element named job: &lt;element name="job" &#8230;&#8203;/&gt;:</p>
</div>
<div class="paragraph">
<p>In &lt;property name="basename":</p>
</div>
<div class="paragraph">
<p>In the &lt;value&gt; sub-element, enter the name of the subfolder in which the class loader of the IdS-J server searches for the classes of your job implementation.</p>
</div>
<div class="paragraph">
<p>In &lt;property name="class":</p>
</div>
<div class="paragraph">
<p>In the &lt;value&gt; sub-element, enter the full class name of your implementation.</p>
</div>
<div class="paragraph">
<p>In &lt;element name="params", sub-element &lt;properties&gt;:</p>
</div>
<div class="paragraph">
<p>For each configuration parameter, enter an element &lt;property&gt; with the following attributes:</p>
</div>
<div class="paragraph">
<p><strong>name</strong>: the parameter name, for example, param1.</p>
</div>
<div class="paragraph">
<p>xmlNotation: always use the value "NameValueProperty".</p>
</div>
<div class="paragraph">
<p>elementname: always use the value "param".</p>
</div>
<div class="paragraph">
<p><strong>type</strong>: designates the data type of the parameter. Common values are: java.lang.Boolean, java.lang.String.</p>
</div>
<div class="paragraph">
<p>Provide allowed values as a list of <strong>&lt;value&gt;</strong> sub-elements. Flag the default value by the attribute default set to true.</p>
</div>
<div class="paragraph">
<p>The presentation of your configuration parameters in the Identity Manager is specified in the &lt;presentationDescription&gt; element.</p>
</div>
<div class="paragraph">
<p>The &lt;propertypage&gt; sub-element defines a property page. Make sure that all your parameters are listed in the <strong>layout</strong> attribute. They are presented in the same order as the list. Pay special attention to the parameter names: they must be prefixed with the XML parent element names in XPath format. For our scenarios, this is always "job/params/". To present your parameters "param1" and "param2" you must enter:</p>
</div>
<div class="paragraph">
<p>layout="properties: job/params/param1, job/params/param2"</p>
</div>
<div class="paragraph">
<p>The presentation of your parameters is specified in the &lt;propertyPresentations&gt; element. Enter a &lt;<strong>property</strong>&gt; sub-element for each of your parameters.</p>
</div>
<div class="paragraph">
<p>Attribute <strong>name</strong>:</p>
</div>
<div class="paragraph">
<p>The name of your property in the same format as used for the &lt;propertypage&gt;. This means: Use "job/params/param1" for parameter "param1"!</p>
</div>
<div class="paragraph">
<p>Sub-element &lt;<strong>label</strong>&gt;:</p>
</div>
<div class="paragraph">
<p>The name of your parameter as it is displayed in the property page.</p>
</div>
<div class="paragraph">
<p>If you entered a list of allowed values in the &lt;element&gt;&lt;property&gt; definition, Identity Manager automatically presents them as a combo box.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_implementing_the_job"><a class="anchor" href="#_ch1_implementing_the_job"></a><a class="link" href="#_ch1_implementing_the_job">1.1.2.2.3. Implementing the Job</a></h6>
<div class="paragraph">
<p>When an activity is to be started, the IdS-J server loads a class with the name configured in the &lt;classname&gt; sub-element of the &lt;job&gt;. The server expects that this class has a default constructor and implements the interface com.siemens.idm.api.Job.</p>
</div>
<div class="paragraph">
<p>This interface requires the following methods:</p>
</div>
<div class="paragraph">
<p>setConfiguration(IDMJob cfg):</p>
</div>
<div class="paragraph">
<p>The server calls this method before the run() method to hand over the job configuration.</p>
</div>
<div class="paragraph">
<p>It passes the configuration in a class that wraps the XML fragment containing the job configuration. The root element is the &lt;job&gt; element with the configuration parameters in its params/param element. See "Reading the Job Configuration" for details.</p>
</div>
<div class="paragraph">
<p>run(TaskContext ctx, Map modifications):</p>
</div>
<div class="paragraph">
<p>This method starts the job. The server passes two parameters.</p>
</div>
<div class="paragraph">
<p>The task context gives read access to the activity and workflow instance, especially to the workflow and activity states, the workflow initiator, the subject and the optional resources.</p>
</div>
<div class="paragraph">
<p>The job can indirectly modify the workflow by entering the desired modifications into the passed modification map. Use this facility to set the resulting activity state or application state.</p>
</div>
<div class="paragraph">
<p>Handling Retries</p>
</div>
<div class="paragraph">
<p>In error situations, the workflow engine re-starts a job according the retry configuration: retry limit and "wait before retry". The engine assumes an error if the job implementation throws an exception. As a result, the job implementation does not need to handle retries. It just throws an exception and relies on the workflow engine to start it again later on. If the job sets an application state (see "Modifying Instance Data" for information on how to do this), it is taken as application state for the activity after the last retry failed.</p>
</div>
<div class="paragraph">
<p>Activity Timeout</p>
</div>
<div class="paragraph">
<p>A timeout is indicated to the job via the TaskContext. If the job does not react or does not react in a timely fashion an interrupt for the thread is called. The resulting InterruptedException should not be ignored. For more information, see the Use Case documentation <em>Java Programming in DirX Identity</em>.</p>
</div>
<div class="paragraph">
<p>Importing Required Libraries</p>
</div>
<div class="paragraph">
<p>When compiling your class, make sure you have the following jar file on your classpath:</p>
</div>
<div class="paragraph">
<p>com.siemens.idm.server-api.jar<br>
com.siemens.idm.requestworkflow-api.jar<br>
dxmAPI.jar<br>
dxmUtil.jar<br>
dxmOrder.jar</p>
</div>
<div class="paragraph">
<p>For the API documentation, consult the following folder on your DVD:</p>
</div>
<div class="paragraph">
<p><strong>Documentation\DirXIdentity\RequestWorkflows\index.html</strong>.</p>
</div>
<div class="paragraph">
<p>For sample sources, see the following folder on your DVD:</p>
</div>
<div class="paragraph">
<p><strong>Additions\RequestWorkflows\samples</strong>.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_reading_the_job_configuration"><a class="anchor" href="#_ch1_reading_the_job_configuration"></a><a class="link" href="#_ch1_reading_the_job_configuration">1.1.2.2.4. Reading the Job Configuration</a></h6>
<div class="paragraph">
<p>The IdS-J server provides a convenience class <em>XmlNodeMapImpl</em> that holds the configuration parameters in a Map. Get a parameter string value using the parameter name as a key. Here is a sample snippet for a string and a boolean parameter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Node paramsNode = _cfg.getNode("params");
Map map = new com.siemens.idm.jini.util.xml.XmlNodeMapImpl(paramsNode);
_attributeName = String.valueOf(map.get("attributeName"));
String s = String.valueOf(map.get("modifySubject"));
_modifySubject = Boolean.valueOf(s);</code></pre>
</div>
</div>
<div class="paragraph">
<p>See also the readConfiguration() method in the sample.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_reading_the_workflow_instance_data"><a class="anchor" href="#_ch1_reading_the_workflow_instance_data"></a><a class="link" href="#_ch1_reading_the_workflow_instance_data">1.1.2.2.5. Reading the Workflow Instance Data</a></h6>
<div class="paragraph">
<p>The configuration object passed in the run(&#8230;&#8203;) method allows us to obtain the activity and the workflow instance object as in the following sample snippet:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">com.siemens.idm.api.nodes.IDMActivity activity = _cfg.getActivity();
com.siemens.idm.api.nodes.IDMWorkflow wf = activity.getWorkflow();</code></pre>
</div>
</div>
<div class="paragraph">
<p>This gives us the interface of a standard workflow. Since we are working here with a request workflow, we want the specialized interface, which we get by class casting:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">com.siemens.idm.requestworkflow.api.RequestWorkflowInstance rqwf = (RequestWorkflowInstance)wf;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now we are able to obtain some data from the workflow, such as the initiator, the subject and the resource(s). Here is a snippet that reads the DN of the workflow initiator:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">String initiator = wf.getInitiator();</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the following sections, we show how to read the subject and the resources. For reading other properties, see the javadoc of the API.</p>
</div>
<div class="paragraph">
<p>Reading the Workflow Subject</p>
</div>
<div class="paragraph">
<p>The workflow subject is the entry that represents</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the user who is created with this workflow or</p>
</li>
<li>
<p>whose attributes are modified or</p>
</li>
<li>
<p>who is assigned some privilege or</p>
</li>
<li>
<p>the role or other object which is created or modified.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The subject is stored in the workflow instance as an XML object, which we call "Order". An order is basically an SPML request that is extended with some properties such as the activation date, the creator, and so on. There are several types of orders: Add- or Modify-Orders are used with a creation or an "approve-modification" workflow, while an Info-Order represents a subject that is not modified as with a user-assignment approval. Note that you can change an Add- or Modify-Order from within an activity, but not an Info-Order.</p>
</div>
<div class="paragraph">
<p>You obtain a subject via the request workflow instance:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">com.siemens.dxm.api.order.Order subject = rqwf.getSubject();</code></pre>
</div>
</div>
<div class="paragraph">
<p>There are a number of "getters" to read properties such as the DN, the order type (Add, Modify, Info, and so on) or the directory type (user, role, &#8230;&#8203;) of the order instance. Here are a few samples. For more details, see the API.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">String subjectDN = subject.getID();
String orderType = subject.getType();
String directoryType = subject.getDirectoryType();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note: if you want to modify the subject and store it persistently for further use in follow-up activities, don&#8217;t use the "setter" methods; use the modification object passed in the calling run(&#8230;&#8203;) method. See the section "Modifying Workflow Instance Data" for more details.</p>
</div>
<div class="paragraph">
<p>Reading the Workflow Resource(s)</p>
</div>
<div class="paragraph">
<p>A workflow instance may contain no resources, one resource, or more than one resource. For example, a workflow for creating a (user) object or approving its modification does not need a resource. In a workflow for approving a user-role assignment, the role assignment is the resource.</p>
</div>
<div class="paragraph">
<p>The resources in a workflow instance are very similar to workflow subjects: they are represented as an "Order".</p>
</div>
<div class="paragraph">
<p>To work with resources, you have the following alternatives:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Handle them as orders. This is the preferred way.</p>
</li>
<li>
<p>Handle them as XML strings.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To work with resources as orders, you obtain an array of resources from a workflow instance by issuing:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Order[] resourceOrders = null;
resourceOrders = rqwf.getResources();</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following code snippet shows how to read attributes from a resource and set some value. For the complete code, see the sample delivered with DirX Identity.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">for (Order resource: resourcesArray) {
    log.info("Resource: resource type=" + resource.getResourceType() + ", Order Type=" + resource.getType() + ", Resource ID="+resource.getID());
    String[] attrnames = resource.getAttributeNames();
    for (String attrname: attrnames) {
        log.info("Value(s) of resource attribute " + attrname + ": " + stringArray2String(resource.getValues(attrname)));
    }
    if (!modifySubject) {
        resource.setProperty(_attributeName, _attributeValue);
        log.info("Resource modified: "+resource.toXMLString());
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To work with resources as strings:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Obtain the resources as a collection from a workflow instance by calling its getResourceAsString method:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">ArrayList resourceStrings = null;
Collection resources = rqwf.getResourceStrings();
resourceStrings = processResourceStrings(resources.iterator());</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Transform the resource string to an order with the following code snippet:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">while (it.hasNext()) {
    String rs = (String)it.next();
    OrderFactory factory = new OrderFactoryImpl();
    Order resource = factory.create(rs);
    // now you can handle the resource order as above
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Get back the resource as string with the order method toXMLString():</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">String resourceString = resource.toXMLString();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note: if you want to modify the resource and store it persistently for further use in follow-up activities, don&#8217;t use the setter methods. Use the modification object passed in the calling run(&#8230;&#8203;) method. See the section "Modifying the Workflow Instance Data" for more details.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_modifying_the_workflow_instance_data"><a class="anchor" href="#_ch1_modifying_the_workflow_instance_data"></a><a class="link" href="#_ch1_modifying_the_workflow_instance_data">1.1.2.2.6. Modifying the Workflow Instance Data</a></h6>
<div class="paragraph">
<p>Use caution when modifying a subject or a resource in a workflow instance. With a normal class, you expect to use the setter methods to store new or modified values. You can do this for orders, too, but the changes are not stored back in the workflow instance; they are lost when your job ends. To store your changes in the workflow instance and make them available to downstream activities, you must return them to the workflow engine as modifications.</p>
</div>
<div class="paragraph">
<p>An empty modifications map is passed to your job as parameter of the "run" method call:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">run(TaskContext ctx, _Map modifications_)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Use this map to return your changes and make them persistent. Put the changed objects into the map using some predefined keys. The following snippets are taken from the sample job implementation delivered with DirX Identity and demonstrate how to store the changes for a subject or a resource as an order or an XML string:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// subject as an order: +
modifications.put(RequestWorkflowInstance.KEY_WF_SUBJECT, subject);

// subject as string: +
modifications.put(RequestWorkflowInstance.KEY_WF_SUBJECTSTRING, subject.toXMLString());

// resource as an order: +
modifications.put(RequestWorkflowInstance.KEY_WF_RESOURCES, resourceOrders);

// resource as string: +
modifications.put(RequestWorkflowInstance.KEY_WF_RESOURCESTRINGS, resourceStrings);</code></pre>
</div>
</div>
<div class="paragraph">
<p>There are other standard keys. You find them as static properties of the <em>RequestWorkflowInstance</em> interface. A very important key is KEY_ACT_APPLICATION_STATE to set the application state of an activity. Use it to set the activity state explicitly. A workflow designer can then easily configure different downstream activities depending on the state of your job implementation. The following sample sets the application state to success:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">modifications.put(RequestWorkflowInstance.KEY_ACT_APPLICATION_STATE, "success");</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more details on changing an order see the section Reading and Changing Orders.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_read_and_write_context_properties"><a class="anchor" href="#_ch1_read_and_write_context_properties"></a><a class="link" href="#_ch1_read_and_write_context_properties">1.1.2.2.7. Read and Write Context Properties</a></h6>
<div class="paragraph">
<p>You can use the workflow context to store application-specific information in a request flow activity and then read it later on in a downstream activity. The context allows you to store custom properties as you would in a Java map. You obtain the context from the request workflow instance as shown in the following snippet (for details, see "Reading the Workflow Instance Data"):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">IDMActivity activity = _cfg.getActivity(); +
IDMWorkflow wf = activity.getWorkflow(); +
RequestWorkflowInstance rqwf = (RequestWorkflowInstance)wf; +
IDMWorkflowContext *ctx = rqwf.getContext()*;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following snippet shows how to put a property named "testtest" with the ID of the Java Virtual Machine into the context:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">VMID vmid = new VMID(); +
String id = vmid.toString();* +
ctx.put*("testtest", id);* +
rqwf.setContext*(ctx);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Don&#8217;t forget to set the modified context at the workflow!</p>
</div>
<div class="paragraph">
<p>Obtaining a property from the context is as easy as reading it from a map:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">String test = (String) *ctx.get*("testtest"); +
logger.info("retrieve testtest:" + ((test !=null) ? test: "nada"));</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_reading_and_changing_orders"><a class="anchor" href="#_ch1_reading_and_changing_orders"></a><a class="link" href="#_ch1_reading_and_changing_orders">1.1.2.2.8. Reading and Changing Orders</a></h6>
<div class="paragraph">
<p>Subjects and resources in a workflow instance are orders. The section "Reading the Workflow Instance Data" shows how to obtain them from the workflow. Orders implement the interface com.siemens.dxm.api.order.Order.</p>
</div>
<div class="paragraph">
<p>An order is either of type <strong>InfoOrderRequest</strong>, <strong>AddOrderRequest</strong>, <strong>ModifyOrderRequest</strong> or <strong>DeleteOrderRequest</strong> (short: info order, add order, etc). The type depends on the workflow type and on the data with which the workflow was created. In a workflow with resources (that is, assignments for a subject user) the subject is always an info order. An info order contains only a number of attributes for the subject, no modifications. If the workflow is for creating an object (for example, creating a user), for approving subject attributes or for deleting an object, the order is of type add, modify or delete respectively.</p>
</div>
<div class="paragraph">
<p>Use the method <strong>getType</strong> to determine the type of the order. With <strong>getID</strong>, you obtain the object&#8217;s DN and with <strong>getValues(*<em>propertyname</em></strong>)*, you get the values of an property as a string array. For more details, examine the appropriate API.</p>
</div>
<div class="paragraph">
<p>The following methods are provided for changing an order:</p>
</div>
<div class="paragraph">
<p><strong>setSubjectDN(*<em>dn</em></strong>)* / <strong>setResourceDN(*<em>dn</em></strong>)*:</p>
</div>
<div class="paragraph">
<p>Sets the identifier (the distinguished name) of the subject with respect to the resource.</p>
</div>
<div class="paragraph">
<p><strong>setProperty(*<em>name</em></strong>,* <em>value</em>*)*:</p>
</div>
<div class="paragraph">
<p>Sets or changes attributes controlled in an order. Note that the behavior depends on the type of the order. For:</p>
</div>
<div class="paragraph">
<p>Info Order:</p>
</div>
<div class="paragraph">
<p>This method simply sets the value for the attribute. Changes are NOT stored in the subject entry in LDAP, they reside only in the workflow.</p>
</div>
<div class="paragraph">
<p>If the value is empty, or an empty String (<strong>""</strong>) or an array of length 0, the old attribute value is removed from the order.</p>
</div>
<div class="paragraph">
<p>Add Order:</p>
</div>
<div class="paragraph">
<p>Attribute changes are stored in the workflow and the apply Change activity stores them in the new subject / resource entry in LDAP.</p>
</div>
<div class="paragraph">
<p>If the value is empty, or an empty String (<strong>""</strong>) or an array of length 0, the old attribute value is removed from the order.</p>
</div>
<div class="paragraph">
<p>Modify Order:</p>
</div>
<div class="paragraph">
<p>Attribute changes are stored in the workflow and the apply Change activity stores them in the updated subject / resource entry in LDAP.</p>
</div>
<div class="paragraph">
<p>Modify orders are different from add orders in that they contain modifications for attributes. An attribute modification contains an operation. This means a <strong>setProperty</strong> overrides the property modification. Therefore, the name attribute is evaluated differently from the other order types:</p>
</div>
<div class="paragraph">
<p>It is expected in the format <strong>"*<em>operation</em></strong>",* <strong>"*<em>property-name</em></strong>"* where <em>operation</em> is <strong>add</strong>, <strong>replace</strong> or <strong>delete</strong>, <em>name</em> is the name of the property as you use it in <strong>getProperty</strong> or <strong>getValues</strong>.</p>
</div>
<div class="paragraph">
<p>Samples:</p>
</div>
<div class="paragraph">
<p><strong>setProperty("add-description", "New Description")</strong></p>
</div>
<div class="paragraph">
<p>adds the value "New Description" to the attribute"description".</p>
</div>
<div class="paragraph">
<p><strong>setProperty("delete-mail", "<a href="mailto:sample@gmx.de">sample@gmx.de</a>")</strong></p>
</div>
<div class="paragraph">
<p>deletes the value "<a href="mailto:sample@gmx.de">sample@gmx.de</a>" from the attribute "mail".</p>
</div>
<div class="paragraph">
<p>As in the add and info order, an empty value deletes the modification. For example:</p>
</div>
<div class="paragraph">
<p><strong>setProperty("delete-mail", "")</strong> or <strong>setProperty("delete-mail", null)</strong></p>
</div>
<div class="paragraph">
<p>deletes the modification previously produced with <strong>setProperty("delete-mail", "<a href="mailto:sample@gmx.de">sample@gmx.de</a>")</strong>.</p>
</div>
<div class="paragraph">
<p>A <strong>setProperty("*<em>name</em></strong>",* <em>value</em>*)* is not expected here. As empty values delete modifications, only a <strong>setProperty("*<em>name</em></strong>"," ")* can be accepted for the modification.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_deploying_the_job"><a class="anchor" href="#_ch1_deploying_the_job"></a><a class="link" href="#_ch1_deploying_the_job">1.1.2.2.9. Deploying the Job</a></h6>
<div class="paragraph">
<p>When you have compiled your job classes and have produced a jar file, you must then deploy it to the IdS-J server. The class loader of the server searches the job-specific classes in a separate folder for your job underneath the server&#8217;s "confdb/jobs" folder. Suppose we have a job named "sampleJob". We need to create the folder</p>
</div>
<div class="paragraph">
<p><em>install_path</em>*/ids-j-<strong><em>domain</em></strong>-S*<em>n</em>*/confdb/jobs/sampleJob/lib*</p>
</div>
<div class="paragraph">
<p>You need to place all the jar files your job needs underneath the <strong>lib</strong> subfolder. This is the jar file of your job implementation and optionally other third-party jar files that your job requires (and which are not yet available in the <strong>confdb/common/lib</strong> folder). If the class loader doesn&#8217;t find a class here, it searches in the <strong>confdb/common/lib</strong> folder.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_obtaining_a_connection_to_the_identity_domain"><a class="anchor" href="#_ch1_obtaining_a_connection_to_the_identity_domain"></a><a class="link" href="#_ch1_obtaining_a_connection_to_the_identity_domain">1.1.2.2.10. Obtaining a Connection to the Identity Domain</a></h6>
<div class="paragraph">
<p>Sometimes custom implementations need an LDAP connection to the Identity domain. There are two methods to obtain this information. We recommend using the job interface described in the following sections. The DomainSessionAccessor method is deprecated.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_implementing_a_job_with_access_to_the_identity_domain"><a class="anchor" href="#_ch1_implementing_a_job_with_access_to_the_identity_domain"></a><a class="link" href="#_ch1_implementing_a_job_with_access_to_the_identity_domain">1.1.2.2.11. Implementing a Job with access to the Identity Domain</a></h6>
<div class="paragraph">
<p>A job interface is available that provides access to the Identity domain, the subject and resource orders, and the job configuration parameters.</p>
</div>
<div class="paragraph">
<p>Implementing the Job</p>
</div>
<div class="paragraph">
<p>You need to derive your job class from the class <strong>com.siemens.idm.jobs.BasicJob</strong>. This class provides an extended run interface that supplies a SvcSession object that is managed in a session pool, subject- and resource orders and a map of configuration parameters.</p>
</div>
<div class="paragraph">
<p>The Interface</p>
</div>
<div class="paragraph">
<p>You need to implement the following interface:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">/**
* A run method providing session access.
* Implement this run method in the derived class
* @param taskCtx The task context
* @param modifications The modifications to be applied to the workflow instance
* @param session The service session, providing LDAP Access
* @param subject The subject order
* @param resources The resource orders
* @param parameters The map of configuration parameters
* @throws Exception An exception leads to a temporary error (retry).
*/
protected abstract void run (TaskContext taskCtx, Map modifications, SvcSession session, Order subject, Order[] resources, Map parameters) throws Exception;</code></pre>
</div>
</div>
<div class="paragraph">
<p>A Sample Job</p>
</div>
<div class="paragraph">
<p>A sample job is provided on the DVD in the folder <strong>Additions &#8594; RequestWorkflows &#8594; samples</strong> (class <strong>SampleJobWithSession</strong>). It shows how to read job configuration parameters, to search objects in LDAP and to set the application state.</p>
</div>
<div class="paragraph">
<p>Deployment</p>
</div>
<div class="paragraph">
<p>The basic class <strong>com.siemens.idm.jobs.BasicJob</strong> is deployed in the jar file <strong>orderImpl.jar</strong>. Consequently, you can deploy your jar file to <strong>confdb/jobs/order/lib</strong>.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_using_the_domainsessionaccessor_method"><a class="anchor" href="#_ch1_using_the_domainsessionaccessor_method"></a><a class="link" href="#_ch1_using_the_domainsessionaccessor_method">1.1.2.2.12. Using the DomainSessionAccessor Method</a></h6>
<div class="paragraph">
<p>You can obtain the connection parameters from the IdS-J server using the static method getSessionClone() of the singleton DomainSessionAccessor. Here is a code snippet that shows how to perform this task:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// get a clone of the domain session
SvcSession session = DomainSessionAccessor.getClone(50000);
netscape.ldap.LDAPConnection ldapcon = session.getLDAPConnection().getLdapConnection.getLDAPConnection();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Because this method clones the session, it can create memory problems and thus this method is deprecated. We recommend using the job interface described above.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_implementing_a_user_hook_for_an_applychange_activity"><a class="anchor" href="#_ch1_implementing_a_user_hook_for_an_applychange_activity"></a><a class="link" href="#_ch1_implementing_a_user_hook_for_an_applychange_activity">1.1.2.2.13. Implementing a User Hook for an applyChange Activity</a></h6>
<div class="paragraph">
<p>ApplyChange activities are used in a request workflow to apply the changes stored in the subject and/or resource orders to the data store. The applyChange activities allow you to add a user hook that is called before and after the application of each order. You can use this user hook to modify the data before the change is applied or to change the order after the change is processed. Changed orders are written back to the workflow instance and can be read in successive activities.</p>
</div>
<div class="paragraph">
<p>Configuring the User Hook</p>
</div>
<div class="paragraph">
<p>To configure a user hook, enter its fully-qualified class name in the <strong>Class name</strong> text entry field of the activityâs Parameters tab. If you want to use the sample user hook, you must enter the class name com.siemens.idm.jobs.sample.SampleApplyChangesUserhook here.</p>
</div>
<div class="paragraph">
<p>The Interface</p>
</div>
<div class="paragraph">
<p>The user hook must be written in Java. It must implement the following interface:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package siemens.dxr.service.order.api;
public interface ApplyChangesUserHook {
/**
* Calls a UserHook before applying the orders
* - changes to the orders are updated at the worklow instance
* - if an ApplyChangesException is thrown, processing is aborted.
* - in this case, workflow context and the activity's application state are updated from the exception if non-null values are provided
* - settings of workflow context / activity application state to the apply changes context are not considered if an exception is thrown
* @param subject The subject order that is applied in the next step.
* @param resource The resource order that is applied in the next step. May be null if no resource is assigned.
* @param context The context object
* @param ld A clone of the session's LDAP connection. Is closed by ApplyChanges.
* @throws OrderJobException Aborts processing
*/
void preProcess(Order subject, Order resource, ApplyChangesContext context, LDAPConnection ld) throws OrderJobException;

/**
* Calls a UserHook after applying the orders
* - changes to the orders are updated at the worklow instance
* - if an ApplyChangesException is thrown, processing is aborted.
* - in this case, workflow context and the activity's application state are updated from the exception if non-null values are provided
* - settings of workflow context / activity application state to the apply changes context are not considered if an exception is thrown
* @param subject The subject order that is applied in the next step.
* @param resource The resource order that is applied in the next step. May be null if no resource is assigned.
* @param context The context object
* @param ld A clone of the session's LDAP connection. Is closed by ApplyChanges.
* @throws OrderJobException Aborts processing
*/
void postProcess(Order subject, Order resource, ApplyChangesContext context, LDAPConnection ld) throws OrderJobException;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A context object is passed to the user hook methods. The context object implements the following interface:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package siemens.dxr.service.order.api;
public interface ApplyChangesContext {

    /**
    * Boolean flag indicating that subject orders are applied
    * @return flag to apply subject orders
    */
    public boolean isApplyAttributeChanges();

    /**
    * Boolean flag indicating that resource orders are applied
    * @return flag to apply resource orders
    */
    public boolean isEvaluateAssignments();

    /**
    * Boolean flag indicating that an approval workflow is started for a privilege requiring approval
    * @return flag for starting approval workflow for resource order
    */
    public boolean isStartApprovalWorkflows();

    /**
    * sets the activity's application state.
    * @param aState The application state to set. If set here, the activity's application state is set to that value after ApplyChanges has completed.
    */
    public void setActivityApplicationState(String aState);

    /**
    * gets the activity's application state
    * @return the activity's application state
    */
    public String getActivityApplicationState();

    /**
    * The audit master uid
    * @return The audit master uid
    */
    public String getAuditMasterUID();

    /**
    * Reads the workflow context
    * @return The workflow context.
    */
    public Map&lt;String, String&gt; getWorkflowContext();

    /**
    * sets the workflow context. If set, the values stored in the context are added to the workflow context after applyChanges has completed.
    * Use getWorkflowContext to get the current context and modify it. Then use setWorkflowContext to make the changes permanent after ApplyChanges has finished.
    * @param wfContext
    */
    public void setWorkflowContext(Map&lt;String, String&gt; wfContext);

    /**
    * The workflow instance ID
    * @return The workflow instance ID
    */
    public String getWfInstId();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A Sample Job</p>
</div>
<div class="paragraph">
<p>A sample job is provided on the DVD in the folder <strong>Additions/RequestWorkflows/samples</strong> (class <strong>SampleApplyChangesUserhook</strong>). It shows how to set a unique ID at the subject order and adds a start date to a resource order before it is applied to the data store.</p>
</div>
<div class="paragraph">
<p>The postProcess call is not used in the sample; it has an empty body.</p>
</div>
<div class="paragraph">
<p>Deployment</p>
</div>
<div class="paragraph">
<p>The interface <strong>siemens.dxr.service.order.api.ApplyChangesUserHook</strong> is deployed in the jar file <strong>dxrServices.jar</strong>. You should deploy your jar file to <strong>confdb/commons/lib</strong>.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch1_implementing_a_socketed_job_framework_based_activity"><a class="anchor" href="#_ch1_implementing_a_socketed_job_framework_based_activity"></a><a class="link" href="#_ch1_implementing_a_socketed_job_framework_based_activity">1.1.2.3. Implementing a Socketed Job Framework-based Activity</a></h5>
<div class="paragraph">
<p>The socketed job framework allows you to implement your own automatic activity with minimal configuration effort and Java code writing. The idea is simple: you configure a predefined universal activity type <strong>Run socketed job</strong> which invokes your implementing Java class specified as a common parameter. The framework provides access to the Identity domain, the subject and resource orders and the predefined job configuration parameters, which means that no new component description is necessary.</p>
</div>
<div class="paragraph">
<p>To create your own job implementation, you must:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Add a new activity of the type Run socketed job</p>
</li>
<li>
<p>Specify values for predefined configuration parameters</p>
</li>
<li>
<p>Implement the job as a Java class</p>
</li>
<li>
<p>Read the job configuration</p>
</li>
<li>
<p>Read the workflow instance data</p>
</li>
<li>
<p>Modify the workflow instance data</p>
</li>
<li>
<p>Read and change orders</p>
</li>
<li>
<p>Deploy your job implementation</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The socketed job framework is based on the common request workflow API. Consult the following folder on your DVD:</p>
</div>
<div class="paragraph">
<p><strong>Documentation\DirXIdentity\RequestWorkflows\index.html.</strong></p>
</div>
<div class="paragraph">
<p>For the specific API and sample sources, see the following folders on your DVD:</p>
</div>
<div class="paragraph">
<p><strong>Additions\SocketedJob\api</strong></p>
</div>
<div class="paragraph">
<p>Additions\SocketedJob\samples</p>
</div>
<div class="sect5">
<h6 id="_ch1_adding_the_new_socketed_job_framework_activity"><a class="anchor" href="#_ch1_adding_the_new_socketed_job_framework_activity"></a><a class="link" href="#_ch1_adding_the_new_socketed_job_framework_activity">1.1.2.3.1. Adding the New Socketed Job Framework Activity</a></h6>
<div class="paragraph">
<p>When defining a request workflow, select the universal automatic activity template <strong>Run socketed job</strong>. Connect it with other activities and define the start conditions. Use start conditions based on application state; for details, see the section "Understanding Request Workflow States" in the chapter "Request Workflow Architecture".</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_specifying_predefined_configuration_parameters"><a class="anchor" href="#_ch1_specifying_predefined_configuration_parameters"></a><a class="link" href="#_ch1_specifying_predefined_configuration_parameters">1.1.2.3.2. Specifying Predefined Configuration Parameters</a></h6>
<div class="paragraph">
<p>The Run socketed job already contains the following predefined configuration parameter names:</p>
</div>
<div class="paragraph">
<p>Class name for socket job - the parameter is accessible as <strong>className</strong> in the XML configuration of the job. This parameter is mandatory and must contain a fully qualified class name of a Java class implementing one of the following interfaces:</p>
</div>
<div class="paragraph">
<p>com.siemens.idm.jobs.socketed.api.CustomSocketJob</p>
</div>
<div class="paragraph">
<p>com.siemens.idm.jobs.socketed.api.CustomSocketSvcSessionJob</p>
</div>
<div class="paragraph">
<p>The specified class must be stored in the following folder:</p>
</div>
<div class="paragraph">
<p><em>install_path</em>*/ids-j-<strong><em>domain</em></strong>-S*<em>n</em>*/confdb/jobs/socketed/lib*</p>
</div>
<div class="paragraph">
<p>1. Parameter to be passed to job - the parameter is accessible as <strong>paramOne</strong> in the XML configuration of the job.</p>
</div>
<div class="paragraph">
<p>2. Parameter to be passed to job - the parameter is accessible as <strong>paramTwo</strong> in the XML configuration of the job.</p>
</div>
<div class="paragraph">
<p>3. Parameter to be passed to job - the parameter is accessible as <strong>paramThree</strong> in the XML configuration of the job.</p>
</div>
<div class="paragraph">
<p>4. Parameter to be passed to job - the parameter is accessible as <strong>paramFour</strong> in the XML configuration of the job.</p>
</div>
<div class="paragraph">
<p>5. Parameter to be passed to job - the parameter is accessible as <strong>paramFive</strong> in the XML configuration of the job.</p>
</div>
<div class="paragraph">
<p>These parameters are optional and can be used to pass any configuration parameter value to the custom socket job. You can pass any value that can be stored as a common string: for example, a path to a file, a number or a boolean value. Note that the name of the parameter cannot be changed and you should document its meaning in the relevant socket job activity implementation. These parameters are also always available only as string constants. You need to convert these strings to the correct types in your socket job class if necessary.</p>
</div>
<div class="paragraph">
<p>The number of parameters cannot be changed without modifying the component description for the Run socketed activity job (<strong>Run socketed job.xml</strong>). If necessary, define a new component description. Do not rewrite the default one. See the section "Supplying a Component Description" in the chapter "Implementing a New Activity" for more details.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_implementing_the_job_2"><a class="anchor" href="#_ch1_implementing_the_job_2"></a><a class="link" href="#_ch1_implementing_the_job_2">1.1.2.3.3. Implementing the Job</a></h6>
<div class="paragraph">
<p>When running the activity, the IdS-J server will search for a class defined in the mandatory configuration parameter class name for socket job. This class must implement one of these very similar interfaces:</p>
</div>
<div class="paragraph">
<p>com.siemens.idm.jobs.socketed.api.CustomSocketJob - use this interface when no access to the Identity domain is required, it requires only one method:</p>
</div>
<div class="paragraph">
<p>executeSocketJob(TaskContext taskCtx, Map&lt;String, Object&gt; modifications, Order subject, Order[] resources, Map&lt;String, Object&gt; parameters, RequestWorkflowInstance wfInstance)</p>
</div>
<div class="paragraph">
<p>This method contains the main logic of the job. The server passes six parameters.</p>
</div>
<div class="paragraph">
<p>The task context gives read access to the activity and workflow instance, especially to the workflow and activity states, the workflow initiator, the subject and the optional resources.</p>
</div>
<div class="paragraph">
<p>The job can indirectly modify the workflow by entering the desired modifications into the passed modification map. Use this facility to set the resulting activity state or application state.</p>
</div>
<div class="paragraph">
<p>The subject contains the subject order of the request workflow as stored within the task context. It is a convenient way to access it directly.</p>
</div>
<div class="paragraph">
<p>The resources contain the resource orders of the request workflow as stored within the task context. It is a convenient way to access it directly. Note that the resource orders may be not available for some request workflow types.</p>
</div>
<div class="paragraph">
<p>The parameters map contains the values for predefined configuration parameters. The values are accessible for key names <strong>paramOne</strong>, <strong>paramTwo</strong>, <strong>paramThree</strong>, <strong>paramFour</strong> and <strong>paramFive</strong> as described in the section "Specifying Predefined Configuration Parameters".</p>
</div>
<div class="paragraph">
<p>The request workflow instance contains the object as it is stored within the task context. It is a convenient way how to access it directly.</p>
</div>
<div class="paragraph">
<p>com.siemens.idm.jobs.socketed.api.CustomSocketSvcSessionJob â use this interface when you need direct access to the Identity domain; it requires only one method:</p>
</div>
<div class="paragraph">
<p>executeSocketJob(TaskContext taskCtx, Map&lt;String, Object&gt; modifications, SvcSession session, Order subject, Order[] resources, Map&lt;String, Object&gt; parameters, RequestWorkflowInstance wfInstance)</p>
</div>
<div class="paragraph">
<p>This method contains the main logic of the job but this time the server passes seven parameters. The signature of the method and its logic are almost the same as the previous interface.</p>
</div>
<div class="paragraph">
<p>This interface also provides session-representing access to the Identity domain.</p>
</div>
<div class="paragraph">
<p>Handling States</p>
</div>
<div class="paragraph">
<p>We recommend using application state when returning a result of the activity to be used as a start condition for a next activity. Use constants from com.siemens.idm.requestworkflow.api.ApplicationState or a custom value and use them in the start conditions. See the section "Modifying the Workflow Instance Data" in the chapter "Implementing a Generic Activity" for more details.</p>
</div>
<div class="paragraph">
<p>Do not set state (com.siemens.idm.api.Job.STATE) directly. It will be set automatically to <strong>Succeeded</strong> if no exception occurs or to <strong>Failed.Temporary</strong> if an unhandled exception is thrown. See the section "Understanding Request Workflow Activity States" in the chapter "Request Workflow Architecture" for more details.</p>
</div>
<div class="paragraph">
<p>Importing Required Libraries</p>
</div>
<div class="paragraph">
<p>When compiling your class, make sure you have the following jar files in your classpath:</p>
</div>
<div class="paragraph">
<p>commons-pool.jar<br>
com.siemens.idm.requestworkflow.jar<br>
com.siemens.idm.requestworkflow-api.jar<br>
com.siemens.idm.server-api.jar<br>
com.siemens.idm.server-config.jar<br>
com.siemens.idm.server-core.jar<br>
dxcLogging.jar<br>
dxiSocketedJob.jar<br>
dxmAPI.jar<br>
dxrServices.jar<br>
ldapjdk.jar<br>
storage.jar</p>
</div>
<div class="paragraph">
<p>Note that the list might not be complete since it depends on the customer extensions. You may also need to add jar files with missing dependencies to the deployment directory; see the section "Deploying the Job".</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_reading_the_job_configuration_2"><a class="anchor" href="#_ch1_reading_the_job_configuration_2"></a><a class="link" href="#_ch1_reading_the_job_configuration_2">1.1.2.3.4. Reading the Job Configuration</a></h6>
<div class="paragraph">
<p>The socketed job framework provides methods and keys to access the predefined configuration parameter values:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">String p1 = SocketedJob.getParameterAsString(ActivityConstants._PARAM_ONE_, parameters);

String p2 = SocketedJob.getParameterAsString(ActivityConstants._PARAM_TWO_, parameters);

String p3 = SocketedJob.getParameterAsString(ActivityConstants._PARAM_THREE_, parameters);

String p4 = SocketedJob.getParameterAsString(ActivityConstants._PARAM_FOUR_, parameters);

String p5 = SocketedJob.getParameterAsString(ActivityConstants._PARAM_FIVE_, parameters);</code></pre>
</div>
</div>
<div class="paragraph">
<p>See also the <strong>ParamListingJob</strong> class in the sample directory.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_reading_the_workflow_instance_data_2"><a class="anchor" href="#_ch1_reading_the_workflow_instance_data_2"></a><a class="link" href="#_ch1_reading_the_workflow_instance_data_2">1.1.2.3.5. Reading the Workflow Instance Data</a></h6>
<div class="paragraph">
<p>The socket job interfaces give you direct access to the request workflow instance, to the subject and to the resources if available. You can also read the participant of the previous people activities or read the initiator of the workflow. See the class <strong>ParamListingJob</strong> and <strong>Utils</strong> in the sample directory for these advanced examples.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_modifying_the_workflow_instance_data_2"><a class="anchor" href="#_ch1_modifying_the_workflow_instance_data_2"></a><a class="link" href="#_ch1_modifying_the_workflow_instance_data_2">1.1.2.3.6. Modifying the Workflow Instance Data</a></h6>
<div class="paragraph">
<p>The socketed job framework is based on common request workflow API. Use the methods described in the section "Modifying the Workflow Instance Data" in the chapter "Implementing a New Activity" for more details.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_read_and_write_context_properties_2"><a class="anchor" href="#_ch1_read_and_write_context_properties_2"></a><a class="link" href="#_ch1_read_and_write_context_properties_2">1.1.2.3.7. Read and Write Context Properties</a></h6>
<div class="paragraph">
<p>The socketed job framework is based on common request workflow API, use the methods described in the section "Read and Write Context Properties" in the section "Implementing a New Activity" for more details.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_reading_and_changing_orders_2"><a class="anchor" href="#_ch1_reading_and_changing_orders_2"></a><a class="link" href="#_ch1_reading_and_changing_orders_2">1.1.2.3.8. Reading and Changing Orders</a></h6>
<div class="paragraph">
<p>The socketed job framework is based on common request workflow API. Use the methods described in the section "Reading and Changing Orders" in the section "Implementing a New Activity" for more details.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_deploying_the_job_2"><a class="anchor" href="#_ch1_deploying_the_job_2"></a><a class="link" href="#_ch1_deploying_the_job_2">1.1.2.3.9. Deploying the Job</a></h6>
<div class="paragraph">
<p>The jar file containing compiled custom implementation of the socketed job APIs must be placed within the folder <em>install_path</em>*/ids-j-<strong><em>domain</em></strong>-S*<em>n</em>*/confdb/jobs/socketed/lib*. Do not add other jar files to this directory unless it is necessary due to class loader problems. It is mainly necessary when using other third-party dependencies.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch1_implementing_a_java_class_for_finding_participants"><a class="anchor" href="#_ch1_implementing_a_java_class_for_finding_participants"></a><a class="link" href="#_ch1_implementing_a_java_class_for_finding_participants">1.1.2.4. Implementing a Java Class for Finding Participants</a></h5>
<div class="paragraph">
<p>Instead of finding the participants of a people activity by approval policies or group lists, you can write your own Java class to do it. To create your own "find participants" implementation, you must:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Define configuration parameters</p>
</li>
<li>
<p>Implement a Java class</p>
</li>
<li>
<p>Deploy the Java class</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For the API documentation, consult the following folder on your DVD:</p>
</div>
<div class="paragraph">
<p><strong>Documentation\DirXIdentity\RequestWorkflows\index.html</strong>.</p>
</div>
<div class="paragraph">
<p>For sample sources, see the following folder on your DVD:</p>
</div>
<div class="paragraph">
<p><strong>Additions\RequestWorkflows\samples</strong>.</p>
</div>
<div class="sect5">
<h6 id="_ch1_defining_configuration_parameters_2"><a class="anchor" href="#_ch1_defining_configuration_parameters_2"></a><a class="link" href="#_ch1_defining_configuration_parameters_2">1.1.2.4.1. Defining Configuration Parameters</a></h6>
<div class="paragraph">
<p>When you create or modify a people activity, select the type <strong>class</strong> from the drop-down list at the top of the Participants tab.</p>
</div>
<div class="paragraph">
<p>In the "Class" field, enter the full class name of your Java class. For the sample class described here, enter: <strong>com.siemens.idm.participants.sample.FindParticipantsSample</strong>.</p>
</div>
<div class="paragraph">
<p>If your class needs configuration parameters, enter them in the "Parameters" table. For each parameter, enter the parameter name into the left column and the value into the right column. Suppose you want to read some data from a file; in this case, you might define a parameter "filename" in the left column and then enter the absolute path name of the file "c:\myconfigdata\findparticipant.properties" in the right column.</p>
</div>
<div class="paragraph">
<p>See the section "Implementing the Java Class" for information on how to read them in your Java class.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_implementing_the_java_class"><a class="anchor" href="#_ch1_implementing_the_java_class"></a><a class="link" href="#_ch1_implementing_the_java_class">1.1.2.4.2. Implementing the Java Class</a></h6>
<div class="paragraph">
<p>The Java class must provide a default constructor and implement the interface <strong>com.siemens.idm.api.custom.Participants</strong>. Optionally, it can implement the interface <strong>com.siemens.idm.api.custom.ParticipantsExtended</strong>: it enables the custom class to obtain a connection to the Identity Store.</p>
</div>
<div class="paragraph">
<p>Implementing the Participants Interface</p>
</div>
<div class="paragraph">
<p>For the <strong>Participants</strong> interface, the only method you need to realize is <strong>findParticipants(</strong>&#8230;&#8203;<strong>)</strong>. The IdS-J server passes the following parameters from the workflow and activity instance:</p>
</div>
<div class="paragraph">
<p><em>operation</em> - the operation string taken from the workflow definition.</p>
</div>
<div class="paragraph">
<p><em>subjecttype</em> - the subject type taken from the workflow definition. In most cases, the subject of the workflow is a user.</p>
</div>
<div class="paragraph">
<p><em>subjectDn</em> - the distinguished name of the workflow&#8217;s subject.</p>
</div>
<div class="paragraph">
<p>Note: If there is an escalation, the subjectDN is the DN of the participant of the previous level. For example, in the first escalation level, you get the DN of the original activity participant, in the second level, the DN of the participant of the first level. Nevertheless, you have access to the workflow subject via the activity. For more details, see the section "Reading the Workflow Instance Data". Here are the necessary commands:<br>
<br>
com.siemens.idm.api.nodes.IDMActivity activity = _cfg.getActivity();<br>
com.siemens.idm.requestworkflow.api.RequestWorkflowInstance rqwf = (RequestWorkflowInstance) activity.getWorkflow(); com.siemens.dxm.api.order.Order subject = rqwf.getSubject();</p>
</div>
<div class="paragraph">
<p><strong>properties</strong> - a map of configuration parameters taken from the activity definition. See the section "Defining Configuration Parameters" for information on how to specify and set them in the workflow.</p>
</div>
<div class="paragraph">
<p><strong>activity</strong> - the interface to access the activity instance and through it the workflow instance. Your class must return a collection of String objects that represent the distinguished names of the participants.</p>
</div>
<div class="paragraph">
<p>Implementing the ParticipantsExtended Interface</p>
</div>
<div class="paragraph">
<p>The <strong>ParticipantsExtended</strong> interface allows a participant finder to obtain a context, which especially gives access to an LDAP connection to the DirX Identity domain. This interface defines a setter for a <strong>ParticipantContext</strong>. The <strong>com.siewmens.idm.api.custom.ParticipantContext</strong> defines the following methods that are to be implemented:</p>
</div>
<div class="paragraph">
<p><strong>LDAPConnection getLdapConnection()</strong> - returns a ânetscape.ldap.LDAPConnectionâ. It is connected to the DirX Identity domain and you use it to retrieve any LDAP entries in the domain. You can also change any LDAP entry, so be careful when using it.</p>
</div>
<div class="paragraph">
<p>Reading Configuration Parameters</p>
</div>
<div class="paragraph">
<p>Reading the configuration parameters is very simple: just call the <strong>get(</strong>&#8230;&#8203;<strong>)</strong> method of the properties map and provide the parameter name as the key, as shown in this sample:</p>
</div>
<div class="paragraph">
<p>String filename = (String)properties.get("filename");</p>
</div>
<div class="paragraph">
<p>Note that the parameter values are treated as strings.</p>
</div>
<div class="paragraph">
<p>Returning Participants</p>
</div>
<div class="paragraph">
<p>The server expects the participants as a collection of strings.</p>
</div>
<div class="paragraph">
<p>The following code snippet simply constructs a list of DN strings and returns them:</p>
</div>
<div class="paragraph">
<p>ArrayList&lt;String&gt; res = new ArrayList&lt;String&gt;(1);<br>
res.add("cn=Taspatch Nik,ou=Global IT,o=My-Company,cn=Users,cn=My-Company");<br>
return res;</p>
</div>
<div class="paragraph">
<p>Importing the Required Libraries</p>
</div>
<div class="paragraph">
<p>When compiling your class, make sure you have the following jar files in your classpath:</p>
</div>
<div class="paragraph">
<p>dxmApi.jar<br>
com.siemens.idm.server-api.jar<br>
com.siemens.idm.requestworkflow-api.jar</p>
</div>
<div class="paragraph">
<p>For the API documentation<strong>,</strong> consult the following file on your DVD:</p>
</div>
<div class="paragraph">
<p><strong>Documentation\DirXIdentity\RequestWorkflows\index.html</strong>.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_deploying_the_java_class"><a class="anchor" href="#_ch1_deploying_the_java_class"></a><a class="link" href="#_ch1_deploying_the_java_class">1.1.2.4.3. Deploying the Java Class</a></h6>
<div class="paragraph">
<p>When you have compiled your classes and produced a jar file, you must deploy it to the IdS-J server. Place it into the folder:</p>
</div>
<div class="paragraph">
<p><em>install_path</em>*/ids-j-<strong><em>domain</em></strong>-S*<em>n</em>*/confdb/common/lib*</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch1_implementing_participant_filters_and_constraints"><a class="anchor" href="#_ch1_implementing_participant_filters_and_constraints"></a><a class="link" href="#_ch1_implementing_participant_filters_and_constraints">1.1.2.5. Implementing Participant Filters and Constraints</a></h5>
<div class="paragraph">
<p>Each people activity allows for specifying a participant filter and participant constraints which are applied to the result of the "find participants" implementation. The filter allows for reducing the list of participants; for example, skipping the workflow initiator. The constraint implementation decides whether the number of participants meets the workflow&#8217;s requirements ("4-eye-principle").</p>
</div>
<div class="paragraph">
<p>Implementation of a filter and a constraint are quite similar. Both must be realized as Java classes. The server passes the list of participants and the current activity. Only the result of their operation is different.</p>
</div>
<div class="paragraph">
<p>Participant Filter:</p>
</div>
<div class="paragraph">
<p>A participant filter must implement the interface <strong>com.siemens.idm.requestworkflow.api.ParticipantsFilter</strong>. In its only method <strong>filterParticipants(</strong>&#8230;&#8203;<strong>)</strong> it receives the list of participants and the current activity. It must return the allowed participants as a list of strings denoting the distinguished names of the participants. For details, see the section "Implementing a Participant Filter".</p>
</div>
<div class="paragraph">
<p>Participant Constraints:</p>
</div>
<div class="paragraph">
<p>A participant constraints class implements the interface <strong>com.siemens.idm.requestworkflow.api.ParticipantConstraints</strong>. In its only method <strong>checkParticipantsConstraints(</strong>&#8230;&#8203;<strong>)</strong> it receives the list of participants and the current activity. If it rejects the participants, it must throw a ConstraintViolationException. For details, see the section "Implementing Participant Constraints".</p>
</div>
<div class="paragraph">
<p>Filters and Constraints as Joblets (Deprecated):</p>
</div>
<div class="paragraph">
<p>As an alternative to providing Java classes implementing the interfaces <strong>ParticipantsFilter</strong> and <strong>ParticipantConstraints</strong>, filters or constraints can be realized as joblets. Joblets are Java sources implementing the <strong>IDMJob</strong> interface that are compiled and started at runtime by the IdS-J server. See the sections "Configuring a Joblet" and "Implementing a Joblet" for instructions on how to realize a joblet.</p>
</div>
<div class="paragraph">
<p>Deploy Filters and Constraints:</p>
</div>
<div class="paragraph">
<p>For details, see the section "Deploying Filters and Constraints".</p>
</div>
<div class="paragraph">
<p>For the API documentation, consult the following folder on your DVD:</p>
</div>
<div class="paragraph">
<p><strong>Documentation\DirXIdentity\RequestWorkflows\index.html</strong>.</p>
</div>
<div class="paragraph">
<p>For sample sources, see the following folder on your DVD:</p>
</div>
<div class="paragraph">
<p><strong>Additions\RequestWorkflows\samples</strong>.</p>
</div>
<div class="sect5">
<h6 id="_ch1_implementing_a_participants_filter"><a class="anchor" href="#_ch1_implementing_a_participants_filter"></a><a class="link" href="#_ch1_implementing_a_participants_filter">1.1.2.5.1. Implementing a Participants Filter</a></h6>
<div class="paragraph">
<p>Your participants filter implementation should have a default constructor and implement the interface <strong>com.siemens.idm.requestworkflow.api.ParticipantsFilter</strong>. The only method of the interface is <strong>filterParticipants(</strong>&#8230;&#8203;<strong>)</strong>. The additional interface <strong>com.siemens.idm.requestworkflow.api.ParticipantsFilterExtended</strong> allows you to obtain a context with the LDAP connection to the Identity domain.</p>
</div>
<div class="paragraph">
<p>Interface ParticipantsFilter:</p>
</div>
<div class="paragraph">
<p>The only method you must implement is: <strong>filterParticipants(</strong>&#8230;&#8203;<strong>)</strong>. The server passes two parameters:</p>
</div>
<div class="paragraph">
<p><em>participants</em>: the list of participants calculated so far, each as a distinguished name string.</p>
</div>
<div class="paragraph">
<p><em>activity</em>: the current activity for which the participants are to be calculated.</p>
</div>
<div class="paragraph">
<p>The method returns the list of filtered participants as a collection of strings, each representing a participant&#8217;s distinguished name.</p>
</div>
<div class="paragraph">
<p>The following snippet shows you how to read the workflow initiator&#8217;s DN, exclude the initiator from the participants and return the new participant list:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">RequestWorkflowInstance wf = (RequestWorkflowInstance) activity.getWorkflow();
String initiator = wf.getInitiator();
ArrayList allowedParticipants = new ArrayList();
Iterator it = participants.iterator();
while (it.hasNext()) {
    Object o = it.next();
    String participant = (String)o;
    if (participant.equalsIgnoreCase(initiator)) {
        log.info("ParticipantFilterSample - participant: " + participant + " not allowed for approval");
    } else {
        allowedParticipants.add(participant);
    }
}
return allowedParticipants;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Interface ParticipantsFilterExtended</p>
</div>
<div class="paragraph">
<p>This interface extends ParticipantsFilter and establishes the ParticipantContext. This allows obtaining an LDAP connection to the DirX Identity domain and thus to execute LDAP operations. You must implement the following methods:</p>
</div>
<div class="paragraph">
<p>public void setParticipantContext(ParticipantContext ctx): the server passes a com.siemens.idm.api.custom.ParticipantContext. See below.</p>
</div>
<div class="paragraph">
<p>Interface ParticipantContext</p>
</div>
<div class="paragraph">
<p>This interface provides the following method:</p>
</div>
<div class="paragraph">
<p>public LDAPConnection getLdapConnection(): it returns an LDAP connection to the DirX Identity domain.</p>
</div>
<div class="paragraph">
<p>Writing Logs</p>
</div>
<div class="paragraph">
<p>You can issue log messages that appear in the server&#8217;s log files. The server&#8217;s log support <strong>com.siemens.idm.jini.util.logging.LogSupport</strong> provides the usual log interface, especially the following methods:</p>
</div>
<div class="paragraph">
<p><strong>log.error(</strong>&#8230;&#8203;<strong>)</strong>: error message</p>
</div>
<div class="paragraph">
<p><strong>log.warning(</strong>&#8230;&#8203;<strong>)</strong>: warning message</p>
</div>
<div class="paragraph">
<p><strong>log.info(</strong>&#8230;&#8203;<strong>)</strong>: normal informational message</p>
</div>
<div class="paragraph">
<p><strong>log.finest(</strong>&#8230;&#8203;<strong>)</strong>: debug message</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_implementing_participant_constraints"><a class="anchor" href="#_ch1_implementing_participant_constraints"></a><a class="link" href="#_ch1_implementing_participant_constraints">1.1.2.5.2. Implementing Participant Constraints</a></h6>
<div class="paragraph">
<p>Your participant constraints implementation should have a default constructor and implement the interface <strong>com.siemens.idm.requestworkflow.api.ParticipantConstraints</strong>. Optionally it can also implement <strong>com.siemens.idm.requestworkflow.api.ParticipantConstraintsExtended</strong>. The only method of the interface is <strong>checkParticipantConstraints(</strong>&#8230;&#8203;<strong>)</strong>.</p>
</div>
<div class="paragraph">
<p>Interface ParticipantConstraints</p>
</div>
<div class="paragraph">
<p>You must implement the only method <strong>checkParticipantConstraints(</strong>&#8230;&#8203;*)*<em>.</em> The server passes two parameters:</p>
</div>
<div class="paragraph">
<p><em>participants</em>: the list of participants calculated so far, each as a distinguished name string.</p>
</div>
<div class="paragraph">
<p><em>activity</em>: the current activity for which the participants are to be calculated.</p>
</div>
<div class="paragraph">
<p>A participant constraints implementation returns a ConstraintViolationException to notify the server that the participant list does not meet the constraint conditions. In the exception constructor, you can supply the desired resulting activity state and application state along with an error message that will be stored with the activity instance. This allows you to configure subsequent activities that are started in this case.</p>
</div>
<div class="paragraph">
<p>The following snippet shows you how to make sure that the list contains at least one participant:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">if (participants == null || participants.size() &lt; 1)
    throw new ConstraintViolationException("SUCCEEDED", "REJECTED", "Too few approvers, at least one approver required!") +
);</code></pre>
</div>
</div>
<div class="paragraph">
<p>If not enough participants are found, the server sets the resulting activity state to "SUCCEEDED" and the activity application state to "REJECTED".</p>
</div>
<div class="paragraph">
<p>Interface ParticipantConstraintsExtended</p>
</div>
<div class="paragraph">
<p>This interface extends ParticipantConstraints and establishes the ParticipantContext. This allows accessing the LDAP connection and thus to execute LDAP operations. You must implement the following methods:</p>
</div>
<div class="paragraph">
<p><strong>public void setParticipantContext(ParticipantContext ctx)</strong>: the server passes a <strong>com.siemens.idm.api.custom.ParticipantContext</strong>. See below.</p>
</div>
<div class="paragraph">
<p>Interface ParticipantContext</p>
</div>
<div class="paragraph">
<p>This interface provides the following method:</p>
</div>
<div class="paragraph">
<p><strong>public LDAPConnection getLdapConnection()</strong>: it returns an LDAP connection to the DirX Identity domain.</p>
</div>
<div class="paragraph">
<p>Writing Logs</p>
</div>
<div class="paragraph">
<p>You can issue log messages that appear in the server&#8217;s log files. The server&#8217;s log support provides the usual log interface, especially the following methods:</p>
</div>
<div class="paragraph">
<p><strong>log.error(</strong>&#8230;&#8203;<strong>)</strong>: error message</p>
</div>
<div class="paragraph">
<p><strong>log.warning(</strong>&#8230;&#8203;<strong>)</strong>: warning message</p>
</div>
<div class="paragraph">
<p><strong>log.info(</strong>&#8230;&#8203;<strong>)</strong>: normal informational message</p>
</div>
<div class="paragraph">
<p><strong>log.finest(</strong>&#8230;&#8203;<strong>)</strong>: debug message</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_configuring_a_joblet"><a class="anchor" href="#_ch1_configuring_a_joblet"></a><a class="link" href="#_ch1_configuring_a_joblet">1.1.2.5.3. Configuring a Joblet</a></h6>
<div class="paragraph">
<p>A joblet is a Java class source code that is compiled by the Java-based Server (IdS-J) at runtime. The server includes the body of the configured Java source code into a template, compiles it and loads the compilation unit.</p>
</div>
<div class="paragraph">
<p>The template contains the common parts of the Java source code implementing the <strong>com.siemens.idm.jobs.java.Joblet</strong> interface:</p>
</div>
<div class="paragraph">
<p>The leading package line</p>
</div>
<div class="paragraph">
<p>It is built dynamically including the workflow and activity name.</p>
</div>
<div class="paragraph">
<p>The common import statements</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import java.util.Map;
import com.siemens.idm.jini.util.logging.LogSupport;
import com.siemens.idm.api.nodes.IDMJob;
import com.siemens.idm.api.context.TaskContext;
import com.siemens.idm.jobs.java.Joblet;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The class and interface method declaration.</p>
</div>
<div class="paragraph">
<p>And the trailing closing brackets for the interface method and the class definition.</p>
</div>
<div class="paragraph">
<p>You must provide the missing parts of the source code in two fields:</p>
</div>
<div class="paragraph">
<p>Imports: The additional import statements.</p>
</div>
<div class="paragraph">
<p>For each additional import, supply the full class name <strong>without</strong> the leading "import" and the trailing "<em>;</em>" strings.</p>
</div>
<div class="paragraph">
<p>Code: The method body.</p>
</div>
<div class="paragraph">
<p>See the section "Implementing a Joblet" for details.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_implementing_a_joblet"><a class="anchor" href="#_ch1_implementing_a_joblet"></a><a class="link" href="#_ch1_implementing_a_joblet">1.1.2.5.4. Implementing a Joblet</a></h6>
<div class="paragraph">
<p>A joblet must implement the <strong>com.siemens.idm.jobs.java.Joblet</strong> interface with the method:</p>
</div>
<div class="paragraph">
<p><strong>public void run(IDMJob job, TaskContext taskCtx, Map modifications) throws Exception;</strong></p>
</div>
<div class="paragraph">
<p>The server passes the following parameters when running the joblet:</p>
</div>
<div class="paragraph">
<p><strong>Job</strong>: gives access to the job, which in turns allows reading the activity and the workflow instance.</p>
</div>
<div class="paragraph">
<p><strong>Task Context</strong>: gives access to a map of context properties. It can be used as an application-specific properties container.</p>
</div>
<div class="paragraph">
<p><strong>modifications</strong>: An empty map for returning modifications that are made on the workflow instance. This parameter should not be used in participant filters and constraints!</p>
</div>
<div class="paragraph">
<p>When implementing a joblet, you only need to provide the additions to the surrounding template: the additional class names to be imported and the body of the run(&#8230;&#8203;) method.</p>
</div>
<div class="paragraph">
<p><strong>Note</strong>:</p>
</div>
<div class="paragraph">
<p>The joblets are compiled at runtime using <strong>Java 1.4</strong> compiler settings. Do not include Java 5 constructs such as generics or the loop enhancements.</p>
</div>
<div class="paragraph">
<p>For the API documentation, consult the following file on your DVD:</p>
</div>
<div class="paragraph">
<p><strong>Documentation\DirXIdentity\RequestWorkflows\index.html</strong>.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_deploying_filters_and_constraints"><a class="anchor" href="#_ch1_deploying_filters_and_constraints"></a><a class="link" href="#_ch1_deploying_filters_and_constraints">1.1.2.5.5. Deploying Filters and Constraints</a></h6>
<div class="paragraph">
<p>When you have compiled your filter and constraint classes, you must produce a jar file and then deploy it to the IdS-J server. The class loader of the server searches the filter and constraint classes in its common folder</p>
</div>
<div class="paragraph">
<p><em>install_path</em>*/ids-j-<strong><em>domain</em></strong>-S*<em>n</em>*/confdb/common/lib*.</p>
</div>
<div class="paragraph">
<p>If you need additional jar files, place them into the same folder.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch1_testing_request_workflows"><a class="anchor" href="#_ch1_testing_request_workflows"></a><a class="link" href="#_ch1_testing_request_workflows">1.1.3. Testing Request Workflows</a></h4>
<div class="paragraph">
<p>Request workflows can be quite complex.Therefore we recommend intensive testing.Use these methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Test the workflow in a test environment.Use collections in conjunction with the transport feature to transfer tested workflows between test and production environments.</p>
</li>
<li>
<p>While in a development or test environment, set up the Map Mail Address field to your mail address.Then you can evaluate and adjust notification mails easily.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_understanding_java_based_workflows"><a class="anchor" href="#_understanding_java_based_workflows"></a><a class="link" href="#_understanding_java_based_workflows">1.2. Understanding Java-based Workflows</a></h3>
<div class="paragraph">
<p>This section provides information about Java-based workflows, including information about:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Java-based Connectivity architecture</p>
</li>
<li>
<p>Customizing Java-based workflows</p>
</li>
<li>
<p>Customizing event-based maintenance workflows</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_ch1_java_based_workflow_architecture"><a class="anchor" href="#_ch1_java_based_workflow_architecture"></a><a class="link" href="#_ch1_java_based_workflow_architecture">1.2.1. Java-based Workflow Architecture</a></h4>
<div class="paragraph">
<p>Java-based workflows can be separated into "provisioning workflow" and "event-based maintenance workflow" categories.</p>
</div>
<div class="paragraph">
<p>Provisioning workflows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Provision account and group attributes and memberships to connected systems.</p>
</li>
<li>
<p>Validate connected systems.</p>
</li>
<li>
<p>Update user passwords and provision password changes to connected systems.</p>
</li>
<li>
<p>Import users and other entries from other source systems.</p>
</li>
<li>
<p>Can work in full or delta mode.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Event-based maintenance workflows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Are only started upon a change event of an entry in the Identity domain.</p>
</li>
<li>
<p>Apply rules (consistency, provisioning and validation) depending on the type, check links and update associated users where necessary.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Java-based workflows are hosted by the Java-based Identity Server (IdS-J). Depending on the type, they can be started by an event, by a schedule or manually in Identity Manager.</p>
</div>
<div class="paragraph">
<p>The following sections describe:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The differences between full export, delta and event-based workflows</p>
</li>
<li>
<p>The location of delta state</p>
</li>
<li>
<p>How to start a Java-based workflow</p>
</li>
<li>
<p>The structure of a provisioning workflow</p>
</li>
<li>
<p>Workflow classification</p>
</li>
<li>
<p>Mapping</p>
</li>
<li>
<p>Cross-memberships</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="_ch1_full_delta_and_event_based_workflows"><a class="anchor" href="#_ch1_full_delta_and_event_based_workflows"></a><a class="link" href="#_ch1_full_delta_and_event_based_workflows">1.2.1.1. Full, Delta and Event-based Workflows</a></h5>
<div class="paragraph">
<p>This section gives information on workflow types that perform a full or delta export or those that are triggered by change events.</p>
</div>
<div class="paragraph">
<p>When started by a <strong>change event</strong>, the workflow processes the entry identified by the event.</p>
</div>
<div class="paragraph">
<p>When started by <strong>schedule</strong> or by Identity Manager, the workflow exports and processes the entries of all channels matching the search criteria. This is typical for Validation or <strong>Full Export</strong> workflows.</p>
</div>
<div class="paragraph">
<p>A <strong>delta</strong> workflow is also started by a schedule or by Identity Manager, but it exports only those entries that have been changed since the last run. When a delta workflow finishes successfully, it stores the delta time in a delta state entry in the Identity domain. Note that each channel has its own delta state. When a delta workflow runs for the first time (it has no delta state), it exports all of the entries from the source system.</p>
</div>
<div class="paragraph">
<p>Compared to the delta features provided by Tcl-based workflows, the Java-based workflows</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Support the delta feature for all connectors and all systems that supply attributes that indicate the last modification time.</p>
</li>
<li>
<p>Additionally support reading deleted entries from Active Directory.</p>
</li>
<li>
<p>Store their delta state in the Identity domain rather than in the configuration database.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch1_location_of_delta_state"><a class="anchor" href="#_ch1_location_of_delta_state"></a><a class="link" href="#_ch1_location_of_delta_state">1.2.1.2. Location of Delta State</a></h5>
<div class="paragraph">
<p>If a delta workflow synchronizes accounts or groups of a target system, it stores the delta state beneath the target system&#8217;s configuration folder. The DN is composed of the RDN display names of the workflow definition and the channel. For example: Windows Domain Europe / Configuration / Delta / My-Company / Target Realtime / ADS / ADS_Ident_Realtime_Delta / accounts.</p>
</div>
<div class="paragraph">
<p>If the workflow is not associated with a target system, it stores the delta state beneath the workflow root of the domain. For example: My-Company / wfRoot / Monitor / Delta / My-Company / Source Realtime / ADS / Import Users from ADS / users.</p>
</div>
<div class="paragraph">
<p>Note that delta workflows read both the attributes requested in the channel and those that are needed to issue delta searches. For LDAP systems in particular, these are the operational attributes createTimestamp and modifyTimestamp. Make sure that the bind account has sufficient access rights to read them.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch1_java_based_workflow_structure"><a class="anchor" href="#_ch1_java_based_workflow_structure"></a><a class="link" href="#_ch1_java_based_workflow_structure">1.2.1.3. Java-based Workflow Structure</a></h5>
<div class="paragraph">
<p>The structure of Java-based workflows is nearly always the same. The following figure illustrates this structure:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch1_applsref/image4.png" alt="Java-based Workflow Structure">
</div>
<div class="title">Figure 4. Java-based Workflow Structure</div>
</div>
<div class="paragraph">
<p>As shown in the figure, the Java-based workflow consists of two activities:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The "join" activity, which is responsible for the workflow functionality and is the productive activity.</p>
</li>
<li>
<p>The "error" activity, which is only involved if errors occur. The join activity passes request and response of a failed update request into the error channel. The workflow engine keeps these requests and re-starts the workflow with such events after a retry waiting time. The failed events are passed to the error activity only if the retry limit is reached. The error activity then usually sends e-mail to an administrator.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The workflow can either be started by an event, by a schedule or manually. It receives the events in its input channel.</p>
</div>
<div class="paragraph">
<p>Normally, the workflow synchronizes data between an Identity domain and a connected system. These items are configured as ports named "IdentityDomain" and "TS" respectively. The join activity&#8217;s controller determines the specific behavior. If configured to do so, the workflow sends e-mails using a "notify" channel with the appropriate connector, usually the mail connector.</p>
</div>
<div class="paragraph">
<p>Some workflows only work with the Identity domain and therefore need only the configuration for the "IdentityDomain" port. The User and Account Password Managers are examples. The "Event-based Resolution" workflow only works with the Identity domain and by default takes the connection from the Identity server.</p>
</div>
<div class="paragraph">
<p>The structure of a Provisioning activity is also nearly always the same, and is illustrated in the following figure:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch1_applsref/image5.png" alt="Provisioning Activity Structure">
</div>
<div class="title">Figure 5. Provisioning Activity Structure</div>
</div>
<div class="paragraph">
<p>The controller determines the activity&#8217;s behavior and thus the complete workflow behavior. The controller is often called the "join engine". See the section "Workflow Types" for the list of controllers. In Identity Manager, when you have selected the join activity in a workflow, you can select the controller from a proposal list. This allows you to easily change the type of a workflow.</p>
</div>
<div class="paragraph">
<p>To access the Identity domain and the connected system, the controller uses the connectors configured for the port: the LDAP connector to the Identity domain and a connector that is appropriate for the type of connected system.</p>
</div>
<div class="paragraph">
<p>The activity is responsible for all entries of the connected system and the associated target system sub-tree in the Identity domain; that is, for all accounts and groups of the target system. These entries are defined via the included channels.</p>
</div>
<div class="paragraph">
<p>When configuring a provisioning port in Identity Manager, you must select a "channel parent" entry. The subtree beneath it contains all of the channels that are considered to be part of the port, as shown in the following figure.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch1_applsref/image6.png" alt="Provisioning Ports and Channels">
</div>
<div class="title">Figure 6. Provisioning Ports and Channels</div>
</div>
<div class="paragraph">
<p>Each channel represents a type of entry in the attached system. Among other items, the channel defines the search base and search filter for identifying the entries in its export section. For more details, see the "Channels and Mapping" section.</p>
</div>
<div class="paragraph">
<p>The workflow and activity structure for cluster workflows is the same as for single systems. They simply use the appropriate type of cluster controller. The following figure illustrates this structure:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch1_applsref/image7.png" alt="Cluster Workflow and Activity Structure">
</div>
<div class="title">Figure 7. Cluster Workflow and Activity Structure</div>
</div>
<div class="paragraph">
<p>The workflow is configured for a default connected system. When the workflow is started, the controller reads the configuration data for the actual connected system from the appropriate target system entry:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the workflow has been triggered by an event, it searches the target system entry to which the changed account or group belongs. The target system entry contains address and binding information for the connected system as well as other options used for mapping. The controller reads this data and updates the connector configuration and environment properties accordingly.</p>
</li>
<li>
<p>If the workflow has been started by a schedule or manually, the start request contains attributes to identify the target system that needs to be provisioned. This information allows the controller to find the target system entry and read and update the configuration data as previously described.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that the structure for cluster target systems is fixed:</p>
</div>
<div class="paragraph">
<p>Target Systems &#8594; <em>cluster_container</em> &#8594; <em>cluster</em> &#8594; <em>target_system</em></p>
</div>
<div class="paragraph">
<p>Cluster containers can only reside at the top level directly between the node cn=Target Systems. This is due to performance aspects. It allows the software to find the related object descriptions of a cluster at a fixed place. No costly evaluation of tree nodes is necessary.</p>
</div>
<div class="paragraph">
<p>For details about how to configure clustered workflows, see the chapter "Creating Cluster Target Systems" in this guide or the chapter "Cluster Workflows" in the <em>DirX Identity Connectivity Administration Guid</em>e.</p>
</div>
<div class="paragraph">
<p><strong>Change Events:</strong></p>
</div>
<div class="paragraph">
<p>After the join engine has changed an entry in the Identity domain, it sends change events depending on the configuration.</p>
</div>
<div class="paragraph">
<p>It searches the appropriate active attribute policy using the object type configured in the channel. It uses the same object type to find the audit policy. If the attribute policy flag for sending events is set, the join engine sends a change event using the JMS connector in the event port. The join engine builds the event topic as it does other events: values for type, cluster and resource are prefixed with a value that indicates the type of the event. In this case, the join engine uses the prefix "dxm.event" to distinguish it from a provisioning request event that starts a synchronization workflow.</p>
</div>
<div class="paragraph">
<p>If the event is for a target system account or a group, the values for type cluster and resource are taken from the respective attribute of the target system entry. This action allows for different workflows for each target system.</p>
</div>
<div class="paragraph">
<p>For other types of objects (such as users, roles, and organizations), the type is the object description name of the changed object, the cluster is the server name where the Identity domain resides and the resource is the domain name.</p>
</div>
<div class="paragraph">
<p>This event is to be processed by the event workflow responsible for this type of object and if appropriate for the target system.</p>
</div>
<div class="paragraph">
<p>Note that for performance reasons, Java-based workflows do not take attribute policies into account.</p>
</div>
<div class="paragraph">
<p><strong>Audit:</strong></p>
</div>
<div class="paragraph">
<p>The join engine writes audit logs for each update operation both at the Identity and at the connected system side. If the audit flag in the port configuration is set, the join engine searches the appropriate audit policy for the given object type. It includes the configured identifying attributes into the record and passes it through the audit channel (which is always internally configured) to the audit log listener(s).</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch1_controller_types"><a class="anchor" href="#_ch1_controller_types"></a><a class="link" href="#_ch1_controller_types">1.2.1.4. Controller Types</a></h5>
<div class="paragraph">
<p>DirX Identity supports a set of different Java-based workflow types. The type of a workflow is determined by the controller of the join activity (see the section "Workflow Structure"). These controllers can be divided into the following categories:</p>
</div>
<div class="paragraph">
<p>Target System Provisioning (single system)</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Sync2TS (event-based)</strong> - an event-based synchronization from the Identity Store to a connected system and backwards.</p>
</li>
<li>
<p><strong>Sync2TS (scheduled)</strong> - a scheduled synchronization from the Identity Store to a connected system and backwards.</p>
</li>
<li>
<p><strong>SyncOneWay2TS (event-based)</strong> - an event-based synchronization from the Identity Store to a connected system.</p>
</li>
<li>
<p><strong>SyncOneWay2TS (scheduled)</strong> - a scheduled synchronization from the Identity Store to a connected system.</p>
</li>
<li>
<p><strong>SyncOneWay2Identity (scheduled)</strong> - a scheduled synchronization from a connected system to the Identity Store. Note that there is no event-based synchronization when using the <strong>SyncOneWay2Identity</strong> controller.</p>
</li>
<li>
<p><strong>SyncOneWay (event-based)</strong> - an event-based synchronization from the Identity Store to a connected system. Note that this controller is only available for compatibility reasons; it has been replaced by <strong>SyncOneWay2TS</strong>.</p>
</li>
<li>
<p><strong>SyncOneWay (scheduled)</strong> - a scheduled synchronization from the Identity Store to a connected system. Note that this controller is only available for compatibility reasons; it has been replaced by <strong>SyncOneWay2TS</strong>.</p>
</li>
<li>
<p><strong>Validation (scheduled)</strong> - a scheduled validation from a connected system to the Identity Store. Note that this controller works in mode <strong>InitialLoad</strong> as long as the <strong>Last Validation</strong> date field in the <strong>General</strong> tab of the target system object is empty. After a run, this field is updated and the next run performs a <strong>Validation</strong>. A run in Validation mode means that changes are reported in ToDo fields.</p>
</li>
<li>
<p>FullImport (scheduled) - a scheduled workflow from a connected system to the Identity Store.</p>
</li>
<li>
<p>RestoreTS (scheduled) - a scheduled workflow that restores a connected system from Identity Store.</p>
</li>
<li>
<p><strong>FullSyncToHistoryDB</strong> (scheduled) - a controller for a scheduled workflow that synchronizes all entries of a configured type from Identity Store to the DirX Audit History Database.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Clustered Target System Provisioning</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ClusterSynchronization - a workflow that synchronizes clusters of target systems from Identity Store to connected systems and backwards. It can be started by a scheduled or triggered by a change event.</p>
</li>
<li>
<p>ClusterValidation - a workflow that validates clusters of connected systems into Identity Store.</p>
</li>
<li>
<p><strong>ClusterRestoreTS</strong> - a workflow that can restore clusters of connected systems from Identity Store.</p>
</li>
<li>
<p><strong>ClusterSyncOneWay2Identity</strong> - a workflow that synchronizes clusters of connected systems into Identity Store.</p>
</li>
<li>
<p><strong>ClusterSyncOneWay2TS</strong> - a workflow that synchronizes clusters of target systems from Identity Store to connected systems.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Password Synchronization</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>UserPasswordEventManager -</strong> a workflow that accepts password changes from Windows domain accounts or from Web Center, updates them at the Identity users and requests password changes for each affected account.</p>
</li>
<li>
<p><strong>PwdExpiration</strong> - a workflow that checks for expired account passwords and generates new ones in case the workflow runs scheduled. In the event-based situation it accepts account password changes from Web Center and changes the given account password.</p>
</li>
<li>
<p><strong>PwdReset</strong> - a scheduled workflow that can be configured for privileged or for personal accounts by setting the respective search filter. If configured for privileged accounts it generates a new password for every privileged account and sets it at the account. If configured for personal accounts it reads the password from the associated user and sets it at the account.</p>
</li>
<li>
<p><strong>PwdUserExpiration</strong> - a scheduled workflow that sends notification messages to users whose passwords are about to expire.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Target System Delta Provisioning (single system)</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>DeltaSyncOneWay2TS</strong> (scheduled) - a scheduled synchronization from the Identity Store to a connected system. The controller searches only for the entries that were changed since the previous run.</p>
</li>
<li>
<p><strong>DeltaSynchronization</strong> (scheduled) - a scheduled synchronization from the Identity Store to a connected system and backwards. The controller searches only for the entries that were changed since the previous run.</p>
</li>
<li>
<p><strong>DeltaSyncOneWay2Identity</strong> (scheduled) - a scheduled synchronization from a connected system to the Identity Store. The controller searches only for the entries that were changed since the previous run. Note that there is no event-based synchronization with this controller.</p>
</li>
<li>
<p><strong>DeltaSyncToHistoryDB</strong> (scheduled) - a controller for a scheduled workflow that synchronizes all entries of a configured type from Identity Store to the DirX Audit History Database. The controller searches only for the entries that were changed since the previous run.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Clustered Target System Delta Provisioning</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>DeltaClusterSynchronization</strong> (scheduled) - a workflow that synchronizes clusters of target systems from Identity Store to connected systems and backwards. It searches only for the entries that were changed since the previous run.</p>
</li>
<li>
<p><strong>DeltaClusterSyncOneWay2TS</strong> (scheduled) - a scheduled synchronization from the Identity Store to a cluster of connected systems. The controller searches only for the entries that were changed since the previous run.</p>
</li>
<li>
<p><strong>DeltaClusterSyncOneWay2Identity</strong> (scheduled) - a scheduled synchronization from a cluster of connected systems to the Identity Store. The controller searches only for the entries that were changed since the previous run.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Maintenance Workflows</p>
</div>
<div class="paragraph">
<p>Maintenance workflows apply rules on changed entries in the Identity domain. Their actions depend on the type of the changed entry and on the changes notified in the event:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Event-based User Resolution</strong> - a workflow that operates on changes to a DirX Identity user. It analyzes the changes and either performs a complete user resolution, updates attributes of the associated accounts or does nothing, if none of the critical attributes have been changed.</p>
</li>
<li>
<p><strong>Business Objects (such as Organization, Organizational Unit and Context)</strong> - workflows that apply the consistency rules whose filters match the entry attributes, check for broken links to and from the entry and update associated users.</p>
</li>
<li>
<p><strong>Generic Event Controller</strong> - allows configuring event-based processing workflows for custom objects.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It does not make sense to start maintenance workflows manually or by a schedule because they only handle events.</p>
</div>
<div class="paragraph">
<p>Note that workflows that are marked as scheduled can also be started in Identity Manager and operate as if they were started by a schedule.</p>
</div>
<div class="paragraph">
<p>Target System Synchronization Controllers</p>
</div>
<div class="paragraph">
<p>The Sync2TS controller provisions entries of the target system in the Identity domain to the connected system and synchronizes their state back to the Identity domain. The operation depends on whether it is called via an event or a schedule. The following figure illustrates the processing:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch1_applsref/image8.png" alt="Sync2TS Controller Processing">
</div>
<div class="title">Figure 8. Sync2TS Controller Processing</div>
</div>
<div class="paragraph">
<p>As illustrated in the figure:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The event contains the DN of the changed entry in the DirX Identity domain.</p>
</li>
<li>
<p>The join engine reads this entry. Based on the DN or on other read attributes, it selects the appropriate channel. If no event is given, the join engine assumes it was started by a schedule or manually. It then performs a search evaluating the configuration in the &lt;export&gt; section. Then it processes the entries of the search result one by one the same way as it does in the event case. Note that in this case the channel sequence is determined by the sequence numbers of the destination channels, in this case the channels attached to the connected system.</p>
</li>
<li>
<p>The join engine searches the joined entry using the join conditions of the corresponding channel. The join conditions are performed one after the other until a single entry has been found. The join engine evaluates the join conditions in the following way: if the join condition defines a search base, then that object is read; if the join condition defines an SPML filter, then that filter is used and is combined with the search base defined in the &lt;export&gt; section. Depending on the search result, the join engine provides the (default) entry operation for the mapping step: ADD if no entry has been found), MODIFY if an entry has been found.</p>
</li>
<li>
<p>The join engine performs mapping and builds an add, modify or delete request depending on the mapping result. It updates the joined entry or creates a new one by passing this request to the connector.</p>
</li>
<li>
<p>The join engine reads the updated entry again using the returned entry identifier for backward synchronization and to retrieve attributes that were indirectly set by the connected system.</p>
</li>
<li>
<p>The join engine performs mapping for the other backward direction using the configuration of the channel attached to the Identity domain.</p>
</li>
<li>
<p>Depending on the mapping result, the join engine builds an add or modify request and updates the entry in the Identity domain.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Note that the Sync2TS controller is also used to synchronize passwords to the connected system (and optionally back to IdentityStore). If the topic of the incoming event starts with either "dxm.setPasswordRequest." or "&lt;Domain&gt;.dxm.setPasswordRequest." then passwords are synchronized to the connected system and optionally password relevant attribute information is synchronized back to IdentityStore. If the password channel on Identity side is missing then synchronisation is done only to the connected system; otherwise synchronisation is done both ways.</p>
</div>
<div class="paragraph">
<p>No other attributes than defined in account or group channels are synchronized.</p>
</div>
<div class="paragraph">
<p>Target System Validation Controller</p>
</div>
<div class="paragraph">
<p>The validation controller performs a target system validation against the content of the target system representation in the Identity Store. The following figure shows the processing:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch1_applsref/image9.png" alt="Validation Controller Processing">
</div>
<div class="title">Figure 9. Validation Controller Processing</div>
</div>
<div class="paragraph">
<p>As shown in the figure, the validation controller performs the following actions:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Searches the entries in the connected system by constructing a search request for each channel based on the channel&#8217;s &lt;export&gt; section. The channel sequence is determined by the sequence numbers of the destination channels, in this case the channels attached to the target system in the DirX Identity domain. Let&#8217;s assume the account channel in DirX Identity has sequence number 1, because the membership references are stored in the groups. In this case, the corresponding channel in the connected system - the one for the users - is searched first. When all entries of the result are processed, the controller issues the search for the next channel (here, the groups) and processes them.</p>
</li>
<li>
<p>Evaluates the join conditions of the DirX Identity channel and searches the joined entry. (For details on evaluation of the join condition see step 3 of "Sync2TS" controller above.)</p>
</li>
<li>
<p>Performs the mapping configured in the DirX Identity channel, constructs the appropriate request (add, modify or delete) and passes it to the LDAP connector for updating the joined entry in the DirX Identity domain.<br></p>
<div class="paragraph">
<p>The validation controller deletes entries in the Identity domain that have no corresponding entry in the connected system. In order to identify these entries, the validation controller uses two different algorithms that depend on the definition of the sort attribute in the &lt;export&gt; section:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If a <strong>sort attribute</strong> is configured at both sides, the controller searches both the source and the destination. It processes the source search result entries one by one, and:</p>
</li>
<li>
<p>If the source entry matches the next destination entry according to the join conditions, it considers this entry the joined entry and updates it. Then it continues with next source entry and next destination entry.</p>
</li>
<li>
<p>If the source entry&#8217;s sort attribute is lexicographically smaller than the destination entry&#8217;s sort attribute, it assumes that the destination entry needs to be created. Then it continues with the next source entry.</p>
</li>
<li>
<p>If the source entry is lexicographically greater than the destination entry, the controller assumes that the destination entry needs to be deleted. It either issues a delete request for the destination entry or delegates the task to the user hook according the user hook&#8217;s response to the "getCallDelete()" method. The controller then continues by comparing current the source entry with the next destination entry.</p>
</li>
<li>
<p>When there are still source entries available and all destination entries have been processed, then all these remaining source entries will be created (after having performed the appropriate mappings).</p>
</li>
<li>
<p>When there are still destination entries available and all source entries have been processed, then all these remaining destination entries need to be deleted. (For details on deletion algorithm look at the previous steps.)</p>
</li>
<li>
<p>In <strong>all other cases</strong>, the controller first searches for all identifiers of the destination and stores them in a map. Then, it exports the source entries and joins one after the other in the destination:</p>
</li>
<li>
<p>If no matching entry is found, the entry will be created in the destination.</p>
</li>
<li>
<p>If a matching entry is found, the entry is eventually modified and the joined entry is deleted from the map.</p>
</li>
<li>
<p>In the end, only the entries that have no corresponding source entries remain in the map. The validation controller either deletes them itself or delegates this task to the user hook.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Note:</p>
</div>
<div class="paragraph">
<p>As a consequence of the algorithms described above, you should configure a Sort Attribute if you configure Paged Read in a channel&#8217;s &lt;export&gt; section. This configuration enables the validation controller to process the entries page by page rather than having to read all pages first into memory before starting the comparison algorithm. As a result, Paged Read, which especially makes sense for large search results, performs in an optimal way if a Sort Attribute is configured, too. Also keep in mind to configure an appropriate size limit at the LDAP Server for the complete search result even if you choose Paged Read.</p>
</div>
<div class="paragraph">
<p>a. Full Import Controllers</p>
</div>
<div class="paragraph">
<p>The "full import" controller performs a full import from a connected system into DirX Identity. Its operation is identical to the validation controller with one exception: the validation controller updates the "last validation date" at the target system when the job is finished. In other words, full import is the same as initial load with respect to a connected system. Full import can be used not only for connected systems with accounts and groups, but also for all types of systems and objects, especially for importing users.</p>
</div>
<div class="paragraph">
<p>b. Restore Target System Controller</p>
</div>
<div class="paragraph">
<p>The "restore target system" controller restores a connected system with the entries stored in the Identity Store after a crash of the connected system. The controller works like the "full import" controller, but from the Identity Store to the connected system. It should be started by a schedule or (preferably) by hand using Identity Manager. It exports all entries of the "IdentityDomain" port and imports them into the connected system. It deletes entries in the connected system that have no representative in the Identity Store.</p>
</div>
<div class="paragraph">
<p>Note: if you donât want objects that do not have a representative in the Identity Store to be deleted in the connected system, you should use the Sync-One-Way-2-TS Controller, which only adds or modifies objects. We recommend using this controller first when going productive to test if your environment and your mapping are correct before using the Restore Target System Controller.</p>
</div>
<div class="paragraph">
<p>c. Sync-One-Way Controller / Sync-One-Way-2-TS Controller</p>
</div>
<div class="paragraph">
<p>The "sync-one-way" controller synchronizes entries from the Identity Store to the connected system. Its operation differs from the "Restore" controller in that it does not delete entries that were deleted in the Identity Store. Its operation differs from the "Sync2TS" controller in that it does not synchronize the changes back from the connected system to Identity Store: it works only "one-way".</p>
</div>
<div class="paragraph">
<p>d. Sync-One-Way-2-Identity Controller</p>
</div>
<div class="paragraph">
<p>The "sync-one-way-2-identity" controller synchronizes entries from the connected system to the connected system. Its operation differs from the "FullImport" controller in that it does not delete entries that were deleted in the connected system, and it does not update the âlast validation dateâ. Its operation differs from the "Sync2TS" controller in that it does not synchronize the changes back from the Identity Store to the connected system: it works only "one-way".</p>
</div>
<div class="paragraph">
<p>e. Cluster Synchronization Controller</p>
</div>
<div class="paragraph">
<p>The "cluster synchronization" controller is like the "Sync2TS" controller except that it serves not only one target system, but a cluster of them. The appropriate workflows accept change events for a target system, but can also be started by a schedule or manually by Identity Manager.</p>
</div>
<div class="paragraph">
<p>When started by a schedule or by hand, the workflow expects the DN of the target system, its type, cluster and domain attributes as start parameters. The controller reads the connector configuration and the environment properties from the target system entry, opens the target system connector with the new configuration data and provisions the entries of the Identity Store to the connected system exactly the same way as the "Sync2TS" controller.</p>
</div>
<div class="paragraph">
<p>When started by a change event, the controller finds the target system by evaluating the event topic: The topic contains the type, domain and cluster attributes of the target system.</p>
</div>
<div class="paragraph">
<p>f. Cluster Validation Controller</p>
</div>
<div class="paragraph">
<p>The "cluster validation" controller is like the normal "validation" controller except that it serves not only one target system, but a cluster of them. For more details on cluster handling, see the Cluster Synchronization Controller.</p>
</div>
<div class="paragraph">
<p>g. Cluster Restore TS Controller</p>
</div>
<div class="paragraph">
<p>The "cluster restore" controller is like the normal "restore target system" controller except that it serves not only one target system, but a cluster of them. For more details on cluster handling, see the Cluster Synchronization Controller.</p>
</div>
<div class="paragraph">
<p>h. Password Reset TS Controller</p>
</div>
<div class="paragraph">
<p>The "password reset TS" controller resets the passwords of the accounts of a DirX Identity target system. If the workflow is configured for personal accounts, it reads the password from the user and sets it at the account. If it is configured for privileged accounts, it generates a new password and sets it at the account. For each change, it sends a change event that triggers the password synchronization workflow to update the password at the connected system. The controller does not handle change events.</p>
</div>
<div class="paragraph">
<p>i. Password Expiration Controller</p>
</div>
<div class="paragraph">
<p>The "password expiration" controller checks for expired passwords of privileged accounts in DirX Identity. The controller searches for passwords that are going to expire according to the configured filter. The number of days before expiration is configurable. The controller generates a new password, sets it at the account and sends the change event to trigger the password synchronization workflow. The controller does not handle change events.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch1_channels_and_mapping"><a class="anchor" href="#_ch1_channels_and_mapping"></a><a class="link" href="#_ch1_channels_and_mapping">1.2.1.5. Channels and Mapping</a></h5>
<div class="paragraph">
<p>The channel configuration specifies how to find entries in the attached system and how to map them to corresponding system.</p>
</div>
<div class="paragraph">
<p>A channel is always attached to a connected directory, which represents either a connected system or a target system sub-tree in an Identity domain. We differentiate between a number of channel types, as shown in the following figure.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch1_applsref/image10.png" alt="Channel Types">
</div>
<div class="title">Figure 10. Channel Types</div>
</div>
<div class="paragraph">
<p>As shown in the figure:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Main or <strong>primary channels</strong> represent the entries of a certain type, typically accounts or groups. They have a reference to the corresponding channel, which represents the entries at the other system. Typically, an accounts channel for the Identity domain has a corresponding channel for the users in the connected system. The same holds for groups.</p>
</li>
<li>
<p><strong>Member channels</strong> represent the account-group memberships. In order to support "cross-membership" scenarios (for more details, see the section<br>
"Cross Memberships"), the attributes that hold the membership information (for example, for LDAP: attribute "members") are separated and managed in the member channel. The member channel is referenced from one of the primary channels, which indicates that the membership attributes are stored in the primary entry. The member channel also has a corresponding channel that may be attached to another primary channel that is not the corresponding channel of the source. This relationship defines a "cross-memberships" scenario, where members are stored in groups at one side and in users at the other.</p>
</li>
<li>
<p><strong>Password channels</strong> represent the password-related attributes of an entry type; that is, of users and accounts. These attributes include the attribute that stores the password (for example, "userPassword" for LDAP systems), and can include additional ones, especially for password reset information. The password channel references the primary channel for the entry that holds its attributes. Separating the password attributes from the normal ones allows the join engine to identify the attributes to be updated upon password change events. The password channel on Identity side is an optional one and will be used when synchronizing password relevant attribute information from Connected System back to IdentityStore.</p>
</li>
<li>
<p><strong>Secondary channels</strong> are mainly intended for relational database systems, which store entry attributes in several joined tables. Each secondary channel has a reference to its primary channel. When reading an entry from the attached system, the join engine also reads the attributes from the secondary channel(s). As a result, it needs some information from the schema of the database:</p>
</li>
<li>
<p>The storage location of the reference between primary and secondary channel</p>
</li>
<li>
<p>The attributes that hold the reference in the source and which are referenced in the destination</p>
</li>
<li>
<p>The type of relationship: 1-to-1, 1-to-many.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The channel configuration is separated into the following sections:</p>
</div>
<div class="paragraph">
<p><strong>Export</strong>: Defines the elements to search the entries in the attached system, usually search base, search filter and scope (for hierarchical systems). Furthermore, the controller can be advised to perform a paged search (with page size, time limit, etc.). You should only activate this option if the appropriate connectors support this functionality.</p>
</div>
<div class="paragraph">
<p><strong>Delta</strong>: The settings here are only evaluated by delta controllers. You have two options here:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Extend the search filters in order to obtain only the changed entries since the last change. This option can be applied to any connector and any connected system that supports attributes representing the creation and or modification time. Typical samples are LDAP servers with the attributes âcreateTimestampâ and âmodifyTimestampâ. You just need to supply the list of attributes containing the creation or modification time.</p>
</li>
<li>
<p>This option, called the âExpert Operational Attributesâ, is only for special connectors that explicitly support delta handling. The most important sample is the Active Directory connector. It is able to not only obtain the changed entries, but also those, which were deleted since the last export. In this case you just need to select the âExpert Operational Attributesâ option and enter a fixed XML String containing the value â${LastDeltaValue}â for the operational attribute âdxm.deltaâ.<br>
<br>
For more information about the specific aspects when selecting this option for the Active Directory Delta Workflow see "Using the Target System (Provisioning) Workflows &#8594; Understanding Java-based target System Workflows - &gt; Active Directory (ADS) Workflows &#8594; Customizing the ADS Workflows &#8594; Delta Workflows" in this guide</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Join</strong>: Specifies a number of join conditions that the join engine is to evaluate when it tries to find the joined entry in the destination, given an entry from the source system. The conditions are applied one after the other. If any one condition leads to exactly one resulting entry in the search, the join engine considers this to be the joined entry. Otherwise, it evaluates the next one in the list. You have two options for formulating a join condition:</p>
</div>
<div class="paragraph">
<p>Specify a <strong>search base</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;searchBase type="..."&gt;&lt;spml:id&gt;${source.dxrPrimaryKey}&lt;/spml:id&gt;&lt;/searchBase&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The join engine in the search request replaces the search base defined in the export section with this one. This option is appropriate if you know the identifier from the source entry. You can use placeholders for referencing attributes of the source, the target entry or the environment. In case of a target entry, the mapping for this attribute is performed.</p>
</div>
<div class="paragraph">
<p>Specify a <strong>filter extension</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;filterExtension&gt;&lt;dsml:equalityMatch name="..."&gt;&lt;dsml:value&gt;...</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the search request, the join engine extends the filter given in the export section with this term by "and-ing" the given conditions. For the values, you can use the same placeholders as mentioned above and in attribute mapping in general.</p>
</div>
<div class="paragraph">
<p><strong>Import</strong>: The import section specifies some options that are evaluated when the join engine creates, updates or deletes an entry in the attached system. In particular, you can define, if a notification is to be sent, when an entry is created or deleted.</p>
</div>
<div class="paragraph">
<p><strong>Mapping</strong>: The mapping section contains the mapping for all attributes of the destination system when a source entry is to be updated / imported at the attached system. You have several options for specifying the mapping, ranging from direct mapping to simple expressions with placeholders to Java mapping classes. You can even specify a post mapping that is called after all the attribute mappings. For details, see the help page on the channel and the customization chapter for Java attribute mapping.</p>
</div>
<div class="paragraph">
<p><strong>Operational Attributes</strong>: A list of so-called "operational attributes" can be passed to the connector with each request. This list depends on the connector. In most cases, you can ignore them.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch1_cross_memberships"><a class="anchor" href="#_ch1_cross_memberships"></a><a class="link" href="#_ch1_cross_memberships">1.2.1.6. Cross-Memberships</a></h5>
<div class="paragraph">
<p>In most applications and systems, user-group memberships are stored at the group. This is typical for LDAP and Active Directory systems: users are members in groups. Scenarios with large groups may face performance problems: the long member lists often must be read and updated. Storing the memberships at the user would normally be much faster.</p>
</div>
<div class="paragraph">
<p>You cannot change how memberships are stored at existing connected systems. But you can change it for the accounts and groups in a DirX Identity target system. If the flag "Reference group from account" is checked, group memberships are stored in the attributes of an account. You can easily change this setting, but you must make sure that the Provisioning workflow is configured consistently.</p>
</div>
<div class="paragraph">
<p>Memberships are Stored in Groups at Both Sides</p>
</div>
<div class="paragraph">
<p>At the DirX Identity target system entry, the flag "Reference group from account" is not checked.</p>
</div>
<div class="paragraph">
<p>In the workflow configuration, the channel "members" is set as the member channel of the groups channel for both connected directories. Make sure that the groups are synchronized after the accounts / users by setting the "Export Sequence Number" to "2" in the groups channels and to "1" in the accounts channels.</p>
</div>
<div class="paragraph">
<p>Memberships are Stored in the Account or User at Both Sides</p>
</div>
<div class="paragraph">
<p>At the DirX Identity target system entry, the flag "Reference group from account" is checked.</p>
</div>
<div class="paragraph">
<p>In the workflow configuration, the channel "members" is set as the member channel of the accounts channel for both connected directories. Make sure that the accounts are synchronized after the groups by setting the "Export Sequence Number" to "2" in the accounts channels and to "1" in the groups channels.</p>
</div>
<div class="paragraph">
<p>Cross-Membership Scenario</p>
</div>
<div class="paragraph">
<p>When the memberships are stored at the accounts in DirX Identity and at the groups in the connected system we call this a "cross-membership" scenario.</p>
</div>
<div class="paragraph">
<p>At the DirX Identity target system entry the flag "Reference group from account" is checked. If in the connected system the identifier of the user is not used as reference in the group, we need to set the attribute "Source for referenced property" at the target system: Set the attribute name of the user, which is used in the member attribute of the group in the connected system. For a Lotus Notes system this would be the "fullname". For LDAP and Active Directory systems it is the DN, which is also used as identifier in mapping: Hence you can leave this attribute empty.</p>
</div>
<div class="paragraph">
<p>In the workflow configuration, the channels must be handled differently:</p>
</div>
<div class="paragraph">
<p>For the connected directory representing the DirX Identity target system, the channel <strong>members</strong> must be assigned as the member channel in the <strong>General</strong> tab of the accounts channel and must be de-assigned at the group channel. The accounts must be imported after the groups. Therefore, the "Export Sequence Number" in the accounts channel must be set to "2" and that of the groups channel must be set to "1".</p>
</div>
<div class="paragraph">
<p>For the connected directory representing the connected system, it is the other way around: The groups must be imported after the users / accounts. Therefore, the "Export Sequence Number" in the accounts channel must be set to "1" and that of the groups channel must be set to "2". Also regarding the members channel assignment the default setting - members channel is assigned at the groups channel - can be left.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch1_starting_java_based_workflows"><a class="anchor" href="#_ch1_starting_java_based_workflows"></a><a class="link" href="#_ch1_starting_java_based_workflows">1.2.1.7. Starting Java-based Workflows</a></h5>
<div class="paragraph">
<p>Java-based workflows are started:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>as the result of an event sent because of an object change</p>
</li>
<li>
<p>regularly by a schedule</p>
</li>
<li>
<p>manually in Identity Manager</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The next sections provide more information about these start-up methods.</p>
</div>
<div class="sect5">
<h6 id="_ch1_event_based_workflows"><a class="anchor" href="#_ch1_event_based_workflows"></a><a class="link" href="#_ch1_event_based_workflows">1.2.1.7.1. Event-Based Workflows</a></h6>
<div class="paragraph">
<p>Conceptually, we distinguish between the following types of event-based workflows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Provisioning workflows, which provision accounts and groups to a connected system.</p>
</li>
<li>
<p>Password change workflows, which receive password changes of a user or a privileged account and update them in the Identity domain and in the user&#8217;s associated accounts in connected systems as necessary.</p>
</li>
<li>
<p>Event-based maintenance workflows, which are started when an entry (such as a user, a role, or an organizational unit) within the Identity domain is changed. They determine the changes that must be made to the entry itself or to associated entries within the domain. Typical reasons for such changes are provisioning or consistency rules that must be applied.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Provisioning Workflows</p>
</div>
<div class="paragraph">
<p>Typically <strong>account or group changes</strong> trigger a real-time workflow, as illustrated in the following figure.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch1_applsref/image11.png" alt="Event-Triggered Provisioning Workflow">
</div>
<div class="title">Figure 11. Event-Triggered Provisioning Workflow</div>
</div>
<div class="paragraph">
<p>Suppose a manager at Web Center or Identity Manager assigns a role to a user. DirX Identity resolves the resulting access rights, creates an account in the Identity Store, puts it into the member list of a group and sends two change events: one for the account, and one for the group. A workflow associated with the target system receives the events and synchronizes the changes in Identity Store with the connected system.</p>
</div>
<div class="paragraph">
<p>The same process occurs as result of a <strong>request workflow</strong>. Usually, the last activity in an approval or object creation workflow is the "apply change" activity. It stores the changes requested in the workflow and sends the same change events for accounts and groups as in the previous scenario.</p>
</div>
<div class="paragraph">
<p>Note that DirX Identity sends the changes only if the flag "Enable Real-time Provisioning" is set to active.</p>
</div>
<div class="paragraph">
<p>Password Workflows</p>
</div>
<div class="paragraph">
<p>Real-time provisioning workflows are also involved in <strong>password changes</strong>. A typical scenario is illustrated in the following figure.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch1_applsref/image11.png" alt="Password Change Workflow">
</div>
<div class="title">Figure 12. Password Change Workflow</div>
</div>
<div class="paragraph">
<p>Assume that a user changes her password in the Windows domain. the DirX Identity Windows Password Listener captures the new password at the domain controller and sends an appropriate change event. The "User Password Event Manager" receives the event, searches the Windows account and then the user entry and updates the password in the Identity Store. Then it finds all accounts of the user for which password synchronization is enabled (see the flag at the target system entry) and sends messages that request the password change at the connected systems. These requests are handled by a "set password" workflow. It takes the new password and if required, the current password out of the message and updates them at the connected system.</p>
</div>
<div class="paragraph">
<p>Nearly the same process occurs if the user changes her password with Web Center. The "User Password Event Manager" workflow finds the user directly with the DN given in the event, updates the password and sends the change requests for the accounts.</p>
</div>
<div class="paragraph">
<p>A user can also use Web Center to change the password of a privileged account. Web Center sends a password change event for the account, which is processed by the "Account Password Manager" workflow. It updates the password at the account in the Identity Store and sends the same password change request as in the previous scenarios to update the password at the connected system.</p>
</div>
<div class="paragraph">
<p>Event-based Maintenance Workflows</p>
</div>
<div class="paragraph">
<p>The maintenance workflows work only with the DirX Identity domain. They are invoked when a domain entry is created or changed, not only accounts or groups but also users, roles, permissions and business objects. Their processing depends upon the entry type, but typically they apply provisioning and consistency rules and check for broken links. The following figure illustrates maintenance workflow operation.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch1_applsref/image13.png" alt="Event-based Maintenance Workflow">
</div>
<div class="title">Figure 13. Event-based Maintenance Workflow</div>
</div>
<div class="paragraph">
<p>The workflows are triggered by a change event that is published by a number of sources:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Web Center, Identity Manager</p>
</li>
<li>
<p>Provisioning Web Service clients</p>
</li>
<li>
<p>Import workflows, both Tcl-based and Java-based workflows</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The client publishes a change event for an entry if the corresponding entry type is activated in the domain&#8217;s event policy. The message topic includes the entry type, which allows the IdS-J server to invoke the appropriate maintenance workflow. The workflow analyzes the changed attributes and performs several maintenance tasks depending on the entry type. For example, the user maintenance workflow:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Applies consistency rules.</p>
</li>
<li>
<p>Checks for broken links.</p>
</li>
<li>
<p>Applies provisioning rules, if their filters match the user attributes.</p>
</li>
<li>
<p>Resolves the user and updates the accounts, if a permission parameter has been changed.</p>
</li>
<li>
<p>Updates account attributes, if an attribute has been changed that matches a list of configured names or wildcards.</p>
</li>
<li>
<p>Ignores the event, if none of the above conditions applies.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If in the course of a user resolution an account or a group is modified, the workflow publishes a provision request that triggers a provisioning workflow.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_scheduled_workflows"><a class="anchor" href="#_ch1_scheduled_workflows"></a><a class="link" href="#_ch1_scheduled_workflows">1.2.1.7.2. Scheduled Workflows</a></h6>
<div class="paragraph">
<p>You can also define schedules for Java-based workflows. The IdS-J workflow scheduler starts the workflow at the scheduled times.</p>
</div>
<div class="paragraph">
<p>A scheduled workflow operates a little bit differently from the way it operates when triggered by an event. It synchronizes all entries from the source to the destination system. For a synchronization workflow, this means that the workflow reads all accounts and groups from Identity Store and updates them one after the other at the connected system.</p>
</div>
<div class="paragraph">
<p>If you want to define a schedule for cluster workflows (which can provision a set or cluster of homogeneous connected systems), you must specify a search filter for all target systems to be provisioned according this schedule. For each target system, the scheduler starts a workflow instance that provisions only the accounts and groups of this system.</p>
</div>
<div class="paragraph">
<p>Note that starting a real-time workflow manually or on a schedule may not make sense for all types of workflows. This is especially true for</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Maintenance workflows: they only process events.</p>
</li>
<li>
<p>Password workflows: they require the new password in the event message.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_starting_a_workflow_manually"><a class="anchor" href="#_ch1_starting_a_workflow_manually"></a><a class="link" href="#_ch1_starting_a_workflow_manually">1.2.1.7.3. Starting a Workflow Manually</a></h6>
<div class="paragraph">
<p>You can also start a workflow manually in Identity Manager in one of two ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In the Connectivity configuration, select a Java-based workflow and start it from the context menu. The workflow works as if started by a schedule and provisions the entire target system.</p>
</li>
<li>
<p>In the Identity domain, choose a target system and from the context menu, select Connectivity, then the workflow, and then start the workflow. This method is especially appropriate for cluster workflows: they process only the entries of this target system.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that starting a real-time workflow manually or on a schedule may not make sense for all types of workflows. This is especially true for</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Maintenance workflows: they only process events.</p>
</li>
<li>
<p>Password workflows: they require the new password in the event message.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch1_customizing_java_based_workflows"><a class="anchor" href="#_ch1_customizing_java_based_workflows"></a><a class="link" href="#_ch1_customizing_java_based_workflows">1.2.2. Customizing Java-based Workflows</a></h4>
<div class="paragraph">
<p>This section describes how to customize the default set of Java-based workflows provided with DirX Identity. It explains how to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Configure and implement user hooks</p>
</li>
<li>
<p>Create complex mapping functions with Java classes</p>
</li>
<li>
<p>Test real-time workflow mapping</p>
</li>
<li>
<p>Create connector filters that intercept calls to connectors</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="_ch1_using_user_hooks"><a class="anchor" href="#_ch1_using_user_hooks"></a><a class="link" href="#_ch1_using_user_hooks">1.2.2.1. Using User Hooks</a></h5>
<div class="paragraph">
<p>User hooks are extensions made by customers to DirX Identity common code that are independent of this code and which therefore do not change with product updates. The DirX Identity default application code is divided into common code (control and central scripts that can change with product updates) and user hooks (customer routines that are protected from product updates).</p>
</div>
<div class="paragraph">
<p>User hooks in a Provisioning workflow are called at various phases while synchronizing a source entry into a destination system. They can</p>
</div>
<div class="paragraph">
<p>Read the source entry, the joined entry and the mapped entry</p>
</div>
<div class="paragraph">
<p>Change the mapped entry</p>
</div>
<div class="paragraph">
<p>Have access to the source and destination systems via the connectors.</p>
</div>
<div class="paragraph">
<p>There are two types of user hook:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A global user hook, which applies to the whole activity</p>
</li>
<li>
<p>A channel user hook, which applies to the entries associated with a channel</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following figure illustrates user hooks.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch1_applsref/image14.png" alt="User Hooks">
</div>
<div class="title">Figure 14. User Hooks</div>
</div>
<div class="paragraph">
<p>As illustrated in the figure, you can have different user hooks when importing</p>
</div>
<div class="ulist">
<ul>
<li>
<p>an account into Identity domain</p>
</li>
<li>
<p>a user into a connected system</p>
</li>
<li>
<p>a group into a connected system</p>
</li>
<li>
<p>a group into Identity domain.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This section describes how to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Configure a user hook</p>
</li>
<li>
<p>Implement a global user hook</p>
</li>
<li>
<p>Implement a channel user hook</p>
</li>
<li>
<p>Implement a user hook for e-mail notifications.</p>
</li>
<li>
<p>Deploy a user hook.</p>
</li>
<li>
<p>Run executables from a user hook.</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="_ch1_configuring_a_user_hook"><a class="anchor" href="#_ch1_configuring_a_user_hook"></a><a class="link" href="#_ch1_configuring_a_user_hook">1.2.2.1.1. Configuring a User Hook</a></h6>
<div class="paragraph">
<p>This section explains how to configure a global and a channel-specific user hook.</p>
</div>
<div class="paragraph">
<p>The global user hook is configured in the XML configuration of a job, which itself is part of an activity configuration. A channel user hook is configured for each channel. Their configuration parameters are the same.</p>
</div>
<div class="paragraph">
<p>A job is configured as part of an activity within a &lt;workflow&gt; element. The global user hook is part of the controller configuration. The XPath expression of the corresponding XML element reads:<br>
workflow/activities/activity[@name='&#8230;&#8203;']/job/controller/operation/user hook.</p>
</div>
<div class="paragraph">
<p>A job configuration collects a number of &lt;port&gt; elements, which itself collect a number of &lt;channel&gt; elements. A channel user hook is a sub-element of the &lt;channel&gt; element. Here the XPath notation:<br>
workflow/activities/activity[@name='&#8230;&#8203;']/job/port/channel/user hook.</p>
</div>
<div class="paragraph">
<p>The XML attributes of the &lt;userhook&gt; element include:</p>
</div>
<div class="paragraph">
<p><strong>classname:</strong>
The full class name of your user hook Java class. It must implement the IGlobalUserHook or the IUserHook interface.</p>
</div>
<div class="paragraph">
<p><strong>implementationLanguage:</strong>
Currently only the value "java" is supported. It&#8217;s also the default, if omitted.</p>
</div>
<div class="paragraph">
<p><strong>data:</strong>
The source of your user hook Java class.</p>
</div>
<div class="paragraph">
<p><strong>code:</strong>
The octets of the compiled unit. This property is loaded by the controller instead of searching a class from the class path. This property will be filled by the Identity Manager in the course of configuration.</p>
</div>
<div class="paragraph">
<p><strong>Sub-properties of &lt;userhook&gt;:</strong>
Some properties are denoted as property sub-elements as follows: &lt;property name="&#8230;&#8203;" value="&#8230;&#8203;"/&gt;. The following properties are evaluated by the controller:</p>
</div>
<div class="paragraph">
<p><strong>sourcepath:</strong>
The full path name of the Java file that contains the source of your user hook implementation. This property is supported for local testing.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_implementing_a_global_user_hook"><a class="anchor" href="#_ch1_implementing_a_global_user_hook"></a><a class="link" href="#_ch1_implementing_a_global_user_hook">1.2.2.1.2. Implementing a Global User Hook</a></h6>
<div class="paragraph">
<p>A global user hook is called at the beginning and at the end of a job. It must implement the interface <strong>com.siemens.dxm.join.api.IGlobalUserHook</strong> with the following methods:</p>
</div>
<div class="paragraph">
<p><strong>setGlobalContext</strong></p>
</div>
<div class="paragraph">
<p>With this method, the controller passes a reference to the global context. It gives access to the connectors, the configurations of the job, the controller and the user hook and to the current working directory.</p>
</div>
<div class="paragraph">
<p><strong>prolog:</strong></p>
</div>
<div class="paragraph">
<p>The method prolog() is called at the beginning of a job, before any entry or channel is handled. It allows you to prepare a job and set any global properties into the job context.</p>
</div>
<div class="paragraph">
<p>Among other tasks, the global user hook can add its proprietary properties in the global context. The join engine passes the updated global context to each channel user hook. In order to avoid overlap of other property names, use custom prefixes such as <strong>org.myorg.mydep.MyProperty</strong>.</p>
</div>
<div class="paragraph">
<p><strong>epilog:</strong></p>
</div>
<div class="paragraph">
<p>The epilog() method is called at the end of the job. It allows you to close any open resources, such as file or network handles.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_implementing_a_channel_user_hook"><a class="anchor" href="#_ch1_implementing_a_channel_user_hook"></a><a class="link" href="#_ch1_implementing_a_channel_user_hook">1.2.2.1.3. Implementing a Channel User Hook</a></h6>
<div class="paragraph">
<p>The join engine calls the channel user hook in various phases while it processes an entry. A user hook implements the interface <em>com.siemens.dxm.join.api.IUserHook</em> and optionally <em>com.siemens.dxm.join.api.IUserHookExt</em>. The following figure provides an overview of the API operations and when they are called from the join engine:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch1_applsref/image15.png" alt="Join Engine-User Hook Operation Calling Sequence">
</div>
<div class="title">Figure 15. Join Engine-User Hook Operation Calling Sequence</div>
</div>
<div class="paragraph">
<p>As shown in the figure, there are the following user hook operations:</p>
</div>
<div class="paragraph">
<p><strong>prolog</strong>:</p>
</div>
<div class="paragraph">
<p>Before the first entry is processed, the join engine passes the environment properties of the source and the target channel to the user hook. These properties comprise the context properties set by the global user hook and a set of "specific attributes" taken from the following entries of the Connectivity configuration database: channel, connected directory, workflow, global configuration.</p>
</div>
<div class="paragraph">
<p>This action allows the user hook to open a file or a connection to another system or do some other preparation task. It may add its own properties to the target environment. The join engine reads them from the user hook at several times via the method <em>getTgtEnvironment</em> (see below).</p>
</div>
<div class="paragraph">
<p><strong>processSourceEntry</strong></p>
</div>
<div class="paragraph">
<p>After the join engine has read a source entry, it asks the user hook whether to process it. The <em>processSourceEntry</em> method receives the identifier and the list of attributes of the source entry and returns a boolean. In case it is false, the join engine skips processing this entry.</p>
</div>
<div class="paragraph">
<p><strong>preUpdate</strong></p>
</div>
<div class="paragraph">
<p>The join engine reads the joined entry from the target system. Then it calls the <em>preUpdate</em> method of the user hook (note: the method of the IUserhook API). As parameters it passes: identifier and attribute list of source and joined entry, references to connectors to source and target system. This action allows the user hook to read additional information from the source or the target, do some processing at the target or some other task before the entry is updated at the target system.</p>
</div>
<div class="paragraph">
<p>This method returns a boolean. If it is set to false, the join engine skips further processing this entry and continues with the next one.</p>
</div>
<div class="paragraph">
<p>For a method that is called after the mapping and before the update, see the <em>preUpdate</em> method of the <em>IUserHookExt</em> interface.</p>
</div>
<div class="paragraph">
<p><strong>getSrcEnvironment</strong></p>
</div>
<div class="paragraph">
<p>The join engine calls this method several times: before the prolog, before the mapping and before the epilog. It allows the user hook to extend the environment properties related to the source channel by its own proprietary ones.</p>
</div>
<div class="paragraph">
<p><strong>getTgtEnvironment</strong></p>
</div>
<div class="paragraph">
<p>The join engine calls this method several times: before the prolog, before the mapping and before the epilog. It allows the user hook to extend the environment properties related to the target channel by its own proprietary ones.</p>
</div>
<div class="paragraph">
<p><strong>preUpdate (API IUserhookExt)</strong></p>
</div>
<div class="paragraph">
<p>After the join engine has mapped the source entry to the target entry and before it updates the target entry, it calls the <em>preUpdate</em> method of the user hook, if it implements the interface <em>IUserHookExt</em>.<br>
As parameters, it passes the identifier and attribute list of the source and joined entry, the mapped entry, and references to connectors to source and target system. This action allows the user hook to change the mapped entry, do some processing at the target or some other task before the entry is updated at the target system.</p>
</div>
<div class="paragraph">
<p>This method returns a boolean. If it is set to false, the join engine discontinues processing this entry and continues with the next one.</p>
</div>
<div class="paragraph">
<p><strong>getCallDelete</strong></p>
</div>
<div class="paragraph">
<p>When the join engine encounters a mapped entry with request type DELETE, it first asks the user hook whether a custom delete method must be called. When this method returns true, the join engine calls the user hook method <em>delete</em>(). Otherwise it performs the delete request at the connector using the identifier of the mapped entry.</p>
</div>
<div class="paragraph">
<p><strong>delete</strong></p>
</div>
<div class="paragraph">
<p>The join engine calls this method when an entry is to be deleted by the user hook instead of performing the delete request itself; that is, if the <em>getCallDelete</em> method returns true. It passes a reference to the connector for the affected system and the mapped entry. As a result, the user hook can issue its own request at the connector (for example, a modify or extended request) or perform other tasks without the connector.</p>
</div>
<div class="paragraph">
<p><strong>postUpdate</strong></p>
</div>
<div class="paragraph">
<p>After the entry has been updated, the join engine calls this method. It passes the identifier and the attributes of the source and the joined entry, the performed update request, the response with its result code and the source and target connector.</p>
</div>
<div class="paragraph">
<p>The update request and the response can be null if no update was performed because the entry was already up-to-date. These two parameters can also be null if the user-defined <em>delete</em> operation is used; in this case, no information about user-defined update requests and update responses is available; it is even unknown whether an update operation has been executed at all.</p>
</div>
<div class="paragraph">
<p>This action allows the user hook to perform additional requests for the updated entry both at the source and the target system.</p>
</div>
<div class="paragraph">
<p>This method returns a boolean. If it is set to false, the join engine discontinues processing this entry and continues with the next one.</p>
</div>
<div class="paragraph">
<p><strong>epilog</strong></p>
</div>
<div class="paragraph">
<p>This method is called after all the entries of a channel have been processed. This action allows the user hook to close all pending handles (for example, sockets or files).</p>
</div>
<div class="paragraph">
<p>For a detailed description of the parameters, see the Java interface documentation in the folder Documentation/DirXIdentity/RealtimeWorkflows.</p>
</div>
<div class="paragraph">
<p>Review the contents of the <strong>Additions\RealtimeWorkflows\samples</strong> folder in the product DVD for a sample implementation that demonstrates basic handling.</p>
</div>
<div class="paragraph">
<p>For details on how to read and set the identifier and attributes of source or target entries, see the section "Evaluating a Mapping Entry".</p>
</div>
<div class="paragraph">
<p><strong>Deployment</strong></p>
</div>
<div class="paragraph">
<p>Make sure the jar file containing your user hook implementation is deployed in the correct folder of your IdS-J server, which is:</p>
</div>
<div class="paragraph">
<p><em>install_path</em>*/ids-j-<strong><em>domain</em></strong>-S*<em>n</em>*/confdb/common/lib*</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_implementing_a_user_hook_for_email_notifications"><a class="anchor" href="#_ch1_implementing_a_user_hook_for_email_notifications"></a><a class="link" href="#_ch1_implementing_a_user_hook_for_email_notifications">1.2.2.1.4. Implementing a User Hook for Email Notifications</a></h6>
<div class="paragraph">
<p>It is possible to send an e-mail notification in a user hook. You can find the sample Java-based workflow using the mail notification for account creation in the sample workflows for Extranet Portal, which is the part of the sample My-Company connectivity scenario. See the chapter "Loading the Connectivity Scenario" in the <em>DirX Identity Tutorial</em> for more information about the My-Company scenario. The provided user hook can be found on the DVD as Java class <strong>NotifyMailAccountCreationUserHook.java</strong>. It implements in particular the method <strong>postUpdate,</strong> which takes the <strong>mail</strong> attribute of the account and creates a specially-handled SPMLv1 request; this request is then sent to connector identified by the name "<strong>notify</strong>". If the provided mail is valid and the notify activity is correctly configured, it sends the notification to that mail address about account creation. Tailor this class to your needs if you intend to use special mail notifications in a Java-based workflow.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_deploying_a_user_hook"><a class="anchor" href="#_ch1_deploying_a_user_hook"></a><a class="link" href="#_ch1_deploying_a_user_hook">1.2.2.1.5. Deploying a User Hook</a></h6>
<div class="paragraph">
<p>Make sure the jar file that contains your user hook class is deployed in the correct folder of your IdS-J Server, which is:</p>
</div>
<div class="paragraph">
<p><em>install_path</em>*/ids-j-<strong><em>domain</em></strong>-S*<em>n</em>*/confdb/common/lib*</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_running_executables_from_a_user_hook"><a class="anchor" href="#_ch1_running_executables_from_a_user_hook"></a><a class="link" href="#_ch1_running_executables_from_a_user_hook">1.2.2.1.6. Running Executables from a User Hook</a></h6>
<div class="paragraph">
<p>DirX Identity provides a general user hook class <strong>UserHookRunExecutable</strong>, which allows running any executable configured in a realtime workflow channel object. It can be used immediately without any extra programming. Specify the class name com.siemens.dxm.join.userhook.common.UserHookRunExecutable in the General tab of the channel and specify the executable name and command line in the channel-specific attributes.</p>
</div>
<div class="paragraph">
<p>For the preUpdate and the postUpdate user hook methods, you can configure an executable with a command line in the channel-specific attributes post_executable, post_cmdline, pre_executable, pre_cmdline. In the postUpdate case, the executable is only called if the update (add or modify) of the object was successful.</p>
</div>
<div class="paragraph">
<p>Architecture</p>
</div>
<div class="paragraph">
<p>The following figure illustrates the architecture of running an executable from a user hook:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch1_applsref/image16.png" alt="Running Executables from a User Hook">
</div>
<div class="title">Figure 16. Running Executables from a User Hook</div>
</div>
<div class="paragraph">
<p>Concept</p>
</div>
<div class="paragraph">
<p>The following features are available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Running executables as part of a user hook.</p>
</li>
<li>
<p>Using the standard user hook with a few configuration steps in any user hook.</p>
</li>
<li>
<p>Using the source code starting point for more complex solutions.</p>
</li>
<li>
<p>Working in a high availability scenario.</p>
</li>
<li>
<p>Running in a multi-threaded environment.</p>
</li>
<li>
<p>Redirecting of logging to the Java-based Server logs by default.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following samples are provided:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A PowerShell script for personal folder creation.</p>
</li>
<li>
<p>Several PowerShell scripts for managing Exchange mailboxes.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Command Line Parameters of the Executable</p>
</div>
<div class="paragraph">
<p>The command line parameters specified in the channel specific attributes post_cmdline and/or pre_cmdline can contain fixed parts and variable parts. The variable parts can reuse all mapping variables by specifying the source, target, env and joinedEntry constructs, like ${source.dxrName}, ${target.homeDirRoot}, ${env.domain}, ${joinedEntry.cn}.</p>
</div>
<div class="paragraph">
<p>Central (Shared) Script Folder</p>
</div>
<div class="paragraph">
<p>Beneath each Java-based Serverâs repository folder, which can be specified at the Java-based Server object in the Connectivity Expert View, there is a subfolder <strong>scripts</strong> where the executables can be located. In a distributed Java-based Server environment, this high availability location can be shared by all running instances.</p>
</div>
<div class="paragraph">
<p>The absolute path of the <strong>scripts</strong> folder is put into the Java-based Server context and can be accessed from user hooks by the environment variable ${env.scripts}. It can also be specified in the channel-specific attributes; for example, in the post_executable or post_cmdline attribute.</p>
</div>
<div class="paragraph">
<p>Output File and Error Handling</p>
</div>
<div class="paragraph">
<p>By default, the executable&#8217;s standard output and standard error messages and the exit code are written to the Java-based Server log file. If the executable fails, the user hook preUpdate and/or postUpdate methods return âfalseâ to the join engine according to the user hook API, which causes the join engine to pass an error record to the Audit Connector and to the Monitor View and to stop processing this entry.</p>
</div>
<div class="paragraph">
<p>You can also define executable return codes that you classify as successful by specifying the specific attributes post_ok_codes and/or pre_ok_codes for executables started in the related user hook methods. The return codes are specified as integer values and must be separated by blanks. If nothing is specified, the return code â0â is regarded as successful by default.</p>
</div>
<div class="paragraph">
<p>If the executable&#8217;s output is to be written to separate files, specify the output file names in the command line as parameters. The executable must interpret these output file names.</p>
</div>
<div class="paragraph">
<p>If you specify your own output files, we recommend including the Workflow Instance ID in the names of the output files to prevent running workflow instances started through further events from overwriting output files that have already been recorded. The Workflow Instance ID is also contained in the Java-based Server context and can be used by specifying the environment variable ${env.dxm.uh.wfInstID}.</p>
</div>
<div class="paragraph">
<p>The workflow name is accessible in the environment and must be specified by ${env.dxm.uh.wfName}.</p>
</div>
<div class="paragraph">
<p>Interrupting Executables</p>
</div>
<div class="paragraph">
<p>If the activity that starts the executable times out or the Java-based Server shuts down, the Java-based Server sets a cancellation flag. During a "graceful" shutdown period, the running activities (this is a standard task of the controller implementations) check this flag at certain times and finish the process. A good time to perform this task, for example, is after one event has completed in a scheduled synchronization. After the configurable graceful shutdown period has elapsed, the Java-based Server interrupts all running activities. If an executable has not yet finished, the UserHookRunExecutable class catches this interruption and kills the executable, which was started as an asynchronous process.</p>
</div>
<div class="paragraph">
<p>Killing Executables after a Configurable Time Period</p>
</div>
<div class="paragraph">
<p>Independently of this interruption scenario, the UserHookRunExecutable class starts the process running the executable asynchronously and asks for the process return value in a loop for a certain time (by default, 90 seconds) and then kills the process if it has not finished in this time frame. You can configure this time in milliseconds in the channel-specific attribute post_timeout for executables started in the postUpdate user hook method or in the pre_timeout specific attribute for executables started in the preUpdate user hook method.</p>
</div>
<div class="paragraph">
<p>Connection Parameters</p>
</div>
<div class="paragraph">
<p>If the activityâs connection parameters like server, user or password should be passed as parameters to the executable, you can extend the UserHookRunExecutable class by adding the desired parameters to the command line. For example, the connection parameters of the target connector can be accessed in a user hook the following way:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">DxmConnectionConfig connectionConfig = null;
DxmConnectorConfig connectorConfig = (DxmConnectorConfig) (_tgtEnv.get("dxm.uh.connectorConfByName.ts"));
if(connectorConfig != null) {
    DxmConnectionConfig connectionConfig = (DxmConnectionConfig) connectorConfig.getConnections().firstElement();
    String server = connectionConfig.getServer();
    int port = new Integer(connectionConfig.getPort());
    String user = connectionConfig.getUser();
    String pwd = connectionConfig.getPassword();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This coding example is already contained as a comment in the standard UserHookRunExecutable class provided as source code.</p>
</div>
<div class="paragraph">
<p>The bind parameters in the sample PowerShell scripts delivered with DirX Identity are kept in the scripts. The scripts read the password from a file that contains the password that you have saved encrypted with PowerShell.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch1_mapping_with_java_classes"><a class="anchor" href="#_ch1_mapping_with_java_classes"></a><a class="link" href="#_ch1_mapping_with_java_classes">1.2.2.2. Mapping with Java Classes</a></h5>
<div class="paragraph">
<p>You can provide Java sources or pre-compiled Java classes to realize complex mapping functions. They can be configured for</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Calculating the identifier of the target entry; for details, see the section "Identifier Mapping".</p>
</li>
<li>
<p>Mapping of attributes; for details see the section "Attribute Mapping".</p>
</li>
<li>
<p>Post mapping; that is, after all attributes have been mapped and before the update of the entry is performed. For details, see the section "Post Mapping".</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This section also provides information how to</p>
</div>
<div class="ulist">
<ul>
<li>
<p>deploy a mapping class.</p>
</li>
<li>
<p>evaluate a mapping entry.</p>
</li>
<li>
<p>handle environment properties.</p>
</li>
<li>
<p>handle the mapped entry.</p>
</li>
<li>
<p>set the map result.</p>
</li>
<li>
<p>write log messages.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can find a sample source that implements all interfaces in the following folder of your installation DVD:</p>
</div>
<div class="paragraph">
<p><strong>Additions\RealtimeWorkflows\samples</strong></p>
</div>
<div class="sect5">
<h6 id="_ch1_identifier_mapping"><a class="anchor" href="#_ch1_identifier_mapping"></a><a class="link" href="#_ch1_identifier_mapping">1.2.2.2.1. Identifier Mapping</a></h6>
<div class="paragraph">
<p>A class that realizes the mapping of an identifier must implement the interface <em>com.siemens.dxm.join.api.IMapIdentifier</em>. It consists of one method:</p>
</div>
<div class="paragraph">
<p>Identifier <strong>mapId</strong>(MappingEntry source, MappingEntry joined, HashMap&lt;String,Object&gt; environment)</p>
</div>
<div class="paragraph">
<p>The join engine passes the following parameters:</p>
</div>
<div class="paragraph">
<p><strong>source</strong>: the source entry, or null if no source entry exists, which occurs when validation workflows find entries at the target that have no corresponding source entry.</p>
</div>
<div class="paragraph">
<p><strong>joined</strong>: the joined entry, or null if no joined entry has been found.</p>
</div>
<div class="paragraph">
<p><strong>environment</strong>: a map of environment properties collected by the specific attributes taken from the affected channel, connected directory, activity and workflow entries. User hook implementations can append additional properties.</p>
</div>
<div class="paragraph">
<p>The identifier mapper must return the new identifier of the mapped entry.</p>
</div>
<div class="paragraph">
<p>For an example see the file <strong>Idmapping.java</strong> on the DVD in the folder <strong>Additions/RealtimeWorkflows/samples/mappings</strong></p>
</div>
<div class="paragraph">
<p>For details on how to handle these parameters, see the following sections:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Evaluating a Mapping Entry</p>
</li>
<li>
<p>Setting the Map Result</p>
</li>
<li>
<p>Handling Environment Properties</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_attribute_mapping"><a class="anchor" href="#_ch1_attribute_mapping"></a><a class="link" href="#_ch1_attribute_mapping">1.2.2.2.2. Attribute Mapping</a></h6>
<div class="paragraph">
<p>A class that realizes the mapping of an attribute must implement the interface <em>com.siemens.dxm.join.api.IMapAttribute</em>. It consists of one method:</p>
</div>
<div class="paragraph">
<p>MapResult <strong>mapAttr</strong>(String tgtAttrname, Request.Type reqType, MappingEntry source, MappingEntry joined, HashMap&lt;String,Object&gt; environment)</p>
</div>
<div class="paragraph">
<p>The join engine passes the following parameters:</p>
</div>
<div class="paragraph">
<p><strong>tgtAttrname</strong>: the name of the target attribute.</p>
</div>
<div class="paragraph">
<p><strong>reqType</strong>: the proposed request type. The attribute mapper can change it in the returned map result. Allowed types are: <em>Request.Type.ADD</em>, <em>Request.Type.MODIFY</em>, <em>Request.Type.DELETE</em>.</p>
</div>
<div class="paragraph">
<p><strong>source</strong>: the source entry, or null if no source entry exists, which occurs when validation workflows find entries at the target that have no corresponding source entry.</p>
</div>
<div class="paragraph">
<p><strong>joined</strong>: the joined entry, or null if no joined entry has been found.</p>
</div>
<div class="paragraph">
<p><strong>environment</strong>: a map of environment properties collected by the specific attributes taken from the affected channel, connected directory, activity and workflow entries. User hook implementations may append additional properties.</p>
</div>
<div class="paragraph">
<p>The attribute mapper must return the map result. In the simplest case, it contains only one value for the attribute. But you can also set a series of attribute modifications, a set of operational attributes and also return a changed request type. The request type determines the request to be issued to the target system connector: add a new entry, modify the existing joined entry or delete the existing entry.</p>
</div>
<div class="paragraph">
<p>A note concerning deleted source entries: normally, the join engine deletes an attribute value in the target entry, if the mapped value is empty or null. If the source entry no longer exists, the mapping routines typically produce empty values for the mapped attributes. However, if you want the target entry just to be modified (for example, set the state to DELETED) or moved (tombstone!), you typically do not want the target attribute values to be deleted. To support this operation, the join engine deletes the attribute values only if the modification operation is set to "delete". By default, it is set to "replace". As a result, if you want a target attribute to be deleted if the source entry no longer exists, it is not sufficient to return an empty value. You must explicitly set the operation in the modification to "delete". The following code snippet provides an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">DsmlModification targetMod = new DsmlModification();
targetMod.setName(tgtAttrname);
targetMod.setOperation(DsmlModificationOperationType.DELETE);</code></pre>
</div>
</div>
<div class="paragraph">
<p>For details on how to handle the input parameters, see the following sections:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Evaluating a Mapping Entry</p>
</li>
<li>
<p>Setting the Map Result</p>
</li>
<li>
<p>Handling Environment Properties</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_post_mapping"><a class="anchor" href="#_ch1_post_mapping"></a><a class="link" href="#_ch1_post_mapping">1.2.2.2.3. Post Mapping</a></h6>
<div class="paragraph">
<p>A class that realizes the post mapping of an entry must implement the interface <em>com.siemens.dxm.join.api.IPostMapping</em>. It consists of one method:</p>
</div>
<div class="paragraph">
<p>MappedEntry <strong>doPostMapping</strong>(MappedEntry mappedEntry, Request.Type reqType, MappingEntry source, MappingEntry joined, HashMap&lt;String,Object&gt; environment)</p>
</div>
<div class="paragraph">
<p>The join engine passes the following parameters:</p>
</div>
<div class="paragraph">
<p><strong>mappedEntry</strong>: the result of the previous attribute and identifier mappings.</p>
</div>
<div class="paragraph">
<p><strong>reqType</strong>: the proposed request type. The attribute mapper can change it in the returned map result. Allowed types are: <em>Request.Type.ADD</em>, <em>Request.Type.MODIFY</em>, <em>Request.Type.DELETE</em>.</p>
</div>
<div class="paragraph">
<p><strong>source</strong>: the source entry, or null if no source entry exists, which occurs with validation workflows when entries at the target are found that have no corresponding source entry.</p>
</div>
<div class="paragraph">
<p><strong>joined</strong>: the joined entry, or null if no joined entry has been found.</p>
</div>
<div class="paragraph">
<p><strong>environment</strong>: a map of environment properties collected by the specific attributes taken from the affected channel, connected directory, activity and workflow entries. User hook implementations may append additional properties.</p>
</div>
<div class="paragraph">
<p>The post mapping returns the new mapped entry. Post mapping is called after all attribute mappings and the identifier mapping have been performed.</p>
</div>
<div class="paragraph">
<p>The post mapping can modify all attribute modifications, the identifier, operational attributes and the request type. The request type determines the request to be issued to the target system connector: add a new entry, modify the existing joined entry or delete the existing entry.</p>
</div>
<div class="paragraph">
<p>For details on how to handle these parameters, see the following sections:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Evaluating a Mapping Entry</p>
</li>
<li>
<p>Handling Environment Properties</p>
</li>
<li>
<p>Handling the Mapped Entry</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_deploying_the_mapping_class"><a class="anchor" href="#_ch1_deploying_the_mapping_class"></a><a class="link" href="#_ch1_deploying_the_mapping_class">1.2.2.2.4. Deploying the Mapping Class</a></h6>
<div class="paragraph">
<p>Make sure the jar file that contains your mapping class is deployed in the correct folder of your IdS-J server, which is:</p>
</div>
<div class="paragraph">
<p><em>install_path</em>*/ids-j-<strong><em>domain</em></strong>-S*<em>n</em>*/confdb/common/lib*</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_evaluating_a_mapping_entry"><a class="anchor" href="#_ch1_evaluating_a_mapping_entry"></a><a class="link" href="#_ch1_evaluating_a_mapping_entry">1.2.2.2.5. Evaluating a Mapping Entry</a></h6>
<div class="paragraph">
<p>A source or joined entry is represented as Java class <strong>com.siemens.dxm.join.map.MappingEntry</strong>. The mapping entry holds the entry&#8217;s identifier, list of attributes and operational attributes.</p>
</div>
<div class="paragraph">
<p>Read Identifier</p>
</div>
<div class="paragraph">
<p>Each entry has an identifier. It is modelled according the OASIS SPML standard. The identifier has a type (most often DN or generic string), an id value and optionally a list of identifier attributes. The following code snippet shows how to read the identifier value from the joined entry:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Identifier id = null;
String idvalue = null;

if (joined!=null)
    id = joined.getId();
if (id!=null) {
    IdentifierType type = id.getType();
    idvalue = id.getIdentifierChoice().getId();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Read Attributes from the Source or Joined Entry</p>
</div>
<div class="paragraph">
<p>Each source and joined entry contains a list of attributes, where each attribute may have a list of values. The values are typically of type string, but may sometimes also be binary. The following code snippet shows how to read the string attribute 'sn' from a source entry. Reading from the joined entry is identical.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">String srcSn;
if (source != null &amp;&amp; source.getAttrs() != null) {
    DsmlAttr srcSnAttr = (DsmlAttr) source.getAttrs().get("sn");
    if (srcSnAttr != null) {
        srcSn = srcSnAttr.getValue(0);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Reading a multi-value string attribute is almost the same. You get an array of strings:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">String[] srcDescriptions;
if (source != null &amp;&amp; source.getAttrs() != null) {
    DsmlAttr srcAttrDescription = (DsmlAttr) source.getAttrs().get("description");
    if (srcAttrDescription != null) {
        srcDescriptions = srcAttrDescription.getValue();
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following snippet shows how to get a binary value and assure the attribute&#8217;s member type base64:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// get - fictive - single-value attribute "binaryValue" from source entry
byte[] binValue = null;
if (source != null &amp;&amp; source.getAttrs() != null) {
    DsmlAttr srcBinAttr = (DsmlAttr) source.getAttrs().get("binaryValue".toLowerCase());
    if (srcBinAttr != null) {
        String memberType = srcBinAttr.getMemberType();
        if (DsmlValue.BASE64BINARY_TYPE.equalsIgnoreCase(memberType)) {
            binValue = srcBinAttr.getBinValue(0);
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note: Use lower-case notation for attribute names. When storing attributes internally in the hash map, the join engine uses the lower-case notation of the attribute name as a key.</p>
</div>
<div class="paragraph">
<p>For more details on how to handle attribute,s take a look at the Java integration framework.</p>
</div>
<div class="paragraph">
<p>Read an Operational Attribute</p>
</div>
<div class="paragraph">
<p>Reading an operational attribute from a source entry is nearly identical to reading a 'normal' attribute. Here a sample snippet for the (fictitious) attribute 'dxrPrimaryKeyOld':</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// read operational attribute "dxrPrimaryKeyOld"
String opKey = null;
if (source != null &amp;&amp; source.getOpAttrs() != null) {
    DsmlAttr srcOpAttr = (DsmlAttr) source.getOpAttrs().get("dxrPrimaryKeyOld".toLowerCase());
    if (srcOpAttr != null) {
        opKey = srcOpAttr.getValue(0);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Operational attributes, like the normal ones, can be multi-valued or binary.</p>
</div>
<div class="paragraph">
<p>Note: Use lowercase notation for attribute names. When storing attributes internally in the hash map, the join engine uses the lowercase notation of the attribute name as a key.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_handling_environment_properties"><a class="anchor" href="#_ch1_handling_environment_properties"></a><a class="link" href="#_ch1_handling_environment_properties">1.2.2.2.6. Handling Environment Properties</a></h6>
<div class="paragraph">
<p>All mapping functions have access to environment properties, which are collected from the respective configuration entries (channel, connected directory, activity, workflow) or set by a global or channel user hook.</p>
</div>
<div class="paragraph">
<p>The environment properties are simply a hash map of objects identified by their name of type String. The following snippet read the standard property "user_base":</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// read environment property "user_base"
String userBase = (String)environment.get("user_base");</code></pre>
</div>
</div>
<div class="paragraph">
<p>Setting an environment property is also as simple:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// set a custom environment property
environment.put("com.siemens.map.ldap.myEnvProperty", "someValue");</code></pre>
</div>
</div>
<div class="paragraph">
<p>In order to avoid naming collisions, we recommend that you use an adequate prefix for your property names that is analogous to the one shown in the example: com.siemens.map.ldap.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_handling_the_mapped_entry"><a class="anchor" href="#_ch1_handling_the_mapped_entry"></a><a class="link" href="#_ch1_handling_the_mapped_entry">1.2.2.2.7. Handling the Mapped Entry</a></h6>
<div class="paragraph">
<p>The mapped entry is first built up by the identifier mapping and the list of attribute mappings. After that, the join engine passes the result to the post mapping (if configured). The post mapping also has access to the source and the joined entry. It can change the complete mapping entry: the identifier, the attribute modifications, the operational attributes and the request type.</p>
</div>
<div class="paragraph">
<p>The sections Identifier Mapping and Evaluating a Mapping Entry show how to read the identifier and the source and joined entry. This section shows how to read the mapping entry and modify it.</p>
</div>
<div class="paragraph">
<p>Identifier</p>
</div>
<div class="paragraph">
<p>Reading and setting the identifier is simply realized by a getter and a setter method as the following code snippet shows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Identifier id = mappedEntry.getIdentifier();
// change the identifier ...
mappedEntry.setIdentifier(id);</code></pre>
</div>
</div>
<div class="paragraph">
<p>See the section on Identifier Mapping for information on how to work with the Identifier.</p>
</div>
<div class="paragraph">
<p>Attribute Modifications</p>
</div>
<div class="paragraph">
<p>You can read the modifications for a single attribute or get a map with the modifications of all attributes. Updating the modifications is done on a per-attribute basis as the following snippet shows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">DsmlModification[] snMods = mappedEntry.getModification("sn");
HashMap&lt;String, DsmlModification[]&gt; modMap = mappedEntry.getModifications();
snMods = modMap.get("sn");
// change the modifications for attribute "sn"
mappedEntry.updateModification(snMods);</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more details on working with modifications, see "Evaluating a Mapping Entry" and "Setting the Map Result".</p>
</div>
<div class="paragraph">
<p>Operational Attributes</p>
</div>
<div class="paragraph">
<p>Reading and modifying the operational attributes is very similar to the attribute modifications. You can either get them all as a map or read them one-by-one. Updating is done on a per-attribute basis:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">HashMap&lt;String, DsmlAttr&gt; opAttrMap = mappedEntry.getOpAttrs();
DsmlAttr myOpAttr = mappedEntry.getOpAttr("myOperationalAttribute");
myOpAttr = opAttrMap.get("myOperationalAttribute");
// change the operational attribute
mappedEntry.setOpAttr(myOpAttr);</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more details on working with operational attributes, see "Evaluating a Mapping Entry" and "Setting the Map Result".</p>
</div>
<div class="paragraph">
<p>Request Type</p>
</div>
<div class="paragraph">
<p>The post mapping can get the request type from the parameter list or read it from the mapped entry via the getter method. Updating it is done via the corresponding setter method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">mappedEntry.setRequestType(reqType);</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_setting_the_map_result"><a class="anchor" href="#_ch1_setting_the_map_result"></a><a class="link" href="#_ch1_setting_the_map_result">1.2.2.2.8. Setting the Map Result</a></h6>
<div class="paragraph">
<p>The mapping result for an attribute consists of the following items:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A list of modifications</p>
</li>
<li>
<p>A list of operational attributes</p>
</li>
<li>
<p>The request type</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Request Type</p>
</div>
<div class="paragraph">
<p>The request type determines the kind of operation to be issued at the target system connector: ADD, MODIFY or DELETE. For the list of allowed values see the static enumeration in the class <em>com.siemens.dxm.join.util.Request.</em></p>
</div>
<div class="paragraph">
<p>Initially, the join engine proposes a value:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>MODIFY, if it has found a joined entry.</p>
</li>
<li>
<p>ADD if no joined entry is found.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the mapping function, you can change the value according your needs. The following code snippet shows how to set the type to DELETED, which results in a delete request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// delete target entry, if mapped state DELETED
if (IState.DELETED.equalsIgnoreCase(tgtState)) {
    targetMapResult.setRequestType(Request.Type.DELETE);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Attribute Modifications</p>
</div>
<div class="paragraph">
<p>The mapping result contains a list of attribute modifications. Each attribute modification needs the attribute name, the modification operation (replace, delete, add) and the attribute value(s). The modifications are applied as they are, if the request is a MODIFY. In case of an ADD, the join engine transforms them to a list of attribute values; that is, it skips the operation. The mapping function does not usually need to be aware of this.</p>
</div>
<div class="paragraph">
<p>The following code snippet shows how to create a MapResult object, create one attribute modification with the attribute name and the default operation REPLACE, add an attribute value and set the new modification and a request type in the mapping result:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">MapResult targetMapResult = new MapResult();
targetMapResult.setRequestType(reqType);
DsmlModification targetMod = new DsmlModification();
targetMod.setName(tgtAttrname);
targetMod.setOperation(DsmlModificationOperationType.REPLACE);
// calculate the attribute value ...
String value = "...";
targetMod.addValue(value);
targetMapResult.addModification(targetMod);</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see from the sample, it&#8217;s even possible to add a number of modifications for the same attribute or for a list of attributes.</p>
</div>
<div class="paragraph">
<p>Operational Attributes</p>
</div>
<div class="paragraph">
<p>The mapping function may append operational attributes to the mapping result. Note that they are specific for a connector or a SPML target service. Here is a short code snippet that shows how to create an operational attribute and add it to the mapping result:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// add an operational attribute to the map result
DsmlAttr dstOpAttr = new DsmlAttr();
dstOpAttr.addValue(userBase);
dstOpAttr.setName("myOperationalAttribute");
targetMapResult.addOperationalAttr(dstOpAttr);</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_logging"><a class="anchor" href="#_ch1_logging"></a><a class="link" href="#_ch1_logging">1.2.2.2.9. Logging</a></h6>
<div class="paragraph">
<p>If you want to implement logging, you can use a log support that provides some simple log methods. The following code snippet shows how to obtain the log support and issue a debug log message:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// Obtain the Log support for your class; here "SampleMapper" +
private static final LogSupport logger = LogSupport.forName(SampleMapper.class);

// Write a debug log +
logger.debug("SampleMapper - Source Entry SN = " + srcSn);</code></pre>
</div>
</div>
<div class="paragraph">
<p>For logging messages with other levels, use the appropriate methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>error</p>
</li>
<li>
<p>warn</p>
</li>
<li>
<p>info</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The messages are written to the same files as that of the other DirX Identity components.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch1_testing_the_real_time_workflow_mapping_classes"><a class="anchor" href="#_ch1_testing_the_real_time_workflow_mapping_classes"></a><a class="link" href="#_ch1_testing_the_real_time_workflow_mapping_classes">1.2.2.3. Testing the Real-Time Workflow Mapping Classes</a></h5>
<div class="paragraph">
<p>The following sections provide information on how to develop and test your own Java mapping classes for a specific real-time workflow.</p>
</div>
<div class="sect5">
<h6 id="_ch1_about_the_mapping_test"><a class="anchor" href="#_ch1_about_the_mapping_test"></a><a class="link" href="#_ch1_about_the_mapping_test">1.2.2.3.1. About the Mapping Test</a></h6>
<div class="paragraph">
<p>The Java Eclipse Project dxmTestMapping can help you develop and test your Java mapping classes needed for a specific real-time workflow. The project is delivered on the DirX Identity DVD as a zip file and can be unpacked to any location in the file system. It has all the necessary libraries in its own subfolder and is independent of any installed DirX Identity files.</p>
</div>
<div class="paragraph">
<p>The mapping can be tested either by running the batch file runTestMapping.bat or by running the Junit-Test TestSample.java. The Junit Test is configured in build.xml, so it is run automatically by starting the build process with mkTestMapping.bat. It can also be started inside the project by configuring a Junit Test with the TestSample class.</p>
</div>
<div class="paragraph">
<p>In both cases (batch file or Junit Test), the agent framework main class AgtSessionExe is called with the configuration file src.test/confs/sample/conf.xml. The resulting trace and response files can be inspected in the src.test/confs/sample subtree.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_about_the_mapping_test_structure"><a class="anchor" href="#_ch1_about_the_mapping_test_structure"></a><a class="link" href="#_ch1_about_the_mapping_test_structure">1.2.2.3.2. About the Mapping Test Structure</a></h6>
<div class="paragraph">
<p>The Java Eclipse Project dxmTestMapping consists of the following subtrees and files:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>src.test/confs/sample/conf.xml<br>
This is a standalone agent framework job configuration file containing the mapping of several attributes for one entry including the mapping of the Java source code EmployeeTypeSource.java. This mapping is configured in the first (and only) channel of the TS-port, hence in job/port[@name='TS']/channel/mappingDefinition [XPath notation].<br>
As a controller the class EntryMappingController, which is part of the join package, is specified in conf.xml. It expects a SPML search request in the request.xml file. The search request is passed to the Identity Domain connector, which gives the search result back in domain-response.xml. The controller takes the first (and only) search result entry as the source entry, configures the mapping in the (one and only) channel of the TS-port, creates an add or mod request from the mapped entry and passes it to the TS-connector configured in the TS-port. The response of the TS-connector is passed to the configured response writer, which writes it into the response.xml file.<br>
<br>
The configured connectors are only test connectors that write their requests into files and read responses from files. The TS-connector can also be replaced by a real target system connector if that part of the process should be tested besides the mapping.</p>
</li>
<li>
<p>src.test/confs/sample/request.xml<br>
Holds the SPML search request passed to the Identity Domain connector by the EntryMappingController.</p>
</li>
<li>
<p>src.test/confs/sample/domain-response.xml<br>
Holds a search result entry taken by the EntryMappingController as the source entry when performing the mapping as configured in the channel.</p>
</li>
<li>
<p>src.test/TestSample.java<br>
The Junit test class to run the agent framework job configured in src.test/confs/sample/conf.xml</p>
</li>
<li>
<p>src/map/samplets/accounts/to/EmployeeTypeSource.java<br>
The sample Java source code, for which an attribute mapping with type javasource is configured in conf.xml.</p>
</li>
<li>
<p>src/map/samplets/accounts/to<br>
Folder containing further Java source code mapping files performing an account attribute mapping from TS to Identity.</p>
</li>
<li>
<p>src/map/samplets/accounts/from<br>
Folder for Java source code mapping files performing an account attribute mapping from TS to Identity.</p>
</li>
<li>
<p>src/map/samplets/groups/to<br>
Folder for Java source code mapping files performing a group attribute mapping from Identity to TS.</p>
</li>
<li>
<p>src/map/samplets/groups/from<br>
Folder for Java source code mapping files performing a group attribute mapping from TS to Identity.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_testing_the_ldap_channel_configuration"><a class="anchor" href="#_ch1_testing_the_ldap_channel_configuration"></a><a class="link" href="#_ch1_testing_the_ldap_channel_configuration">1.2.2.3.3. Testing the LDAP Channel Configuration</a></h6>
<div class="paragraph">
<p>After the single mappings have been tested as described, each channel as it is configured in LDAP can be tested as a whole the following way:</p>
</div>
<div class="paragraph">
<p>Go to the corresponding LDAP channel, open the Mapping page and insert a new Java source code mapping if it does not yet exist. Go to the Java source mapping LDAP object and import your tested Java source code mapping file (like the EmployeeTypeSource.java mentioned above). Repeat this for all Java source code attribute mapping files belonging to this channel and then export the resolved channel configuration into a file and copy it into the channel part of your standalone conf.xml file.</p>
</div>
<div class="paragraph">
<p>Now the standalone batch script can be run again to check whether the LDAP configuration is also correct.</p>
</div>
<div class="paragraph">
<p>The environment property source path which you can see in the conf.xml sample no longer exists in the resolved channel, because at this time the compiled code exists in the channel section. As a result, the source path where the files to be compiled can be found if no byte code exists is no longer needed.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch1_using_connector_filters"><a class="anchor" href="#_ch1_using_connector_filters"></a><a class="link" href="#_ch1_using_connector_filters">1.2.2.4. Using Connector Filters</a></h5>
<div class="paragraph">
<p>Connector filters intercept calls from the Provisioning controller (that is, the "join engine") to connectors. They see all requests to and all responses from the connector. The following figure illustrates connector filters.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch1_applsref/image17.png" alt="Connector Filters">
</div>
<div class="title">Figure 17. Connector Filters</div>
</div>
<div class="paragraph">
<p>A filter can change requests to the connector or responses from the connector, issue new requests to the connector, prohibit sending requests to the connector or even perform other tasks without the connector on the connected system. As an example, it could create or update a share on a Windows file system.</p>
</div>
<div class="paragraph">
<p>By default, DirX Identity uses a connector filter for decrypting and encrypting data, especially passwords. Other custom filters can be inserted before or after the default filter.</p>
</div>
<div class="paragraph">
<p>The connector filters are part of a chain of filters. In its <strong>doFilter()</strong> method, each filter receives the request. Usually, it checks the type of request (is it an Add, a modify, delete or search), optionally modifies it and passes it to the successor in the chain by calling its <strong>doFilter()</strong> method. This method returns the response from the successor. The filter can inspect it, modify it or do anything else. But it must return a response to its predecessor in the chain.</p>
</div>
<div class="paragraph">
<p>The framework passes the configuration options of a connector filter in its <strong>open()</strong> method. Essentially, they are a list of simple properties. The section "Configuring a Connector Filter" provides more detail.</p>
</div>
<div class="paragraph">
<p>Some filters might need to access the connected system directly and bypass the connector. In order to reduce configuration, they have access to the connector configuration, especially to address parameters and binding credentials. For this they must implement the interface <strong>ConnectorFilterConfig</strong>, through which the connector framework passes the connector configuration.</p>
</div>
<div class="sect5">
<h6 id="_ch1_configuring_a_connector_filter"><a class="anchor" href="#_ch1_configuring_a_connector_filter"></a><a class="link" href="#_ch1_configuring_a_connector_filter">1.2.2.4.1. Configuring a Connector Filter</a></h6>
<div class="paragraph">
<p>The connector filter is configured as part of the job configuration, which itself is part of an activity configuration. This section describes the XML format of the configuration that is passed to the framework. For the presentation in Identity Manager, see a filter entry beneath a port.</p>
</div>
<div class="paragraph">
<p>A job configuration contains a number of &lt;port&gt; elements. A &lt;port&gt; contains a &lt;connector&gt; and a list of &lt;filter&gt; and &lt;channel&gt; elements. A &lt;filter&gt; element represents the configuration of a connector filter.</p>
</div>
<div class="paragraph">
<p><strong>XML attributes of &lt;filter&gt;</strong>:</p>
</div>
<div class="paragraph">
<p><strong>classname:</strong>
The full class name of the connector filter Java class; mandatory.</p>
</div>
<div class="paragraph">
<p><strong>name:</strong>
An optional name of the filter.</p>
</div>
<div class="paragraph">
<p><strong>Sub-Elements of &lt;filter&gt;:</strong></p>
</div>
<div class="paragraph">
<p>A &lt;filter&gt; allows only a number of &lt;property&gt; sub-elements. Each &lt;property&gt; supports the following XML attributes:</p>
</div>
<div class="paragraph">
<p><strong>name:</strong>
The name of the configuration property; mandatory.</p>
</div>
<div class="paragraph">
<p><strong>value:</strong>
The value of the configuration property.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_deploying_a_connector_filter"><a class="anchor" href="#_ch1_deploying_a_connector_filter"></a><a class="link" href="#_ch1_deploying_a_connector_filter">1.2.2.4.2. Deploying a Connector Filter</a></h6>
<div class="paragraph">
<p>Make sure the jar file that contains your connector filter implementation is deployed in the correct folder of your IdS-J server, which is:</p>
</div>
<div class="paragraph">
<p><em>install_path</em>*/ids-j-<strong><em>domain</em></strong>-S*<em>n</em>*/confdb/common/lib*</p>
</div>
<div class="paragraph">
<p><strong>Notes</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>All dependent jar files for your connector filter must also be deployed in the above folder.</p>
</li>
<li>
<p>For a SAP ECC UM connector filter, you then need to move the files <strong>sapjco3.jar</strong>, the associated shared library (<strong>sapjco3.dll/.so</strong>) and <strong>SapUM4Role.jar</strong> from <strong>confdb/jobs/framework/lib</strong> to the above mentioned folder. Alternatively, you can just put your SAP ECC UM connector filter jar file into the folder <strong>confdb/jobs/framework/lib</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For more details on the interfaces, see the chapter on "Java Connector Integration Framework" in the <em>DirX Identity Integration Framework Guide</em>. You can also find information about reading the configuration and working with requests and responses in this guide. A sample is provided on the product DVD in the folder: <strong>Additions\SampleConnectorFilter</strong>.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch1_customizing_password_synchronization_workflows"><a class="anchor" href="#_ch1_customizing_password_synchronization_workflows"></a><a class="link" href="#_ch1_customizing_password_synchronization_workflows">1.2.3. Customizing Password Synchronization Workflows</a></h4>
<div class="paragraph">
<p>This section describes how to customize the default set of Java-based workflows provided with DirX Identity for password management with user hooks. User hooks for password synchronization controllers are based on an extended global user hook interface used in common Java-based Provisioning workflows. Currently only User Password Event Manager workflow can use a user hook. The user hook can:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Read the source password event, user entry and related account entries.</p>
</li>
<li>
<p>Skip the processing of a source password event for a user entry or for an account.</p>
</li>
<li>
<p>Gain access to the Identity store and other components via the connectors.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This section describes how to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Configure a password user hook.</p>
</li>
<li>
<p>Implement a password user hook.</p>
</li>
<li>
<p>Deploy a password user hook.</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="_ch1_configuring_a_password_user_hook"><a class="anchor" href="#_ch1_configuring_a_password_user_hook"></a><a class="link" href="#_ch1_configuring_a_password_user_hook">1.2.3.1. Configuring a Password User Hook</a></h5>
<div class="paragraph">
<p>The password user hook is configured in the XML configuration of the job for the User Password Event Manager controller, which itself is part of an activity configuration.</p>
</div>
<div class="paragraph">
<p>A job is configured as part of an activity within a &lt;workflow&gt; element. The password user hook is part of the controller configuration. The XPath expression of the corresponding XML element reads:</p>
</div>
<div class="paragraph">
<p>workflow/activities/activity[@name='&#8230;&#8203;']/job/controller/operation/user hook.</p>
</div>
<div class="paragraph">
<p>The XML attributes of the &lt;userhook&gt; element include:</p>
</div>
<div class="paragraph">
<p><strong>classname:</strong>
The full class name of your user hook Java class. It must implement the IPasswordUserHook.</p>
</div>
<div class="paragraph">
<p><strong>implementationLanguage:</strong>
Currently only the value "java" is supported. It&#8217;s also the default, if omitted.</p>
</div>
<div class="paragraph">
<p><strong>data:</strong>
The source of your user hook Java class.</p>
</div>
<div class="paragraph">
<p><strong>code:</strong>
The octets of the compiled unit. This property is loaded by the controller instead of searching a class from the class path. This property will be filled by the Identity Manager in the course of configuration.</p>
</div>
<div class="paragraph">
<p>Sub-properties of &lt;userhook&gt;:</p>
</div>
<div class="paragraph">
<p>Some properties are denoted as property sub-elements as follows: &lt;property name="&#8230;&#8203;" value="&#8230;&#8203;"/&gt;. The following properties are evaluated by the controller:</p>
</div>
<div class="paragraph">
<p><strong>sourcepath:</strong>
The full path name of the Java file that contains the source of your user hook implementation. This property is supported for local testing.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch1_implementing_a_password_user_hook"><a class="anchor" href="#_ch1_implementing_a_password_user_hook"></a><a class="link" href="#_ch1_implementing_a_password_user_hook">1.2.3.2. Implementing a Password User Hook</a></h5>
<div class="paragraph">
<p>A password user hook is called several times during execution of the workflow job. It must implement the interface <strong>com.siemens.dxm.join.api.IPasswordUserHook</strong> with the following methods:</p>
</div>
<div class="paragraph">
<p><strong>setGlobalContext</strong></p>
</div>
<div class="paragraph">
<p>With this method, the controller passes a reference to the global context. It gives access to the connectors, the configurations of the job, the controller and the user hook and to the current working directory.</p>
</div>
<div class="paragraph">
<p><strong>prolog:</strong></p>
</div>
<div class="paragraph">
<p>The prolog() method is called at the beginning of a job, before any entry is handled. It allows you to prepare a job and set any global properties into the job context.</p>
</div>
<div class="paragraph">
<p><strong>epilog:</strong></p>
</div>
<div class="paragraph">
<p>The epilog() method is called at the end of the job. It allows you to close any open resources, such as file or network handles.</p>
</div>
<div class="paragraph">
<p><strong>processPasswordEvent:</strong></p>
</div>
<div class="paragraph">
<p>The processPasswordEvent() method is called at the start of processing of an incoming JMS message that contains a password change event. It allows you to omit a password change for certain users on specific conditions.</p>
</div>
<div class="paragraph">
<p><strong>preUserPasswordUpdate:</strong></p>
</div>
<div class="paragraph">
<p>The preUserPasswordUpdate() method is called just before a real password change in the Identity store. You can stop the processing or define additional actions.</p>
</div>
<div class="paragraph">
<p><strong>postUserPasswordUpdate:</strong></p>
</div>
<div class="paragraph">
<p>The postUserPasswordUpdate() method is called after successful change of a user password in the Identity store. You can define additional actions like notifications. You can also stop further processing of the accounts.</p>
</div>
<div class="paragraph">
<p><strong>processAccountPassword</strong>:</p>
</div>
<div class="paragraph">
<p>The processAccountPassword() method is called just before a JMS notification for a setPassword workflow is sent. The method is called for all related accounts. You can prevent the workflow from sending the event and stop the processing of the account or define additional actions.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch1_deploying_a_password_user_hook"><a class="anchor" href="#_ch1_deploying_a_password_user_hook"></a><a class="link" href="#_ch1_deploying_a_password_user_hook">1.2.3.3. Deploying a Password User Hook</a></h5>
<div class="paragraph">
<p>Make sure the jar file that contains your password user hook class is deployed in the correct folder of your IdS-J Server, which is:</p>
</div>
<div class="paragraph">
<p><em>install_path</em>*/ids-j-<strong><em>domain</em></strong>-S*<em>n</em>*/confdb/common/lib*</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch1_customizing_event_based_maintenance_workflows"><a class="anchor" href="#_ch1_customizing_event_based_maintenance_workflows"></a><a class="link" href="#_ch1_customizing_event_based_maintenance_workflows">1.2.4. Customizing Event-based Maintenance Workflows</a></h4>
<div class="paragraph">
<p>All event-based maintenance workflows call a user hook during processing of the event. This action is usually performed after normal operation just before the entry is to be stored to LDAP, but might be different for certain entry types. Consult the respective description of the workflow&#8217;s operation.</p>
</div>
<div class="paragraph">
<p>A user hook is a Java class that implements the API <strong>com.siemens.idm.jobs.ebr.api.IEventProcessor</strong>. The user hook has access to the event and the changed entry. It can change the entry and perform other operations in the Identity domain using the available LDAP connection.</p>
</div>
<div class="paragraph">
<p>The following sections describe how to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Implement the user hook</p>
</li>
<li>
<p>Configure the user hook</p>
</li>
<li>
<p>Use event contexts</p>
</li>
<li>
<p>Deploy the user hook</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For a sample, see the folder <strong>Additions/EventMaintenanceWorkflows</strong> on the installation DVD.</p>
</div>
<div class="sect4">
<h5 id="_ch1_configuring_a_user_hook_for_an_event_based_maintenance_workflow"><a class="anchor" href="#_ch1_configuring_a_user_hook_for_an_event_based_maintenance_workflow"></a><a class="link" href="#_ch1_configuring_a_user_hook_for_an_event_based_maintenance_workflow">1.2.4.1. Configuring a User Hook for an Event-based Maintenance Workflow</a></h5>
<div class="paragraph">
<p>This section explains how to configure a user hook for an event-based maintenance workflow.</p>
</div>
<div class="paragraph">
<p>You configure a user hook in the "join" activity of the workflow. You must supply the class name and optionally also configuration options. Enter these values in the activity&#8217;s Userhook tab. The following figure shows this tab:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch1_applsref/image18.png" alt="Userhook Tab">
</div>
<div class="title">Figure 18. Userhook Tab</div>
</div>
<div class="paragraph">
<p>Enter the full class name of your implementation into <strong>Userhook Classname</strong>. This value indicates to the workflow that a user hook is to be called.</p>
</div>
<div class="paragraph">
<p>If the user hook expects configuration options, enter them in the <strong>Options</strong> table:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <strong>Property Name</strong> column contains the name of the option as the user hook expects it.</p>
</li>
<li>
<p>The <strong>Value</strong> column contains the string value of the option.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The workflow passes the configuration with the <em>open</em> method. See the implementation section for a snippet how to read the options in your user hook.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch1_implementing_a_user_hook_for_an_event_based_maintenance_workflow"><a class="anchor" href="#_ch1_implementing_a_user_hook_for_an_event_based_maintenance_workflow"></a><a class="link" href="#_ch1_implementing_a_user_hook_for_an_event_based_maintenance_workflow">1.2.4.2. Implementing a User Hook for an Event-based Maintenance Workflow</a></h5>
<div class="paragraph">
<p>The event maintenance workflow calls the user hook typically after it has performed the standard operations just before it stores the entry changes. The user hook implements the interface <strong>com.siemens.idm.jobs.ebr.api.IEventProcessor</strong> with the following operations:</p>
</div>
<div class="paragraph">
<p><strong>setEventContext</strong>:</p>
</div>
<div class="paragraph">
<p>This is the first method the workflow calls after instantiating the user hook. In addition to the LDAP connection to the domain, the event context provides some useful methods for reading and searching one or more entries. See "Using Event Contexts" for more details.</p>
</div>
<div class="paragraph">
<p><strong>open(DxmUserhookConfig conf)</strong></p>
</div>
<div class="paragraph">
<p>With this method the workflow passes the configuration options for the user hook before any of the events is processed.</p>
</div>
<div class="paragraph">
<p>The only parameter is the user hook configuration implementing the interface <strong>siemens.dxm.configuration.DxmUserhookConfig</strong>. In addition to some meta information important for the workflow it allows to read configuration properties with its <strong>getProperty</strong> method. The following snippet shows how to read an option "objectclass":</p>
</div>
<div class="paragraph">
<p>Map&lt;String, String&gt; options = new HashMap&lt;String, String&gt;();<br>
options.put("objectclass", (String)conf.getProperty("objectclass"));</p>
</div>
<div class="paragraph">
<p><strong>processAddEvent(AddEvent event, Entry changedEntry)</strong></p>
</div>
<div class="paragraph">
<p>The workflow calls this method, when the entry was created in the Identity domain. It passes the created entry and the add event.</p>
</div>
<div class="paragraph">
<p>Each entry implements the interface <strong>com.siemens.dxm.api.entry.Entry</strong>. This interface allows getting and set attribute values and especially the DN of the LDAP entry. The <strong>siemens.dxm.connector.event.AddEvent</strong> class is generated according an XML schema, which extends a SPMLv1 request with some information about the event topic and the event source. The following snippet shows how to read the values of the attribute "owner" and to set one, if it was empty before:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">String[] values = changedEntry.getValues("owner");
if ((values == null) || (values.length == 0)) {
    changedEntry.setProperty("owner", "cn=DefaultOwner,cn=Users," + eventCtx.getDomainRoot());
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that you shouldn&#8217;t store the entry changes yourself. This is done by the workflow at the end of the event processing, if the entry was changed. But if you change other entries, you need to store them yourself. See "Using Event Contexts" how to do this.</p>
</div>
<div class="paragraph">
<p><strong>processModifyEvent(ModifyEvent event, Entry changedEntry)</strong></p>
</div>
<div class="paragraph">
<p>The workflow calls this method when the entry was changed in the Identity domain. It passes the changed entry and the modify event.</p>
</div>
<div class="paragraph">
<p>Each entry implements the interface <strong>com.siemens.dxm.api.entry.Entry</strong>. This interface allows getting and set attribute values and especially the DN of the LDAP entry. The <strong>siemens.dxm.connector.event.ModifyEvent</strong> class is generated according an XML schema, which extends a SPMLv1 request with some information about the event topic and the event source. The following snippet shows how to check, if the attribute "dxrState" was modified to the value "TBDEL", i.e. if the entry is to be deleted in the connected system:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">for (DsmlModification mod : event.getModifications().getModification()) {
    if ("dxrState".equalsIgnoreCase(mod.getName()) &amp;&amp; ("TBDEL".equalsIgnoreCase(mod.getValue(0)) {
        entryDeleted = true;
        break;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that you shouldn&#8217;t store the entry changes yourself. This is done by the workflow at the end of the event processing, if the entry was changed. But if you change other entries, you need to store them yourself. See "Using Event Contexts" how to do this.</p>
</div>
<div class="paragraph">
<p><strong>processDeleteEvent(DeleteEvent event)</strong></p>
</div>
<div class="paragraph">
<p>The workflow calls this method, when the entry was deleted in the Identity domain. It passes only the delete event as the entry itself is not available any more.</p>
</div>
<div class="paragraph">
<p>The <strong>siemens.dxm.connector.event.DeleteEvent</strong> class is generated according an XML schema. In addition to the event topic and the event source the embedded SPMLv1 delete request contains the DN of the deleted entry. See the following snippet how to read the DN:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">String dn = SpmlUtils.getIdString(event);</code></pre>
</div>
</div>
<div class="paragraph">
<p>This allows you to search for other entries referencing the deleted one and perform some cleanup.</p>
</div>
<div class="paragraph">
<p><strong>close()</strong>:</p>
</div>
<div class="paragraph">
<p>The workflow calls this method after all entries of the batch are processed. It allows the user hook to perform some housekeeping.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch1_using_event_contexts"><a class="anchor" href="#_ch1_using_event_contexts"></a><a class="link" href="#_ch1_using_event_contexts">1.2.4.3. Using Event Contexts</a></h5>
<div class="paragraph">
<p>A user hook for an event-based maintenance workflow may use an event context object. An event context implements the interface <strong>com.siemens.idm.jobs.ebr.api.EventContext*<em>.</em> It is passed in the method *setEventContext</strong> of the <strong>IEventProcessor</strong> interface.</p>
</div>
<div class="paragraph">
<p>The event context provides some useful helper methods:</p>
</div>
<div class="paragraph">
<p><strong>getDomainRoot()</strong></p>
</div>
<div class="paragraph">
<p>Returns the DN of the Identity domain root node.</p>
</div>
<div class="paragraph">
<p><strong>getLDAPConnection()</strong></p>
</div>
<div class="paragraph">
<p>Returns an established LDAP connection to the Identity domain.</p>
</div>
<div class="paragraph">
<p><strong>getEntry(String dn)</strong></p>
</div>
<div class="paragraph">
<p>Reads the entry with the given DN from the Identity domain. It returns an object, which implements the <strong>com.siemens.dxm.api.entry.Entry</strong> API. This API allows reading and setting attributes.</p>
</div>
<div class="paragraph">
<p><strong>searchEntries(String base, String filter)</strong></p>
</div>
<div class="paragraph">
<p>Performs an LDAP search in the Identity domain with the given search base and filter. The method returns the found entries as an enumeration. Each entry implements the <strong>com.siemens.dxm.api.entry.Entry</strong> API.</p>
</div>
<div class="paragraph">
<p><strong>saveEntry(Entry entry)</strong></p>
</div>
<div class="paragraph">
<p>Stores the entry in the Identity domain.</p>
</div>
<div class="paragraph">
<p>Note that the user hook should not store the entry referenced in the change event, but needs to store all others it has changed.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch1_deploying_a_user_hook_for_an_event_based_maintenance_workflow"><a class="anchor" href="#_ch1_deploying_a_user_hook_for_an_event_based_maintenance_workflow"></a><a class="link" href="#_ch1_deploying_a_user_hook_for_an_event_based_maintenance_workflow">1.2.4.4. Deploying a User Hook for an Event-based Maintenance Workflow</a></h5>
<div class="paragraph">
<p>To deploy your user hook, build a jar file with your class and copy this file and any other jar files you need to the following folder of your Java-based Server installation:</p>
</div>
<div class="paragraph">
<p><em>install_path</em>*/ids-j-<strong><em>domain</em></strong>-S*<em>n</em>*/confdb/common/lib*</p>
</div>
<div class="paragraph">
<p>Make sure the user hook is configured and then re-start the IdS-J server.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch1_using_combined_workflows"><a class="anchor" href="#_ch1_using_combined_workflows"></a><a class="link" href="#_ch1_using_combined_workflows">1.2.5. Using Combined Workflows</a></h4>
<div class="paragraph">
<p>You can combine a set of Java-based workflows into a "combined workflow" and define the sequence in which these workflows should be run. Note that you cannot combine entry change workflows, cluster workflows and combined workflows.</p>
</div>
<div class="paragraph">
<p>For a combined workflow, you select a sequence of workflows. All activities of the selected workflows are copied into the combined workflow (the referenced workflow is only referenced, not changed). Start conditions are adapted so that the activities are started in the defined sequence.</p>
</div>
<div class="paragraph">
<p>The activities are named <em>worklow_name</em>*-<strong><em>join</em></strong>-*<em>sequence<strong>-</strong>nr</em>.Activity <em>n</em>+1 is started after activity <em>n</em> has finished.</p>
</div>
<div class="paragraph">
<p>For every workflow that is included in the combined workflow, you can also define whether or not it should stop if the preceding workflow or activity finishes with the state WARNING.</p>
</div>
<div class="paragraph">
<p>To create a combined workflow, use the New menu and select <strong>Combined</strong> <strong>Realtime</strong> <strong>Workflow</strong>.In the Workflow Sequence tab, insert the workflows in the order you want to run them.</p>
</div>
<div class="paragraph">
<p>You can start a combined workflow with the DirX Identity Manager by using Run workflow from the context menu at the combined workflow object or you can define a schedule for the combined workflow.</p>
</div>
<div class="paragraph">
<p>Using a combined workflow (instead of scheduling each workflow separately with a given start time) guarantees that the workflows are started in sequence one after the other and ensures that there are no overlays or gaps between the workflows.For example, you can define a combined workflow that first performs a source import from a database, next performs a source import from SAP and then performs user resolution for these imported users.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_understanding_tcl_based_workflows"><a class="anchor" href="#_understanding_tcl_based_workflows"></a><a class="link" href="#_understanding_tcl_based_workflows">1.3. Understanding Tcl-based Workflows</a></h3>
<div class="paragraph">
<p>The sections in this chapter include information about Tcl-based workflows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Tcl-based Connectivity architecture - defines the concepts of the DirX Identity Tcl-based workflows</p>
</li>
<li>
<p>Understanding server delta handling</p>
</li>
<li>
<p>Customizing Tcl-based workflows - describes customization procedures and hints.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_ch1_tcl_based_connectivity_architecture"><a class="anchor" href="#_ch1_tcl_based_connectivity_architecture"></a><a class="link" href="#_ch1_tcl_based_connectivity_architecture">1.3.1. Tcl-based Connectivity Architecture</a></h4>
<div class="paragraph">
<p>The Tcl-based connectivity architecture is based on a standard script that is designed to handle all transfers between two connected directories in one step.For two-step workflows (which require an additional agent to access the target connected directoryâs API), the standard script handles the meta controller (<strong>metacp</strong>) step.</p>
</div>
<div class="paragraph">
<p>The connectivity standard script can be controlled by about 60 parameters and also by optional user hook routines. It is structured into the following logical sections:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A <strong>control script</strong>, which defines all parameters, including the default values and references to the relevant attributes at the user interface (DirX Identity Manager) level.</p>
</li>
<li>
<p>A <strong>profile script</strong>, which contains the central algorithm for the connectivity script.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The profile script is divided into the following logical sections:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <strong>prolog section</strong>, which performs preparatory tasks before the loop section is executed, such as opening input and output connections, reading attribute configuration files, and so on.</p>
</li>
<li>
<p>The <strong>loop section</strong>, which performs, for each entry in the source, all of the necessary actions: mapping, joining, operation on the target system side, and so on. This section is the most complex, because it can handle file and LDAP connections and contains most of the script&#8217;s functionality and features.</p>
</li>
<li>
<p>The <strong>epilog section</strong>, which performs all completion tasks, such as releasing handles and closing connections.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>All of the parameters that control the script are accessible from Identity Manager. They are distributed into the relevant tabs of the job, channel and connected directory configuration objects, which can be referenced from the relevant wizards.</p>
</div>
<div class="paragraph">
<p>The script&#8217;s design is based on the following requirements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>One script for all applications</p>
</li>
<li>
<p>Controllable by switches and user hooks</p>
</li>
<li>
<p>Clear separation between central, local and user parts</p>
</li>
<li>
<p>Clear separation between entry masters and attribute masters. An entry master can add and delete entries, while an attribute master can only perform attribute modifications.</p>
</li>
<li>
<p>Handling of multi-entry and attribute masters</p>
</li>
<li>
<p>Support of manual masters (such as Web interfaces)</p>
</li>
<li>
<p>Support of purification workflows (for example, the deletion of entries marked for deletion).<br>
Note: This version does not implement this feature.</p>
</li>
<li>
<p>Support of operational attributes (mastership, status, entry and expiration dates)</p>
</li>
<li>
<p>Enhanced tracing (an additional command trace)</p>
</li>
<li>
<p>Delta handling based on date type</p>
</li>
<li>
<p>Tuning parameters (Read DN Only, paged mode)</p>
</li>
<li>
<p>Support of merge and replace modes</p>
</li>
<li>
<p>Standard handling of notifications</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The script can handle the following types of synchronizations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>File to file</p>
</li>
<li>
<p>LDAP to file</p>
</li>
<li>
<p>File to LDAP</p>
</li>
<li>
<p>LDAP to LDAP</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>With extra profile scripts, it can handle DirX change log information and HDMS connections.</p>
</div>
<div class="paragraph">
<p>All LDAP connections can work optionally in paged mode.</p>
</div>
<div class="paragraph">
<p>The next sections provide information about:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The script structure</p>
</li>
<li>
<p>The script behavior</p>
</li>
<li>
<p>The switches and parameters that control the script</p>
</li>
<li>
<p>References used in default applications</p>
</li>
<li>
<p>Object class handling</p>
</li>
<li>
<p>The GUID generator</p>
</li>
<li>
<p>Multi-mastered attributes</p>
</li>
<li>
<p>Naming and scopes</p>
</li>
<li>
<p>User hook routines</p>
</li>
<li>
<p>Important Tcl interfaces</p>
</li>
<li>
<p>Global Tcl variables</p>
</li>
<li>
<p>Meta handles</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="_ch1_connectivity_standard_script_structure"><a class="anchor" href="#_ch1_connectivity_standard_script_structure"></a><a class="link" href="#_ch1_connectivity_standard_script_structure">1.3.1.1. Connectivity Standard Script Structure</a></h5>
<div class="paragraph">
<p>The Connectivity standard script consists of logical pieces that are stored in specific physical locations in the installation area or the configuration database. The following sections describe the script&#8217;s logical structure and use an example to illustrate its physical structure.</p>
</div>
<div class="sect5">
<h6 id="_ch1_connectivity_standard_script_logical_structure"><a class="anchor" href="#_ch1_connectivity_standard_script_logical_structure"></a><a class="link" href="#_ch1_connectivity_standard_script_logical_structure">1.3.1.1.1. Connectivity Standard Script Logical Structure</a></h6>
<div class="paragraph">
<p>The following figure illustrates the logical structure of the DirX Identity Connectivity standard script.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch1_applsref/image19.png" alt="DirX Identity Connectivity Script Logical Structure">
</div>
<div class="title">Figure 19. DirX Identity Connectivity Script Logical Structure</div>
</div>
<div class="paragraph">
<p>The <strong>control script</strong> is the script that starts the whole procedure. It contains all of the variables that control the rest of the procedure. The values of these variables are linked by DirX Identity references to the attributes of objects in the configuration directory. It also loads the central routines from the installation area and the profile, mapping and miscellaneous scripts from the job object.</p>
</div>
<div class="paragraph">
<p>The control script calls the <strong>profile script</strong>, which performs the central algorithm. Different profile scripts are delivered to provide different basic algorithms. Most workflows use the standard script <strong>Profile Script</strong>, while others use the <strong>HDMS Export Profile Script</strong> or the <strong>LDIF Change Profile Script</strong>.</p>
</div>
<div class="paragraph">
<p>One of the most important parts of this algorithm - the <strong>mapping script</strong> - must be highly configurable, since it is individual to each workflow. The script is divided into a mapping that occurs before the join operation and a <strong>post join mapping</strong> that occurs after the join operation.</p>
</div>
<div class="paragraph">
<p>All scripts can call common routines provided by the <strong>central script</strong> (routines that are common to any workflow) and the <strong>common script</strong> (routines that are used by this type of workflow).</p>
</div>
<div class="paragraph">
<p>The profile script calls local routines (hooks). Default routines for these hooks are loaded with the <strong>user hooks default script</strong>. You can establish your own extensions by providing routines in the <strong>user hooks script</strong> (they will overload the default routines).</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_connectivity_standard_script_physical_structure"><a class="anchor" href="#_ch1_connectivity_standard_script_physical_structure"></a><a class="link" href="#_ch1_connectivity_standard_script_physical_structure">1.3.1.1.2. Connectivity Standard Script Physical Structure</a></h6>
<div class="paragraph">
<p>We&#8217;ll use an example to explain the physical structure of the Connectivity standard script and its relationship to other objects in the configuration database and the installation area. The following figure illustrates this example.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch1_applsref/image20.png" alt="DirX Identity Connectivity Script Physical Structure">
</div>
<div class="title">Figure 20. DirX Identity Connectivity Script Physical Structure</div>
</div>
<div class="paragraph">
<p>The <strong>job MyMetaCPjob</strong> references the <strong>MetaCP agent</strong> that is of <strong>type Meta Controller</strong>, which is described by the "Meta Controller-Job.xml" definition. The job also relates to channels (here <strong>Channel 1</strong>) that access the LDAP directory (for example, <strong>MetaStore</strong>), which is of <strong>type LDAP</strong> and is described by the "LDAP-ConnDir.xml" definition.</p>
</div>
<div class="paragraph">
<p>The <strong>mapping script</strong> and the <strong>user hooks script</strong> are local objects of the workflow. They are downloaded to the work area before each workflow run. Only some of the default application workflows initially contain a user hooks script (for example the RACF workflows).</p>
</div>
<div class="paragraph">
<p>The <strong>central script</strong>, the <strong>common script</strong>, the <strong>post join default script</strong> and the <strong>user hooks default script</strong> (a template) are located in the installation area of DirX Identity (path: <em>install_path</em>*\lib\centralTcl*). They are part of the installation and will not be downloaded before each workflow run. Because the common script&#8217;s size is more than 130 KB, this saves time. For information purposes, a copy of these scripts is shown at the user interface level in the configuration database.</p>
</div>
<div class="paragraph">
<p>Please note that changing these script copies has no effect! You should instead copy the user hooks default script as an individual <strong>user hooks script</strong> or <strong>post join script</strong> under your job object (donât forget to link it to the job) and modify the routines as required. This user hooks script and all of the other miscellaneous scripts will be downloaded before each workflow run.</p>
</div>
<div class="paragraph">
<p>The <strong>control</strong>, <strong>profile,</strong> <strong>common</strong>, <strong>post join default script</strong> and <strong>user hooks default scripts</strong> (together with the <strong>messages script</strong> that contains all messages) are located in the central configuration area in the section <strong>Tcl</strong> &#8594; <strong>Default</strong>. Only the control, profile and messages scripts will also be downloaded before each workflow run.</p>
</div>
<div class="paragraph">
<p><strong>Warning:</strong> You are not allowed to change the central or common scripts (because any changes will be overwritten during update and upgrade installations!). Instead, you can copy a routine youâd like to change to your local user hooks script. This routine overloads the routine from the central script. The advantage of this method is that you can view all of your changes in one place and that an exchange or update of central script will not affect your workflow at all.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch1_provisioning_workflow_script_structure"><a class="anchor" href="#_ch1_provisioning_workflow_script_structure"></a><a class="link" href="#_ch1_provisioning_workflow_script_structure">1.3.1.2. Provisioning Workflow Script Structure</a></h5>
<div class="paragraph">
<p>The DirX Identity Provisioning workflows use the default DirX Identity Connectivity standard script structure. The following figure illustrates how the DirX Identity Provisioning script structure is embedded in the DirX Identity Connectivity script structure.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch1_applsref/image21.png" alt="DirX Identity Provisioning and Connectivity Script Structure">
</div>
<div class="title">Figure 21. DirX Identity Provisioning and Connectivity Script Structure</div>
</div>
<div class="paragraph">
<p>The left two columns of the figure represent the default DirX Identity Connectivity script structure. The DirX Identity <strong>metacp</strong> scripts (mapping, post-join mapping, and user hooks) call functions in the DirX Identity <strong>provisioning</strong> <strong>common script</strong> and the <strong>provisioning</strong> <em>TS</em> <strong>common script</strong>. The following figure illustrates these interactions in more detail.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch1_applsref/image22.png" alt="DirX Identity Connectivity and Provisioning Script Function Calls">
</div>
<div class="title">Figure 22. DirX Identity Connectivity and Provisioning Script Function Calls</div>
</div>
<div class="paragraph">
<p>The provisioning <em>TS</em> common script functions include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>accountEnabled()</strong><br>
Checks whether the account is enabled or disabled in the target system depending on the passed target system attribute(s), and sets the passed variable AccEnabled to TRUE or FALSE.</p>
</li>
<li>
<p><strong>setPasswordFlags()</strong><br>
Sets the password-specific flags of an account in a role depending on the passed target system attribute(s).</p>
</li>
<li>
<p><strong>splitLocalRemoteMembers()</strong><br>
Divides the list of the target system group members into local members, which are all members that belong to the target systems users or group root, and remote members, which are outside these roots.</p>
</li>
<li>
<p><strong>setGroupType()</strong><br>
Sets the group type attribute in a role depending on the passed target system attribute.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The Provisioning common script functions include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>addAccountInRole()</strong><br>
Sets the dxrTSState attribute of the account in a role to DISABLED or ENABLED depending on the passed AccEnabled parameter. Sets the dxrState attribute to IMPORTED and the dxrToDo attribute to CREATED_IN_TS for a validation workflow.</p>
</li>
<li>
<p><strong>modAccountInRole()</strong><br>
Sets the dxrTSState attribute of the account in a role to DISABLED or ENABLED depending on the passed AccEnabled parameter. The function leaves the dxrState attribute as it is and sets the dxrToDo attribute to RECREATED_IN_TS for a validation workflow if dxrState was in the state DELETED.</p>
</li>
<li>
<p><strong>addGroupInRole()</strong><br>
Sets the dxrTSState and the dxrState attribute of the group in a role to ENABLED. Sets the dxrTSLocal attribute to TRUE and the dxrToDo attribute to CREATED_IN_TS in case of a validation workflow. Sets dxrGroupMemberImported to the local members of the target system, which were calculated by the splitLocalRemoteMembers function.</p>
</li>
<li>
<p><strong>modGroupInRole()</strong><br>
Sets the dxrTSState attribute of the group in a role to ENABLED. The function leaves the dxrState, dxrTSLocal and dxrToDo attributes as they are and sets the group member attributes according to the passed list of local target system group members and of the actual group member states in role.</p>
</li>
<li>
<p><strong>postJoinAddAccInTS()</strong><br>
Depending on the account attributes in a role, calls the following functions of the postJoinMapping script of the sync account job, which perform the target system specific attribute settings:</p>
</li>
<li>
<p>setAccEnabled() if the accounts dxrState in role is ENABLED</p>
</li>
<li>
<p>setAccDisabled() if the accounts dxrState in role is DISABLED</p>
</li>
<li>
<p>setPassword()</p>
</li>
<li>
<p>resetPwdNotRequired()</p>
</li>
<li>
<p>setChgPwdAtLogin()</p>
</li>
<li>
<p>resetPwdCantChange()</p>
</li>
<li>
<p>setPwdNeverExpires() if dxrPwdNeverExpires in role is TRUE</p>
</li>
<li>
<p>resetPwdNeverExpires() if dxrPwdNeverExpires in role is FALSE</p>
</li>
<li>
<p><strong>postJoinModAccInTS()</strong><br>
Depending on the account attributes in a role, calls the following functions of the postJoinMapping script of the sync account job, which perform the target system-specific attribute settings:</p>
</li>
<li>
<p>setAccEnabled() if the accounts dxrState in role is ENABLED</p>
</li>
<li>
<p>setAccDisabled() if the accounts dxrState in role is DISABLED</p>
</li>
<li>
<p>deletePassword()</p>
</li>
<li>
<p>setPwdNotRequired() if dxrPwdNotRequired in role is TRUE</p>
</li>
<li>
<p>resetPwdNotRequired() if dxrPwdNotRequired in role is FALSE</p>
</li>
<li>
<p>setPwdCantChange() if dxrPwdCantChange in role is TRUE</p>
</li>
<li>
<p>resetPwdCantChange() if dxrPwdCantChange in role is FALSE</p>
</li>
<li>
<p>setPwdNeverExpires() if dxrPwdNeverExpires in role is TRUE</p>
</li>
<li>
<p>resetPwdNeverExpires() if dxrPwdNeverExpires in role is FALSE</p>
</li>
<li>
<p><strong>postJoinDelAccInTS()</strong><br>
This function currently does nothing. In the future, it may contain common coding for all target system workflows.</p>
</li>
<li>
<p><strong>postJoinAddGrpInTS()</strong><br>
This function currently does nothing. In the future, it may contain common coding for all target system workflows.</p>
</li>
<li>
<p><strong>postJoinModGrpInTS()</strong><br>
This function currently does nothing. In the future, it may contain common coding for all target system workflows.</p>
</li>
<li>
<p><strong>postJoinDelGrpInTS()</strong><br>
This function currently does nothing. In the future, it may contain common coding for all target system workflows.</p>
</li>
<li>
<p><strong>setTSAttributesInRole()</strong><br>
For a validation workflow, sets the dxrLastValidation attribute of the target system object in a role to the current time and the accountRootInTS and groupRootInTS attributes of the target system object in a role to the values passed to the function.</p>
</li>
<li>
<p><strong>del_TS2Role()</strong><br>
Called only in the validation workflow for all objects in a <strong>metacp</strong> search result that cannot be matched to any source entry in order to either delete or modify the object. The function deletes the object in a role if the dxrState attribute of the object is set to DELETED; otherwise, it sets the dxrTSState attribute to DELETED and writes a dxrToDo message.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch1_connectivity_standard_script_operation"><a class="anchor" href="#_ch1_connectivity_standard_script_operation"></a><a class="link" href="#_ch1_connectivity_standard_script_operation">1.3.1.3. Connectivity Standard Script Operation</a></h5>
<div class="paragraph">
<p>The meta controller is called with the control script as a parameter (see the command line attribute of the job). The next sections describe how the control and profile scripts operate.</p>
</div>
<div class="sect5">
<h6 id="_ch1_control_script_operation"><a class="anchor" href="#_ch1_control_script_operation"></a><a class="link" href="#_ch1_control_script_operation">1.3.1.3.1. Control Script Operation</a></h6>
<div class="paragraph">
<p>The Connectivity standard script&#8217;s control script contains all of the variable settings; that is, constants or references to attributes of other objects in the configuration database. These variable settings are grouped into the following sections:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Common parameters <strong>-</strong> basic parameters needed for the other sections (for example, the role names of the input and output channels).</p>
</li>
<li>
<p>GUID generator parameters - parameters that control the generation of global unique identifiers.</p>
</li>
<li>
<p>Common job-specific parameters - parameters that belong to the job: tracing, operation control, notification and data control.</p>
</li>
<li>
<p>Source parameters - parameters that control the source connected directory and its channel.</p>
</li>
<li>
<p>Target parameters - parameters that control the target connected directory and its channel.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The control script loads the standard scripts in the following sequence:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Loads the <strong>central.tcl</strong> script with the <strong>source</strong> command. This script contains important routines like <strong>dxm_source</strong> that are necessary to load scripts with another code set.</p>
</li>
<li>
<p>Reads <strong>user_hooks_default.tcl</strong>, which contains all relevant empty user hook routines. This action pre-defines these routines.</p>
</li>
<li>
<p>Reads the <strong>mapping script</strong>.</p>
</li>
<li>
<p>Uses a loop to load all miscellaneous scripts, including the <strong>user_hooks.tcl</strong> script if it is defined by the user and any other routines needed for the job. Note: Scripts that cannot be edited are not loaded (the common script is an example).</p>
</li>
<li>
<p>Reads the <strong>profile script</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The control script&#8217;s loading logic relies on Tcl&#8217;s routine overloading mechanism, in which the last loaded routine is used.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_profile_script_operation"><a class="anchor" href="#_ch1_profile_script_operation"></a><a class="link" href="#_ch1_profile_script_operation">1.3.1.3.2. Profile Script Operation</a></h6>
<div class="paragraph">
<p>The control flow for the standard script consists of several steps. The <strong>prolog</strong> step prepares all of the necessary prerequisites. The <strong>process entry loop</strong> reads entries from the source, maps the entries, then joins the mapped entries and writes them to the target. The <strong>epilog</strong> step closes all channels and handles and performs notifications if necessary.</p>
</div>
<div class="paragraph">
<p>The profile script contains only the main logic. All detailed routines are contained in the common script or the central script. The following figure illustrates the profile script algorithm.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch1_applsref/image23.png" alt="Profile Script Algorithm">
</div>
<div class="title">Figure 23. Profile Script Algorithm</div>
</div>
<div class="paragraph">
<p><strong>Profile Script - Prolog</strong></p>
</div>
<div class="paragraph">
<p>The prolog step performs the following tasks:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Initializes the meta controller.</p>
</li>
<li>
<p>Sets all necessary default values.</p>
</li>
<li>
<p>Calls the <strong>uh::Preprocessing</strong> user hook, which prepares everything before the rest of the script logic is executed. Note: no handles are available at this point.</p>
</li>
<li>
<p>Opens connections to the source and target connected directories and creates handles for them. This task consists of the following sub-tasks:</p>
</li>
<li>
<p>Reading the attribute configurations (variables: <strong>File Name</strong> and <strong>Encoding</strong>).</p>
</li>
<li>
<p>Performing a bind if Directory Type = LDAP (variables: <strong>Server Address, Protocol, User, Password, SSL Connection, Authentication, Protocol</strong>).</p>
</li>
<li>
<p>Opening a file if Directory Type = File (variables: <strong>File Name, File Format, File Mode, Encoding</strong>).</p>
</li>
<li>
<p>Creating the necessary handles for the source and target connection.</p>
</li>
<li>
<p>Creating a second handle for the input channel, if <strong>Read DN Only</strong> is set.</p>
</li>
<li>
<p>Defining <strong>Page Size</strong> to allow page mode operation if <strong>Paged Read</strong> is set.</p>
</li>
<li>
<p>Reads the source (variables: <strong>Base Object</strong> and <strong>Subset</strong> both from the input channel as well as a <strong>Search</strong> and <strong>OR</strong> <strong>Filter</strong>) and eventually sort it (if <strong>Sorted List</strong> = true together with <strong>Sort Key</strong> and <strong>Sort Order</strong>). This is only necessary when the search result is not sorted and a sorted result is necessary. If <strong>Paged Read</strong> is set <strong>Page Size</strong> must be defined to allow page mode operation.</p>
</li>
<li>
<p>If the workflow shall replace all entries in the target; that is, if a deletion of entries that are no longer available compared to the source is necessary, a full target search (variables: <strong>Base Object</strong>, <strong>Subset</strong> both from the output channel as well as the <strong>Replace Filter</strong>) with a subsequent sort is required (variables: <strong>Sorted List</strong> = true together with <strong>Sort Key</strong> and <strong>Sort Order</strong>). The result must be sorted because the <strong>Sort Key</strong> is used for the find operation later on in the join operation.</p>
</li>
<li>
<p>Calls the <strong>uh::Prolog</strong> user hook.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Now the source and target are prepared. Next, the loop on all entries must be performed.</p>
</div>
<div class="paragraph">
<p><strong>Profile Script - Process Entry Loop</strong></p>
</div>
<div class="paragraph">
<p>The profile script&#8217;s standard entry processing loop (used by the <strong>profile.tcl</strong> script) performs the following tasks:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Reads an entry from the source.</p>
</li>
<li>
<p>Initializes the target entry (sets all fields to initial values).</p>
</li>
<li>
<p>Optionally applies an extra filter during the user hook <strong>uh::LoopExtraFilter</strong>. This filter allows the individual exclusion of entries from further actions.</p>
</li>
<li>
<p>Performs the mapping (subroutine <strong>perform_mapping</strong>). This routine delivers the return code <strong>0</strong> for OK and <strong>1</strong> for errors that occurred.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The sequence of steps is different depending on the <strong>Directory Type</strong>.</p>
</div>
<div class="paragraph">
<p>If <strong>Directory Type = LDAP</strong>, the following steps are performed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If <strong>Import Mode = Merge</strong>, a search based on the <strong>Join Expression</strong> or <strong>Expert Filter</strong> is performed in the target directory. In this case a list of searches can be performed.</p>
</li>
<li>
<p>If <strong>Import Mode = Replace</strong>, the object is retrieved from the existing (and sorted) search result.</p>
</li>
<li>
<p>Depending on the result, an action is calculated (see the subroutine <strong>Calculate Action</strong>).</p>
</li>
<li>
<p>After calculating the action, a postJoin routine (<strong>uh::LoopPostJoin</strong>) performs an additional mapping step that merges information from the joined entry with the mapped information.</p>
</li>
<li>
<p>Depending on the calculated action and the join result, the <strong>Entry Handling</strong> subroutine is called. The possible actions are:</p>
</li>
<li>
<p><strong>action = add</strong><br>
A new entry will be created.</p>
</li>
<li>
<p><strong>action = mod</strong><br>
The located entry is to be modified.</p>
</li>
<li>
<p><strong>action = modDN</strong><br>
The distinguished name (DN) of the located entry will be modified.</p>
</li>
<li>
<p><strong>action = del</strong><br>
A delete operation will be performed for this entry depending on the selected deletion mode (see the deletion algorithm ). The user hook <strong>uh::Delete</strong> is eventually called.</p>
</li>
<li>
<p><strong>action = done</strong><br>
The action to be taken has already been carried out. No action is necessary.</p>
</li>
<li>
<p><strong>action = error</strong><br>
An error must be reported because something was incorrect. This action will result in a warning at the workflow level.</p>
</li>
<li>
<p>An extra function can be optionally executed (<strong>uh::LoopExtraFunction</strong>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If <strong>Directory Type = FILE</strong>, similar procedures are called:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A user-specific join routine can be performed (<strong>uh::LoopPerformJoin</strong>).</p>
</li>
<li>
<p>Depending on the result, an action is calculated (see the <strong>Calculate Action</strong> subroutine).</p>
</li>
<li>
<p>After calculating the action, a postJoin routine (<strong>uh::LoopPostJoin</strong>) performs an additional mapping step that merges information from the joined entry with the mapped information.</p>
</li>
<li>
<p>Writes the record to the file.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Profile Script - Calculate Action</strong></p>
</div>
<div class="paragraph">
<p>The profile script&#8217;s "calculate action" subroutine calculates the action to be taken based on any change type, source entry status, and target entry conditions, as illustrated in the following figure.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch1_applsref/image24.png" alt="Profile Script - Calculate Action Logic">
</div>
<div class="title">Figure 24. Profile Script - Calculate Action Logic</div>
</div>
<div class="paragraph">
<p>As shown in the figure:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A ChangeType condition allows the action in the target directory to be controlled by information coming from the source directory (for example, change types defined in LDIF change syntax).</p>
</li>
<li>
<p>When the source directory keeps status information about new or deleted entries (<strong>Source Add Marking Attribute</strong> and <strong>Value</strong> and <strong>Source Del Marking Attribute</strong> and <strong>Value</strong>), this information allows the action to be controlled at the target directory side. For example, a customerStatus attribute with the value <strong>New</strong> in the source directory could force an add operation in the target directory.</p>
</li>
<li>
<p>In some cases, the existence of an attribute in the source directory that comes from the target directory can indicate the existence of a target system entry (<strong>Target Entry Exists</strong>). This indicator only works when a workflow operates in the opposite direction that handles this attribute.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If none of these conditions is met, the action is set to <strong>mod</strong>.</p>
</div>
<div class="paragraph">
<p><strong>Profile Script - Entry Handling</strong></p>
</div>
<div class="paragraph">
<p>Based on the calculated action and the result of the join operation, the entry is handled as shown in the following figure.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch1_applsref/image25.png" alt="Profile Script - Entry Handling Logic">
</div>
<div class="title">Figure 25. Profile Script - Entry Handling Logic</div>
</div>
<div class="paragraph">
<p>As shown in the figure:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If no entry is found and action = del, an error is reported or no further action is performed, depending on the exact action switch. If action = mod, an error is reported or an add operation is performed, depending on the exact action switch</p>
</li>
<li>
<p>If exactly one entry is found and action = del, the entry is deleted. Action = modDN results in a modifyDN operation. If action = mod, the entry is modified. Otherwise, the entry is either modified or an error is reported, depending on the exact action switch</p>
</li>
<li>
<p>If more than one entry is found, an error is reported.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>After the entry processing, a user hook (<strong>uh:LoopExtraFunction</strong>) allows you to define user-specific additional processing.</p>
</div>
<div class="paragraph">
<p><strong>Note:</strong> In the loop, an error means that the workflowâs result will be <strong>Warning</strong>. Otherwise one single erroneous entry would abort the workflow.</p>
</div>
<div class="paragraph">
<p><strong>Profile Script - Epilog</strong></p>
</div>
<div class="paragraph">
<p>The profile script&#8217;s epilog step performs the following tasks:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>When the script works in replace mode (switch <strong>Import Mode</strong>), it deletes all entries that were not contained in the source but are contained in the target (in a separate loop after the main loop).</p>
</li>
<li>
<p>When the script works in delta mode (switch <strong>Delta Synchronization</strong>), it processes the delta information and delivers it to the C++-based identity server.</p>
</li>
<li>
<p>When notifications are required (switch <strong>Notify Not OK</strong> is set or one of the <strong>Entry Handling</strong> switches <strong>Add Entries</strong>, <strong>Modify Entries</strong> or <strong>Delete Entries</strong> is set to one of the NTF options), it sends notifications.</p>
</li>
<li>
<p>Closes all connections have (unbind for directories, close for files)</p>
</li>
<li>
<p>Writes statistics (switch <strong>Statistics</strong>).</p>
</li>
<li>
<p>Terminates the meta controller and automatically closes all handles.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Profile Script - Delete Entries</strong></p>
</div>
<div class="paragraph">
<p>The delete routine is either called from the central processing loop for each entry or from the separate loop at the end for all unmarked entries. The following figure illustrates its logic:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch1_applsref/image26.png" alt="Profile Script - Entry Deletion Logic">
</div>
<div class="title">Figure 26. Profile Script - Entry Deletion Logic</div>
</div>
<div class="paragraph">
<p>As shown in the figure, the delete routine:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Does nothing if <strong>Delete Entries</strong> is not activated.</p>
</li>
<li>
<p>Checks whether the entry is in the <strong>Keep Objects</strong> list. If yes, it preserves the entry.</p>
</li>
<li>
<p>If <strong>Operational Attributes</strong> are activated, sets the <strong>dxrState</strong> to TBDEL and sets the <strong>dxrEndDate</strong> to the current date.</p>
</li>
<li>
<p>Otherwise, evaluates the <strong>Deletion Mode</strong>:</p>
</li>
<li>
<p><strong>MARK</strong> - Sets the value of the defined marking attribute.</p>
</li>
<li>
<p><strong>MOVE -</strong> Moves the entry to the tombstone area (by eventually calling <strong>uh::GenerateTombstoneDN</strong>).</p>
</li>
<li>
<p><strong>PHYSICAL -</strong> Physically deletes the entry.</p>
</li>
<li>
<p><strong>USER -</strong> Calls the user hook <strong>uh::Delete</strong>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch1_connectivity_standard_script_switches_and_parameters"><a class="anchor" href="#_ch1_connectivity_standard_script_switches_and_parameters"></a><a class="link" href="#_ch1_connectivity_standard_script_switches_and_parameters">1.3.1.4. Connectivity Standard Script Switches and Parameters</a></h5>
<div class="paragraph">
<p>You use switches and parameters to control the behavior of the Connectivity standard script. The following sections give information about switches and parameters for:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Operational control</p>
</li>
<li>
<p>Notification control</p>
</li>
<li>
<p>Global unique identifier (GUID) generation</p>
</li>
<li>
<p>Trace control</p>
</li>
<li>
<p>Source connected directory specification</p>
</li>
<li>
<p>Input channel specification</p>
</li>
<li>
<p>Target connected directory specification</p>
</li>
<li>
<p>Output channel specification</p>
</li>
<li>
<p>Pre-configured operational attribute handling</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="_ch1_switches_for_operational_control"><a class="anchor" href="#_ch1_switches_for_operational_control"></a><a class="link" href="#_ch1_switches_for_operational_control">1.3.1.4.1. Switches for Operational Control</a></h6>
<div class="paragraph">
<p>The following set of switches control the script&#8217;s operation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <strong>Delta Synchronization</strong> switch allows you to run the meta controller (<strong>metacp</strong>) job in delta mode based on date information (by default based on creation and modification time stamps or optionally on any other time attribute). For details, see "Understanding Delta Handling" in section "Managing the C++-based Server" in chapter "Managing Identity Servers" in the <em>DirX Identity Connectivity Administration Guide</em>.</p>
</li>
<li>
<p>The <strong>Minimum Source Entries</strong> switch helps to avoid situations in which the number of source entries differs a lot (due to an error in the generation of the entries) during subsequent runs of a full update or an export. The switch allows you to specify a minimum number of entries that must be available; otherwise, the workflow terminates with error and returns exit code 12.<br>
<br>
For import workflows running in <strong>MERGE</strong> mode, this parameter is not evaluated. However it is evaluated for import workflows running in <strong>REPLACE</strong> mode. In <strong>REPLACE</strong> mode, this parameter helps to avoid deletion of objects if only a small number of source entries is provided (by mistake).</p>
</li>
<li>
<p>The <strong>Exact Action</strong> switch allows you to control the algorithm&#8217;s automatic correction features.</p>
</li>
<li>
<p>The <strong>Init Mode</strong> switch allows you to run the meta controller either in real mode, where LDAP operations are performed, or trial mode, where trace information is written but LDAP update operations are not performed (searches are performed to simulate the real behavior).</p>
</li>
<li>
<p>The <strong>Test Mapping Only</strong> switch allows you to select whether just a test mapping is performed or if all operations (LDAP and file operations) are executed. You can use the <strong>Test Max Entries</strong> switch to define the number of entries to be mapped.</p>
</li>
<li>
<p>The <strong>Operational Attributes</strong> switch controls whether operational attributes are to be used, which controls the marking of entries with the master name or the handling of status attributes and entry and expiration dates. See the "Pre-Configured Operational Attribute Handling" section for details.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_switches_for_notification_control"><a class="anchor" href="#_ch1_switches_for_notification_control"></a><a class="link" href="#_ch1_switches_for_notification_control">1.3.1.4.2. Switches for Notification Control</a></h6>
<div class="paragraph">
<p>The Connectivity standard script currently implements two basic notification mechanisms:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <strong>Notify Not OK</strong> switch, which allows a notification to be created when the meta controller job runs into an error and/or warning situation.</p>
</li>
<li>
<p>The <strong>Entry Handling</strong> switches <strong>Add Entries</strong>, <strong>Modify Entries</strong> and <strong>Delete Entries</strong>, which allow data notification to be executed if the switches are set to one of the NTF options. If set to NTF, notification is performed instead of the operation (add, delete or modify), if set to <em>operation</em>NTF (ADDNTF, MODNTF or DELNTF), the operation is performed but the same information is sent via notification.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_switches_for_guid_generation"><a class="anchor" href="#_ch1_switches_for_guid_generation"></a><a class="link" href="#_ch1_switches_for_guid_generation">1.3.1.4.3. Switches for GUID Generation</a></h6>
<div class="paragraph">
<p>The Connectivity standard script allows global unique identifiers (GUIDs) to be generated for each entry that is to be imported into the Identity Store. See the "GUID Generation" section for more information. The parameters for this generation are stored in the field variable GUIDparam.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_switches_for_trace_control"><a class="anchor" href="#_ch1_switches_for_trace_control"></a><a class="link" href="#_ch1_switches_for_trace_control">1.3.1.4.4. Switches for Trace Control</a></h6>
<div class="paragraph">
<p>The meta controller can generate a lot of trace information, and you can use the switches <strong>Trace Level</strong> and <strong>Debug Trace</strong> to control the granularity of this output. The parameter <strong>Max Trace Entries</strong> controls the number of hits that are output during a join operation. Trace information can be written into <strong>Trace Files</strong> or <strong>Report Files</strong>.</p>
</div>
<div class="paragraph">
<p>The <strong>Statistics</strong> switch allows you to control whether or not the meta controller writes standard statistics. If you disable the standard statistics, your script must provide its own statistics.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_source_directory_parameters"><a class="anchor" href="#_ch1_source_directory_parameters"></a><a class="link" href="#_ch1_source_directory_parameters">1.3.1.4.5. Source Directory Parameters</a></h6>
<div class="paragraph">
<p>This set of parameters is necessary to connect correctly to the specific type of the source connected directory. The most important parameters are the <strong>Directory Type</strong> and the <strong>Directory Subtype</strong>, which determine the behavior of the connected directory.</p>
</div>
<div class="paragraph">
<p>The script generally needs the file name of the attribute configuration file, which is controlled via the parameters <strong>File Name</strong> and <strong>Encoding</strong>.</p>
</div>
<div class="paragraph">
<p>If <strong>Directory Type = LDAP</strong>, the additional parameters are required to perform an LDAP bind. These parameters are: <strong>Server Address</strong>, <strong>Protocol</strong>, <strong>User</strong>, <strong>Password</strong>, <strong>Authentication</strong>, <strong>Protocol</strong> and <strong>SSL Connection</strong> (see the Service and Bind Profile configuration objects for details).</p>
</div>
<div class="paragraph">
<p>If <strong>Directory Type = FILE</strong>, the following parameters are necessary to handle the file correctly: <strong>File Name</strong>, <strong>File Format</strong>, <strong>File Mode</strong> and <strong>Encoding</strong> (see the section File Item configuration object for details).</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_input_channel_parameters"><a class="anchor" href="#_ch1_input_channel_parameters"></a><a class="link" href="#_ch1_input_channel_parameters">1.3.1.4.6. Input Channel Parameters</a></h6>
<div class="paragraph">
<p>The input channel definition allows access to the related connected directory.</p>
</div>
<div class="paragraph">
<p>The parameter <strong>Selected Attributes</strong> defines he list of attributes that must be handled.</p>
</div>
<div class="paragraph">
<p>If <strong>Directory Type = LDAP</strong>, a <strong>Base Object</strong>, the <strong>Subset</strong> definition, a <strong>Search Filter</strong> optionally together with an <strong>OR Filter</strong> and whether the result is to be sorted (<strong>Sorted List</strong> together with the <strong>Sort Key</strong> and the <strong>Sort Order</strong>) must be defined (see Export Properties for details).</p>
</div>
<div class="paragraph">
<p>You can use the switch <strong>Read DN Only</strong> or <strong>Paged Read</strong> together with <strong>Page Size</strong> to optimize memory consumption.</p>
</div>
<div class="paragraph">
<p>If <strong>Directory Type = File</strong>, no additional parameters need to be specified in the input channel definition.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_target_directory_parameters"><a class="anchor" href="#_ch1_target_directory_parameters"></a><a class="link" href="#_ch1_target_directory_parameters">1.3.1.4.7. Target Directory Parameters</a></h6>
<div class="paragraph">
<p>This set of parameters is necessary to connect correctly to the specific type of the target connected directory. The most important parameters are the <strong>Directory Type</strong> and the <strong>Directory Subtype</strong>, which determine the behavior of the connected directory.</p>
</div>
<div class="paragraph">
<p>The script needs generally needs the file name of the attribute configuration file, which is controlled via the parameters <strong>File Name</strong> and <strong>Encoding</strong>.</p>
</div>
<div class="paragraph">
<p>If <strong>Directory Type = LDAP</strong>, the following additional parameters are required to perform an LDAP bind: <strong>Server Address</strong>, <strong>Protocol</strong>, <strong>User</strong>, <strong>Password</strong>, <strong>Authentication</strong>, <strong>Protocol</strong> and <strong>SSL Connection</strong> (see the Service and Bind Profile objects for details).</p>
</div>
<div class="paragraph">
<p>If <strong>Directory Type = FILE</strong>, the following parameters are necessary to handle the file correctly: <strong>File Name</strong>, <strong>File Format</strong>, <strong>File Mode</strong> and <strong>Encoding</strong> (see the section File Item configuration object for details).</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_output_channel_parameters"><a class="anchor" href="#_ch1_output_channel_parameters"></a><a class="link" href="#_ch1_output_channel_parameters">1.3.1.4.8. Output Channel Parameters</a></h6>
<div class="paragraph">
<p>The output channel definition allows access to the related connected directory.</p>
</div>
<div class="paragraph">
<p>The <strong>Selected</strong> <strong>Attributes</strong> parameter defines the list of attributes to be handled.</p>
</div>
<div class="paragraph">
<p>If <strong>Directory Type = LDAP</strong>, a <strong>Base Object</strong>, the <strong>Subset</strong> definition, a <strong>Join Expression</strong> (or alternatively <strong>Expert Filters</strong>) and whether the result should be sorted (<strong>Sorted List</strong> together with the <strong>Sort Key</strong> and the <strong>Sort Order</strong>) must be defined (see Import Properties for details).</p>
</div>
<div class="paragraph">
<p>You can use the switch <strong>Read DN Only</strong> or <strong>Paged Read</strong> together with <strong>Page Size</strong> to optimize memory consumption.</p>
</div>
<div class="paragraph">
<p>If <strong>Directory Type = File</strong>, no additional parameters need to be specified in the output channel definition.</p>
</div>
<div class="paragraph">
<p>Entry handling parameters are also required to define the behavior at the target connected directory side. This is the Import Mode that controls whether the script works in merge or replace mode.</p>
</div>
<div class="paragraph">
<p>The <strong>Add Entries</strong>, <strong>Superior Info</strong>, and the source and target <strong>Add Marking Attribute</strong> and <strong>Add Marking Value</strong> parameters can control the addition of entries.</p>
</div>
<div class="paragraph">
<p>The <strong>Modify Entries</strong>, <strong>Modify Marking Attribute</strong>, <strong>Modify Marking Value</strong> and <strong>Rename Entries</strong> switches control entry modification.</p>
</div>
<div class="paragraph">
<p>The switches <strong>Delete Entries</strong>, <strong>Deletion Mode</strong>, the source and target <strong>Del Marking Attribute</strong> and <strong>Del Marking Value</strong> and <strong>Keep Objects</strong> control entry deletion.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_switches_for_pre_configured_operational_attribute_handling"><a class="anchor" href="#_ch1_switches_for_pre_configured_operational_attribute_handling"></a><a class="link" href="#_ch1_switches_for_pre_configured_operational_attribute_handling">1.3.1.4.9. Switches for Pre-Configured Operational Attribute Handling</a></h6>
<div class="paragraph">
<p>DirX Identity provides a pre-configured handling of the operational attributes. By default, <strong>dxmOprMaster</strong>, <strong>dxrStartDate</strong>, <strong>dxrEndDate</strong> and <strong>dxrState</strong> are used as attribute types if the switch <strong>Operational Attributes</strong> is on. You can select your preferred set of operational attributes in the user hooks script. The following description works with the standard set of operational attributes.</p>
</div>
<div class="paragraph">
<p>These attributes are only handled for entry masters depending on the calculated action.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch1_applsref/image27.png" alt="Table of Operational Attributes for Master handling">
</div>
</div>
<div class="paragraph">
<p><strong>DxmOprMaster Handling</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Add</strong>: this attribute will be set to the <strong>dxmOprMasterName</strong> value of the relevant source connected directory.</p>
</li>
<li>
<p><strong>Modify</strong>, <strong>ModifyDN</strong> and <strong>Delete</strong>: DirX Identity checks the mastership of the relevant entry. Only entries that belong to this entry master may be touched.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Entry and Expiration Date Handling</strong></p>
</div>
<div class="paragraph">
<p>Both date values are always set (empty fields cannot occur):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Add</strong>: the <strong>dxrStartDate</strong> or <strong>dxrEndDate</strong> is either set to the mapped value or if not present to the actual date or to 31.12.2037.</p>
</li>
<li>
<p><strong>Modify</strong>: if new mapped values are available, <strong>dxrStartDate</strong> or <strong>dxrEndDate</strong> are updated.</p>
</li>
<li>
<p><strong>Delete</strong>: <strong>dxrStartDate</strong> is not touched, <strong>dxrEndDate</strong> is set to the actual date.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Status Handling</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Add</strong>: dxrState will be set to<strong><br>
ENABLED</strong> if dxrStartDate &#8656; actual date<strong><br>
NEW</strong> if dxrStartDate &gt; actual date<br>
Note: The entry will be refused if dxrEndDate &#8656; dxmEntryDate.</p>
</li>
<li>
<p><strong>Modify</strong>: dxrState will be set to (tests in this sequence!)*<br>
ENABLED* if dxrStartDate &#8656; actual date<strong><br>
NEW</strong> if dxrStartDate &gt; actual date<strong><br>
TBDEL</strong> if dxrEndDate &#8656; actual date<br>
Note: An error will be reported if dxrEndDate &#8656; dxmEntryDate.</p>
</li>
<li>
<p><strong>Delete</strong>: dxrState will be set to <strong>TBDEL</strong>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch1_references_in_the_default_connectivity_applications"><a class="anchor" href="#_ch1_references_in_the_default_connectivity_applications"></a><a class="link" href="#_ch1_references_in_the_default_connectivity_applications">1.3.1.5. References in the Default Connectivity Applications</a></h5>
<div class="paragraph">
<p>References are widely used in DirX Identity&#8217;s default applications, allowing a high degree flexibility (especially through copy operations) to be combined with the central configuration of important and widely-used parameters. This section describes some general reference concepts that are used in the default applications: base object references and references in filter expressions.</p>
</div>
<div class="paragraph">
<p>Most references are defined in configuration files (Tcl files, INI files, XML files). For a detailed description of how to create and interpret references, see the chapter "Customizing Object References" in the <em>DirX Identity Customization Guide</em>. You can also find some references in attributes at the user interface level.</p>
</div>
<div class="sect5">
<h6 id="_ch1_base_object_references"><a class="anchor" href="#_ch1_base_object_references"></a><a class="link" href="#_ch1_base_object_references">1.3.1.5.1. Base Object References</a></h6>
<div class="paragraph">
<p>DirX Identity uses a two-step approach to make the configuration of the base object fields in channels easy and consistent. The following figure illustrates this approach.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch1_applsref/image28.png" alt="Base Object Reference Concept">
</div>
<div class="title">Figure 27. Base Object Reference Concept</div>
</div>
<div class="paragraph">
<p>The <strong>Base Object</strong> field in an input or output channel can contain values like:</p>
</div>
<div class="paragraph">
<p><strong>&lt;?$src_base_obj/&gt;</strong> or <strong>&lt;?$tgt_base_obj/&gt;</strong></p>
</div>
<div class="paragraph">
<p>These values are reference variables, which almost completely hide the complexity of references. The DirX Identity default applications contain the following reference variables:</p>
</div>
<div class="paragraph">
<p>&lt;?$src_base_obj/&gt; - occurs in input channels. Points to the source connected directory to the specific attribute <strong>base_obj</strong> (named <strong>Creation / Search Base</strong> at the user interface).</p>
</div>
<div class="paragraph">
<p>&lt;?$tgt_base_obj/&gt; - occurs in output channels. Points to the target connected directory to the specific attribute base_obj (named Creation / Search Base at the user interface).</p>
</div>
<div class="paragraph">
<p>&lt;?$src_master_name/&gt; - occurs in input channels. Points to the source connected directory to the attribute dxmMasterName (named Master Name at the user interface in the Operational Attributes tab).</p>
</div>
<div class="paragraph">
<p>&lt;?$tgt_master_name/&gt; - occurs in output channels. Points to the target connected directory to the attribute dxmMasterName (named Master Name at the user interface in the Operational Attributes tab).</p>
</div>
<div class="paragraph">
<p>&lt;?$tgt_machine_name/&gt; - occurs in output channels. Points to the service object of the target connected directory to the attribute dxmAddress (named IP Address at the user interface).</p>
</div>
<div class="paragraph">
<p>&lt;?$tgt_server_address/&gt; - occurs in output channels. Points to the service object of the target connected directory to the attribute dxmAddress and dxmDataPort (named IP Address and Data Port at the user interface). Note: This reference does not work for SSL connections.</p>
</div>
<div class="paragraph">
<p>You can find the definition of these reference variables in the control Tcl script or at the start of the INI files. The definitions are contained in comments because they only set the variable content that is used later on in other places. They are not visible to the Tcl or INI script. Note: another way to hide this information is to use set_nv instead of set for the variable definition, but this technique makes debugging more difficult because you cannot see the evaluated values.</p>
</div>
<div class="paragraph">
<p>The &lt;?$src_base_obj/&gt; and &lt;?$tgt_base_obj/&gt; reference variables point to the base_obj fields in the connected directories. To make the values here as independent as possible of a specific directory implementation, the values in the base_obj fields can also contain references, for example:</p>
</div>
<div class="paragraph">
<p><strong>ou=mthb,&lt;?Configuration@SpecificAttributes(BaseNode)/&gt;</strong></p>
</div>
<div class="paragraph">
<p>The reference to the specific attribute <strong>Base Node</strong> allows you to set a central definition of the start node in the directory. For example, DirX Directory delivers samples that start with <strong>o=My-Company</strong>. In the example (which is valid for most workflows in DirX Identity&#8217;s default applications), the workflows use ou=mthb,o=My-Company as the base point.</p>
</div>
<div class="paragraph">
<p>Other variables, such as the <strong>Tombstone Base</strong> in a connected directory&#8217;s Operational Attributes tab, can also use this base value, for example, ou=tombstone,&lt;?Configuration@SpecificAttributes(BaseNode)/&gt;. This method creates very consistent scenarios that can easily be adapted to new situations.</p>
</div>
<div class="paragraph">
<p>Another example is the setting in the <strong>Search Base</strong> field of the Import Properties tab of the Ident2ADS workflow: LDAP://&lt;?$tgt_machine_name/&gt;/&lt;?$tgt_base_obj/&gt;. In this case, the search base is built from a constant "LDAP://", then the target machine name, another constant "/" and then the target base_obj.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_references_in_filter_expressions"><a class="anchor" href="#_ch1_references_in_filter_expressions"></a><a class="link" href="#_ch1_references_in_filter_expressions">1.3.1.5.2. References in Filter Expressions</a></h6>
<div class="paragraph">
<p>Fields like <strong>Search Filter</strong>, <strong>OR Filter</strong>, <strong>Expert Filter</strong> or <strong>Replace Filter</strong> in input or output channels can contain simple or complex LDAP filter expressions, and they can also contain references. For example:</p>
</div>
<div class="paragraph">
<p><strong>\{dxmOprMaster=&lt;?$src_master_name/&gt;}</strong></p>
</div>
<div class="paragraph">
<p>This filter searches for all entries that contain the value of the src_master_name reference in the dxmOprMaster attribute. Simply change the <strong>Master Name</strong> field of your source connected directory to handle another master source. The advantage of these fields is that both the import and export workflows use them. As a result, you don&#8217;t need to set two different values in each workflow - one central change is sufficient.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch1_object_class_handling"><a class="anchor" href="#_ch1_object_class_handling"></a><a class="link" href="#_ch1_object_class_handling">1.3.1.6. Object Class Handling</a></h5>
<div class="paragraph">
<p>The Connectivity standard script supports easy object class handling. Use these two variables to perform object class handling tasks:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>dxm_add_objclass - These object classes will be added to the set of object classes.</p>
</li>
<li>
<p>dxm_rem_objclass - These object classes will be removed from the set of object classes.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These two variables permit the object classes to be completely handled during add and modify operations.</p>
</div>
<div class="paragraph">
<p>The object classes are calculated in the following steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use the mapped target&#8217;s objectClass attribute value (for example, rh_ldap(objectClass)) as the starting point. This is supported for compatibility reasons.</p>
</li>
<li>
<p>For a <strong>modify</strong> operation only, merge the object classes from the target entry.</p>
</li>
<li>
<p>Merge the object classes from the <strong>Object</strong> <strong>Classes</strong> field in the target connected directory&#8217;s Operational Attributes if available.</p>
</li>
<li>
<p>Merge the list of object classes from dxm_add_objClass.</p>
</li>
<li>
<p>Remove the list of object classes from dxm_rem_objclass</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Examples</strong>:</p>
</div>
<div class="paragraph">
<p>Set dxm_rem_objclass to the object classes of the joined entry. This action removes all object classes from the entry. If you set new object classes with dxm_add_objclass, you can completely replace the object classes.</p>
</div>
<div class="paragraph">
<p>Joined entry object classes = "person inetOrgPerson", dxm_add_objclass = "dxmADsUser", connected directory object classes = "person inetOrgPerson organizationalPerson". These values are merged to "person inetOrgPerson organizationalPerson dxmADsUser".</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch1_global_unique_identifier_guid_generation"><a class="anchor" href="#_ch1_global_unique_identifier_guid_generation"></a><a class="link" href="#_ch1_global_unique_identifier_guid_generation">1.3.1.7. Global Unique Identifier (GUID) Generation</a></h5>
<div class="paragraph">
<p>Global unique identifiers (GUIDs) significantly ease synchronization work. All processes such as join operations are well-defined and robust.</p>
</div>
<div class="paragraph">
<p>The basic GUID concept is that each entry in the Identity Store contains a unique identifier that is used as much as possible for all synchronizations to target systems (ideally, this identifier is stored in the target systems). A re-synchronization from the target system to the Identity Store can use this identifier to join to the correct entry exactly without any ambiguity.</p>
</div>
<div class="paragraph">
<p>The Connectivity standard script generates a GUID only during add operations. If a GUID is defined in the mapping, this value is taken. Otherwise, DirX Identity Connectivity supports three mechanisms to create a unique GUID: local GUID generation, central GUID generation, and user-defined GUID generation. You can switch between these modes in the job object&#8217;s <strong>GUID Generation Type</strong>.</p>
</div>
<div class="sect5">
<h6 id="_ch1_local_guid_generation"><a class="anchor" href="#_ch1_local_guid_generation"></a><a class="link" href="#_ch1_local_guid_generation">1.3.1.7.1. Local GUID Generation</a></h6>
<div class="paragraph">
<p>In local GUID generation, a GUID can be generated from a local unique identifier and a unique prefix from the source system. The employeeNumber is a good example of a unique source system identifier. You define this attribute type in the source connected directory&#8217;s <strong>Local GUID Attribute</strong> field.</p>
</div>
<div class="paragraph">
<p>A unique prefix is necessary for creating a unique identifier for the entire scenario. This prefix must be defined manually. It can be stored in the dxmGuidID attribute value of the source connected directory (<strong>GUID Prefix</strong>).</p>
</div>
<div class="paragraph">
<p>In the target connected directory, you must define the <strong>GUID Attribute</strong>, which stores the GUID values.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_central_guid_generation"><a class="anchor" href="#_ch1_central_guid_generation"></a><a class="link" href="#_ch1_central_guid_generation">1.3.1.7.2. Central GUID Generation</a></h6>
<div class="paragraph">
<p>DirX Identity Connectivity provides an algorithm that allows for the creation of unique integer numbers. In this case, the highest already used value is stored in a special attribute <strong>dxmActualGUIDvalue</strong> in the target connected directory object.</p>
</div>
<div class="paragraph">
<p>To generate a new GUID value, this value is retrieved, increased by one and stored again in the actual GUID value attribute. The algorithm guarantees that double generation of a number is impossible.</p>
</div>
<div class="paragraph">
<p>Because each add entry operation would require an additional read and a write operation to this actual GUID attribute, it is possible to reserve <em>n</em> GUID values with one read/write operation. If all of these numbers are not used, this method may lead to unused numbers. The highest possible number (2.147.483.647 for Windows) limits this method. You can specify the block size with the <strong>GUID Generation Block Size</strong> parameter in the job object.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_user_defined_guid_generation"><a class="anchor" href="#_ch1_user_defined_guid_generation"></a><a class="link" href="#_ch1_user_defined_guid_generation">1.3.1.7.3. User-Defined GUID Generation</a></h6>
<div class="paragraph">
<p>DirX Identity Connectivity provides the following user hooks for implementing user-defined GUID generation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>uh:InitCreateGUID</strong> - use this routine to initialize your procedure before processing all entries.</p>
</li>
<li>
<p><strong>uh::CreateGuid</strong> - use this routine to process a single GUID.</p>
</li>
<li>
<p><strong>uh::CleanupCreateGuid</strong> - use this routine to clean up after processing all entries.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch1_multi_mastered_attributes"><a class="anchor" href="#_ch1_multi_mastered_attributes"></a><a class="link" href="#_ch1_multi_mastered_attributes">1.3.1.8. Multi-Mastered Attributes</a></h5>
<div class="paragraph">
<p>DirX Identity provides the <strong>dxmOprOriginator</strong> attribute to handle multiple masters for the different values of multi-valued attributes This attribute keeps the organizational information to handle the different values of multi-valued attributes and is part of the dxrUser object class of a user entry. The dxmOprOriginator attribute is a structured attribute of the form:</p>
</div>
<div class="paragraph">
<p><em>master_name</em><mark><em>master_rec_ID</em></mark><em>attribute_name</em>#<em>attribute_value</em></p>
</div>
<div class="paragraph">
<p>where</p>
</div>
<div class="paragraph">
<p><em>master_name</em> is the name of the master directory (and should be the dxmMasterName property of the source directory)</p>
</div>
<div class="paragraph">
<p><em>master_rec_ID</em> is the unique record ID that identifies the record in the source (master) system.</p>
</div>
<div class="paragraph">
<p><em>attribute_name</em> is the name of the multi-valued attribute.</p>
</div>
<div class="paragraph">
<p><em>attribute_value</em> is the value of the multi-valued attribute that is mastered.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="paragraph">
<p>HDMS1#12345#telephoneNumber#+49 89 636 45667<br>
HDMS1#34526#telephoneNumber#+49 89 722 82736<br>
PHONEDIR#43257#telephoneNumber#+49 89 722 34526<br>
HDMS1#12345#faxNumber#+49 89 636 45668</p>
</div>
<div class="paragraph">
<p>In this example, the phone number +49 89 636 45667 is mastered from the record 12345 in the HDMS1 system together with the FAX number +49 89 636 45668.</p>
</div>
<div class="paragraph">
<p>The record 34526 from same system HDMS1 masters the phone number +49 89 722 82736.</p>
</div>
<div class="paragraph">
<p>Another record (43257) from the system PHONEDIR masters a telephone number of the same user: +49 89 722 34526.</p>
</div>
<div class="paragraph">
<p>This example shows that several systems can handle the same attribute and on the other hand that several attributes can be handled from the same master but from different records. Thus the concept covers all possible cases.</p>
</div>
<div class="paragraph">
<p>Note: This mechanism is currently only used by the HDMS workflows.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch1_naming_and_scopes"><a class="anchor" href="#_ch1_naming_and_scopes"></a><a class="link" href="#_ch1_naming_and_scopes">1.3.1.9. Naming and Scopes</a></h5>
<div class="paragraph">
<p>If you want to use your own functions and variables, you should use name spaces. This approach guarantees that there are no collisions in variable names and procedure names.</p>
</div>
<div class="paragraph">
<p>The default applications use the following name spaces, which you therefore must not use:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">uh</dt>
<dd>
<p>- used for user hooks</p>
</dd>
<dt class="hdlist1">dxm</dt>
<dd>
<p>- reserved for future use (for default applications)</p>
</dd>
<dt class="hdlist1">hdms</dt>
<dd>
<p>- used by the HDMS workflow</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>You are also not allowed to re-define the global variables used in <strong>control.tcl</strong> (for details, see the "User Hooks" section).</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch1_user_hooks"><a class="anchor" href="#_ch1_user_hooks"></a><a class="link" href="#_ch1_user_hooks">1.3.1.10. User Hooks</a></h5>
<div class="paragraph">
<p>You can control the standard Connectivity script with the switches and parameters described in the "Switches and Parameters" section, and you can also control it by customizing the user hook routines. The following figure shows these routines and their relationship to the standard script structure.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch1_applsref/image29.png" alt="User Hook Routines">
</div>
<div class="title">Figure 28. User Hook Routines</div>
</div>
<div class="paragraph">
<p>DirX Identity provides the following user hook routines:</p>
</div>
<div class="paragraph">
<p><strong>uh::Initialize</strong></p>
</div>
<div class="paragraph">
<p>Initializes the script. Currently only the array <strong>opr</strong> is set (defines the names of the operational attributes).</p>
</div>
<div class="paragraph">
<p><strong>uh::Preprocessing</strong></p>
</div>
<div class="paragraph">
<p>Prepares everything thatâs needed before the rest of the profile code is executed. No files or handles are open at this time. An example is to set additional control variables with references.</p>
</div>
<div class="paragraph">
<p><strong>uh::Prolog</strong></p>
</div>
<div class="paragraph">
<p>Handles everything that is needed before the loop is entered (for example, opening additional files). Here all handles are already available.</p>
</div>
<div class="paragraph">
<p>When the "lStringEncrypt" mapping function is called the very first time, it reads the userCertificate using the latest bind connection. Therefore this user hook provides also the bind information that needs to be used for retrieving the userCertificate. For import workflows, it uses the target connection parameters "tgt_conn_param". For export workflows, it uses the source connection parameters "src_conn_param". If the user data that needs to be encrypted is not stored in the directory server where the ConfDB tree (which includes the userCertificate) is located, then the user hook needs to be changed.</p>
</div>
<div class="paragraph">
<p><strong>uh::RefineSearch</strong></p>
</div>
<div class="paragraph">
<p>If a search returns with a predefined amount of entries (for example, 4096 for RACF), the default applications try to read pieces of the search result. A default mechanism is provided that can be customized (see an application of this user hook in the RACF workflows).</p>
</div>
<div class="paragraph">
<p><strong>uh::GenerateTombstoneDN</strong></p>
</div>
<div class="paragraph">
<p>Used for move mode in the delete procedure. Generates the Tombstone-DN by concatenating the original DN with the tombstone base by default. Another function can be defined here.</p>
</div>
<div class="paragraph">
<p><strong>uh::LoopExtraFilter</strong></p>
</div>
<div class="paragraph">
<p>Filters entries that are not to be processed in the loop (for example, RACF does not permit entries to be read with a filter condition; filtering must be performed in the central script logic on a per-entry basis).</p>
</div>
<div class="paragraph">
<p><strong>(Mapping)</strong></p>
</div>
<div class="paragraph">
<p>You can freely define the mapping between the source and target entries in the mapping script.</p>
</div>
<div class="paragraph">
<p><strong>uh::LoopPerformJoin</strong></p>
</div>
<div class="paragraph">
<p>Performs a user-specific join routine when type is set to FILE. The routine can be used to compare the actual set of entries with a previous set to calculate delta information.</p>
</div>
<div class="paragraph">
<p><strong>uh::LoopPostJoin</strong></p>
</div>
<div class="paragraph">
<p>Runs after the join operation but before the write/update operation to the target system. The mapping can be adapted according to the results from the read entry of the target system.</p>
</div>
<div class="paragraph">
<p><strong>uh::Delete</strong></p>
</div>
<div class="paragraph">
<p>Defines a user-specific entry deletion method. This routine is only used when the switch Deletion Mode is set to âUserâ. It is used during the main loop processing and during the processing of unmarked entries after the main loop.</p>
</div>
<div class="paragraph">
<p><strong>uh::LoopExtraFunction</strong></p>
</div>
<div class="paragraph">
<p>Performs additional actions for an entry (for example, writing additional log file information into a special file).</p>
</div>
<div class="paragraph">
<p><strong>uh::Epilog</strong></p>
</div>
<div class="paragraph">
<p>Closes and finalizes everything that is needed after the loop has been processed (for example, the closing of additional files).</p>
</div>
<div class="paragraph">
<p><strong>uh::ErrorHandler</strong></p>
</div>
<div class="paragraph">
<p>Error codes that are returned as errorCode value by the general function exec_cmd can be changed here. Codes can be ignored, modified or additional actions can be issued.</p>
</div>
<div class="paragraph">
<p><strong>uh::InitCreateGuid</strong></p>
</div>
<div class="paragraph">
<p>Initializes the GUID generator before processing all entries.</p>
</div>
<div class="paragraph">
<p><strong>uh::CreateGuid</strong></p>
</div>
<div class="paragraph">
<p>Creates a user-specific GUID value. Define your own algorithms here and set the GUID Generation Type to "User".</p>
</div>
<div class="paragraph">
<p><strong>uh::CleanupCreateGuid</strong></p>
</div>
<div class="paragraph">
<p>Defines the cleanup code for the GUID generator after processing all entries.</p>
</div>
<div class="paragraph">
<p>See the section "Important Routines" for information about the interfaces to some of these routines.</p>
</div>
<div class="paragraph">
<p>To use the user hook routines:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Select the job object in the DirX Identity Manager&#8217;s expert view.</p>
</li>
<li>
<p>Right-click the job, then select <strong>New</strong> &#8594; <strong>Tcl Script</strong>. Set the name to "User Hooks Script".</p>
</li>
<li>
<p>Open <strong>Configuration</strong> &#8594; <strong>Tcl</strong> &#8594; <strong>Default</strong> &#8594; <strong>User Hooks Default Script</strong>.</p>
</li>
<li>
<p>Select the <strong>Content</strong> tab. Click in the edit window. Select the entire code (for example, with Ctrl-A) and copy it (for example, with Ctrl-C).</p>
</li>
<li>
<p>Click the <strong>Content</strong> tab of your newly created Tcl script. Click <strong>Edit</strong>. Paste the content of the default script into your script object. Click <strong>Save</strong> to store it. Note that you can&#8217;t copy the User Hooks Default Script object as a whole because it is set to read-only. Consequently, you must copy the content.</p>
</li>
<li>
<p>Link the job to your Tcl script: Click the tab <strong>Tcl Scripts</strong>, click <strong>Edit</strong>, create a new line in the <strong>Miscellaneous</strong> table and link it to the User Hooks Tcl script. Click <strong>Save</strong>.</p>
</li>
<li>
<p>Note: We recommend that you delete all of the routines in your user hook scripts that you do not use. This action makes your changes more obvious.</p>
<div class="dlist">
<dl>
<dt class="hdlist1">The user hook routines are defined in the name space <strong>uh::</strong>. All user hook routines must be called with the prefix uh</dt>
<dd>
<p>==== Important Tcl Interfaces</p>
</dd>
</dl>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>This section describes some important Tcl interfaces in the <strong>central.tcl</strong>, <strong>user_hooks_default.tcl</strong> and <strong>post_join_mapping.tcl</strong> files.</p>
</div>
<div class="sect5">
<h6 id="_ch1_central_tcl_interfaces"><a class="anchor" href="#_ch1_central_tcl_interfaces"></a><a class="link" href="#_ch1_central_tcl_interfaces">1.3.1.10.1. Central Tcl Interfaces</a></h6>
<div class="paragraph">
<p>The following Tcl interfaces are provided in <strong>central.tcl</strong>:</p>
</div>
<div class="paragraph">
<p><strong>exec_cmd</strong></p>
</div>
<div class="paragraph">
<p>Executes a <strong>metacp</strong> command and terminates on error.</p>
</div>
<div class="paragraph">
<p><strong>exec_cmd</strong> executes a given command and returns the result of the executed command. The global variable debug_trace should be set to one of the values 8, 9, 12, 13 to make command trace information available in the trace file. The command <strong>meta initialize</strong> should be the very first command that is executed by <strong>exec_cmd</strong>; otherwise tracing canât be successfully performed.</p>
</div>
<div class="paragraph">
<p>When serious errors occur, <strong>exec_cmd</strong> terminates with exit code 10. <strong>exec_cmd</strong> does not handle some error situations; for example, the error "METACP 4852" (âobject doesnât existâ in case of a search operation) or the error "METACP 4515" (âno more results in a paged result requestâ). In these cases, these error codes are returned.</p>
</div>
<div class="paragraph">
<p>Synopsis:<br>
<strong>exec_cmd</strong> <em>command</em> <em>directory_subtype</em></p>
</div>
<div class="paragraph">
<p>Parameters:<br>
<em>command</em> - the command to be executed<br>
<em>dir_subtype</em> - the directory subtype, for example, RACF</p>
</div>
<div class="paragraph">
<p>Global variables used:</p>
</div>
<div class="paragraph">
<p><strong>errorCode</strong> - Tcl error code variable</p>
</div>
<div class="paragraph">
<p><strong>debug_trace</strong> - level of debug tracing<br>
0 â no trace<br>
4 â Tcl variable trace to stdout<br>
5 â Tcl variable trace to file<br>
8 â command trace to stdout<br>
9 â command trace to file<br>
12 â Tcl variable trace and command trace to stdout<br>
13 â Tcl variable trace and command trace to file</p>
</div>
<div class="paragraph">
<p><strong>trace_file</strong> - the name of the trace file</p>
</div>
<div class="paragraph">
<p><strong>notify_not_ok</strong> - a flag that indicates whether a notification should be sent in case of errors/warnings</p>
</div>
<div class="paragraph">
<p><strong>notify_notok_file</strong> - a notification file</p>
</div>
<div class="paragraph">
<p><strong>DEBUG_COMMAND</strong> indicates that Tcl commands should be traced</p>
</div>
<div class="paragraph">
<p>Return values:</p>
</div>
<div class="paragraph">
<p><strong>result</strong> - on success, the result string of the executed command.</p>
</div>
<div class="paragraph">
<p><strong>errorCode</strong> - on error, the error code of the executed command (for errors that are not serious)</p>
</div>
<div class="paragraph">
<p>Exit codes:<br>
10 on serious errors</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-tcl hljs" data-lang="tcl">set result [exec_cmd âmeta modifyentry âoldentry old ânewentry newâ]</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>getCurrentTimeGMT</strong></p>
</div>
<div class="paragraph">
<p>Returns the current time as a GENERALIZED_TIME string.</p>
</div>
<div class="paragraph">
<p>Synopsis:<br>
<strong>getCurrentTimeGMT</strong></p>
</div>
<div class="paragraph">
<p>Parameters:<br>
None.</p>
</div>
<div class="paragraph">
<p>Global variables used:<br>
None.</p>
</div>
<div class="paragraph">
<p>Return values:<br>
time_value - the current system time as a GENERALIZED_TIME string</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-tcl hljs" data-lang="tcl">set current_time [getCurrentTimeGMT]</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>int2zulu</strong></p>
</div>
<div class="paragraph">
<p>Converts a time in seconds into a GENERALIZED_TIME value</p>
</div>
<div class="paragraph">
<p>Synopsis:<br>
<strong>Int2zulu</strong> [<em>time_val</em>]</p>
</div>
<div class="paragraph">
<p>Parameters:<br>
<em>time_val</em> - a time value in seconds (optional); if omitted, the current system time is used.</p>
</div>
<div class="paragraph">
<p>Global variables used:<br>
None.</p>
</div>
<div class="paragraph">
<p>Return values:<br>
value - time value as GENERALIZED_TIME string</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-tcl hljs" data-lang="tcl">int2zulu 1000000 - returns the value â19700112134640Zâ
int2zulu - returns the current time as GENERALIZED_TIME string</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>trace_out</strong></p>
</div>
<div class="paragraph">
<p>Writes trace information to the trace file.</p>
</div>
<div class="paragraph">
<p>trace_out writes the strings given in the parameters string1, string2, â¦ to the trace file, if the global variable debug_trace permits the operation. The parameter mode defines the kind of information that string1, string2, â¦ represent. If the value of mode matches the value of debug_trace, then the trace information will be written. mode is a bit combination of the global variables DEBUG_VARIABLE, DEBUG_COMMAND, DEBUG_LEVEL1, â¦, DEBUG_LEVEL4.</p>
</div>
<div class="paragraph">
<p>Synopsis:<br>
<strong>trace_out</strong> <em>mode string1</em> [<em>string2</em> ..]</p>
</div>
<div class="paragraph">
<p>Parameters:<br>
<em>mode</em> - the type of information to be written<br>
<em>string1, string2 â¦</em> - a list of strings to be written</p>
</div>
<div class="paragraph">
<p>Global variables used:<br>
<strong>debug_trace</strong> - for details, see the description in exec_cmd<br>
<strong>DEBUG_IN_FILE</strong> - defines that trace information should be written into the trace file; if not set, tracing is sent to stdout<br>
<strong>DEBUG_VARIABLE</strong> - defines that variable tracing is switched on<br>
<strong>DEBUG_COMMAND</strong> - defines that command tracing is switched on<br>
<strong>DEBUG_LEVEL1</strong> - defines that trace information of level 1 will be written<br>
<strong>DEBUG_LEVEL2</strong> - defines that trace information of level 2 will be written<br>
<strong>DEBUG_LEVEL3</strong> - defines that trace information of level 3 will be written<br>
<strong>DEBUG_LEVEL4</strong> - defines that trace information of level 4 will be written</p>
</div>
<div class="paragraph">
<p>Return values:<br>
None.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-tcl hljs" data-lang="tcl">proc f {
 global DEBUG_VARIABLE
 trace_out $DEBUG_VARIABLE ârh_ldap(sn)=$rh_ldap(sn)â
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>zulu2int</strong></p>
</div>
<div class="paragraph">
<p>Converts a GENERALIZED_TIME value to its representation in seconds</p>
</div>
<div class="paragraph">
<p>Synopsis:<br>
<strong>zulu2int</strong> <em>time_val</em></p>
</div>
<div class="paragraph">
<p>Parameters:<br>
<em>time_val</em> - a GENERALIZED_TIME value</p>
</div>
<div class="paragraph">
<p>Global variables used:<br>
None.</p>
</div>
<div class="paragraph">
<p>Return values:<br>
<strong>seconds</strong> - the time value in seconds</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-tcl hljs" data-lang="tcl">zulu2int 20031231120000Z - returns the value â1072872000â</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_default_user_hook_tcl_interfaces"><a class="anchor" href="#_ch1_default_user_hook_tcl_interfaces"></a><a class="link" href="#_ch1_default_user_hook_tcl_interfaces">1.3.1.10.2. Default User Hook Tcl Interfaces</a></h6>
<div class="paragraph">
<p>The following Tcl interfaces are provided in <strong>user_hooks_default.tcl</strong>:</p>
</div>
<div class="paragraph">
<p><strong>uh::Delete</strong></p>
</div>
<div class="paragraph">
<p>Defines a user-specific entry deletion method.</p>
</div>
<div class="paragraph">
<p>uh::Delete implements a user-defined method of deleting an entry. You define the action to be executed when an entry should be deleted. The routine is used when the deletion_mode switch is set to "User". This routine is used in the default applications during the main loop processing and during the processing of unmarked entries after the main loop.</p>
</div>
<div class="paragraph">
<p>Synopsis:<br>
<strong>uh::Delete</strong> <em>tgt_data</em></p>
</div>
<div class="paragraph">
<p>Parameters:<br>
<em>tgt_data</em> - an array of attribute values that represent the object to be deleted</p>
</div>
<div class="paragraph">
<p>Global variables used:<br>
<strong>tgt_conn_param</strong> - the connection parameters to be used when performing a directory update operation</p>
</div>
<div class="paragraph">
<p>Return values:<br>
0 in case of success<br>
1 in case of errors</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-tcl hljs" data-lang="tcl">set update_result [uh::Delete tgt]</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>uh::Epilog</strong></p>
</div>
<div class="paragraph">
<p>Closes and finalizes everything that is needed after the loop has been processed (for example, the closing of additional files)</p>
</div>
<div class="paragraph">
<p>Synopsis:<br>
<strong>uh::Epilog</strong></p>
</div>
<div class="paragraph">
<p>Parameters:<br>
None.</p>
</div>
<div class="paragraph">
<p>Global variables used:<br>
None.</p>
</div>
<div class="paragraph">
<p>Return values:<br>
0 - on success</p>
</div>
<div class="paragraph">
<p><em>return_code</em> - on error</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-tcl hljs" data-lang="tcl">set return_code [uh::Epilog]</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>uh::ErrorHandler</strong></p>
</div>
<div class="paragraph">
<p>Handles specific errors that were originally returned in "errorCode" (in exec_cmd).</p>
</div>
<div class="paragraph">
<p>uh::ErrorHandler is called by the exec_cmd procedure when errors occur. Because error operation is different for various directory systems (for example, RACF is very restrictive and very often returns the LDAP error âLDAP_OTHERâ), exec_cmd must handle these situations. You should implement uh::ErrorHandler to return â0â for errors that are not serious and that do not prevent the Connectivity standard script from continuing its entry-processing functions, and return â1â for serious errors.</p>
</div>
<div class="paragraph">
<p>Synopsis:<br>
<strong>uh::ErrorHandler</strong> <em>command result dir_subtype</em></p>
</div>
<div class="paragraph">
<p>Parameters:<br>
<em>command</em> - a command string that has been executed by exec_cmd<br>
<em>result</em> - a result returned by exec_cmd<br>
<em>dir_subtype</em> - a directory subtype, e.g., RACF</p>
</div>
<div class="paragraph">
<p>Global variables used:<br>
<strong>errorCode</strong> - Tcl error code variable</p>
</div>
<div class="paragraph">
<p>Return values:<br>
0 if a specific error has been handled by that procedure<br>
1 if the error has not been handled by that procedure</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-tcl hljs" data-lang="tcl">set return_code [uh::ErrorHandler $command $result RACF]</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>uh::GenerateTombstoneDN</strong></p>
</div>
<div class="paragraph">
<p>Generates a DN when an object that should normally be deleted is moved to a different tombstone branch of the DIT.</p>
</div>
<div class="paragraph">
<p>uh::GenerateTombstoneDN generates the tombstone DN by exchanging the target search base object with the tombstone base object.</p>
</div>
<div class="paragraph">
<p>Synopsis:<br>
<strong>uh::GenerateTombstoneDN</strong> <em>current_dn</em></p>
</div>
<div class="paragraph">
<p>Parameters:<br>
<em>current_dn</em> - the DN of the object to be moved to the tombstone branch</p>
</div>
<div class="paragraph">
<p>Global variables used:<br>
<strong>tombstone_base</strong> - the base DN of the tombstone branch<br>
<strong>tgt_search_param</strong> - the target search parameters</p>
</div>
<div class="paragraph">
<p>Return values:<br>
<strong>new_dn</strong> - tombstone DN</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-tcl hljs" data-lang="tcl">set new_dn [uh::GenerateTombstoneDN $current_dn]</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>uh::Initialize</strong></p>
</div>
<div class="paragraph">
<p>Initializes the default applications.</p>
</div>
<div class="paragraph">
<p>uh::Initialize is used to initialize the environment of the default applications. Because it&#8217;s the very first statement of the Connectivity standard script, the meta controller&#8217;s <strong>meta initialize</strong> operation has not yet been called, so no tracing can be done in that routine. The routine currently initializes the names of the operational attributes.</p>
</div>
<div class="paragraph">
<p>Synopsis:<br>
<strong>uh::Initialize</strong></p>
</div>
<div class="paragraph">
<p>Parameters:<br>
None.</p>
</div>
<div class="paragraph">
<p>Global variables used:<br>
<strong>opr</strong> - an array of operational attribute names</p>
</div>
<div class="paragraph">
<p>Return values:<br>
0 - on success<br>
1 - on error</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-tcl hljs" data-lang="tcl">set rc [uh::Initialize]</code></pre>
</div>
</div>
<div class="paragraph">
<p>uh::LoopExtraFilter</p>
</div>
<div class="paragraph">
<p>Filters entries that are not to be processed in the loop (for example, RACF does not permit entries to be read with a filter condition; filtering must be performed in the central script logic on a per-entry basis).</p>
</div>
<div class="paragraph">
<p>For entries that should be ignored, the return code of the function should be set to 1; otherwise, 0 should be returned.</p>
</div>
<div class="paragraph">
<p>Synopsis:<br>
<strong>uh::LoopExtraFilter</strong> <em>data</em></p>
</div>
<div class="paragraph">
<p>Parameters:<br>
<em>data</em> - the name of the Tcl array that holds the source data</p>
</div>
<div class="paragraph">
<p>Global variables used:<br>
None.</p>
</div>
<div class="paragraph">
<p>Return values:<br>
0 if the source entry will not be ignored<br>
1 if the source entry will be ignored</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-tcl hljs" data-lang="tcl">set rc [uh::LoopExtraFilter rh_ldap]</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>uh::LoopExtraFunction</strong></p>
</div>
<div class="paragraph">
<p>Performs additional actions for an entry.</p>
</div>
<div class="paragraph">
<p>uh::LoopExtraFunction allows to perform additional actions for an entry (for example, to write additional log file information into a special file). Both the names of the source data array and the target data array are passed to the routine so that the user can operate on both arrays. In addition, the executed operation is passed in the operation parameter, the result of that operation in the rc parameter.</p>
</div>
<div class="paragraph">
<p>Synopsis:<br>
<strong>uh::LoopExtraFunction</strong> <em>source target operation rc</em></p>
</div>
<div class="paragraph">
<p>Parameters:<br>
<em>source</em> - the name of the Tcl array that holds the source data<br>
<em>target</em> - the name of the Tcl array that holds the mapped target data<br>
<em>operation</em> - the operation that has been performed for the entry:<br>
âaddâ: if the entry has been created<br>
âdelâ: if the entry has been deleted<br>
âmodâ: if the entry has been modified<br>
âmodifyDNâ: if the entry&#8217;s name has been changed<br>
âerrorâ: if the entry caused multiple matches<br>
âdoneâ: if the entry doesnât exist in the DIT</p>
</div>
<div class="paragraph">
<p><em>rc</em> - the return code of the directory operation</p>
</div>
<div class="paragraph">
<p>Global variables used:<br>
None.</p>
</div>
<div class="paragraph">
<p>Return values:<br>
0 if the source entry will not be ignored<br>
1 if the source entry will be ignored</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="paragraph">
<p>set rc [uh::LoopExtraFunction rh_file rh_ldap $action $update_res]</p>
</div>
<div class="paragraph">
<p><strong>uh::LoopPerformJoin</strong></p>
</div>
<div class="paragraph">
<p>Performs a user-specific join routine when an entry is exported to FILE. You can use this routine to calculate delta information by comparing the current set of entries with a previous set.</p>
</div>
<div class="paragraph">
<p>Synopsis:<br>
<strong>uh::LoopPerformJoin</strong> <em>source target joined_entry num</em></p>
</div>
<div class="paragraph">
<p>Parameters:<br>
<em>source name</em> - the Tcl array that holds the source data<br>
<em>target name</em> - the Tcl array that holds the mapped target data<br>
<em>joined_entry</em> - OUT: the array of data fields of the joined entry<br>
<em>num</em> - OUT: the number of matching entries</p>
</div>
<div class="paragraph">
<p>Global variables used:<br>
None.</p>
</div>
<div class="paragraph">
<p>Return values:<br>
0 on success<br>
1 on error</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-tcl hljs" data-lang="tcl">set rc [uh::LoopPerformJoin rh_file rh_ldap entry count]</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Note</strong>: When using name spaces, there might be problems using the variable source and target. As an alternative the following expression can be used:</p>
</div>
<div class="paragraph">
<p>"rh_&lt;?job@InputChannel-DN@RoleName/&gt;" for source<br>
"rh_&lt;?job@OutputChannel-DN[Anchor=DATA]@RoleName/&gt;" for target</p>
</div>
<div class="paragraph">
<p><strong>uh::Preprocessing</strong></p>
</div>
<div class="paragraph">
<p>Prepares everything that&#8217;s needed before the profile code is executed. No files or handles are open at this time.</p>
</div>
<div class="paragraph">
<p>Synopsis:<br>
<strong>uh::Preprocessing</strong></p>
</div>
<div class="paragraph">
<p>Parameters:<br>
None.</p>
</div>
<div class="paragraph">
<p>Global variables used:<br>
None.</p>
</div>
<div class="paragraph">
<p>Return values:<br>
0 on success<br>
1 on error</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-tcl hljs" data-lang="tcl">set rc [uh::Preprocessing]</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>uh::Prolog</strong></p>
</div>
<div class="paragraph">
<p>Handles everything that&#8217;s needed before the loop is entered (for example, opening additional files or setting additional control variables with references).</p>
</div>
<div class="paragraph">
<p>Synopsis:<br>
<strong>uh::Prolog</strong></p>
</div>
<div class="paragraph">
<p>Parameters:<br>
None.</p>
</div>
<div class="paragraph">
<p>Global variables used:<br>
None.</p>
</div>
<div class="paragraph">
<p>Return values:<br>
0 on success<br>
1 on error</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-tcl hljs" data-lang="tcl">set rc [uh::Prolog]</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_post_join_mapping_tcl_interfaces"><a class="anchor" href="#_ch1_post_join_mapping_tcl_interfaces"></a><a class="link" href="#_ch1_post_join_mapping_tcl_interfaces">1.3.1.10.3. Post-Join Mapping Tcl Interfaces</a></h6>
<div class="paragraph">
<p>The following Tcl interfaces are provided in <strong>post_join_mapping.tcl</strong>:</p>
</div>
<div class="paragraph">
<p><strong>uh::LoopPostJoin</strong></p>
</div>
<div class="paragraph">
<p>Performs additional mapping before calling the ADD, DELETE or MODIFY operation. Mappings that are commonly used for ADD, DELETE, and MODIFY operations should be listed in the body of this procedure. Internally, uh::LoopPostJoin calls one of the following subroutines:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>uh::postMappingAdd</p>
</li>
<li>
<p>uh::postMappingDel</p>
</li>
<li>
<p>uh::postMappingMod</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The operation-specific mappings should be listed in one of these procedures.</p>
</div>
<div class="paragraph">
<p>The action parameter is used as an input and an output parameter. When used as an input parameter, it indicates the directory operation that should normally be performed. This operation can change if the situation requires an operation other than the initially calculated one.</p>
</div>
<div class="paragraph">
<p>Synopsis:<br>
<strong>uh::LoopPostJoin</strong> s<em>ource target joined_entry action</em></p>
</div>
<div class="paragraph">
<p>Parameters:<br>
<em>source</em> - the name of the Tcl array that holds the source data<br>
<em>target</em> - OUT: the name of the Tcl array that holds the mapped target data<br>
<em>joined_entry</em> - the name of the Tcl array that holds the joined entry<br>
<em>action</em> - IN/OUT: the calculated action, which is one of the following values:<br>
âaddâ for object creation<br>
âmodâ for object modification<br>
âdelâ for object deletion</p>
</div>
<div class="paragraph">
<p>Global variables used:<br>
None.</p>
</div>
<div class="paragraph">
<p>Return values:<br>
0 - indicates successful post mapping<br>
1 - indicates an error in post mapping</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-tcl hljs" data-lang="tcl">set rc [uh::LoopPostJoin rh_file rh_ldap entry mod]</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>uh::postMappingAdd</strong></p>
</div>
<div class="paragraph">
<p>uh::postMappingAdd allows you to perform additional mapping procedures before the final directory update operation (which normally is an ADD operation) is called.</p>
</div>
<div class="paragraph">
<p>The action parameter is used as an input and an output parameter. When used as an input parameter, it indicates the directory operation that should normally be performed. This operation can change if the situation requires an operation other than the initially calculated one.</p>
</div>
<div class="paragraph">
<p>Synopsis:<br>
<strong>uh::postMappingAdd</strong> <em>source target action</em></p>
</div>
<div class="paragraph">
<p>Parameters:<br>
<em>source</em> - the name of the Tcl array that holds the source data<br>
<em>target</em> - OUT: the name of the Tcl array that holds the mapped target data<br>
<em>action</em> - IN/OUT: the calculated action, which is one of the following values:<br>
âaddâ for object creation<br>
âmodâ for object modification<br>
âdelâ for object deletion</p>
</div>
<div class="paragraph">
<p>Global variables used:<br>
None.</p>
</div>
<div class="paragraph">
<p>Return values:<br>
0 - indicates successful post mapping<br>
1 - indicates an error in post mapping</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-tcl hljs" data-lang="tcl">set rc [uh::postMappingAdd rh_file rh_ldap add]</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>uh::postMappingDel</strong></p>
</div>
<div class="paragraph">
<p>uh::postMappingDel allows you to perform additional mapping procedures before the final directory update operation (which normally is a DELETE operation) is called.</p>
</div>
<div class="paragraph">
<p>The action parameter is used as an input and an output parameter. When used as an input parameter, it indicates the directory operation that should normally be performed. This operation can change if the situation requires an operation other than the initially calculated one.</p>
</div>
<div class="paragraph">
<p>Synopsis:<br>
<strong>uh::postMappingDel</strong> <em>source target joined_entry action</em></p>
</div>
<div class="paragraph">
<p>Parameters:<br>
<em>source</em> - the name of the Tcl array that holds the source data<br>
<em>target</em> - OUT: the name of the Tcl array that holds the mapped target data<br>
<em>joined_entry</em> - the name of the Tcl array that holds the joined entry<br>
<em>action</em> - IN/OUT: the calculated action, which is one of the following values:<br>
âaddâ for object creation<br>
âmodâ for object modification<br>
âdelâ for object deletion</p>
</div>
<div class="paragraph">
<p>Global variables used:<br>
None.</p>
</div>
<div class="paragraph">
<p>Return values:<br>
0 - indicates successful post mapping<br>
1 - indicates an error in post mapping</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-tcl hljs" data-lang="tcl">set rc [uh::postMappingDel rh_file rh_ldap entry del]</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>uh::postMappingMod</strong></p>
</div>
<div class="paragraph">
<p>uh::postMappingMod allows you to perform additional mapping procedures before the final directory update operation (which normally is a MODIFY operation) is called.</p>
</div>
<div class="paragraph">
<p>The action parameter is used as an input and an output parameter. When used as an input parameter, it indicates the directory operation that should normally be performed. This operation can change if the situation requires an operation other than the initially calculated one.</p>
</div>
<div class="paragraph">
<p>Synopsis:<br>
<strong>uh::postMappingMod</strong> <em>source target joined_entry action</em></p>
</div>
<div class="paragraph">
<p>Parameters:<br>
<em>source</em> - name of the Tcl array that holds the source data<br>
<em>target</em> - OUT: name of the Tcl array that holds the mapped target data<br>
<em>joined_entry</em> - name of the Tcl array that holds the joined entry<br>
<em>action</em> - IN/OUT: the calculated action, which is one of the following values:<br>
âaddâ for object creation<br>
âmodâ for object modification<br>
âdelâ for object deletion</p>
</div>
<div class="paragraph">
<p>Global variables used:<br>
None.</p>
</div>
<div class="paragraph">
<p>Return values:<br>
0 - indicates successful post mapping<br>
1 - indicates an error in post mapping</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-tcl hljs" data-lang="tcl">set rc [uh::postMappingMod rh_file rh_ldap entry del]</code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch1_global_tcl_variables"><a class="anchor" href="#_ch1_global_tcl_variables"></a><a class="link" href="#_ch1_global_tcl_variables">1.3.1.11. Global Tcl Variables</a></h5>
<div class="paragraph">
<p>This section describes all of the variables that can be used when working with the Connectivity standard script.</p>
</div>
<div class="sect5">
<h6 id="_ch1_control_script_variables"><a class="anchor" href="#_ch1_control_script_variables"></a><a class="link" href="#_ch1_control_script_variables">1.3.1.11.1. Control Script Variables</a></h6>
<div class="paragraph">
<p>The default applications use a set of global variables that are defined in <strong>control.tcl</strong>. Many of these variables can be used in the user hook routines, if not already passed as argument.</p>
</div>
<div class="paragraph">
<p>The description of the user hook interfaces lists only the global Tcl variables that are currently used by the given routine. Because you can set up very complex user hooks, the description of an interface doesnât list all of the global variables that are available. Itâs up to you to select the relevant variables, if required.</p>
</div>
<div class="paragraph">
<p>The most important global variables are (in alphabetical order):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>add_entries</strong> - NONE = no addition, ADD = addition only, NTF = notification only, ADDNTF = addition and notification.</p>
</li>
<li>
<p><strong>debug_trace</strong> - 0 â no trace, 1 â variable trace to screen (compatibility mode), 2 â variable trace to file (compatibility mode), 4 â variable trace to screen, 5 â variable trace to file, 8 â command trace to screen, 9 â command trace to file, 12 â command and variable trace to screen, 13 â command and variable trace to file.</p>
</li>
<li>
<p><strong>delete_entries</strong> - NONE = no deletion, DEL = deletion only, NTF = notification only, DELNTF = deletion and notification.</p>
</li>
<li>
<p><strong>deletion_mode</strong> - PHYSICAL = physical removal of entry, MARK = entry is only marked, MOVE = entry is moved to tombstone area, USER = user hook defines the mechanism.</p>
</li>
<li>
<p><strong>delta_check</strong> - defines whether the script runs in delta mode. FALSE = Delta Mode is off, TRUE = Delta Mode is on.</p>
</li>
<li>
<p><strong>delta_date</strong> - the deltaInputData delivered from the Identity server.</p>
</li>
<li>
<p><strong>exact_action</strong> - (static) Tcl variable:<br>
TRUE = prohibits soft change of action from add to modify or no action when entry is already deleted (if set to TRUE). Reports error instead.<br>
FALSE = allows soft change of action.</p>
</li>
<li>
<p><strong>filter_type</strong> - defines whether the filter or join_expression field shall be taken for the join operation. Either table or expert.</p>
</li>
<li>
<p><strong>GUIDparam</strong> - (static) Tcl array with information for generation of GUIDs; its subcomponents are<br>
type - GUID generation type (none, local, global).<br>
targetIDattr - attribute where to store the generated GUID in the target directory.<br>
blockSize - number of central GUIDs to be generated to minimize read accesses.<br>
user - user name to access the configuration tree of Connectivity.<br>
pass - password to access the configuration tree of Connectivity.<br>
address - server address to access the configuration tree of Connectivity.<br>
base - search base.<br>
nr_free_guids - internal counter for number of free GUIDs in the block.<br>
next_free_guid - next free GUID in the block.<br>
sourceGuidID - fixed value to be used as prefix for the generation of a local GUID.<br>
sourceIDattr - attribute from which to obtain the variable (unique) part of local GUID to be generated.</p>
</li>
<li>
<p><strong>init_mode</strong> - type of script operation:<br>
real = real operation.<br>
trial = simulation (no real operation, only traces).<br>
If trial mode is selected, the meta controller must exit with error (because no valid data has been generated for subsequent steps).</p>
</li>
<li>
<p><strong>join_expression</strong> - join expression filter.</p>
</li>
<li>
<p><strong>master_name</strong> - master name to be filled into the target entry.</p>
</li>
<li>
<p><strong>max_trace_entries</strong> - maximum number of hits displayed in trace file.</p>
</li>
<li>
<p><strong>min_source_entries</strong> - minimum number of source entries that must be present (valid for import and export).</p>
</li>
<li>
<p><strong>modify_entries</strong> - NONE = No modification, MOD = Modification only, NTF = Notification only, MODNTF = Modification and Notification.</p>
</li>
<li>
<p><strong>notif_notok</strong> - 0 = no notification, 1 = notification when workflow ended with warning, 2 = notification when workflow ended with error, 3 = notification when not OK (error or warning).</p>
</li>
<li>
<p><strong>notify_notok_file</strong> - the INI file for the "notify if not ok" operation.</p>
</li>
<li>
<p><strong>notify_data_file</strong> - the INI file for notification to write entries for manual handling.</p>
</li>
<li>
<p><strong>object_class_collection</strong> - the object to which the object_classes belong (for example, user or group).</p>
</li>
<li>
<p><strong>object_classes</strong> - the object classes that must be handled during an add or modify operation.</p>
</li>
<li>
<p><strong>operational_attributes</strong> - whether or not operational attributes like dxrState shall be handled.</p>
</li>
<li>
<p><strong>opr</strong> - the operational attributes to be used (by default, dxmOprMaster, dxrState, dxrStartDate, dxrEndDate).</p>
</li>
<li>
<p><strong>rename_entries</strong> - FALSE = move DN not allowed, TRUE = move DN allowed.</p>
</li>
<li>
<p><strong>src_conn_param</strong> - (static) a Tcl array with information about source connection; its subcomponents are<br>
attr_file - name of attribute configuration file.<br>
attr_file_localcode - code set of the attribute configuration file.<br>
attr_list - list of attributes to be handled at the source side.<br>
dir_type - type of source connection.<br>
dir_subtype - subtype of LDAP directory (RACF, NDS) to react on specific behavior.<br>
superior_info - information to create higher level entries.<br>
data_file - name of data file (if dir_type=File).<br>
file_format - file format (if dir_type=File).<br>
file_mode - read or write mode (if dir_type=File).<br>
file_localcode - code set of file (if dir_type=File).<br>
authentication - type of authentication.<br>
user_name - user name of bind profile.<br>
user_pwd - user password of bind profile.<br>
ssl - FALSE = no SSL connection, TRUE = SSL connection.<br>
server_address - server TCP/IP address and port number.<br>
protocol - LDAP protocol (V2 or V3).<br>
bind_id - internal name of bind connection.<br>
LDIFchangeOutput - write all operations into an LDIF change file instead of direct LDAP operations.<br>
LDIFagreementFolder - the folder where DirX changelogs reside.</p>
</li>
<li>
<p><strong>src_data</strong> - the name of the Tcl array that holds the source entry. The source entry&#8217;s data is available after the source entry has been read from the source directory and therefore can be used in the following user hooks:<br>
uh::LoopExtraFilter<br>
uh::LoopExtraFunction<br>
uh::LoopPerformJoin<br>
uh::LoopPostJoin</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note: When using name spaces, there might be problems using the variable âsrc_dataâ. The following expression can be used as an alternative:<br>
"rh_&lt;?job@InputChannel-DN@RoleName/&gt;"</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>src_add_marking_attr</strong> - the attribute type that is used as status attribute to indicate add operations at the source side.</p>
</li>
<li>
<p><strong>src_add_marking_value</strong> - the value that indicates an add operation at the source side.</p>
</li>
<li>
<p><strong>src_del_marking_attr</strong> - the attribute type that is used as status attribute to indicate delete operations at the source side.</p>
</li>
<li>
<p><strong>src_del_marking_value</strong> - the value that indicates a delete operation at the source side.</p>
</li>
<li>
<p><strong>src_search_param</strong> - (static) a Tcl array with information about source search parameters; its subcomponents are<br>
base_obj - the base object at which to start the search.<br>
subset - the search scope, either -baseobject, -onelevel, -subtree.<br>
filter - the filter definition for the search.<br>
or_filter - the OR filter (optional).<br>
read_DN_only - read DNs only. Perform for each entry a separate search afterwards. Either true or false.<br>
paged_read - read in paged read mode, either true or false.<br>
page_size - the page size for paged read.</p>
</li>
<li>
<p><strong>src_sort_param</strong> - (static) a Tcl array with information about source sorting parameters; its subcomponents are<br>
sorted_list - FALSE = result not sorted, TRUE = result sorted.<br>
key - the attribute to sort when the result shall be sorted. DDN cannot be used!<br>
order - ASCENDING = ascending sort order, DESCENDING = descending sort order.</p>
</li>
<li>
<p><strong>start_time</strong> - a Tcl variable that holds the start time.</p>
</li>
<li>
<p><strong>statistics</strong> - a switch that suppresses standard <strong>metacp</strong> statistics.</p>
</li>
<li>
<p><strong>target_entry_exists</strong> - the name of an attribute that is used to indicate whether an entry exists in the target system.</p>
</li>
<li>
<p><strong>test_mapping_only</strong> - FALSE = full operation, TRUE = only mapping is performed.</p>
</li>
<li>
<p><strong>test_max_entries</strong> - the number of entries that are mapped when test_mapping_only is TRUE.</p>
</li>
<li>
<p><strong>tgt_add_marking_attr</strong> - the attribute type that is used as a status attribute to mark add operations.</p>
</li>
<li>
<p><strong>tgt_add_marking_value</strong> - the value that is used as a status attribute to mark add operations.</p>
</li>
<li>
<p><strong>tgt_conn_param</strong> - (static) a Tcl array with information about target connection; its subcomponents are the same as in the <strong>src_conn_param</strong> variable.</p>
</li>
<li>
<p><strong>tgt_data</strong> - the name of the Tcl array that holds the target entry. The target entry&#8217;s data is available after the target entry has been mapped and therefore can be used in the following user hooks:<br>
uh::LoopExtraFilter<br>
uh::LoopExtraFunction<br>
uh::LoopPerformJoin<br>
uh::LoopPostJoin</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note: When using name spaces, there might be problems using the variable âtgt_dataâ. The following expression can be used as an alternative:<br>
"rh_&lt;?job@OutputChannel-DN[Anchor=DATA]@RoleName/&gt;"</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>tgt_del_marking_attr</strong> - the attribute type that is used as a status attribute to mark delete operations.</p>
</li>
<li>
<p><strong>tgt_del_marking_value</strong> - the value that is used as a status attribute to mark delete operations.</p>
</li>
<li>
<p><strong>tgt_import_mode</strong> - REPLACE = Complete subtree in the target area is replaced by subtree from source, MERGE = Subtree from source is merged into subtree in target.</p>
</li>
<li>
<p><strong>tgt_keep_objects</strong> - the objects that are not to be deleted.</p>
</li>
<li>
<p><strong>tgt_mod_marking_attr</strong> - the attribute type that is used as a status attribute to mark modify operations.</p>
</li>
<li>
<p><strong>tgt_mod_marking_value</strong> - the value that is used as a status attribute to mark modify operations.</p>
</li>
<li>
<p><strong>tgt_search_param</strong> - (static) a Tcl array with information about target search parameters; its subcomponents are<br>
base_obj - the base object from which to start the search.<br>
subset - BASE_OBJECT, ONE_LEVEL, SUBTREE.<br>
filter - the filter to perform a join operation.<br>
delete_filter - the search filter that searches the set of entries for REPLACE mode.<br>
read_DN_only - read DNs only. Perform for each entry a separate search afterwards. Either true or false.<br>
paged_read - read in paged read mode, either true or false.<br>
page_size - the page size for paged read.</p>
</li>
<li>
<p><strong>tgt_sort_param</strong> - (static) a Tcl array with information about target sorting parameters; its subcomponents are the same as the src_sort_param variable.</p>
</li>
<li>
<p><strong>tombstone_base</strong> - the base node at which to place the deleted entries (if deletion_mode = MOVE).</p>
</li>
<li>
<p><strong>trace_file</strong> - the name of the trace file.</p>
</li>
<li>
<p><strong>trace_level</strong> - 1 = Error trace, 2 = Full trace, 3 = Short trace.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_profile_script_variables"><a class="anchor" href="#_ch1_profile_script_variables"></a><a class="link" href="#_ch1_profile_script_variables">1.3.1.11.2. Profile Script Variables</a></h6>
<div class="paragraph">
<p>The profile script <strong>profile.tcl</strong> also defines some global variables. These variables are created in the procedures listed in <strong>common.tcl</strong> while executing the synchronization logic.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>counter</strong> - a Tcl array of counters used for additional statistic information; its components are</p>
</li>
<li>
<p>mappingProblem - the number of ignored records/entries due to mapping problems</p>
</li>
<li>
<p>userFilter - the number of ignored records/entries due to user defined filtering</p>
</li>
<li>
<p>wrongDates - the number of ignored records/entries due to expirationDate &lt; entryDate</p>
</li>
<li>
<p>alreadyExpired - the number of ignored records/entries due to expirationDate is already in the past</p>
</li>
<li>
<p>missingSortKey - the number of ignored records/entries due to sorting key attribute not present</p>
</li>
<li>
<p>missingSortKey - the number of ignored records/entries due to sorting key attribute not present</p>
</li>
<li>
<p>illegalFilter - the number of ignored records/entries due to illegal filters</p>
</li>
<li>
<p>nonUnique - the number of ignored records/entries due to non unique objects found in the DIT</p>
</li>
<li>
<p>noPermission - the number of ignored records/entries due to missing permissions</p>
</li>
<li>
<p>nonExistingObj - the number of ignored records/entries due to non existing objects</p>
</li>
<li>
<p>differentMaster - the number of ignored records/entries due to ownership of entry is held by a different master</p>
</li>
<li>
<p>exactAction - the number of ignored records/entries because the calculated action is different from action provided with the record/entry</p>
</li>
<li>
<p>sourceEntryCount - the number of entries processed from source directory</p>
</li>
<li>
<p>guidError - the number of ignored records/entries due to errors while generating a GUID</p>
</li>
<li>
<p><strong>entry_handle</strong> - the name of the handle that represents the current matching entry in the target directory. The handle name is set to "entry_h" (or âentry_hâ and âentry_h_nextâ when paged results are used). Itâs available after the join has been performed.</p>
</li>
<li>
<p><strong>ExitCode</strong> - the Tcl variable that holds the current exit code used by <strong>profile.tcl</strong> when terminating. Pre-defined exit codes are the following global values:</p>
</li>
<li>
<p>TCL_ERROR (4) - a Tcl script is syntactically incorrect.</p>
</li>
<li>
<p>SERIOUS_ERROR (10) - a <strong>meta</strong> command of <strong>metacp</strong> failed.</p>
</li>
<li>
<p>ERROR (11) - the parameters defined in <strong>control.tcl</strong> are inconsistent, so the synchronization cannot be performed; for example, sorted results should be generated, but no sort key is given.</p>
</li>
<li>
<p>DATA_ERROR (12) - the minimum number of expected source entries (min_source_entries) is not available.</p>
</li>
<li>
<p>NOTIFICATION_ERROR (59) - errors occurred while sending notifications.</p>
</li>
<li>
<p>WARNING (60) - the workflow terminated with warnings, for example, the object that should be modified belongs to a different master.</p>
</li>
<li>
<p>WARNING_UPDATE (61) - an LDAP update operation terminated with an error.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The meta controller itself can also generate errors. For information about these errors, refer to the <em>DirX Identity</em> <em>Meta Controller Reference</em>.</p>
</div>
<div class="paragraph">
<p>Note: Users can exit in the user hooks directly. But before terminating the meta controller, at least <strong>meta</strong> <strong>terminate</strong> should be called in order to get a consistent trace file output.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>src_conn_handles</strong> - the Tcl array that holds the names of source connection handles; components are:</p>
</li>
<li>
<p>Standard - a connection handle that requests all the attributes to be synchronized. The handle name is set to âsrc_châ. Itâs available after initChannel for the source channel has been called and therefore can be used in the following user hooks:<br>
uh::LoopExtraFilter<br>
uh::LoopExtraFunction<br>
uh::LoopPerformJoin<br>
uh::LoopPostJoin<br>
uh::GenerateTombstoneDN</p>
</li>
<li>
<p>Minimal - a connection handle that requests just a very limited number of attributes, e.g. DDN, dxrState and the sort key attribute. The handle name is set to âsrc_min_châ in case the âread_DN_onlyâ flag is set for that connection. In that case itâs available after initChannel for the source channel has been called and therefore can be used in the following user hooks:<br>
uh::LoopExtraFilter<br>
uh::LoopExtraFunction<br>
uh::LoopPerformJoin<br>
uh::LoopPostJoin<br>
uh::GenerateTombstoneDN</p>
</li>
<li>
<p><strong>src_search_res_handle</strong> - the name of the search result handle used for accessing the source search result. The handle name is set to "src_search_res". Itâs available after initChannel for the source channel has been called.</p>
</li>
<li>
<p><strong>start_time</strong> - the Tcl variable that holds the start time of the job. This variable is available after the routine initJob has been called in <strong>profile.tcl</strong>.</p>
</li>
<li>
<p><strong>tgt_conn_handles</strong> - the Tcl array that holds the names of target connection handles; its components are</p>
</li>
<li>
<p>Standard - a connection handle that requests all the attributes to be synchronized. The handle name is set to "tgt_ch". It can be used whenever additional data is to be written into the target connected directory.</p>
</li>
<li>
<p>Minimal - a connection handle that requests just a very limited number of attributes, e.g. DDN dxrState and the sort key attribute. The handle name is set to âtgt_min_châ in case the âread_</p>
</li>
<li>
<p>LDIF-CHANGE - a connection handle used while processing LDIF change files. The handle name is set to "tgt_ldif_change_ch".</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The handles are available after initChannel for the target channel has been called and therefore can be used in the following user hooks:<br>
uh::LoopExtraFilter<br>
uh::LoopExtraFunction<br>
uh::LoopPerformJoin<br>
uh::LoopPostJoin<br>
uh::GenerateTombstoneDN</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>tgt_del_handles</strong> - the Tcl array that holds the names of target connection handles that are used when deleting/moving objects; its components are</p>
</li>
<li>
<p>ldap_del_ch - the name of the LDAP connection to be used when physically deleting objects. The handle name is set to "del_ch".</p>
</li>
<li>
<p>ldap_del_handle - the name of the handle to be used when physically deleting objects. The handle name is set to "del_hdl".</p>
</li>
<li>
<p>ldap_mark_ch - the name of the LDAP connection to be used for marking objects. The handle name is set to "mod_ch".</p>
</li>
<li>
<p>ldap_mark_handle - the name of the handle to be used when marking objects for deletion. The handle name is set to "rh_mod".</p>
</li>
<li>
<p>ldap_move_ch - the name of the LDAP connection to be used for moving objects. The handle name is set to "mod_ch".</p>
</li>
<li>
<p>ldap_move_handle - the name of the handle to be used when moving objects to the tombstone branch. The handle name is set to "rh_mod".</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The handles are available after initChannel for the target channel has been called and therefore can be used in the following user hooks:<br>
uh::LoopExtraFilter<br>
uh::LoopExtraFunction<br>
uh::LoopPerformJoin<br>
uh::LoopPostJoin<br>
uh::GenerateTombstoneDN</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>tgt_search_res_handle</strong> - the name of the search result handle to be used for accessing the target search result. The handle name is set to "tgt_search_res". Itâs available after initChannel for the source channel has been called.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch1_meta_handles"><a class="anchor" href="#_ch1_meta_handles"></a><a class="link" href="#_ch1_meta_handles">1.3.1.12. Meta Handles</a></h5>
<div class="paragraph">
<p>The default Connectivity applications use the following "meta" handles that can be used in the user hook routines:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>del_ch</strong> - for details, see the description of the Tcl array tgt_del_handles in the section âGlobal Tcl Variablesâ.</p>
</li>
<li>
<p><strong>del_hdl</strong> - for details, see the description of the Tcl array tgt_del_handles in the section âGlobal Tcl Variablesâ.</p>
</li>
<li>
<p><strong>entry_h</strong> and <strong>entry_h_next</strong> for details, see the description of the Tcl variable entry_handle in the section âGlobal Tcl Variablesâ.</p>
</li>
<li>
<p><strong>mod_ch</strong> - for details, see the description of the Tcl array tgt_del_handles in the section âGlobal Tcl Variablesâ.</p>
</li>
<li>
<p><strong>rh_mod</strong> - for details, see the description of the Tcl array tgt_del_handles in the section âGlobal Tcl Variablesâ.</p>
</li>
<li>
<p><strong>src_ah</strong> - represents the attribute handle for accessing the source attribute configuration file. The handle is available once the routine initChannel has been called for the source channel.</p>
</li>
<li>
<p><strong>src_ch</strong> - for details, see the description of the Tcl array src_conn_handles in the section âGlobal Tcl Variablesâ.</p>
</li>
<li>
<p><strong>src_min_ch</strong> - for details, see the description of the Tcl array src_conn_handles in the section âGlobal Tcl Variablesâ.</p>
</li>
<li>
<p><strong>src_search_res</strong> - for details, see the description of the Tcl variable src_search_res_handle in the section âGlobal Tcl Variablesâ.</p>
</li>
<li>
<p><strong>tgt_ah</strong> - represents the attribute handle for accessing the target attribute configuration file. The handle is available once the routine initChannel has been called for the target channel.</p>
</li>
<li>
<p><strong>tgt_ch</strong> - for details, see the description of the Tcl array tgt_conn_handles in the section âGlobal Tcl Variablesâ.</p>
</li>
<li>
<p><strong>tgt_ldif_change_ch</strong> - for details, see the description of the Tcl array tgt_conn_handles in the section âGlobal Tcl Variablesâ.</p>
</li>
<li>
<p><strong>tgt_min_ch</strong> - for details, see the description of the Tcl array tgt_conn_handles in the section âGlobal Tcl Variablesâ.</p>
</li>
<li>
<p><strong>tgt_search_res</strong> - for details, see the description of the Tcl variable tgt_search_res_handle in the section âGlobal Tcl Variablesâ.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch1_understanding_delta_handling"><a class="anchor" href="#_ch1_understanding_delta_handling"></a><a class="link" href="#_ch1_understanding_delta_handling">1.3.2. Understanding Delta Handling</a></h4>
<div class="paragraph">
<p>This section describes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The types of delta-handling mechanisms that DirX Identity supports</p>
</li>
<li>
<p>The DirX Identity controls for delta operations</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="_ch1_types_of_delta_handling"><a class="anchor" href="#_ch1_types_of_delta_handling"></a><a class="link" href="#_ch1_types_of_delta_handling">1.3.2.1. Types of Delta handling</a></h5>
<div class="paragraph">
<p>Directory synchronizations typically run in full or delta mode. DirX Identity supports different methods of delta handling. There are three ways that a job can manage delta handling:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Type DATE: Using a date from which entries in the connected directory must be extracted (typically the data of the end of the last synchronization).</p>
</li>
<li>
<p>Type USN: Using unique serial numbers provided by some directories. The number from the last synchronization is used for the next one</p>
</li>
<li>
<p>Type FILE: Using a delta file that contains information about the last run. Some jobs keep delta files from different runs.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Most agents and connected directories only support one of these methods, which means that this is a fixed parameter that cannot be changed. You can use the DirX Identity Manager to view a delta job to see which type of delta is supported (select the Delta Handling tab and then examine the <strong>Delta</strong> <strong>Type</strong> field).</p>
</div>
<div class="paragraph">
<p><strong>Note:</strong> If a workflow contains jobs that work in delta mode, DirX Identity guarantees that the delta information is only updated when the complete workflow runs successfully (does not return closed.completed.error). Thus the next run of the workflow will start the same delta operation as the previous one (the one that failed). This operation ensures that no data is lost.</p>
</div>
<div class="paragraph">
<p><strong>Warning:</strong> Do not use the <strong>Ignore Errors</strong> flag of the Activity object for jobs that use delta handling. This could result in serious data loss! (For details on the <strong>Ignore Errors</strong> flag see the <em>Connectivity Administration Guide</em> &#8594; Context Sensitive Help &#8594; Tcl-based Workflows &#8594; Tcl-based Activity.)</p>
</div>
<div class="sect5">
<h6 id="_ch1_date_oriented_delta_handling"><a class="anchor" href="#_ch1_date_oriented_delta_handling"></a><a class="link" href="#_ch1_date_oriented_delta_handling">1.3.2.1.1. Date-Oriented Delta Handling</a></h6>
<div class="paragraph">
<p>In order to perform date-oriented delta handling, each entry in the configuration database must contain a creation and/or a modification date. If another attribute is used for date oriented delta handling all entries must have this attribute set (see the Delta Time Attribute setting for jobs in the <em>Connectivity Administration Guide</em> &#8594; Context Sensitive Help &#8594; Jobs &#8594; Operation &#8594; Delta Handling).</p>
</div>
<div class="paragraph">
<p>You can then extract and process all entries where the delta time attribute has changed since the last delta date, which must be kept in the configuration database under the corresponding job entry.</p>
</div>
<div class="paragraph">
<p>Note that this type of delta handling cannot detect explicitly deleted entries because they are no longer contained in the directory. Deletions can only be properly handled if they are marked with a specific value (but not deleted) or if they have been moved to a tombstone area.</p>
</div>
<div class="paragraph">
<p>For password synchronization a special algorithm is used that compensates time differences between client and server machines. The mechanism consists of a client side and workflow side part.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_client_side_handling"><a class="anchor" href="#_ch1_client_side_handling"></a><a class="link" href="#_ch1_client_side_handling">1.3.2.1.2. Client-Side Handling</a></h6>
<div class="paragraph">
<p>If the client writes a password to a user entry it sets the dxmPwdLastChange attribute to the local time plus a previously calculated offset representing the time difference of the local machine to the machine where the directory server resides (dxmPwdLastChange = localtime + offset).</p>
</div>
<div class="paragraph">
<p>It then reads the entry and checks whether the absolute difference between the dxmPwdLastChange attribute and the modification timestamp is below a defined limit (see for example the Delta Time attribute of the event manager in the <em>Connectivity Administration Guide</em> &#8594; Context Sensitive Help &#8594; Jobs &#8594; Tcl-based Event Manager - Operation). If the comparison fails the dxmPwdLastChange value is set to the value of the modifyTimestamp and the offset value is adapted. Note that the modification timestamp might be slightly higher than the value of the dxmPwdLastChange attribute because the second write operation differs from the first one.</p>
</div>
<div class="paragraph">
<p>The client must calculate the offset after startup during handling of the first entry. It writes the password to the first entry and reads the modifyTimeStamp. It compares it with the local time and stores the difference in offset (offset=modifyTS - localtime). For this entry it writes the dxmPwdLastChange attribute with the modifyTimeStamp value.</p>
</div>
<div class="paragraph">
<p>This algorithm guarantees that the dxmPwdLastChange attribute of the entries differs only within the defined limit even if the client and server machines run with different clock settings. Note that these calculations must be done in GMT time to work properly.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_workflow_side_handling"><a class="anchor" href="#_ch1_workflow_side_handling"></a><a class="link" href="#_ch1_workflow_side_handling">1.3.2.1.3. Workflow-Side Handling</a></h6>
<div class="paragraph">
<p>Even if the dxmPwdLastChange is adjusted by the client side algorithm, the standard script provides a mechanism that allows compensating the remaining difference. You can activate this mechanism with the Password Synchronization flag of a meta controller job. Additionally you must set the Delta Time Attribute to "dxmPwdLastChange" and define the compensation time (Password Delta Time). (For details see <em>Connectivity Administration Guide</em> &#8594; Context Sensitive Help &#8594; Jobs &#8594; Operation &#8594; Delta Handling.) You should set the Password Delta Time to a value slightly higher than the highest limit of all clients. A good value to start is to set the Delta Time of the clients to 2 seconds and the Password Delta Time to 3 or more seconds.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch1_applsref/image30.png" alt="image30">
</div>
<div class="title">Figure 29. Workflow-Side Delta Handling</div>
</div>
<div class="paragraph">
<p>The workflows retrieve password changes from the directory by using the dxmPwdLastChange attribute as delta time attribute for the DirX Identity delta mechanism. Due to the fact that the dxmPwdLastChange attribute is only exact within some limit (the reason is that the modifyTimestamp attribute is only delivered in seconds) a comparison between the list of retrieved directory entries and a stored delta file in the work area of the password synchronization workflow can be used to identify the real difference. The delta file contains at the beginning the delta_input information and then a set of password changes of the last run. The UID can be any unique attribute that is used for join purposes in the target systems (for example employeeNumber).</p>
</div>
<div class="paragraph">
<p>The fact that the delta workflow can fail due to various reasons complicates this issue (this results in no update of the delta information in the configuration database). Thus the workflow must keep two delta files in his work area. The file names are fixed: _delta_primary.csv and _delta_secondary.csv</p>
</div>
<div class="paragraph">
<p>Based on this concept we must distinguish two possible use cases:</p>
</div>
<div class="paragraph">
<p><strong>Use Case 1</strong>: <strong>Full transfer</strong> - The workflow retrieves all entries from the directory. The delta files must be ignored.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In this case a lot of password updates at the target systems could fail if the password policy is set to 'user cannot set the same password again'. Nevertheless at the end of this workflow all passwords in the target system are up to date.</p>
</li>
<li>
<p>If the target system allows overwriting the same password value the result is up to date passwords, too. If the target system delivers password events (for example via the Windows Password Listener) then a lot of such events could be generated which results in high load of the message system. These changes are blocked at the event manager so the loop is broken here (overwriting the same password is not possible).</p>
</li>
<li>
<p>A new delta file _delta_primary.csv is written at the end that keeps the last few entries according to the Password Delta Time value set (for example the last three seconds).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Full password workflow synchronizations can result in many warnings that should be ignored.</p>
</div>
<div class="paragraph">
<p><strong>Case 2: Delta transfer</strong> - The workflow retrieves delta entries from the directory.</p>
</div>
<div class="paragraph">
<p>The workflow reads all entries based on the delta specification from the directory. In parallel it checks the delta files:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If no delta file is available, all entries are transferred to the target systems (this case should normally not happen).</p>
</li>
<li>
<p>If one delta file _delta_primary.csv is available and the delta_input_data is different from the first entry in the file, this file is used as delta list for comparison.</p>
</li>
<li>
<p>If one delta file _delta_primary.csv is available and the delta_input_data is equal (which indicates that the previous run was not successful), the second delta file _delta_secondary.csv is used as delta list for comparison. If this file is not present, all entries are transferred to the target system.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Comparison means that each entry from the source is compared with the delta list via the UID. If a UID is found in this list, the passwords (both encrypted) are compared. If they are equal, this entry was obviously already delivered and is dropped therefore. All other entries are delivered to the target system.</p>
</div>
<div class="paragraph">
<p>This mechanism guarantees that passwords are not delivered twice to the target system if the workflow runs in delta mode. Thus a warning for an entry must have another reason that the administrator should be sure to check.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_client_side_delta_handling"><a class="anchor" href="#_ch1_client_side_delta_handling"></a><a class="link" href="#_ch1_client_side_delta_handling">1.3.2.1.4. Client-Side Delta Handling</a></h6>
<div class="paragraph">
<p>If the client writes a password to a user entry it sets the dxmPwdLastChange attribute to the local time plus a previously calculated offset representing the time difference of the local machine to the machine where the directory server resides (dxmPwdLastChange = localtime + offset).</p>
</div>
<div class="paragraph">
<p>It then reads the entry and checks whether the absolute difference between the dxmPwdLastChange attribute and the modification timestamp is below a defined limit (see for example the Delta Time attribute of the event manager). If the comparison fails the dxmPwdLastChange value is set to the value of the modifyTimestamp and the offset value is adapted. Note that the modification timestamp might be slightly higher than the value of the dxmPwdLastChange attribute because the second write operation differs from the first one.</p>
</div>
<div class="paragraph">
<p>The client must calculate the offset after startup during handling of the first entry. It writes the password to the first entry and reads the modifyTimeStamp. It compares it with the local time and stores the difference in offset (offset=modifyTS - localtime). For this entry it writes the dxmPwdLastChange attribute with the modifyTimeStamp value.</p>
</div>
<div class="paragraph">
<p>This algorithm guarantees that the dxmPwdLastChange attribute of the entries differs only within the defined limit even if the client and server machines run with different clock settings. Note that these calculations must be done in GMT time to work properly.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_workflow_side_delta_handling"><a class="anchor" href="#_ch1_workflow_side_delta_handling"></a><a class="link" href="#_ch1_workflow_side_delta_handling">1.3.2.1.5. Workflow-Side Delta Handling</a></h6>
<div class="paragraph">
<p>Even if the dxmPwdLastChange is adjusted by the client side algorithm, the standard script provides a mechanism that allows compensating the remaining difference. You can activate this mechanism with the Password Synchronization flag of a meta controller job. Additionally you must set the Delta Time Attribute to "dxmPwdLastChange" and define the compensation time (Password Delta Time). You should set the Password Delta Time to a value slightly higher than the highest limit of all clients. A good value to start is to set the Delta Time of the clients to 2 seconds and the Password Delta Time to 3 or more seconds.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch1_applsref/image31.png" alt="Workflow-Side Delta handling">
</div>
<div class="title">Figure 30. Workflow-Side Delta handling</div>
</div>
<div class="paragraph">
<p>The workflows retrieve password changes from the directory by using the dxmPwdLastChange attribute as delta time attribute for the DirX Identity delta mechanism. Due to the fact that the dxmPwdLastChange attribute is only exact within some limit (the reason is that the modifyTimestamp attribute is only delivered in seconds) a comparison between the list of retrieved directory entries and a stored delta file in the work area of the password synchronization workflow can be used to identify the real difference. The delta file contains at the beginning the delta_input information and then a set of password changes of the last run. The UID can be any unique attribute that is used for join purposes in the target systems (for example employeeNumber).</p>
</div>
<div class="paragraph">
<p>The fact that the delta workflow can fail due to various reasons complicates this issue (this results in no update of the delta information in the configuration database). Thus the workflow must keep two delta files in his work area. The file names are fixed: _delta_primary.csv and _delta_secondary.csv</p>
</div>
<div class="paragraph">
<p>Based on this concept we must distinguish two possible use cases:</p>
</div>
<div class="paragraph">
<p><strong>Use Case 1: Full transfer</strong> - The workflow retrieves all entries from the directory. The delta files must be ignored.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In this case a lot of password updates at the target systems could fail if the password policy is set to 'user cannot set the same password again'. Nevertheless at the end of this workflow all passwords in the target system are up to date.</p>
</li>
<li>
<p>If the target system allows overwriting the same password value the result is up to date passwords, too. If the target system delivers password events (for example via the Windows Password Listener) then a lot of such events could be generated which results in high load of the message system. These changes are blocked at the event manager so the loop is broken here (overwriting the same password is not possible).</p>
</li>
<li>
<p>A new delta file _delta_primary.csv is written at the end that keeps the last few entries according to the Password Delta Time value set (for example the last three seconds).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Full password workflow synchronizations can result in many warnings that should be ignored.</p>
</div>
<div class="paragraph">
<p><strong>Case 2: Delta transfer</strong> - The workflow retrieves delta entries from the directory.</p>
</div>
<div class="paragraph">
<p>The workflow reads all entries based on the delta specification from the directory. In parallel it checks the delta files:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If no delta file is available, all entries are transferred to the target systems (this case should normally not happen).</p>
</li>
<li>
<p>If one delta file _delta_primary.csv is available and the delta_input_data is different from the first entry in the file, this file is used as delta list for comparison.</p>
</li>
<li>
<p>If one delta file _delta_primary.csv is available and the delta_input_data is equal (which indicates that the previous run was not successful), the second delta file _delta_secondary.csv is used as delta list for comparison. If this file is not present, all entries are transferred to the target system.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Comparison means that each entry from the source is compared with the delta list via the UID. If a UID is found in this list, the passwords (both encrypted) are compared. If they are equal, this entry was obviously already delivered and is dropped therefore. All other entries are delivered to the target system.</p>
</div>
<div class="paragraph">
<p>This mechanism guarantees that passwords are not delivered twice to the target system if the workflow runs in delta mode. Thus a warning for an entry must have another reason that the administrator should be sure to check.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_usn_oriented_delta_handling"><a class="anchor" href="#_ch1_usn_oriented_delta_handling"></a><a class="link" href="#_ch1_usn_oriented_delta_handling">1.3.2.1.6. USN-Oriented Delta Handling</a></h6>
<div class="paragraph">
<p>In order to perform USN-oriented delta handling, each change in the connected directory must be written into a special tree (the "changelog" tree). A unique serial number (USN) identifies each entry in this tree. The content of this entry is the type of change and a reference to the entry that was changed.</p>
</div>
<div class="paragraph">
<p>You can extract this "changelog" information from the connected directory, analyze the contained information and process the corresponding entries.</p>
</div>
<div class="paragraph">
<p>This type of delta handling mechanism can handle deletions correctly.</p>
</div>
<div class="paragraph">
<p><strong>Note:</strong> Some implementations only keep the DN of the deleted entry. If you need other information like a global unique identifier for removal of this entry in your target system, you must store the DN in your target system!</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_file_oriented_delta_handling"><a class="anchor" href="#_ch1_file_oriented_delta_handling"></a><a class="link" href="#_ch1_file_oriented_delta_handling">1.3.2.1.7. File-Oriented Delta Handling</a></h6>
<div class="paragraph">
<p>In order to perform file-oriented delta handling, an external delta database must exist against which the current state of the directory can be compared (this means that the directory does not support any delta mechanism). The external delta database is usually a file with partial content (hashed entries are also possible).</p>
</div>
<div class="paragraph">
<p>The agent for the directory must create and maintain these files and handle the compare operation. All types of changes (also deletions) can be processed correctly.</p>
</div>
<div class="paragraph">
<p>This type of delta-handling mechanism is very time-consuming, especially for large amounts of data.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch1_delta_handling_control"><a class="anchor" href="#_ch1_delta_handling_control"></a><a class="link" href="#_ch1_delta_handling_control">1.3.2.2. Delta Handling Control</a></h5>
<div class="paragraph">
<p>At the user interface, all of the delta-handling types are reduced to a list of dates where delta runs were performed. This list is part of the delta-handling properties of the related job configuration object. Normally the next delta run is performed on the result of the last one (the value RECENT indicates this mode).</p>
</div>
<div class="paragraph">
<p>In special cases (for example, when a connected directory must be restored due to a severe error), the administrator can select a specific date to perform the next run.</p>
</div>
<div class="paragraph">
<p>The delta information stored in the configuration database is a list of date/time stamps with the necessary values (a date, a USN, a file name) denoting the time points where former synchronizations took place. This list is extended by the items RECENT and FULL to indicate a request for synchronization of all data changed since the last synchronization.</p>
</div>
<div class="paragraph">
<p>The following figure illustrates the delta information as it appears in the job configuration object viewed with the DirX Identity Manager Expert View.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch1_applsref/image32.png" alt="Job Object Delta Information">
</div>
<div class="title">Figure 31. Job Object Delta Information</div>
</div>
<div class="paragraph">
<p>The relevant fields are:</p>
</div>
<div class="paragraph">
<p><strong>Delta type:</strong> the type of delta handling (DATE, USN, FILE).</p>
</div>
<div class="paragraph">
<p><strong>Info Items:</strong> the list of delta information in the format number, time, delta_value which keeps the results of all delta runs in the configuration database. You cannot see this list from the DirX Identity Manager. Examples are:</p>
</div>
<div class="exampleblock">
<div class="content">
USN delta Example: 2;20010503123400Z=1234<br>
DATE delta Example: 7;20010503123400Z=20010503123400Z<br>
FILE delta Example: 5;20010503123400Z=delta1.txt
</div>
</div>
<div class="exampleblock">
<div class="content">
USN full Example: 1;FULL=1<br>
DATE full Example: 1;FULL=19800101000000Z<br>
FILE full Example: 1;FULL=
</div>
</div>
<div class="paragraph">
<p><strong>Selected:</strong> the value from the <strong>Info Items</strong> list to start the next delta run:<br>
RECENT - (value 0) takes the item with the highest sequence number in the list<br>
FULL - takes the item number 1<em><br>
date value -</em> represents one of the stored delta runs</p>
</div>
<div class="paragraph">
<p><strong>MaxDeltaBase:</strong> the maximum number of <strong>Info Items</strong> entries (used to clean up the item area).</p>
</div>
<div class="paragraph">
<p>The next sections discuss how to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Control delta runs</p>
</li>
<li>
<p>Configure delta handling</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="_ch1_how_to_control_delta_runs"><a class="anchor" href="#_ch1_how_to_control_delta_runs"></a><a class="link" href="#_ch1_how_to_control_delta_runs">1.3.2.2.1. How to Control Delta Runs</a></h6>
<div class="paragraph">
<p>Normally the value of the field selected is RECENT, but you can select another value for the next run, either FULL or a date which characterizes older delta run results (refer to the previous figure, which shows an example of type FILE).</p>
</div>
<div class="paragraph">
<p>When the C++-based Server starts the corresponding activity during the next run, it delivers the content of the relevant Info Item field to the agent controller based on the value of the Selected field.</p>
</div>
<div class="paragraph">
<p>The agent controller performs the delta operation. If it completes successfully, the agent controller returns as a result the current time value with the specific delta information (the USN, date or file name).</p>
</div>
<div class="paragraph">
<p>DirX Identity stores this information in the <strong>Info Items</strong> list with the next available item number when it was not a temporary run and resets the <strong>Selected</strong> field to RECENT.</p>
</div>
<div class="paragraph">
<p><strong>Note:</strong> If a workflow contains jobs that work in delta mode, DirX Identity guarantees that the delta information is only updated when the complete workflow runs successfully (does not return closed.completed.error). Thus the next run of the workflow will start the same delta operation as the previous one (the one that failed). This operation ensures that no data is lost.</p>
</div>
<div class="paragraph">
<p><strong>Warning:</strong> Do not use the <strong>Ignore Errors</strong> flag of the Activity object for jobs that use delta handling. This could result in serious data loss! (For details on the <strong>Ignore Errors</strong> flag see the <em>Connectivity Administration Guide</em> &#8594; Context Sensitive Help &#8594; Tcl-based Workflows &#8594; Tcl-based Activity.)</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_configuring_delta_handling"><a class="anchor" href="#_ch1_configuring_delta_handling"></a><a class="link" href="#_ch1_configuring_delta_handling">1.3.2.2.2. Configuring Delta Handling</a></h6>
<div class="paragraph">
<p>When you define a new job, you must set up DeltaType in the configuration database. Set the field <strong>Delta</strong> <strong>Type</strong> in the <strong>Delta</strong> <strong>Handling</strong> tab of the job object or use a wizard in the DirX Identity Manager Global View. The <strong>Info Items</strong> field is automatically initialized to:</p>
</div>
<div class="paragraph">
<p>USN full Example: 1;FULL=1<br>
DATE full Example: 1;FULL=19800101000000Z<br>
FILE full Example: 1;FULL=</p>
</div>
<div class="paragraph">
<p>Please note that if you change the DeltaType field at any time later on, DirX Identity Manager will reset the existing <strong>Info ltems</strong> list to the FULL-entry. The <strong>Selected</strong> field is set to Recent.</p>
</div>
<div class="paragraph">
<p><strong>Hint:</strong> DirX Identity agents are designed to work with the agent controller to support delta handling in the correct way, but any other agent can also use the delta handling feature of DirX Identity:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The delta information from the last run can be obtained via the reference <strong>&lt;?DeltaInputData/&gt;</strong>. You can use this reference in the command line or in any configuration file.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The new delta information, which should be stored into the Connectivity configuration, must be written into the first line of the file <strong>deltaoutputdata.txt</strong> (location must be the work path).</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch1_customizing_tcl_based_workflows"><a class="anchor" href="#_ch1_customizing_tcl_based_workflows"></a><a class="link" href="#_ch1_customizing_tcl_based_workflows">1.3.3. Customizing Tcl-based Workflows</a></h4>
<div class="paragraph">
<p>Each Tcl-based workflow has a number of parameters that you can change. These parameters are common to most Tcl-based workflows and can all be accessed from the corresponding workflow wizard. The topics in this section describe these parameters for workflows that export data from the Identity Store and workflows that import data from the Identity Store.</p>
</div>
<div class="sect4">
<h5 id="_ch1_customizing_identity_store_export_workflows"><a class="anchor" href="#_ch1_customizing_identity_store_export_workflows"></a><a class="link" href="#_ch1_customizing_identity_store_export_workflows">1.3.3.1. Customizing Identity Store Export Workflows</a></h5>
<div class="paragraph">
<p>The most important parameters for workflows that export data from the Identity Store are attribute mapping, base object, filter and tracing. Clicking <strong>Help</strong> in the relevant wizard step gives you more information about these parameters.</p>
</div>
<div class="sect5">
<h6 id="_ch1_attribute_mapping_2"><a class="anchor" href="#_ch1_attribute_mapping_2"></a><a class="link" href="#_ch1_attribute_mapping_2">1.3.3.1.1. Attribute Mapping</a></h6>
<div class="paragraph">
<p>You need source and target attributes for attribute mapping. Use the <strong>source selected attributes</strong> to define the attributes to be exported from the Identity Store. Use the <strong>target selected attributes</strong> to define the attributes to be imported into the target system. Use the mapping editor to define the mapping from source to target. You can use the pre-defined mapping functions or create additional ones.</p>
</div>
<div class="paragraph">
<p>If the left-hand list in the selected attributes editor does not contain the necessary attributes, you need to add the attributes to your source or target connected directory. Double-click the connected directory icon in the Global View and select the Attribute Configuration step. Add the necessary attributes to the list and set the correct parameters. If the connected directory is of type LDAP or ADS, you can update the list by synchronizing the schema.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_base_object_export_properties_tab"><a class="anchor" href="#_ch1_base_object_export_properties_tab"></a><a class="link" href="#_ch1_base_object_export_properties_tab">1.3.3.1.2. Base Object (Export Properties Tab)</a></h6>
<div class="paragraph">
<p>This parameter defines the base point at which the search is to be performed.</p>
</div>
<div class="paragraph">
<p>For the <strong>creation workflows</strong>, this variable is set to</p>
</div>
<div class="paragraph">
<p>o=My-Company,&lt;?Job@InputChannel-DN@ConnDir-DN@SpecificAttributes(Role_user_base)/&gt;</p>
</div>
<div class="paragraph">
<p>which is a combination of a constant (o=My-Company) and a reference.</p>
</div>
<div class="paragraph">
<p>The reference fetches the specific attribute role_user_base from the connected directory. It starts at the job object, selects the connected directory via the input channel, and from the connected directory it uses the specific attribute role_user_base.</p>
</div>
<div class="paragraph">
<p>For the <strong>Provisioning synchronization workflows</strong>, this variable is set to:</p>
</div>
<div class="paragraph">
<p>&lt;?Workflow@Activity-DN[Anchor=TSagent]@RunObject-DN@InputChannel-DN@ConnDir-DN@SpecificAttributes(Role_TS_Account_Base)/&gt;</p>
</div>
<div class="paragraph">
<p>The reference starts at the workflow object, goes down to the start activity and then to the job object. At the job level, it selects the connected directory via the input channel, and from the connected directory it takes the specific attribute role_ts_account_base.</p>
</div>
<div class="paragraph">
<p>You could set these parameters directly to the correct values, but then you would lose the advantage of being able to change parameters for an entire set of workflows at the same time because each workflow uses an individual value. In this case, the validation and synchronization workflows use such central parameters.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_filter_export_properties_tab"><a class="anchor" href="#_ch1_filter_export_properties_tab"></a><a class="link" href="#_ch1_filter_export_properties_tab">1.3.3.1.3. Filter (Export Properties Tab)</a></h6>
<div class="paragraph">
<p>This parameter allows you to define a <strong>filter condition</strong> in LDAP notation. In the default Connectivity scenario, this field is set in several ways.</p>
</div>
<div class="paragraph">
<p>For the <strong>creation workflows</strong>, the filter is usually set to a constant value, for example:</p>
</div>
<div class="paragraph">
<p>( not ( c="DE" ) and not ( c="IT" ) and not ( c="US" ) )</p>
</div>
<div class="paragraph">
<p>For <strong>Provisioning</strong> <strong>synchronization</strong> <strong>workflows</strong>, the filter is set, for example, to:</p>
</div>
<div class="paragraph">
<p>(objectClass="dxrTargetSystemAccount" and not ( dxrTSState="DELETED" ) )</p>
</div>
<div class="paragraph">
<p>In this case, the workflow exports target system accounts whose dxrTSState values are not in the DELETED state.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_tracing"><a class="anchor" href="#_ch1_tracing"></a><a class="link" href="#_ch1_tracing">1.3.3.1.4. Tracing</a></h6>
<div class="paragraph">
<p>Set the <strong>trace parameters</strong> adequately to debug your workflow during configuration.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch1_customizing_identity_store_import_workflows"><a class="anchor" href="#_ch1_customizing_identity_store_import_workflows"></a><a class="link" href="#_ch1_customizing_identity_store_import_workflows">1.3.3.2. Customizing Identity Store Import Workflows</a></h5>
<div class="paragraph">
<p>The most important parameters for workflows that import data to the Identity Store are mapping and selected attributes, base object, import mode, filters for merge/replace, entry handling, tracing, and page mode. Clicking <strong>Help</strong> in the relevant wizard step gives you more information about these parameters.</p>
</div>
<div class="sect5">
<h6 id="_ch1_mapping_and_selected_attributes"><a class="anchor" href="#_ch1_mapping_and_selected_attributes"></a><a class="link" href="#_ch1_mapping_and_selected_attributes">1.3.3.2.1. Mapping and Selected Attributes</a></h6>
<div class="paragraph">
<p>You need source and target selected attributes for the mapping. Use the <strong>source selected attributes</strong> to define the attributes to be exported from the source system. Use the <strong>target selected attributes</strong> to define the attributes to be imported into the Identity Store. It is important to set the correct flags that influence whether attributes may be added, deleted or modified. A combination of these flags for a specific attribute defines the mastership for that attribute.</p>
</div>
<div class="paragraph">
<p>Use the mapping editor to define the mapping from source to target. You can use the pre-defined mapping functions or create additional ones.</p>
</div>
<div class="paragraph">
<p>If the left-hand list in the selected attributes editor does not contain the necessary attributes, you need to add them to your source or target connected directory. Double-click the connected directory icon in the global view and select the Attribute Configuration step. Add the necessary attributes to the list and set the correct parameters. If the connected directory is of type LDAP or ADS, you can update the list by synchronizing the schema.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_base_object_import_properties_tab"><a class="anchor" href="#_ch1_base_object_import_properties_tab"></a><a class="link" href="#_ch1_base_object_import_properties_tab">1.3.3.2.2. Base Object (Import Properties tab)</a></h6>
<div class="paragraph">
<p>This parameter defines the base point for the join operation.</p>
</div>
<div class="paragraph">
<p>For <strong>creation workflows</strong>, this value is set to a reference:</p>
</div>
<div class="paragraph">
<p>&lt;?Job@OutputChannel-DN@ConnDir-DN@SpecificAttributes(Role_user_base)/&gt;</p>
</div>
<div class="paragraph">
<p>The reference retrieves the specific attribute role_user_base from the Identity Store object.</p>
</div>
<div class="paragraph">
<p>For <strong>Provisioning synchronization workflows</strong>, the base point is set to a reference:</p>
</div>
<div class="paragraph">
<p>&lt;?Workflow@Activity-DN[Anchor=TSagent]@RunObject-DN@InputChannel-DN@ConnDir-DN@SpecificAttributes(Role_TS_Account_Base)/&gt;</p>
</div>
<div class="paragraph">
<p>See the export section for an explanation of this reference.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_import_mode_import_properties_tab"><a class="anchor" href="#_ch1_import_mode_import_properties_tab"></a><a class="link" href="#_ch1_import_mode_import_properties_tab">1.3.3.2.3. Import Mode (Import Properties Tab)</a></h6>
<div class="paragraph">
<p>For import operations, you can choose between two modes: <strong>Replace</strong> and <strong>Merge</strong>.</p>
</div>
<div class="paragraph">
<p><strong>Replace</strong> mode assumes the existence of a full set of entries and therefore cannot handle delta information. In this mode, the source and the target are identical after the operation. This mode can be used for up to 250,000 entries without any problems (typical execution times are 2.5 hours or less). This mode is particularly useful for initial loads. In this case, it is about four times faster than merge mode.</p>
</div>
<div class="paragraph">
<p><strong>Merge</strong> mode can handle all kinds of input. Content information can be handled as a full import or as a delta set if only addition and modification are enabled (see the Entry Handling tab for these settings). If the source delivers an operation code (especially for deleted entries), then deletions can be handled in this mode, too. Large numbers of entries (500,000 entries and more) should be handled with this mode in conjunction with a delete operations code.</p>
</div>
<div class="paragraph">
<p>Creation and provisioning workflows use merge mode in the default scenario.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_filters_for_merge_replace_import_properties_tab"><a class="anchor" href="#_ch1_filters_for_merge_replace_import_properties_tab"></a><a class="link" href="#_ch1_filters_for_merge_replace_import_properties_tab">1.3.3.2.4. Filters for Merge / Replace (Import Properties Tab)</a></h6>
<div class="paragraph">
<p>Depending on the value of the import mode parameter (<strong>Merge</strong> or <strong>Replace</strong>), you need to set either the Filters for Merge or the Filters for Replace parameter.</p>
</div>
<div class="paragraph">
<p>If the import mode is <strong>Merge</strong>, you use the Join table either in table or expert mode (for details, see the description of this element). Each row in this table defines a separate filter condition that is evaluated one after the other until exactly one match is found. For example, you can first search for the employeeNumber, then for a combination of sn, givenName and telephoneNumber and so on.</p>
</div>
<div class="paragraph">
<p>If the import mode is <strong>Replace</strong>, you define a Replace Filter, which is a condition that retrieves all entries in the target into the meta controller&#8217;s memory. The meta controller compares all source entries with this memory list. Entries that it finds are marked and modified if the content has changed. Entries that it does not find must be added to the target. At the end, all entries that are not marked in the list are subject to be deleted from the target. This algorithm guarantees a consistent set of entries after the operation. In this mode, it is important that the retrieved memory list is sorted with the field that is used for comparison. This field is to be defined as Sort Key.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_entry_handling_properties_tab"><a class="anchor" href="#_ch1_entry_handling_properties_tab"></a><a class="link" href="#_ch1_entry_handling_properties_tab">1.3.3.2.5. Entry Handling Properties Tab</a></h6>
<div class="paragraph">
<p>This tab contains a set of properties that allow you to define together with the Import Mode parameter the specific behavior of the entry handling at the target side. You can define parameters for <strong>Add</strong>, <strong>Modify</strong> and <strong>Delete</strong> operations.</p>
</div>
<div class="paragraph">
<p>The <strong>Add Entries/Modify Entries/Delete Entries</strong> switches each allow four options. You can either forbid the operation (None), allow it (Add, Modify or Delete) or choose instead only notification (NTF), where a file is generated for this type of operation and is sent via e-mail to an administrator, who must then perform the requested task manually. The fourth option permits the performance of both the operation and the notification. This option is useful if the administrator wants to check the operations regularly and is especially useful for additions and deletions.</p>
</div>
<div class="paragraph">
<p>For <strong>Add</strong>, you should set the <strong>Superior Info</strong> information. This is not necessary if you are absolutely sure that creation of upper-level nodes is never required.</p>
</div>
<div class="paragraph">
<p>For <strong>Modify</strong>, you can choose whether you want to allow a DN rename operation (<strong>Rename Entries</strong>)</p>
</div>
<div class="paragraph">
<p>For <strong>Delete</strong>, you can choose the <strong>Deletion Mode</strong>. The selection must be consistent with your delivered data. You can use the <strong>Keep</strong> <strong>Objects</strong> field to define DNs that your workflow should not delete.</p>
</div>
<div class="paragraph">
<p>See the script structure sections in the chapter "Understanding the Default Application Workflow Technology" for information about the other entry handling properties.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_tracing_2"><a class="anchor" href="#_ch1_tracing_2"></a><a class="link" href="#_ch1_tracing_2">1.3.3.2.6. Tracing</a></h6>
<div class="paragraph">
<p>Set the adequate <strong>trace parameters</strong> to debug your workflow during configuration.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch1_page_mode"><a class="anchor" href="#_ch1_page_mode"></a><a class="link" href="#_ch1_page_mode">1.3.3.2.7. Page Mode</a></h6>
<div class="paragraph">
<p>DirX Identity&#8217;s default workflows are configured to run without paging by default. However, if you intend to work with large amounts of data, use paging wherever possible. Otherwise you could reach the limits of the directory server or the operating system. In the latter case, the result is not predictable. Note that for comparison of two result lists, sorting is absolutely necessary if you work in paged mode.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_request_workflows"><a class="anchor" href="#_using_request_workflows"></a><a class="link" href="#_using_request_workflows">2. Using Request Workflows</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can use request workflows for a variety of tasks, including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Creating objects (user self registration, users, roles, and so on with or without approval)</p>
</li>
<li>
<p>Modifying objects (users, roles, and so on) and approving object attribute changes</p>
</li>
<li>
<p>Approving privilege assignment changes</p>
</li>
<li>
<p>Deleting objects (users, roles, and so on)</p>
</li>
<li>
<p>Performing certifications</p>
</li>
<li>
<p>Performing service management tasks</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_understanding_creation_workflows"><a class="anchor" href="#_understanding_creation_workflows"></a><a class="link" href="#_understanding_creation_workflows">2.1. Understanding Creation Workflows</a></h3>
<div class="paragraph">
<p>Creation workflows allow you to place controls on the object creation process.Let&#8217;s look at several typical examples:</p>
</div>
<div class="paragraph">
<p><strong>User Self Registration Workflows</strong> - the <strong>Customer Self Registration</strong> workflow allows for self registration of a customer</p>
</div>
<div class="paragraph">
<p><strong>Create User Workflows</strong> - the <strong>Create User With Approval</strong> workflow shows how an administrator enters a new user with approval.</p>
</div>
<div class="paragraph">
<p><strong>Create Persona Workflows</strong> - the <strong>Create Persona from User</strong> shows a typical workflow for administrative persona creation.</p>
</div>
<div class="paragraph">
<p><strong>Create User Facet Workflows</strong> - the <strong>Create</strong> <strong>User Facet from User</strong> shows a typical workflow for creating a user facet.</p>
</div>
<div class="paragraph">
<p><strong>Create Functional User Workflows</strong> - the <strong>Create Functional User from User</strong> shows a typical workflow for administrative functional user creation.</p>
</div>
<div class="paragraph">
<p><strong>Create Privilege Workflows</strong> - the <strong>Create Role</strong> workflow defines a process for role creation.</p>
</div>
<div class="paragraph">
<p>These examples of creation workflows show that you can build various types of creation workflows that satisfy your organizational and process requirements. We recommend that you streamline your processes when defining request workflows so that they are fast and flexible but still maintain regulatory compliance.</p>
</div>
<div class="sect3">
<h4 id="_ch2_user_self_registration_workflows"><a class="anchor" href="#_ch2_user_self_registration_workflows"></a><a class="link" href="#_ch2_user_self_registration_workflows">2.1.1. User Self Registration Workflows</a></h4>
<div class="paragraph">
<p>Self registration workflows have a special function: they are triggered by a user that is not yet registered within DirX Identity. To handle this case, DirX Identity uses the special and reserved user ANYONE, which has the limited access rights defined by access policies that are sufficient to perform the self registration process. See the access policies for ANYONE under <strong>Policies</strong> &#8594; <strong>Access Policies</strong> &#8594; <strong>Default &#8594;</strong> <strong>Request Workflow Definitions</strong> for more information. You need to supply a password for ANYONE in the file <em>install_path</em>*\web\webCenter\WEB-INF* to enable the self registration process.</p>
</div>
<div class="paragraph">
<p>A typical self registration workflow is the Customer Self Registration workflow:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch2_reqWFs/image1.png" alt="Customer Self Registration Workflow">
</div>
<div class="title">Figure 32. Customer Self Registration Workflow</div>
</div>
<div class="paragraph">
<p>The Customer Self Registration workflow contains the following activities</p>
</div>
<div class="paragraph">
<p><strong>Enter Attributes</strong> (people) - displays a set of attributes (mandatory or optional) that the requesting user must supply.</p>
</div>
<div class="paragraph">
<p><strong>Enter Password</strong> (people) - requests a password that complies with the defined password policies from the user.</p>
</div>
<div class="paragraph">
<p><strong>Request Services</strong> (people) - allows the user to select some of the offered services. The policy execution service can assign additional privileges automatically later on.</p>
</div>
<div class="paragraph">
<p><strong>Confirm Data</strong> (people) - presents all entered data to the user, who can change the data if it is not correct and then either confirm or abort the entire self registration process.</p>
</div>
<div class="paragraph">
<p><strong>Notification if Aborted</strong> (automatic) - sends a final notification to the requesting user that he aborted the self registration process.</p>
</div>
<div class="paragraph">
<p><strong>Set Constants</strong> (automatic) - sets some constant values, for example, the user type to "Customer" and the master attribute to "Self Registration".</p>
</div>
<div class="paragraph">
<p><strong>Approve Self Registration</strong> (people) - requires a set of persons (the participants) to approve this user self registration request. In this case, a fixed group of people defines the list of approvers.</p>
</div>
<div class="paragraph">
<p><strong>Apply Change</strong> (automatic) - creates the LDAP entry for the user if the participants in <strong>Approve</strong> <strong>Creation</strong> accept the creation request. Up to this point, the user entry does not exist. It exists only as an order object within the workflow instance. Creating the user LDAP entry includes a privilege resolution and generation of events for real-time workflows.</p>
</div>
<div class="paragraph">
<p><strong>Notification if Rejected</strong> (automatic) - typically sends an e-mail notification to the initiator of this workflow if the participants reject the user creation request.</p>
</div>
<div class="paragraph">
<p><strong>Notification if EXPIRED (automatic)</strong> - sends an e-mail to an administrator that the workflow has expired. Obviously the participants did not react in time.</p>
</div>
</div>
<div class="sect3">
<h4 id="_ch2_create_user_workflows"><a class="anchor" href="#_ch2_create_user_workflows"></a><a class="link" href="#_ch2_create_user_workflows">2.1.2. Create User Workflows</a></h4>
<div class="paragraph">
<p>You can create users in various ways. The following figure shows a typical workflow for administrative user creation:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch2_reqWFs/image2.png" alt="Example of a Create User Workflow">
</div>
<div class="title">Figure 33. Example of a Create User Workflow</div>
</div>
<div class="paragraph">
<p>The workflow shown in the figure contains the following activities:</p>
</div>
<div class="paragraph">
<p><strong>Enter Attributes</strong> (people) - displays a set of attributes (mandatory or optional) that the administrator must supply.</p>
</div>
<div class="paragraph">
<p><strong>Request Privileges</strong> (people) - allows the administrator to assign some privileges by hand. The policy execution service can assign additional privileges automatically later on.</p>
</div>
<div class="paragraph">
<p><strong>Approve Creation</strong> (people) - requires a set of persons (the participants) to approve this administrative request for user creation. There are many ways to define the participants; for example, fixed lists, the members of groups, an LDAP filter definition and so on. For this workflow, a fixed list of approvers that are part of the human resources department is configured.</p>
</div>
<div class="paragraph">
<p><strong>Calculate GUID (automatic)</strong> - calculates a standard global unique identifier. Example: uid-c0a8e480&#8212;&#8203;4b5b380c-121222f6f42&#8212;&#8203;7fb8. You can create your own UID generator as a custom activity.</p>
</div>
<div class="paragraph">
<p><strong>Apply Change</strong> (automatic) - creates the LDAP entry for the user if the participants in <strong>Approve</strong> <strong>Creation</strong> accept the creation request. Up to this point, the user entry does not exist. It exists only as an order object within the workflow instance. Creating the user LDAP entry includes a privilege resolution and generation of events for real-time workflows.</p>
</div>
<div class="paragraph">
<p><strong>Notification if Rejected</strong> (automatic) - typically sends an e-mail notification to the initiator of this workflow if the participants reject the user creation request.</p>
</div>
<div class="paragraph">
<p><strong>Notification if EXPIRED (automatic)</strong> - sends an e-mail to an administrator that the workflow has expired (the participants did not respond in time).</p>
</div>
</div>
<div class="sect3">
<h4 id="_ch2_create_persona_workflows"><a class="anchor" href="#_ch2_create_persona_workflows"></a><a class="link" href="#_ch2_create_persona_workflows">2.1.3. Create Persona Workflows</a></h4>
<div class="paragraph">
<p>You can create personas in various ways. The following figure shows a typical workflow for administrative persona creation:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch2_reqWFs/image3.png" alt="Example of a Create Persona Workflow">
</div>
<div class="title">Figure 34. Example of a Create Persona Workflow</div>
</div>
<div class="paragraph">
<p>The workflow shown in the figure is derived from the corresponding create user workflow, which has been extended to include a new first activity:</p>
</div>
<div class="paragraph">
<p><strong>Persona from User</strong> (automatic) - creates the default values for the persona to be created from its owner using a special object description. This workflow causes the "enter attributes" dialog for personas to be populated with useful default values.</p>
</div>
<div class="paragraph">
<p>All of the other activities for the create persona workflow are the same as the create user workflow described in the previous section.</p>
</div>
<div class="paragraph">
<p>See the section "Customizing Persona Create Workflows" in the chapter "Customizing Program Logic" in the <em>DirX Identity Customization Guide</em> for information on how to configure the Persona from User activity.</p>
</div>
</div>
<div class="sect3">
<h4 id="_ch2_create_user_facet_workflows"><a class="anchor" href="#_ch2_create_user_facet_workflows"></a><a class="link" href="#_ch2_create_user_facet_workflows">2.1.4. Create User Facet Workflows</a></h4>
<div class="paragraph">
<p>You can create user facets in the same ways as for personas. The workflow for creating a user facet is basically the same as the workflow for creating a persona described in the section "Create Persona Workflows". The only difference is the first automatic activity <strong>User Facet from User</strong>, which sets default values for the new user facet taken from the associated user and configured in the object description <strong>UserFacetFromUser.xml</strong>.</p>
</div>
<div class="paragraph">
<p>See the section "Customizing User Facet Create Workflows" in the chapter "Customizing Program Logic" in the <em>DirX Identity Customization Guide</em> for information on how to configure the <strong>User Facet from User</strong> activity.</p>
</div>
</div>
<div class="sect3">
<h4 id="_ch2_create_functional_user_workflows"><a class="anchor" href="#_ch2_create_functional_user_workflows"></a><a class="link" href="#_ch2_create_functional_user_workflows">2.1.5. Create Functional User Workflows</a></h4>
<div class="paragraph">
<p>You can create functional users in various ways. The following figure shows a typical workflow for administrative functional user creation:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch2_reqWFs/image4.png" alt="Example of a Create Functional User Workflow">
</div>
<div class="title">Figure 35. Example of a Create Functional User Workflow</div>
</div>
<div class="paragraph">
<p>The workflow shown in the figure is derived from the corresponding create user workflow, which is extended to include a new first activity:</p>
</div>
<div class="paragraph">
<p><strong>Functional User from User</strong> (automatic) - creates the default values for the functional user to be created from its sponsor using a special object description. This workflow causes the "enter attributes" dialog for functional users to be populated with useful default values.</p>
</div>
<div class="paragraph">
<p>All of the other activities for the create functional user workflow are the same as the create user workflow described in the previous section.</p>
</div>
<div class="paragraph">
<p>See the section "Customizing Functional User Create Workflows" in the chapter "Customizing Program Logic" in the <em>DirX Identity Customization Guide</em> for information on how to configure the Functional User from User activity.</p>
</div>
</div>
<div class="sect3">
<h4 id="_ch2_create_privilege_workflows"><a class="anchor" href="#_ch2_create_privilege_workflows"></a><a class="link" href="#_ch2_create_privilege_workflows">2.1.6. Create Privilege Workflows</a></h4>
<div class="paragraph">
<p>There are also many ways to define a workflow for a role - or more generally, a privilege - request. The following figure shows a typical workflow definition:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch2_reqWFs/image5.png" alt="Example of a Create Role Workflow">
</div>
<div class="title">Figure 36. Example of a Create Role Workflow</div>
</div>
<div class="paragraph">
<p>Because role creation is a complex task, the workflow takes a two-step approach. First, a person supplies a set of descriptive attributes to request the new role. When this "basis" request is approved, the workflow creates the role object and notifies a role administrator to complete the role definition. This workflow contains the following activities:</p>
</div>
<div class="paragraph">
<p><strong>Enter General Attributes</strong> (people) - displays a set of descriptive attributes (mandatory or optional ones) the role requester must supply.</p>
</div>
<div class="paragraph">
<p><strong>Approve Role Creation</strong> (people) - requires a set of persons (the participants) to approve the role creation request, possibly including a check for an existing role definition that can be used instead of the requested one.</p>
</div>
<div class="paragraph">
<p><strong>Apply Change</strong> (automatic) - creates the preliminary LDAP role entry if the participants of <strong>Approve</strong> <strong>Role</strong> <strong>Creation</strong> accept the creation request.</p>
</div>
<div class="paragraph">
<p><strong>Notification if Rejected</strong> (automatic) - typically sends an e-mail notification to the initiator of this workflow if the participants of <strong>Approve</strong> <strong>Role</strong> <strong>Creation</strong> reject the role creation request.</p>
</div>
<div class="paragraph">
<p><strong>Perform Administrative Tasks</strong> (people) - notifies the role administrator that a preliminary role object has been created and requests that he completes the role definition.This action may include tasks like setting the role ID, assigning permissions, role parameters and senior roles (and perhaps these additional objects must be created first), assigning users as owners and role administrators and defining approval and re-approval parameters.</p>
</div>
<div class="paragraph">
<p><strong>Notification if Role Request Completed</strong> (automatic) - typically sends an e-mail notification to the initiator of this workflow when the role administrator can complete the role definition successfully.</p>
</div>
<div class="paragraph">
<p><strong>Notification if Not Completed</strong> (automatic) - typically sends an e-mail notification to the initiator of this workflow when the role administrator finds that the role creation is not possible; for example, because there is a conflict with other role definitions.</p>
</div>
<div class="paragraph">
<p><strong>Notification if EXPIRED (automatic)</strong> - sends an e-mail to an administrator that the workflow has expired (the participants did not respond in time).</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_understanding_modification_workflows"><a class="anchor" href="#_understanding_modification_workflows"></a><a class="link" href="#_understanding_modification_workflows">2.2. Understanding Modification Workflows</a></h3>
<div class="paragraph">
<p>This type of workflow allows approval of object modifications if critical attributes are changed.You use attribute policies to define the list of critical attributes for an object type.Managing attribute modification approval comprises these steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Enabling attribute modification approval via the <strong>Attribute</strong> <strong>Modification</strong> <strong>Approval</strong> flag of the domain object.</p>
</li>
<li>
<p>Configuring the corresponding attribute policies for each object type (critical attributes).<br>
Note: either create your own attribute policies or copy the default policies to prevent your policies from being overwritten during upgrade installation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each matching policy results in the start of one workflow.</p>
</div>
<div class="paragraph">
<p>The next section provides an example for a user attribute modification workflow.You can set up similar modification workflows for other object types.</p>
</div>
<div class="sect3">
<h4 id="_ch2_user_modification_workflows"><a class="anchor" href="#_ch2_user_modification_workflows"></a><a class="link" href="#_ch2_user_modification_workflows">2.2.1. User Modification Workflows</a></h4>
<div class="paragraph">
<p>The following figure shows a typical attribute modification workflow that is triggered by a change of the dxroulink or dxrlocationlink attributes.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch2_reqWFs/image6.png" alt="Modify Location and Organization">
</div>
<div class="title">Figure 37. Modify Location and Organization</div>
</div>
<div class="paragraph">
<p>The workflow shown in the figure contains the following activities:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Approval of Attribute Modifications</strong> (people) - requests that a set of participants approve the modification of critical attributes. In this special case, we use all persons of the HR department as approvers. These persons are also allowed to change some of the attributes to their correct values before they accept the changes.</p>
</li>
<li>
<p><strong>Apply Change</strong> (automatic) - changes the LDAP entry if the participants of the previous step accepted the modification. Up to now, the modifications do not exist. They exist only as an order object within the workflow instance.</p>
</li>
<li>
<p><strong>Notification if Rejected</strong> (automatic) - typically sends an e-mail notification to the initiator of this workflow if the participants reject the modification request.</p>
</li>
<li>
<p><strong>Notification if EXPIRED (automatic)</strong> - sends an e-mail to an administrator that the workflow has expired. Obviously the participants did not react in time.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The attribute modification workflow functions as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The modification workflow does not allow a participant to accept a part of the attributes and reject the rest.</p>
</li>
<li>
<p>If several participants must approve, and all approve but some make changes to the data before they approve, DirX Identity takes the changes made by the last approver, and ignores the rest.</p>
</li>
<li>
<p>If several workflows are started for the same attribute, DirX Identity takes the changes from the last approved change.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This feature is not applicable for:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Properties that depend on a master object.In this case, the change of the master attribute must be approved rather than the change of the dependent attribute.For more information, see the section "Using the Master Attribute" in the section "Customizing Objects" in the <em>DirX Identity Customization Guide</em>.</p>
</li>
<li>
<p>Properties that are used as system properties for privilege assignment.The privilege assignments are handled by extra assignment approval workflows.</p>
</li>
<li>
<p>Properties that are calculated automatically by the system to set some states or other system relevant values.</p>
</li>
<li>
<p>Properties that are specific properties holding a set of individual properties.For example, dxrRPValues cannot be chosen, select dxrRPValues(c) or dxrRPValues(l) instead.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The workflow checks these rules and if it detects a violation, it reports it as an error message when the policy is saved.</p>
</div>
<div class="paragraph">
<p><strong>Warning:</strong> You can bypass these checks by editing the attributes for approval in the attribute policy with a native LDAP editor (for example, DirX Identity&#8217;s Data View).However, this action may result in unexpected problems that are not covered by product support.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_understanding_assignment_workflows"><a class="anchor" href="#_understanding_assignment_workflows"></a><a class="link" href="#_understanding_assignment_workflows">2.3. Understanding Assignment Workflows</a></h3>
<div class="paragraph">
<p>This type of workflow only handles the approval of privilege assignments.In this section, we:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Describe how approval works.</p>
</li>
<li>
<p>Examine the 4-eye approval, automatic (notification-only) approval and risk approval workflows.</p>
</li>
<li>
<p>Explain how to set up approval workflows for different assignment operation types.</p>
</li>
<li>
<p>Give some guidelines for determining when to implement privilege assignment approval and re-approval.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_ch2_how_approval_works"><a class="anchor" href="#_ch2_how_approval_works"></a><a class="link" href="#_ch2_how_approval_works">2.3.1. How Approval Works</a></h4>
<div class="paragraph">
<p>The following figure illustrates the approval process in DirX Identity Provisioning.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch2_reqWFs/image7.png" alt="The DirX Identity Provisioning Approval Process">
</div>
<div class="title">Figure 38. The DirX Identity Provisioning Approval Process</div>
</div>
<div class="paragraph">
<p>The approval process works as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A privilege that is flagged for approval is assigned to a user. This action initiates a request workflow configured for assignment approval (the creation request is sent via HTTP/SOAP from the client to the Java-based Server).</p>
</li>
<li>
<p>The request workflow service checks all active workflow templates to determine whether they fit (<strong>When Applicable</strong> section).</p>
</li>
<li>
<p>The first workflow template that fits is converted to a workflow instance. The state is set to <strong>Running</strong>.</p>
</li>
<li>
<p>The request workflow service starts all activities whose start conditions are satisfied and performs the assigned actions (for example, sending an e-mail to the relevant approver(s)).</p>
</li>
<li>
<p>The request workflow service waits for responses from the approvers or for new approval workflow requests. <strong>Note</strong>: from time to time, it performs a full check of the instances to solve the problem of lost SOAP requests. The full check interval is configurable (the default is 5 minutes).</p>
</li>
<li>
<p>When a user performs an approval (he accepts or rejects), a SOAP message informs the request workflow service again. It performs the necessary actions and calculates the next steps.</p>
</li>
<li>
<p>When a workflow instance finishes, either successfully (state <strong>Succeeded</strong>) or with error (state <strong>Failed</strong>), the workflow is completed. If the approval was successful, the user-to-privilege assignment is enabled and a privilege resolution is performed automatically. Now the assignment is active.</p>
</li>
<li>
<p>The workflow instance remains in the Identity Store based on the configured <strong>Expiration Time</strong>. Use the <strong>Cleanup Objects</strong> workflow with its corresponding cleanup rules to remove the expired instances from the Identity Store regularly. Note that all history information is removed from the expired instances before they can be deleted. Thus it is good practice to run the Extract Audit Trail workflow in advance (or to set up the corresponding collector of DirX Audit).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Changing an existing assignment or deleting an assignment also triggers an approval workflow if the privilege is flagged for approval.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s look at three examples of approval workflows: 4-eye approval, automatic (notification only) approval and risk approval.</p>
</div>
<div class="sect4">
<h5 id="_ch2_4_eye_approval"><a class="anchor" href="#_ch2_4_eye_approval"></a><a class="link" href="#_ch2_4_eye_approval">2.3.1.1. 4-Eye Approval</a></h5>
<div class="paragraph">
<p>You can approve privilege assignments in various ways. A typical approval type is 4-eye approval if you assign a privilege to a user. Both the manager of the user and the manager of the privilege must approve. The following figure shows an example of this workflow:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch2_reqWFs/image8.png" alt="4-Eye Approval Workflow">
</div>
<div class="title">Figure 39. 4-Eye Approval Workflow</div>
</div>
<div class="paragraph">
<p>This workflow contains the following activities:</p>
</div>
<div class="paragraph">
<p><strong>Approval by User Managers</strong> (people) - requires the user&#8217;s manager(s) to approve the privilege assignment, which means he accepts that the user receives these additional access rights to perform new tasks.</p>
</div>
<div class="paragraph">
<p><strong>Approval by Privilege Managers</strong> (people) - requires the privilege&#8217;s manager(s) to approve that this user gets this privilege, which means that this user has access to the resources this privilege protects.</p>
</div>
<div class="paragraph">
<p><strong>+ Merge (AND)</strong> - calculates the result of previous activities, which means that it calculates all applications states via AND.</p>
</div>
<div class="paragraph">
<p><strong>o Merge (OR)</strong> - calculates the result of previous activities, which means that it calculates all applications states via OR.</p>
</div>
<div class="paragraph">
<p><strong>Apply Approved Privilege Change</strong> (automatic) - assigns the privilege to the user if all participants approve the assignment. This activity includes a privilege resolution and generation of messages for real-time workflows.</p>
</div>
<div class="paragraph">
<p><strong>Notification if Rejected</strong> (automatic) - typically sends an e-mail notification to the related user that the privilege is not assigned, if the participants reject the assignment request.</p>
</div>
<div class="paragraph">
<p><strong>Notification if EXPIRED (automatic)</strong> - sends an e-mail to an administrator that the workflow has expired (the participants did not respond in time).</p>
</div>
<div class="paragraph">
<p>Note: For details about configuration with access policies, see the subsection "Policies for Approvals" in the section "Delegated Administration" in the chapter "Managing Policies" in the <em>DirX Identity Provisioning Administration Guide</em>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch2_automatic_notification_only_approval"><a class="anchor" href="#_ch2_automatic_notification_only_approval"></a><a class="link" href="#_ch2_automatic_notification_only_approval">2.3.1.2. Automatic (Notification Only) Approval</a></h5>
<div class="paragraph">
<p>Another example is a workflow that simply sends a notification when a privilege is assigned to a user. In this example, the workflow informs a user that he has received the "Signature Level 1" privilege with some valuable hints about using it:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch2_reqWFs/image9.png" alt="Signature Information Workflow">
</div>
<div class="title">Figure 40. Signature Information Workflow</div>
</div>
<div class="paragraph">
<p>This workflow consists of these activities:</p>
</div>
<div class="paragraph">
<p><strong>Apply Privilege and Notify User</strong> (automatic) - assigns the privilege to the user automatically, including a privilege resolution and generation of messages for real-time workflows. The activity also sends a notification to the user about this assignment.</p>
</div>
<div class="paragraph">
<p><strong>Notification if EXPIRED (automatic)</strong> - sends an e-mail to an administrator that the workflow has expired. Obviously the participants did not react in time.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch2_risk_approval"><a class="anchor" href="#_ch2_risk_approval"></a><a class="link" href="#_ch2_risk_approval">2.3.1.3. Risk Approval</a></h5>
<div class="paragraph">
<p>In a risk approval workflow, the first activity calculates the new risk level that would become effective if the assignment was approved. If the risk level is computed to high (is equal to 3), an additional approval step <strong>Approval by Company Head</strong> must be executed if <strong>Approve</strong> <strong>by</strong> <strong>Privilege</strong> <strong>Manager</strong> has been accepted. The following figure shows an example of this workflow:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch2_reqWFs/image10.png" alt="Risk Approval Workflow">
</div>
<div class="title">Figure 41. Risk Approval Workflow</div>
</div>
<div class="paragraph">
<p>This workflow contains the following activities:</p>
</div>
<div class="paragraph">
<p><strong>Calculate Risk</strong> (automatic) - simulates a risk level resolution for the requested privilege assignment. For the new/deleted group assignments, it calculates the risk and then merges these new risks with the risk values already computed to calculate the new potential risk level. The activity then stores this new risk level in the application state and the workflow context (values of 0, 1, 2 and 3 are possible, with 3 corresponding to a high risk assignment).</p>
</div>
<div class="paragraph">
<p><strong>Approval by Privilege Manager</strong> (people) - requires the privilege&#8217;s manager(s) to approve that this user gets this privilege, which means that this user has access to the resources this privilege protects.</p>
</div>
<div class="paragraph">
<p><strong>+ Merge</strong> (AND) - calculates the result of previous activities, where <strong>Approve by Privilege Manager</strong> was accepted and Calculate Risk computed a high risk (a value of 3).</p>
</div>
<div class="paragraph">
<p><strong>Approval by Company Head</strong> (people) - requires the company head to approve that this user receive this privilege, which means that this user has access to the resources this privilege protects. This activity is only entered if a high risk for the assignment was calculated and the first approval was accepted.</p>
</div>
<div class="paragraph">
<p><strong>+ Merge</strong> (AND) - calculates the result of previous activities, which means that it calculates all applications states via AND. <strong>Approve by Privilege Manager</strong> was accepted and <strong>Calculate Risk</strong> computed a lower risk (not equal to 3) so that no additional approval is necessary.</p>
</div>
<div class="paragraph">
<p><strong>o Merge (OR)</strong> - calculates the result of previous activities, which means that it calculates all applications states via OR. Either <strong>Approval by Company Head</strong> was accepted or <strong>Approve by Privilege Manage</strong>r was accepted and the risk was not calculated to be high.</p>
</div>
<div class="paragraph">
<p><strong>Apply Approved Privilege Change</strong> (automatic) - assigns the privilege to the user if all participants approve the assignment. This activity includes a privilege resolution and generation of messages for real-time workflows.</p>
</div>
<div class="paragraph">
<p><strong>Notification if Rejected</strong> (automatic) - typically sends an e-mail notification to the related user that the privilege is not assigned, if the participants reject the assignment request. This activity is called if the privilege manager has rejected the assignment.</p>
</div>
<div class="paragraph">
<p><strong>Notification if High Risk Rejected</strong> (automatic) - typically sends an e-mail notification to the related user that the privilege is not assigned, if the participants reject the assignment request. This activity is called if <strong>Approval by Company Head</strong> was rejected.</p>
</div>
<div class="paragraph">
<p><strong>Notification if EXPIRED</strong> (automatic) - sends an e-mail to an administrator that the workflow has expired (the participants did not respond in time).</p>
</div>
<div class="paragraph">
<p>Note: For details about configuration with access policies, see the subsection "Policies for Approvals" in the section "Delegated Administration" in the chapter "Managing Policies" in the <em>DirX Identity Provisioning Administration Guide</em>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch2_understanding_assignment_operation_types"><a class="anchor" href="#_ch2_understanding_assignment_operation_types"></a><a class="link" href="#_ch2_understanding_assignment_operation_types">2.3.2. Understanding Assignment Operation Types</a></h4>
<div class="paragraph">
<p>DirX Identity can distinguish between several operation types for assignments. These operation types are available:</p>
</div>
<div class="paragraph">
<p><strong>Create</strong> - a privilege is assigned either to another privilege or a user.</p>
</div>
<div class="paragraph">
<p><strong>Modify</strong> - a privilege assignment to a user is to be modified (for example the end time or a role parameter value changes).</p>
</div>
<div class="paragraph">
<p><strong>Delete</strong> - a privilege is removed either from another privilege or a user.</p>
</div>
<div class="paragraph">
<p><strong>SoD</strong> - an SoD rule requires approval of a user-to-privilege assignment.</p>
</div>
<div class="paragraph">
<p><strong>Re-Approval</strong> - an existing user-to-privilege assignment is to be re-approved at the defined time.</p>
</div>
<div class="paragraph">
<p>You can set up workflows for specific operation types either from a privilege via the corresponding direct workflow link or via the <strong>When Applicable</strong> section in a request workflow definition.</p>
</div>
<div class="paragraph">
<p>Note that links between privileges allow only the operations <strong>assign</strong> and <strong>remove</strong>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_ch2_guidelines_for_approving_privilege_assignments"><a class="anchor" href="#_ch2_guidelines_for_approving_privilege_assignments"></a><a class="link" href="#_ch2_guidelines_for_approving_privilege_assignments">2.3.3. Guidelines for Approving Privilege Assignments</a></h4>
<div class="paragraph">
<p>When talking about approval of assignments, you should be aware that many privilege assignments in a company do not require approval. For example, consider the following policies:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>All of your employees - internal and external ones - are to have a Windows account and an e-mail box. This policy is best implemented with a provisioning rule that provides a basic role. Approval does not make sense in this case.</p>
</li>
<li>
<p>All of your internal employees are to have access to public pages in your intranet.This policy is best handled with a provisioning rule that acts on the attribute value employeeType=Internal.Approval does not make sense in this case.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There are a lot of other cases where approval does not make sense.A good rule of thumb is to determine whether or not you required approval for a privilege when your process was paper-based.Another important issue is to check whether a privilege is compliance-relevant and should therefore be approved.</p>
</div>
<div class="paragraph">
<p>You should thoroughly define which privileges need approval and only define approval workflows for these items.Otherwise you end up with a lot of unnecessary overhead, which results in additional costs and time-consuming processes because approval costs time.</p>
</div>
</div>
<div class="sect3">
<h4 id="_ch2_guidelines_for_re_approving_privilege_assignments"><a class="anchor" href="#_ch2_guidelines_for_re_approving_privilege_assignments"></a><a class="link" href="#_ch2_guidelines_for_re_approving_privilege_assignments">2.3.4. Guidelines for Re-Approving Privilege Assignments</a></h4>
<div class="paragraph">
<p>The re-approval feature is even more critical than the approval feature because it generates approval requests fairly frequently.Thus we recommend that you make sure that it&#8217;s really necessary to set up re-approval for a specific privilege.Re-approval makes sense for highly critical access to business-critical applications as well as for compliance-relevant access rights.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_understanding_deletion_workflows"><a class="anchor" href="#_understanding_deletion_workflows"></a><a class="link" href="#_understanding_deletion_workflows">2.4. Understanding Deletion Workflows</a></h3>
<div class="paragraph">
<p>This type of workflow allows approval of object deletions.You use delete policies to define approval for deletion of a specific object type.</p>
</div>
<div class="paragraph">
<p>Managing object deletion approval comprises these steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Configuring a <strong>Delete Policy</strong> that contains all object types whose deletion is to be approved.<br>
Note: either create your own attribute policies or copy the default policies to prevent overwritten policies during upgrade installation.</p>
</li>
<li>
<p>Defining one or more deletion request workflows for each of these object types.In the When Applicable section of the workflow, set the operation to <strong>delete</strong> and the subject field to the corresponding object type.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that you can only define a deletion policy for an object type (for example, roles).It is not possible to define a policy for a portion of the objects.</p>
</div>
<div class="paragraph">
<p>Hint: You can specify different object descriptions as a workaround, but this task requires that you set up a mapping section. For example, you could add a custom flag to the object "Request workflow for deletion" and then include this flag into the mapping section of your object descriptions.</p>
</div>
<div class="paragraph">
<p>The next sections provide</p>
</div>
<div class="ulist">
<ul>
<li>
<p>an overview of the deletion procedure.</p>
</li>
<li>
<p>a list of object types that support deletion workflows.</p>
</li>
<li>
<p>an example of a role deletion workflow. You can set up similar modification workflows for other object types.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_ch2_deletion_procedure"><a class="anchor" href="#_ch2_deletion_procedure"></a><a class="link" href="#_ch2_deletion_procedure">2.4.1. Deletion Procedure</a></h4>
<div class="paragraph">
<p>The deletion procedure depends on the object type and whether auditing is enabled. The basic procedure is shown in the next figure.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch2_reqWFs/image11.png" alt="Deletion Procedure">
</div>
<div class="title">Figure 42. Deletion Procedure</div>
</div>
<div class="paragraph">
<p>The procedure comprises these steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Receiving a deletion request, the service layer checks for an active Delete Policy for this object type.</p>
</li>
<li>
<p>If no policy is active, it proceeds with step 5.</p>
</li>
<li>
<p>If a policy is active, a deletion approval workflow is started. If none is found, an error is reported.</p>
</li>
<li>
<p>If the object deletion is rejected, the object is not deleted.</p>
</li>
<li>
<p>If the object deletion is accepted, the deletion procedure is performed.</p>
</li>
<li>
<p>If auditing is disabled, the object-specific procedure is performed immediately. In most cases, this is a direct deletion of the object.</p>
</li>
<li>
<p>If auditing is enabled, history / audit information is written to the objects into the attribute dxrHistory. This means that objects cannot be deleted immediately; they are set to the DELETED state. You must set up workflows for history extraction and object deletion, which guarantees that no audit information is lost.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_ch2_supported_object_types"><a class="anchor" href="#_ch2_supported_object_types"></a><a class="link" href="#_ch2_supported_object_types">2.4.2. Supported Object Types</a></h4>
<div class="paragraph">
<p>Deletion workflows are not yet supported for all object types. The following types are currently supported (the deletion procedure is briefly described):</p>
</div>
<div class="paragraph">
<p><strong>Groups</strong> - are always set to DELETED status. See the chapter "Managing States" in the <em>DirX Identity Provisioning Administration Guide</em> for more information.</p>
</div>
<div class="paragraph">
<p><strong>JavaScripts</strong> - direct deletion</p>
</div>
<div class="paragraph">
<p><strong>Nationalization</strong> - direct deletion</p>
</div>
<div class="paragraph">
<p><strong>Object Descriptions</strong> - direct deletion</p>
</div>
<div class="paragraph">
<p><strong>Proposal Lists</strong> - direct deletion</p>
</div>
<div class="paragraph">
<p><strong>Role Parameters</strong> - direct deletion</p>
</div>
<div class="paragraph">
<p><strong>Roles</strong> - direct deletion</p>
</div>
<div class="paragraph">
<p><strong>Permissions</strong> - direct deletion</p>
</div>
<div class="paragraph">
<p><strong>Users</strong> - are always set to TBDEL status. See the chapter "Managing States" in the <em>DirX Identity Provisioning Administration Guide</em> for more information.</p>
</div>
<div class="paragraph">
<p>Policies</p>
</div>
<div class="paragraph">
<p><strong>Access Policies</strong> - direct deletion</p>
</div>
<div class="paragraph">
<p><strong>Attribute Policies</strong> - direct deletion</p>
</div>
<div class="paragraph">
<p><strong>Audit Policies</strong> - direct deletion</p>
</div>
<div class="paragraph">
<p><strong>Delete Policies</strong> - direct deletion</p>
</div>
<div class="paragraph">
<p><strong>Event Policies</strong> - direct deletion</p>
</div>
<div class="paragraph">
<p><strong>Password Policies</strong> - direct deletion</p>
</div>
<div class="paragraph">
<p><strong>SoD Policies</strong> - direct deletion</p>
</div>
<div class="paragraph">
<p>Business Objects</p>
</div>
<div class="paragraph">
<p><strong>Context</strong> - direct deletion</p>
</div>
<div class="paragraph">
<p><strong>Cost Units</strong> - direct deletion</p>
</div>
<div class="paragraph">
<p><strong>Countries</strong> - direct deletion</p>
</div>
<div class="paragraph">
<p><strong>Locations</strong> - direct deletion</p>
</div>
<div class="paragraph">
<p><strong>Organizations</strong> - direct deletion</p>
</div>
<div class="paragraph">
<p><strong>Organizational Units</strong> - direct deletion</p>
</div>
<div class="paragraph">
<p><strong>Projects</strong> - direct deletion</p>
</div>
</div>
<div class="sect3">
<h4 id="_ch2_role_deletion_workflow"><a class="anchor" href="#_ch2_role_deletion_workflow"></a><a class="link" href="#_ch2_role_deletion_workflow">2.4.3. Role Deletion Workflow</a></h4>
<div class="paragraph">
<p>The following figure shows a typical delete workflow that is triggered by a deletion of a role. This workflow is started when the delete policy for roles is active.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch2_reqWFs/image12.png" alt="Delete Role Workflow">
</div>
<div class="title">Figure 43. Delete Role Workflow</div>
</div>
<div class="paragraph">
<p>The workflow shown in the figure contains the following activities:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Approval of Object Deletion</strong> (people) - requests that the role administrators must approve the deletion of a role.</p>
</li>
<li>
<p><strong>Apply Change</strong> (automatic) - changes the LDAP role entry if the participants of the previous step accepted the deletion.Up to this point, the deletion request existed only as an order object within the workflow instance.</p>
</li>
<li>
<p><strong>Notification if Rejected</strong> (automatic) - typically sends an e-mail notification to the initiator of this workflow if the participants reject the modification request.</p>
</li>
<li>
<p><strong>Notification if EXPIRED (automatic)</strong> - sends an e-mail to an administrator that the workflow has expired (the participants did not respond in time).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The object deletion workflow functions as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The deletion procedure used depends on the type of object and the audit settings.Users and Privileges are not directly deleted.Instead the status is set to DELETED and the end date is set.The CleanupObjects rule (typically part of a Tcl-based workflow) needs to be run to delete the object completely.This deletion may be delayed until the history (audit) information is removed from the object entry.</p>
</li>
<li>
<p>Other objects are immediately deleted.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_understanding_certification_workflows"><a class="anchor" href="#_understanding_certification_workflows"></a><a class="link" href="#_understanding_certification_workflows">2.5. Understanding Certification Workflows</a></h3>
<div class="paragraph">
<p>Certification workflows allow you to certify various object types.DirX Identity currently supports workflows for certification campaigns, which means that you can verify and clean up the manual assignments of a privilege to users.</p>
</div>
<div class="paragraph">
<p>To use this type of certification, perform these steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Configure the certification campaign feature, including a corresponding schedule.</p>
</li>
<li>
<p>Create a certification campaign for privileges or users.</p>
</li>
<li>
<p>Configure a certification campaign with the <strong>Review the revocation of all manually assigned privileges that are rejected or left uncertified</strong> option for the <strong>Apply</strong> <strong>Changes</strong> configuration field.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For details about certification campaigns, read the DirX Identity Use Case Document <em>Certification Campaigns</em>.</p>
</div>
<div class="sect3">
<h4 id="_ch2_certification_campaign_workflows"><a class="anchor" href="#_ch2_certification_campaign_workflows"></a><a class="link" href="#_ch2_certification_campaign_workflows">2.5.1. Certification Campaign Workflows</a></h4>
<div class="paragraph">
<p>The certification campaign workflows are normal assignment workflows.For more information about this type of workflow, see the section "Guidelines for Approving Privilege Assignments".</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_understanding_service_management_workflows"><a class="anchor" href="#_understanding_service_management_workflows"></a><a class="link" href="#_understanding_service_management_workflows">2.6. Understanding Service Management Workflows</a></h3>
<div class="paragraph">
<p>Service management workflows help to perform tasks in a service management environment (ticket-based workflows).</p>
</div>
<div class="paragraph">
<p>DirX Identity currently supports two use cases:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Manual provisioning of offline target systems</p>
</li>
<li>
<p>Workflows for ticket processing from a source ticket system</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For more information about service management use cases, read the DirX Identity Use Case Document Service Management.</p>
</div>
<div class="sect3">
<h4 id="_ch2_manual_provisioning_workflows"><a class="anchor" href="#_ch2_manual_provisioning_workflows"></a><a class="link" href="#_ch2_manual_provisioning_workflows">2.6.1. Manual Provisioning Workflows</a></h4>
<div class="paragraph">
<p>DirX Identity currently supports only workflows for manual provisioning, which means that you can handle manual provisioning for systems that are not (yet) connected to the Identity Store.</p>
</div>
<div class="paragraph">
<p>To use this type of workflow, perform these steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Set up a target system of type Service Management. Part of this setup is the configuration of a Java-based synchronization workflow that uses a request workflow connector to start a corresponding request workflow for each action.</p>
</li>
<li>
<p>Set up the necessary manual provisioning request workflow.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following figure shows a typical manual provisioning workflow that can be used in service management environments.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch2_reqWFs/image13.png" alt="Manual Provisioning">
</div>
<div class="title">Figure 44. Manual Provisioning</div>
</div>
<div class="paragraph">
<p>The workflow shown in the figure contains the following activities:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Split Orders</strong> (automatic) - checks the order type (Add, Modify, Delete) and sets the Application State accordingly. The following activities are started according to this value.</p>
</li>
<li>
<p><strong>Addition by Administrator</strong> (people) - requests that an administrator adds the object (account or group) with all defined properties into the offline target system. After completion of this task, the approver confirms the activity (accepts it). This step is configured to take the owners of the privilege as approvers.</p>
</li>
<li>
<p><strong>Modification by Administrator</strong> (people) - requests that an administrator modifies an object (account or group) with all defined properties in the offline target system. After completion of this task, the approver confirms the activity (accepts it). This step is configured to take the owners of the privilege as approvers.</p>
</li>
<li>
<p><strong>Deletion by Administrator</strong> (people) - requests that an administrator deletes the object (account or group) in the offline target system. After completion of this task, the approver confirms the activity (accepts it). This step is configured to take the owners of the privilege as approvers.</p>
</li>
<li>
<p><strong>Set States</strong> (automatic) - sets the target system state (dxrTSState) of the object according to the operation; for example, a new account is set from NONE to ENABLED.</p>
</li>
<li>
<p><strong>Notification if Rejected</strong> - sends an e-mail to the corresponding user if the manual provisioning request was refused by the administrator.</p>
</li>
<li>
<p><strong>Notification if EXPIRED (automatic)</strong> - sends an e-mail to an administrator that the workflow has expired (the participants did not respond in time).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The manual provisioning workflow works as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In Web Center, the approvers receive a form with the specific request and its details.</p>
</li>
<li>
<p>They perform the corresponding task in the target system.</p>
</li>
<li>
<p>After performing the task, they accept the form. DirX Identity sets the target system state (dxrTSState) attribute for accounts and groups accordingly or moves the user to the correct member attribute (for example, from dxrGroupMemberAdd to dxrGroupMemberOK).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For more information about manual provisioning, refer to the DirX Identity Use Case Document <em>Service Management</em>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_ch2_process_ticket_workflows"><a class="anchor" href="#_ch2_process_ticket_workflows"></a><a class="link" href="#_ch2_process_ticket_workflows">2.6.2. Process Ticket Workflows</a></h4>
<div class="paragraph">
<p>DirX Identity supports workflows to process incoming tickets from source ticket systems. These tickets are converted into DirX Identity orders that are processed by a corresponding request workflow.</p>
</div>
<div class="paragraph">
<p>To use this type of workflow, perform these steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Set up a ticket web service interface that consumes the tickets sent from a service management workflow. Use the sample ticket web service interface as starting point.</p>
</li>
<li>
<p>Use the provided "Process Ticket" workflow sample and adapt it to your requirements.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following figure shows a typical ticket-processing workflow that can be used in service management environments.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch2_reqWFs/image14.png" alt="Process Ticket">
</div>
<div class="title">Figure 45. Process Ticket</div>
</div>
<div class="paragraph">
<p>The workflow shown in the figure contains the following activities:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Add attributes</strong> (automatic) - adds some fixed attributes to the subject order. In the pre-configured example, the <strong>employeeType</strong> is set to <strong>Contractor</strong> and the <strong>dxmOprMaster</strong> is set to <strong>Service</strong> <strong>Management</strong>.</p>
</li>
<li>
<p><strong>Apply order</strong> (automatic) - this step executes the order(s). For example, if you send a create user request with two role assignments, the user is created and the assignments are resolved. If an assignment requires approval, a child workflow is started automatically.</p>
</li>
<li>
<p><strong>Wait for child workflows</strong> (conditional) - this activity waits for all started child workflows to complete.</p>
</li>
<li>
<p><strong>Wait for completed provisioning</strong> (automatic) - this activity waits for all provisioning actions to target systems to be completed.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The Process Ticket workflow as defined in this default workflow works completely automatically without any user interaction. It instantiates or changes the object, assigns privileges and eventually starts a child workflow. Then it waits until the child workflows and the generated provisioning actions are complete.</p>
</div>
<div class="paragraph">
<p>For more information about ticket processing, read the DirX Identity Use Case Document <em>Service Management</em>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuring_custom_scenarios"><a class="anchor" href="#_configuring_custom_scenarios"></a><a class="link" href="#_configuring_custom_scenarios">3. Configuring Custom Scenarios</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Creating a customized DirX Identity scenario both in the Provisioning and Connectivity configuration and maintaining its objects can be a complex task.DirX Identity provides easy-to-use, comprehensive tools to simplify this task.You can use the Identity Manager <strong>Provisioning</strong> and <strong>Connectivity</strong> views to create identity creation, maintenance, and provisioning workflows that are consistent with the target system structure in your Provisioning domain.</p>
</div>
<div class="paragraph">
<p>To create and configure a custom DirX Identity scenario for a DirX Identity domain, perform the following steps with Identity Manager:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use the target system creation wizard in <strong>Provisioning</strong> &#8594; <strong>Target</strong> <strong>Systems</strong> to create a new target system in your new Provisioning domain.The wizard automatically creates a new scenario in the Connectivity domain provided no other scenarios yet exist and places the necessary configuration objects (connected directories and workflows) into this scenario.</p>
</li>
<li>
<p>Use the <strong>Provisioning</strong> view to refine the configuration of the newly created target system and its objects.</p>
</li>
<li>
<p>Use the <strong>Connectivity</strong> view to refine the configuration of the newly created maintenance and target system workflows.</p>
</li>
<li>
<p>Create and maintain additionally the necessary identity creation workflows (source workflows).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For additional target systems, perform these steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use the target system wizard to create additional target systems. The necessary configuration objects (connected directories and workflows) are added to your existing scenario in the Connectivity view automatically.</p>
</li>
<li>
<p>Use the <strong>Provisioning</strong> view to refine the configuration of the newly created target system and its objects.</p>
</li>
<li>
<p>Use the <strong>Connectivity</strong> view to refine the configuration of the newly created maintenance and target system workflows.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To create clustered target systems, see the section "Creating Cluster Target Systems".</p>
</div>
<div class="sect2">
<h3 id="_creating_the_new_scenario"><a class="anchor" href="#_creating_the_new_scenario"></a><a class="link" href="#_creating_the_new_scenario">3.1. Creating the New Scenario</a></h3>
<div class="paragraph">
<p>You can use the target system creation wizard to create a new target system and a new custom Connectivity scenario for your Provisioning domain. To run the target system creation wizard in this way, you need to have:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A fully configured Provisioning customer domain that contains only the default target system DirXmetaRole.</p>
</li>
<li>
<p>An installed Connectivity configuration.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To create the first target system and set up the new Connectivity scenario automatically:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Log in to DirX Identity Manager and select <strong>Provisioning</strong>.</p>
</li>
<li>
<p>Click the <strong>Domain Configuration</strong> view.</p>
</li>
<li>
<p>Click the top-level object (it has the name of your Provisioning domain).</p>
</li>
<li>
<p>Check the <strong>Connectivity configuration</strong> parameter in the <strong>General</strong> tab. If it is not correct, change it to the server where your Connectivity configuration domain is installed.</p>
</li>
<li>
<p>Click the <strong>Target Systems</strong> view.</p>
</li>
<li>
<p>Optionally you can create a folder or several folders that reflect your target system environment.</p>
</li>
<li>
<p>Click either on the top level object <strong>Target Systems</strong> or on one of the created folders, and then select <strong>New</strong> &#8594; <strong>Target System</strong>. The Target System Wizard opens. Click <strong>Next</strong>.</p>
</li>
<li>
<p>Select one of the available target system templates. Click <strong>Next</strong>.</p>
</li>
<li>
<p>Set the name of the new target system. Click <strong>Next</strong>.</p>
</li>
<li>
<p>Set the target system advanced parameters. Click <strong>Next</strong>.</p>
</li>
<li>
<p>Set the target system options. These might differ according to the target system template. Click <strong>Next</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>At this point, we have defined the parameters for the target system object in the Provisioning domain. Now the target system creation wizard detects that a scenario does not yet exist and prompts for the parameters that describe how to create the scenario:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The wizard will automatically create a new scenario with the same name as your Provisioning domain and will create a new identity store representation in your new scenario.</p>
</li>
<li>
<p>Next, the wizard prompts for the <strong>Maintenance Workflows</strong> to copy to the new scenario. Click <strong>Next</strong>. The wizard copies the workflows (this action takes some time to complete).</p>
</li>
<li>
<p>Now the wizard prompts for the <strong>Connected Directory</strong> template to be used for the new target system. Use either the proposed templates (Show preferred) or choose any of the other available templates (Show all). The latter choice makes sense, for example, if you intend to create an eDirectory target system. In this case, the Provisioning view assumes an LDAP type, whereas the Connectivity connected directory should be of type NDS (so choose the NDS template). Click <strong>Next</strong>.</p>
</li>
<li>
<p>You can synchronize the schema and change the attribute configuration of the new connected directory (only for target systems where this makes sense) in the next two steps. Click <strong>Next</strong>.</p>
</li>
<li>
<p>The wizard&#8217;s Configuration step (and depending on the target system, an additional next step) lets you define the most important parameters:</p>
</li>
<li>
<p><strong>Account Base</strong> and <strong>Group Base</strong> of the target system have already been defined and cannot be changed.</p>
</li>
<li>
<p>Set the <strong>Service</strong> and the <strong>Bind Profile</strong> parameters to the values of your target system connected directory.</p>
</li>
<li>
<p>Set the <strong>Connected Directory</strong> parameters. These parameters may differ depending on the connected directory type.</p>
</li>
<li>
<p>Click <strong>Next</strong>.</p>
</li>
<li>
<p>Now the target system wizard asks for the <strong>Provisioning Workflows</strong> to create. Select from <strong>Synchronization</strong>, <strong>Validation</strong> and <strong>Password</strong> <strong>Synchronization</strong>.</p>
</li>
<li>
<p>If you select <strong>Password</strong> <strong>Synchronization</strong>, you need to fill in the next four steps. For the other selections, the target system wizard copies and configures the workflows.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When the wizard finishes, you should have a completely configured Connectivity scenario with all of the necessary elements. The configured workflows should run. Of course, you might need to change some details, like the mapping of additional account and group attributes. The next section describes how to make these changes.</p>
</div>
</div>
<div class="sect2">
<h3 id="_refining_the_scenario"><a class="anchor" href="#_refining_the_scenario"></a><a class="link" href="#_refining_the_scenario">3.2. Refining the Scenario</a></h3>
<div class="paragraph">
<p>You can use the <strong>Provisioning</strong> &#8594; <strong>Target</strong> <strong>Systems</strong> view to maintain your newly created scenario. Click any of the target systems in the <strong>Target Systems</strong> view and select <strong>Connectivity</strong>. The subsequent menu selections allow you to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Change the configuration of the connected directory (<strong>Configure Connected Directory</strong>).</p>
</li>
<li>
<p>View the connected directory (if the Viewer command is entered correctly) (<strong>Open Connected Directory</strong>).</p>
</li>
<li>
<p>Copy new workflows to the workflow line between <strong>Identity Store</strong> and the connected directory (<strong>New Workflow</strong>).</p>
</li>
<li>
<p>Assign an existing workflow to the workflow line between <strong>Identity</strong> <strong>Store</strong> and the connected directory (<strong>Assign Workflow</strong>).</p>
</li>
<li>
<p>Configure, run, report or remove the validation workflow (<strong>Validation</strong>).</p>
</li>
<li>
<p>Configure, run, report or remove the synchronization workflow (<strong>Synchronization</strong>).</p>
</li>
<li>
<p>Configure, run, report or remove any of the other assigned workflows (<strong>Workflows</strong>).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can also manage the <strong>Identity Store</strong> connected directory from here. Right-click the Target Systems root node and select <strong>Connectivity</strong>. The subsequent menu selections allow you to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Change the configuration of <strong>Identity</strong> <strong>Store</strong> (<strong>Configure Connected Directory</strong>).</p>
</li>
<li>
<p>View the connected directory (if the Viewer command is entered correctly) (<strong>Open Connected Directory</strong>).</p>
</li>
<li>
<p>Copy new workflows to the workflow line between <strong>Identity Store</strong> and the connected directory (<strong>New Workflow</strong>).</p>
</li>
<li>
<p>Assign an existing workflow to the workflow line between <strong>Identity Store</strong> and the connected directory (<strong>Assign Workflow</strong>).</p>
</li>
<li>
<p>Configure, run, report or remove one of the assigned workflows (<strong>Workflows</strong>).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As you can see, the most important features of the Connectivity view are also available in the Provisioning view.</p>
</div>
<div class="paragraph">
<p>Scheduling and Combining Workflows</p>
</div>
<div class="paragraph">
<p>You should set up schedules that define when your created workflows shall run. The methods you use to set up schedules for DirX Identity Connectivity scenarios are highly dependent on your environment. We recommend that you:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Run synchronization workflows periodically, for example, every half hour. Optionally you can use a nested workflow that performs account-to-user joining after each run.</p>
</li>
<li>
<p>Run policy execution workflows and privilege execution after each creation workflow or after a sequence of creation workflows (use nested workflows and run them once a day or more often).</p>
</li>
<li>
<p>Run validation workflows each night or during each weekend (depending on the number of accounts and groups in your target systems). We recommend that you use a nested workflow that performs account-to-user joining after each run.</p>
</li>
<li>
<p>Run check consistency workflows every night or during each weekend.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_creating_the_identity_creation_workflows"><a class="anchor" href="#_creating_the_identity_creation_workflows"></a><a class="link" href="#_creating_the_identity_creation_workflows">3.3. Creating the Identity Creation Workflows</a></h3>
<div class="paragraph">
<p>The target system creation wizard helps you to create the initial Connectivity scenario and copies and configures everything that is necessary to handle the provisioning of the target systems. However, the wizard does not handle identity creation workflows. You must use the <strong>Connectivity</strong> view to create and maintain these workflows. For information about these tasks, see the <strong>Importing Identities</strong> section in the "Getting Started" chapter of the <em>DirX Identity Tutorial</em>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_creating_cluster_target_systems"><a class="anchor" href="#_creating_cluster_target_systems"></a><a class="link" href="#_creating_cluster_target_systems">3.4. Creating Cluster Target Systems</a></h3>
<div class="paragraph">
<p>Creating clustered target systems is a bit different from creating a single target system. Read the section "Cluster Workflows" in the <em>DirX Identity Connectivity Administration Guide</em> to understand the concept of cluster workflows. The chapter "Java-based Workflow Architecture" in this guide provides additional information.</p>
</div>
<div class="paragraph">
<p>Before we start with the creation procedure, be aware that the structure for cluster target systems is fixed:</p>
</div>
<div class="paragraph">
<p><strong>Target Systems</strong> &#8594; <em>cluster_container</em> &#8594; <em>cluster</em> &#8594; <em>target_system</em></p>
</div>
<div class="paragraph">
<p>Here is an example that shows how you can use this structure:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Target Systems
    UNIX-Clusters
    Linux-Cluster
        Linux1
        Linux2
        ...
        Linux&lt;n&gt;
    Windows-Clusters
    Europe-Cluster
        ADS-EU1
        ADS-EU2
        ...
    US-Cluster
        ADS-US1
        ADS-US2
        ...
Other-Clusters +
    ...</pre>
</div>
</div>
<div class="paragraph">
<p>The UNIX-Clusters folder comprises a Linux-Cluster with the target systems Linux1 to Linux<em>n</em>. The configuration of each cluster is identical except for some specific parameters like server addresses and bind profiles. The Windows clusters in this example are structured according to areas.</p>
</div>
<div class="paragraph">
<p>To set up clustered target systems, perform these steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Select the <strong>Target Systems</strong> view and then click the top node. Select <strong>New Cluster Container</strong> from the context menu and create a cluster container. In our example above, these are the UNIX-Clusters and Windows-Clusters objects.</p>
</li>
<li>
<p>Click the created object and then select <strong>New Cluster</strong> from the context menu. Define a name for your cluster. In our example, this would be for the UNIX-Clusters cluster container the object Linux-Cluster.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can create as many new target systems for your cluster below these clusters as you need. DirX Identity provides Web services for target system creation that are designed to set up cluster target systems efficiently, because this task requires setting many parameters for each system. Alternatively, you can create these target systems by hand, as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use the target system wizard to create a first target system below the cluster folder. Select the workflows that are necessary for provisioning. Select the cluster workflows - if present - for your target system template, or select non-cluster workflows. You can easily adjust them to work with cluster target systems.</p>
</li>
<li>
<p>After creating the first target system, move the <strong>Configuration</strong> folder one level up just below the cluster folder to allow its use by every subsequently created target system. Remember that all target systems in a cluster use the same set of object descriptions and other configuration definitions. Note that the <strong>Configuration</strong> folder will not be found if it is located anywhere else; that is, anywhere other than below the target system or - for a cluster - in the cluster folder that corresponds to the target systems that belong to the cluster.</p>
</li>
<li>
<p>If you were not able to select cluster workflows in the step above, change the copied workflows in the Expert view of the Connectivity view group:</p>
</li>
<li>
<p>Change the controller to the corresponding cluster controller type.</p>
</li>
<li>
<p>Adjust any other parameters that need to be adapted.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Now you can create additional cluster target systems:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use the target system wizard again, but do not select additional workflows. Remember that you can use one provisioning workflow for all target systems in a cluster. Delete the <strong>Configuration</strong> folder beneath the target system created again by the target system wizard, because you&#8217;ll use the one you moved up one level after you created the first target system.</p>
</li>
<li>
<p>For every created target system, set these parameters:</p>
</li>
<li>
<p>Set the <strong>Connected Directory</strong> link on the General tab to the same connected directory as the first target system.</p>
</li>
<li>
<p>Create an account object, for example, named <strong>bindaccount</strong>, for the purpose of binding to the connected system beneath the <strong>Accounts</strong> or <strong>Accounts</strong> <strong>and</strong> <strong>Groups</strong> container. Account objects are not allowed to be created under a different container. Then move it up one level in the Data View to exclude it from synchronization to the connected system. The link to this bind account is set in the <strong>Bind</strong> <strong>Parameters</strong> section in the <strong>Server</strong> <strong>Connection</strong> tab of the target system. Set the password of this account in the Data View <strong>userPassword</strong> attribute. This action sets the <strong>dxmPassword</strong> accordingly. Using an existing account that is linked to a user can cause problems because the workflow may no longer be able to log in to the connected system if the password is changed. Therefore we recommend using a separate bind account where you manage the password manually. As this account may be used as access for password modifications, it must have sufficient access rights (preferably an administrator account) in the connected system.<br></p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <strong>dxrName</strong> attribute of the bind account must contain the bind user name in the form <em>domain</em>*\*<em>user name</em>.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Set all other necessary parameters on the Workflow Configuration (for some target system types this tab is called Server Connection), Connector Configuration and Environment Properties tabs. These parameters are specific to the target system. Keep in mind that all target systems in the cluster use the same cluster workflows configured in the Connectivity view group.<br>
<br>
If, for example, you want to specify some connection-specific properties like the following ones for the SapECCUMConnector:<br></p>
<div class="paragraph">
<p><code>&lt;property name="client" value=800/&gt;<br>
&lt;property name="accessToCUA" value="FALSE"/&gt;</code><br></p>
</div>
<div class="paragraph">
<p>you must specify those properties as <em>tag</em>*=<strong><em>value</em> pairs (client=800, accessToCUA=FALSE) in the Connector Configuration tab - or directly dxmSpecificAttributes in the Data View - of the Provisioning Target System object.<br>
<br>
The <em>tag</em></strong>=<strong><em>value</em> pairs specified in the Connector Configuration or Server Connection tabs are stored in the LDAP attribute dxmSpecificAttributes and added to the &lt;connection&gt; section of the specific target system connector on workflow execution.<br>
<br>
The <em>tag</em></strong>=*<em>value</em> pairs specified in the Environment Properties tab are stored in the LDAP attribute dxrEnvironmentProperties. The environment properties must contain at least those attributes that are needed in a non-clustered workflow and specified in the Provisioning tab of the Connected Directory, like role_ts_account_base, role_ts_group_base or user_base. You can specify any property here and refer to it on the Connectivity workflow side - for example, in channel search base definitions like $\{env.user_base} - to restrict the search to a target system-specific user base, or you can refer to the environment properties in the mapping.<br>
<br>
Note that some attributes like the base nodes for accounts and groups exist both in the Provisioning-side target system and the Connectivity-side connected directory. The Connectivity-side attributes, if specified, are overwritten by the target system attributes when the workflow runs for that specific target system.</p>
</div>
</li>
<li>
<p>If the target system type of the cluster is <strong>OpenICF</strong>, every target system contains an additional tab where bind parameters and server address/port and the bundle-specific parameters are stored for the OpenICF server. Like the target system itself, the OpenICF server bind profile requires an additional account object which is referenced here; to exclude it from any synchronization, we recommend placing this account object alongside the target systems in the cluster. If several OpenICF servers belong to the cluster, but the bind password is the same for all of them, one such account object is sufficient; otherwise several must be created. One additional restriction applies to target systems in an OpenICF cluster: while DirX Identity can process the address <strong>localhost</strong>, the OpenICF server does not recognize a "root", so using localhostâ results in an error.</p>
</li>
<li>
<p>All the specific attributes in the Workflow Configuration, Connector Configuration, Environment Properties and OpenICF Server Configuration (for OpenICF) tabs are read from the default configuration on the Connectivity side and need only be present on the Provisioning side if the value differs for the target system. If no value is present in the target system, the default is evaluated. For OpenICF, where the server configuration is comprised of several bundle-specific attributes and the necessary bind profile attributes, this means:<br></p>
<div class="paragraph">
<p>1) If only one bundle is used (which we expect to be the main case), the bundle-specific attributes can be used from the workflow and need not be entered in every target system.<br>
<br>
2) If the same password is used in all OpenICF servers in the cluster, the bind profile can be used from the connected directory and need not be entered in every target system, thus also making the additional bind account redundant.<br>
<br>
3) If only one OpenICF server is used, the bind profile and the server address/port can be used from the connected directory/service and need not be entered in every target system, thus again making the additional bind account redundant.<br></p>
</div>
<div class="paragraph">
<p>4) For all other cases, remember that the values entered on the Connectivity side are used. They must only be entered in the actual target system if they differ.</p>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_the_default_connectivity_applications"><a class="anchor" href="#_using_the_default_connectivity_applications"></a><a class="link" href="#_using_the_default_connectivity_applications">4. Using the Default Connectivity Applications</a></h2>
<div class="sectionbody">
<div class="paragraph">
<div class="title">png</div>
<p>This chapter describes the default Connectivity applications available in the <strong>Connectivity</strong> view group and how to configure and customize them.For information about the default request workflows, see the <em>DirX Identity Provisioning Administration Guide</em>.The sections in this chapter</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Describe how to work with the default Connectivity applications as a whole</p>
</li>
<li>
<p>Provide an understanding of the default Connectivity applications</p>
</li>
<li>
<p>Describe how to configure a custom Connectivity scenario</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The chapters that follow describe the default Connectivity applications and are subdivided into the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Source workflows</p>
</li>
<li>
<p>Maintenance workflows</p>
</li>
<li>
<p>Target system workflows</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_working_with_default_connectivity_application_objects"><a class="anchor" href="#_working_with_default_connectivity_application_objects"></a><a class="link" href="#_working_with_default_connectivity_application_objects">4.1. Working with Default Connectivity Application Objects</a></h3>
<div class="paragraph">
<p>All default Connectivity application objects are located in <strong>Default</strong> folders. We strongly recommend that you do not work directly in the default Connectivity scenario or any of its folders. Instead, you should create your own scenarios and create your own connected directories and workflows within your own scenarios. The "Getting Started" chapter in the <em>DirX Identity Tutorial</em> provides detailed instructions on how to perform these tasks. When you follow this recommended procedure, all of your objects are created in folders within your own scenario; for example, workflows are created in the <strong>Workflows</strong> folder, connected directories are created in the <strong>Connected Directory</strong> folder and so on. DirX Identity automatically uses folders that have the name of your scenario.</p>
</div>
<div class="paragraph">
<p><strong>Important note:</strong> The objects you create from default application objects will not be affected by DirX Identity upgrades for two reasons: each object has a unique identifier (and your created objects have these identifiers, too) and DirX Identity preserves all central objects from the previous release by copying them to a version-specific folder (but only if there were changes in these objects).</p>
</div>
<div class="paragraph">
<p>You should also be aware that some default Connectivity applications use central objects like Tcl scripts in the folder <strong>Configuration</strong> &#8594; <strong>Tcl</strong>. If you change these central objects, all of your copied default applications will be affected by your change. DirX Identity surrounds all property sheets that belong to this central area with a red border that contains the text <strong>This object might be shared because it belongs to the Configuration folder</strong>. If you do not want this behavior, you should make your copies independent from the central objects by creating local ones. See the section "Linking Objects" in the "Managing Provisioning Workflows" chapter in the <em>DirX Identity Connectivity Administration Guide</em> to learn more about thi concept.s</p>
</div>
</div>
<div class="sect2">
<h3 id="_working_with_default_connectivity_scenario"><a class="anchor" href="#_working_with_default_connectivity_scenario"></a><a class="link" href="#_working_with_default_connectivity_scenario">4.2. Working with the Default Connectivity Scenario</a></h3>
<div class="paragraph">
<p>The default Connectivity applications consist of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Source Workflows</strong> - comprise the <strong>Source Real-time</strong> and <strong>Source Scheduled</strong> scenarios. These scenarios consist of Java-based / Tcl-based Identity creation workflows, which assist with importing and joining organizational and user information from various sources to create identities within the Identity Store. Update workflows can import attributes back to these source systems.</p>
</li>
<li>
<p><strong>Maintenance Workflows</strong> - comprise the <strong>Identity Store</strong> scenario. This scenario contains Identity maintenance workflows, which help to manage the created identities. Consistency checks, policy execution, privilege resolution and password expiration are examples of this workflow group.</p>
</li>
<li>
<p><strong>Target System Workflows</strong> - comprise the <strong>Target Real-time</strong> and <strong>Target Scheduled</strong> scenarios. These scenarios contain all Java-based / Tcl-based Identity Provisioning workflows, which offer initial load and validation from connected systems as well as regular synchronization. These scenarios also offer password synchronization and other useful capabilities.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These workflows are part of the default Connectivity scenario, which you can view with Identity Manager&#8217;s <strong>Connectivity</strong> &#8594; <strong>Global</strong> view. The following figure illustrates the default Connectivity scenarios and its workflows.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch4_defappls/image1.png" alt="DirX Identity Default Connectivity Scenario">
</div>
<div class="title">Figure 46. DirX Identity Default Connectivity Scenario</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_the_source_workflows"><a class="anchor" href="#_using_the_source_workflows"></a><a class="link" href="#_using_the_source_workflows">5. Using the Source Workflows</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Identity source workflows synchronize information from existing sources to the Identity Store.This chapter provides detailed information about source workflow features, configuration, and user hooks.The sections in this chapter describe:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Java-based source workflows</p>
</li>
<li>
<p>Tcl-based source workflows</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_understanding_the_java_based_source_workflows"><a class="anchor" href="#_understanding_the_java_based_source_workflows"></a><a class="link" href="#_understanding_the_java_based_source_workflows">5.1. Understanding the Java-based Source Workflows</a></h3>
<div class="paragraph">
<p>DirX Identity&#8217;s Java-based source real-time workflows provided with the default Connectivity scenario include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Creation workflows - workflows that extract user information from existing identity sources (for example, an HR or a CRM database, an Active Directory system or a file system) and populate the Identity Store with user information. The workflows either use the <strong>Full-Import</strong> controller, which works in "Replace" mode and deletes those users in DirX Identity that do not exist in the source system, or the <strong>SyncOneWay2Identity</strong> controller, which works in "Merge" mode and does not delete DirX Identity user entries that do not exist in the source.</p>
</li>
<li>
<p>Update workflows - workflows that transfer specific information from the Identity Store to the identity sources (for example, e-mail addresses or telephone numbers) to enable them to use the joined, high-quality information in the Identity Store. These workflows use the SyncOneWay2TS controller.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>DirX Identity provides the following pre-configured creation and update workflows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Import Users from Active Directory</strong> - imports Active Directory users to the Identity Store.</p>
</li>
<li>
<p>Import Users from Database - imports users from a relational database to the Identity Store.</p>
</li>
<li>
<p><strong>Import Roles From Database</strong> - imports role data from a database to the role catalog of the Identity Store.</p>
</li>
<li>
<p><strong>Import Users from LDIF</strong> - imports users from an LDIF content file to the Identity Store.</p>
</li>
<li>
<p><strong>Export Users to LDIF</strong> - exports users from the Identity Store to an LDIF content file.</p>
</li>
<li>
<p><strong>Import Users from CSV</strong> - imports users from a CSV file to the Identity Store.</p>
</li>
<li>
<p><strong>Export Users from CSV</strong> - exports users from the Identity Store to a CSV file.</p>
</li>
<li>
<p><strong>Import of External LDAP Users</strong> - imports users from an external LDAP to the Identity Store.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>DirX Identity also provides the Remote AD workflow, which is intended for deployment with Atos Cloud Service Identity Management as a Service (IDMaaS).</p>
</div>
<div class="sect3">
<h4 id="_ch5_active_directory_ads_user_import_workflow"><a class="anchor" href="#_ch5_active_directory_ads_user_import_workflow"></a><a class="link" href="#_ch5_active_directory_ads_user_import_workflow">5.1.1. Active Directory (ADS) User Import Workflow</a></h4>
<div class="paragraph">
<p>The Active Directory (ADS) user import workflow operates between the users folder in the Identity Store and an Active Directory connected system. It uses the same APIs and component deployment as the Java-based Active Directory (ADS) Provisioning workflows. See the section "Active Directory (ADS) Workflows" in the chapter "Using the Target System (Provisioning) Workflows" in this guide for more details.</p>
</div>
<div class="paragraph">
<p>The workflow is based on Java real-time technology, with the ADS connector accessing an Active Directory via native LDAP protocol and the LDAP connector accessing a DirX Identity domain. The Full-Import controller is configured as the join engine. The controller exports all AD users from the source system and then imports them into the Identity domain user tree.</p>
</div>
<div class="paragraph">
<p>This workflow can also be used as a template for other Java-based source workflows for user objects. Other user data sources instead of ADS can be connected.</p>
</div>
<div class="paragraph">
<p>The connected directory UserADS represents the Active Directory containing the users and the connected directory Identity Store represents the Identity domain.</p>
</div>
<div class="paragraph">
<p>The next sections describe</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Workflow prerequisites</p>
</li>
<li>
<p>How to configure the workflow</p>
</li>
<li>
<p>The workflow and its activities</p>
</li>
<li>
<p>Ports</p>
</li>
<li>
<p>Channels</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The workflow allows you to import Identity users from source ADS user entries. The workflow needs only one channel for users and a set of attributes to be imported.</p>
</div>
<div class="paragraph">
<p>The workflow handles these common objects:</p>
</div>
<div class="paragraph">
<p>Users - the user represents in this workflow a common account in an ADS connected system. It typically holds the demographic data and ADS account control attributes.</p>
</div>
<div class="paragraph">
<p>The delivered workflow is:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Import Users from ADS</strong> - the source Java-based workflow exports all specified ADS users and then imports them into Identity Store.</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="_ch5_ads_user_import_workflow_prerequisites"><a class="anchor" href="#_ch5_ads_user_import_workflow_prerequisites"></a><a class="link" href="#_ch5_ads_user_import_workflow_prerequisites">5.1.1.1. ADS User Import Workflow Prerequisites</a></h5>
<div class="paragraph">
<p>The workflow can be used only with supported versions of Active Directory server.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch5_ads_user_import_workflow_configuration"><a class="anchor" href="#_ch5_ads_user_import_workflow_configuration"></a><a class="link" href="#_ch5_ads_user_import_workflow_configuration">5.1.1.2. ADS User Import Workflow Configuration</a></h5>
<div class="paragraph">
<p>The ADS User Import workflow configuration on the Connectivity side is described in detail in "Active Directory (ADS) Workflows" in the section "Using the Target System (Provisioning) Workflows".</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch5_ads_user_import_workflow_and_activities"><a class="anchor" href="#_ch5_ads_user_import_workflow_and_activities"></a><a class="link" href="#_ch5_ads_user_import_workflow_and_activities">5.1.1.3. ADS User Import Workflow and Activities</a></h5>
<div class="paragraph">
<p>The workflow <strong>Import Users from ADS</strong> is a Java-based source workflow with two activities:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Join activity - implements the user import</p>
</li>
<li>
<p>Error activity - receives update requests that failed despite retries and issues notifications</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The join activity is controlled by the Full-Import controller. It exports ADS user entries via the connector configured in the TS port and performs updates via the connector configured in the IdentityDomain port, as illustrated in the following figure:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch5_sourceWFs/image1.png" alt="ADS User Import Workflow Ports and Channels">
</div>
<div class="title">Figure 47. ADS User Import Workflow Ports and Channels</div>
</div>
<div class="paragraph">
<p>You can start the workflow either manually or via a schedule.</p>
</div>
<div class="paragraph">
<p>There are no global user hooks and no filters necessary.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch5_ads_user_import_workflow_ports"><a class="anchor" href="#_ch5_ads_user_import_workflow_ports"></a><a class="link" href="#_ch5_ads_user_import_workflow_ports">5.1.1.4. ADS User Import Workflow Ports</a></h5>
<div class="paragraph">
<p>The workflow supports the following ports:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>TS port - represents the ADS that contains the users (accounts). The ADS connector is used to access the Active Directory.</p>
</li>
<li>
<p>IdentityDomain port - represents the DirX Identity domain and is accessed via the LDAP connector.</p>
</li>
<li>
<p>Event - used for sending change events.</p>
</li>
<li>
<p>Notify - used for sending e-mails.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch5_ads_user_import_workflow_channels"><a class="anchor" href="#_ch5_ads_user_import_workflow_channels"></a><a class="link" href="#_ch5_ads_user_import_workflow_channels">5.1.1.5. ADS User Import Workflow Channels</a></h5>
<div class="paragraph">
<p>The workflow needs only one channel per port. It represents the user objects.</p>
</div>
<div class="sect5">
<h6 id="_ch5_ts_port"><a class="anchor" href="#_ch5_ts_port"></a><a class="link" href="#_ch5_ts_port">5.1.1.5.1. TS Port</a></h6>
<div class="paragraph">
<p>This port represents the connection to ADS. It is only used for exporting users and attributes from the ADS. The users are expected to be stored in the organizational unit <strong>OU=Users,OU=BRQH,OU=CZ</strong>.</p>
</div>
<div class="paragraph">
<p>Export:</p>
</div>
<div class="paragraph">
<p>Filter is set to <strong>&amp;(objectClass=user)(objectCategory=person)</strong>.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch5_identity_port"><a class="anchor" href="#_ch5_identity_port"></a><a class="link" href="#_ch5_identity_port">5.1.1.5.2. Identity Port</a></h6>
<div class="paragraph">
<p>This port represents the connection to the Identity Store. It is used for importing users into an Identity domain.</p>
</div>
<div class="paragraph">
<p><strong>Export:</strong></p>
</div>
<div class="paragraph">
<p>For exporting, the search base is taken from the environment property <strong>role_ts_account_base</strong> (in the connected directory <strong>Provisioning</strong> tab). The filter is needed to only export users from an Identity domain.</p>
</div>
<div class="paragraph">
<p><strong>Mapping:</strong></p>
</div>
<div class="paragraph">
<p>The SPML identifier must be set when a user is created. The id is composed by exchanging the base of source ADS identifier (full DN containing DCs and OUs) through the <strong>role_ts_account_base</strong>. The base of the ADS user is set as the concatenation of the Relative User Base (<strong>user_base_rel</strong>) settings and Domain.</p>
</div>
<div class="paragraph">
<p>The associated user for a source entry is first searched using the mapped <strong>dxmADsGuid</strong> attribute value and then via the <strong>dxmADsSamAccountName</strong> attribute value.</p>
</div>
<div class="paragraph">
<p>The attribute dxrState is mapped specially by a Java class. The resulting values are ENABLED, DISABLED or TBDEL. The states ENABLED and DISABLED are set according to the attribute flag <strong>userAccountControl</strong>, which controls the account state in ADS. The TBDEL state is set when the source entry in ADS no longer exists. When a change of the <strong>dxrState</strong> attribute is detected, an appropriate date attribute of the user entry is set with the current date and time. The <strong>dxrStartDate</strong> attribute is set for newly imported user objects (ENABLED). Deleted entries (TBDEL) have the attribute <strong>dxrEndDate</strong> set. The change of state ENABLED to DISABLED (DISABLED to ENABLED resp.) is tracked in the attribute <strong>dxrDisableStartDate</strong> (<strong>dxrDisableEndDate</strong> resp.).</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch5_relational_database_user_import_workflow"><a class="anchor" href="#_ch5_relational_database_user_import_workflow"></a><a class="link" href="#_ch5_relational_database_user_import_workflow">5.1.2. Relational Database User Import Workflow</a></h4>
<div class="paragraph">
<p>The <strong>Import Users from Database</strong> workflow imports users and their role assignments from a relational database into a DirX identity domain. It uses the Identity domain connector to access the DirX Identity domain and the JDBC connector to access the relational database. The connected directory UserDB represents the relational database containing the users and their role assignments and the connected directory Identity Store represents the Identity domain.</p>
</div>
<div class="paragraph">
<p>The Full-Import controller is configured as the join engine. The controller exports all users from the database table, adds the assignments from the role assignment table and then imports them into the DirX Identity domain user tree. The Identity domain connector resolves and stores the users along with changed accounts and groups. If a privilege requires approval, the connector starts a request workflow.</p>
</div>
<div class="sect4">
<h5 id="_ch5_relational_database_user_import_workflow_prerequisites"><a class="anchor" href="#_ch5_relational_database_user_import_workflow_prerequisites"></a><a class="link" href="#_ch5_relational_database_user_import_workflow_prerequisites">5.1.2.1. Relational Database User Import Workflow Prerequisites</a></h5>
<div class="paragraph">
<p>The sample workflow configuration expects a Microsoft Access database <strong>new-hr</strong>. It uses the open source JDBC Java driver UCanAccess; the jar file <strong>ucanaccess.jar</strong> with this driver is deployed with the IdS-J Server in its subfolder <strong>confdb/jobs/framework/lib/</strong>.</p>
</div>
<div class="paragraph">
<p>The relational database must contain two tables: the <strong>EMPL</strong> table with a list of users and the <strong>EmplRoles</strong> table with a list of user-role assignments. They reference the user with their <strong>PersonalNr</strong> and the role with their <strong>roleID</strong>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch5_relational_database_user_import_workflow_configuration"><a class="anchor" href="#_ch5_relational_database_user_import_workflow_configuration"></a><a class="link" href="#_ch5_relational_database_user_import_workflow_configuration">5.1.2.2. Relational Database User Import Workflow Configuration</a></h5>
<div class="paragraph">
<p>The Import Users from Database workflow configuration conforms to the standard real-time workflow structure: it is composed of a join activity and an error activity. The following figure illustrates this configuration:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch5_sourceWFs/image2.png" alt="Relational Database User Import Workflow">
</div>
<div class="title">Figure 48. Relational Database User Import Workflow</div>
</div>
<div class="paragraph">
<p>As shown in the figure, the JDBC connector accesses the relational database, while the Identity domain connector accesses the Identity domain.</p>
</div>
<div class="sect5">
<h6 id="_ch5_jdbc_connector_and_connected_directory_configuration"><a class="anchor" href="#_ch5_jdbc_connector_and_connected_directory_configuration"></a><a class="link" href="#_ch5_jdbc_connector_and_connected_directory_configuration">5.1.2.2.1. JDBC Connector and Connected Directory Configuration</a></h6>
<div class="paragraph">
<p>The JDBC connector configuration obtains its properties from the referenced bind profile (user, password) and the JDBC connected directory&#8217;s <strong>driverDBType</strong>, <strong>type</strong> and <strong>url</strong> attributes. In the sample, <strong>driverDBtype</strong> is the JDBC-ODBC driver (class name: <strong>siemens.dxm.connector.jdbc.AccessOverJdbcOdbcDriver</strong>) and <strong>type</strong> is the class name of the driver (<strong>net.ucanaccess.jdbc.UcanaccessDriver</strong>).</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch5_ts_port_filter_configuration"><a class="anchor" href="#_ch5_ts_port_filter_configuration"></a><a class="link" href="#_ch5_ts_port_filter_configuration">5.1.2.2.2. TS Port Filter Configuration</a></h6>
<div class="paragraph">
<p>The TS port represents the relational database accessed by the JDBC connector. You need to configure a real-time filter for the TS port that adds the user-role assignments from the <strong>EmplRoles</strong> table as an attribute to the user. The sample configuration uses the filter class <strong>net.atos.dirx.dxi.connector.svclayer.workflow.JdbcRoleAsgFilter</strong>, which evaluates the following configuration options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>assignmentTable - the filter needs to know the name of the table that contains the user-role assignments. As it sees all requests and responses between the join engine and the JDBC connector, it also receives the requests to the users table and must leave them untouched.</p>
</li>
<li>
<p>roleAsgAttribute - the attribute under which the role assignments should be returned to the join engine. If the option is empty, the filter uses the <strong>rolesassigned</strong> attribute.</p>
</li>
<li>
<p>userIdColumn - the column name of the user-role table that holds the ID of the user. The filter expects the search result to be ordered by this column. All consecutive records with the same user ID are considered to belong to the same user and added as multiple values (one record = one assignment = one value) to the role assignment attribute of the user.</p>
</li>
<li>
<p>roleIdColumn - the column name of the user-role table that holds the identifier of the role.</p>
</li>
<li>
<p>paramIDColumn - the column name of the user-role table that holds the identifier of the role parameter.</p>
</li>
<li>
<p>paramValueColumn - the column name of the user-role table that holds the value of the role parameter.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The filter only intersects search requests for the assignment table. It collects all search result entries for the same user and adds them as a multi-value attribute to the first entry for this user. The join engine then adds this attribute to the user attributes list it has obtained by reading from the userâs table.</p>
</div>
<div class="paragraph">
<p>Note that the column names that contain the end date of an assignment, the role parameter UID and the role parameter value are hard-coded in the filter. For a custom workflow, the filter needs to be changed and adapted.</p>
</div>
<div class="paragraph">
<p>The sample filter implementation can be used as a template for custom filters. See the source code in the folder <strong>Additions/ServiceLayerConnector</strong> and the Javadoc in the folder <strong>Documentation/DirX identity/ServiceLayerConnector</strong> of the product media.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch5_relational_database_user_import_workflow_channel_configuration"><a class="anchor" href="#_ch5_relational_database_user_import_workflow_channel_configuration"></a><a class="link" href="#_ch5_relational_database_user_import_workflow_channel_configuration">5.1.2.3. Relational Database User Import Workflow Channel Configuration</a></h5>
<div class="paragraph">
<p>The following figure illustrates the workflow&#8217;s ports and their channels:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch5_sourceWFs/image3.png" alt="Relational Database User Import Workflow Ports and Channels">
</div>
<div class="title">Figure 49. Relational Database User Import Workflow Ports and Channels</div>
</div>
<div class="paragraph">
<p>As shown in the figure, the TS port represents the access to the relational database, while the Identity Store port represents the access to the DirX Identity domain.</p>
</div>
<div class="paragraph">
<p>You need to configure two channels for the relational database:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>User - the primary channel for reading the user attributes.</p>
</li>
<li>
<p>user-roles - the secondary channel that represents the table holding the user-role assignments.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Here is a snippet of the <strong>EMPL</strong> table with the user attributes, including the <strong>PersonalNr</strong> column, which uniquely identifies the user in this table:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch5_sourceWFs/image4.png" alt="Relational Database User Import Workflow EMPL Table">
</div>
<div class="title">Figure 50. Relational Database User Import Workflow EMPL Table</div>
</div>
<div class="paragraph">
<p>Here is a snippet of the EmplRoles table showing its columns:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch5_sourceWFs/image5.png" alt="Relational Database User Import Workflow EmplRoles Table">
</div>
<div class="title">Figure 51. Relational Database User Import Workflow EmplRoles Table</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Especially the <strong>PersonalNr</strong> column, which contains the ID of the user and acts as a type of foreign key into the <strong>EMPL</strong> table in the database.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You need to configure three channels for the Identity domain:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>User - the primary channel that represents the users in the domain.</p>
</li>
<li>
<p>user-roles - the secondary channel that represents the user-role assignments.</p>
</li>
<li>
<p>setPassword - the password channel that defines the password-related attributes.</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="_ch5_user_channel_at_the_ts_port"><a class="anchor" href="#_ch5_user_channel_at_the_ts_port"></a><a class="link" href="#_ch5_user_channel_at_the_ts_port">5.1.2.3.1. User Channel at the TS Port</a></h6>
<div class="paragraph">
<p>This port is only used for searching, so there is nothing to be configured for the import. The Export tab needs to contain the table name in DN format; in the sample, it is <strong>Table=EMPL</strong>.</p>
</div>
<div class="paragraph">
<p>The mapping lists all the columns of the table that are to be synchronized to the Identity domain. Note that the identifier is in DN format and should be populated with the <strong>EmployeeID</strong>, which is considered to be unique.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch5_user_roles_channel_at_the_ts_port"><a class="anchor" href="#_ch5_user_roles_channel_at_the_ts_port"></a><a class="link" href="#_ch5_user_roles_channel_at_the_ts_port">5.1.2.3.2. User-roles Channel at the TS Port</a></h6>
<div class="paragraph">
<p>This secondary channel needs to refer to the primary channel <strong>User</strong> in its Primary Channel tab. For joining an assignment record to the user record, you need to select the user ID column in the assignment table (in the sample, <strong>EmplRoles.PersonalNr</strong>) and in the users table (in the sample, <strong>PersonalNr</strong>).</p>
</div>
<div class="paragraph">
<p>The Export tab needs to contain the table name in DN format; in the sample, it&#8217;s <strong>Table=EMPL</strong>.</p>
</div>
<div class="paragraph">
<p>The mapping lists the columns to be exported. As the workflow only reads from the database, you don&#8217;t need to configure a mapping.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch5_user_channel_at_the_identity_store_port"><a class="anchor" href="#_ch5_user_channel_at_the_identity_store_port"></a><a class="link" href="#_ch5_user_channel_at_the_identity_store_port">5.1.2.3.3. User Channel at the Identity Store Port</a></h6>
<div class="paragraph">
<p>In the Export tab, make sure to sort the entries according to the same attribute as in the database; in the sample, it is the <strong>employeeNr</strong>, because the <strong>personalNr</strong> in the database is mapped to it.</p>
</div>
<div class="paragraph">
<p>In the Export tab, configure the parent folder of the users to be exported and imported as the search base. It is taken from the environment variable <strong>role_ts_account_base</strong>. This variable is set in the connected TS directory (that is, the user database). For simplicity, the folder <strong>cn=system</strong> under the users folder is selected for the sample because it exists by default and it is empty.</p>
</div>
<div class="paragraph">
<p>The joining of a database user to the user in LDAP is also performed using the unique <strong>employeeNr</strong> (Join tab).</p>
</div>
<div class="paragraph">
<p>The user-privilege assignments are configured in the separate channel <strong>user-roles</strong>. As a result, you need to add a reference to this channel to the <strong>Member</strong> <strong>Channel</strong> field in the General tab.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch5_user_roles_channel_at_the_identity_store_port"><a class="anchor" href="#_ch5_user_roles_channel_at_the_identity_store_port"></a><a class="link" href="#_ch5_user_roles_channel_at_the_identity_store_port">5.1.2.3.4. User-roles Channel at the Identity Store Port</a></h6>
<div class="paragraph">
<p>The user-roles channel represents the privilege assignments of the user.</p>
</div>
<div class="paragraph">
<p>As the sample covers only role assignments, you only need to configure the <strong>rolesassigned</strong> attribute in the mapping section. You need to configure the attributes <strong>permissionsassigned</strong> and <strong>groupsassigned</strong> for permissions and groups. You also need to implement and configure a mapping function for these attributes; in the sample, it is <strong>net.atos.dirx.dxi.connector.svclayer.workflow.MapRolesAssigned</strong>. This function expects the assignments in the attribute <strong>rolesassigned</strong> of the source entry in structured JSON format; for details, see the chapter on the Identity Domain Connector in the <em>DirX Identity Connectivity Reference</em>. The mapping replaces the ID of the role that is known in the database with the DN of the role in LDAP. For this purpose, it retrieves a reference to the connector from the environment and requests it to search the role by its role ID.</p>
</div>
<div class="paragraph">
<p>You can use the sample mapping function implementation as a template for custom mappings. See the source code in the folder <strong>Additions/ServiceLayerConnector</strong> and the Javadoc in the folder <strong>Documentation/DirX identity/ServiceLayerConnector</strong> of the product media.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch5_setpassword_channel_at_the_identity_store_port"><a class="anchor" href="#_ch5_setpassword_channel_at_the_identity_store_port"></a><a class="link" href="#_ch5_setpassword_channel_at_the_identity_store_port">5.1.2.3.5. setPassword Channel at the Identity Store Port</a></h6>
<div class="paragraph">
<p>The <strong>setPassword</strong> channel represents the password-related attributes of the user. This is expressed by setting a reference to the <strong>Password</strong> <strong>Primary</strong> <strong>Channel</strong> field (in the sample, <strong>User</strong>) in the General tab.</p>
</div>
<div class="paragraph">
<p>By default, the connector does not store the password itself. Instead, it sends it encrypted within a password change event to the workflow UserPasswordEventManager. This workflow changes the password at the user and initiates an update in corresponding accounts. You don&#8217;t need to configure other password-related attributes such as <strong>dxrPwdReset</strong> explicitly. They are handled automatically by the password change workflows.</p>
</div>
<div class="paragraph">
<p>If you want the connector to store the password as is directly in LDAP and not send a password change event, you must set the configuration attribute <strong>suppressPwdEvent</strong> to true. You can do this in the port <strong>IdentityDomain</strong> under the join activity of the workflow and select the tab Target System.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch5_importing_database_users_without_their_role_assignments"><a class="anchor" href="#_ch5_importing_database_users_without_their_role_assignments"></a><a class="link" href="#_ch5_importing_database_users_without_their_role_assignments">5.1.2.4. Importing Database Users without their Role Assignments</a></h5>
<div class="paragraph">
<p>The sample workflow imports users and their role assignments. If you want to import users but not their assignments, you can re-use the workflow configuration by making the following changes to it:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Delete the channels for the assignments: navigate to the user-roles channel of the connected TS directory (in the sample, this is <strong>UserDB</strong>), select <strong>Go</strong> <strong>to</strong> <strong>DataView</strong> and then delete the LDAP channel entry in the Data View. Now perform the same actions on the corresponding user-roles channel under the Identity Store connected directory. To find its parent channel, select the <strong>IdentityDomain</strong> port under the workflow join activity and then navigate to the channel parent.</p>
</li>
<li>
<p>Delete the references from the User channels: under both connected directories, select the User channel. In the General tab, clear the <strong>Member</strong> <strong>Channel</strong> field.</p>
</li>
<li>
<p>Delete the role-assignment filter in the TS port: navigate to the join activity in the workflow and then to its TS port. Select the child role-assignment filter. From the context menu, select <strong>Go to DataView</strong> and then delete the LDAP filter entry in the Data View.</p>
</li>
<li>
<p>Select the workflow wizard <strong>wf-UserImportFromDB</strong>: In the Wizard field of the workflow entry, select the other wizard from the folder <strong>Configuration</strong> &#8594; <strong>Connector</strong> <strong>Types</strong> &#8594; <strong>SvcLayerConnector</strong> &#8594; <strong>Wizards</strong>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch5_role_import_workflow"><a class="anchor" href="#_ch5_role_import_workflow"></a><a class="link" href="#_ch5_role_import_workflow">5.1.3. Role Import Workflow</a></h4>
<div class="paragraph">
<p>The workflow <strong>Import Roles from database</strong> imports roles from a JDBC database using DirX Identity Provisioning Web Services. The following figure illustrates this workflow.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch5_sourceWFs/image6.png" alt="Role Import Workflow">
</div>
<div class="title">Figure 52. Role Import Workflow</div>
</div>
<div class="paragraph">
<p>The role import workflow is based on Java real-time technology, with the JDBC connector accessing the database and the SPMLV1ToV2 connector accessing DirX Identity domain. The Full-Import controller is configured as the join engine. Full-Import is a one-way controller that exports all roles from the source system and then imports them into the target system; in this case, the Identity domain.</p>
</div>
<div class="paragraph">
<p>This workflow can also be used as a template for normal provisioning workflows to SPMLv2 target systems by setting the SPMLV1ToV2 connector for the target system port, the LDAP connector for the Identity port and the synchronization or validation controller as the join engine.</p>
</div>
<div class="paragraph">
<p>The connected directory <strong>RoleDB</strong> represents the database containing the roles and the connected directory <strong>SPMLv2WebServices</strong> represents the Identity domain accessed via the Provisioning Services.</p>
</div>
<div class="paragraph">
<p>The workflow needs only one channel for roles and a minimal set of attributes to be synchronized.</p>
</div>
<div class="paragraph">
<p>The next sections describe</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Workflow prerequisites</p>
</li>
<li>
<p>How to configure the workflow</p>
</li>
<li>
<p>The workflow and its activities</p>
</li>
<li>
<p>Ports</p>
</li>
<li>
<p>Channels</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="_ch5_role_import_workflow_prerequisites"><a class="anchor" href="#_ch5_role_import_workflow_prerequisites"></a><a class="link" href="#_ch5_role_import_workflow_prerequisites">5.1.3.1. Role Import Workflow Prerequisites</a></h5>
<div class="paragraph">
<p>The workflow configuration expects a Microsoft Access database registered as <strong>new-hr</strong> using the URL "jdbc:odbc:new-hr" (see connected directory, tab <strong>Configuration</strong>).</p>
</div>
<div class="paragraph">
<p>At the Identity side, the Identity Web Services must be deployed. Configure its port at the service associated with the connected directory and then configure the server name at the server object associated with the service. The URL path <strong>ProvisioningService/services/Spmlv2RequestService</strong> reflects the default path of the Web Services' Provisioning Services deployed with the IdS-J server.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch5_role_import_workflow_configuration"><a class="anchor" href="#_ch5_role_import_workflow_configuration"></a><a class="link" href="#_ch5_role_import_workflow_configuration">5.1.3.2. Role Import Workflow Configuration</a></h5>
<div class="paragraph">
<p>The default Connectivity scenario&#8217;s <strong>Import Role From Database</strong> workflow synchronizes role entries from a relational database table to the role catalog in the Identity Store.</p>
</div>
<div class="paragraph">
<p>To run the Import Role From Database workflow successfully, you must perform these steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Configure the JDBC source.</p>
</li>
<li>
<p>Configure the Role Import workflow.</p>
</li>
<li>
<p>Deploy the Identity Web Services.</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="_ch5_configuring_the_jdbc_source"><a class="anchor" href="#_ch5_configuring_the_jdbc_source"></a><a class="link" href="#_ch5_configuring_the_jdbc_source">5.1.3.2.1. Configuring the JDBC Source</a></h6>
<div class="paragraph">
<p>The example database used for this scenario is delivered with DirX Identity and has the pathname <em>install_path</em>*/data/extension/new-hr.mdb*. It is protected with the password <strong>dirx</strong> to show the JDBC connector&#8217;s password feature.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Copy this database to <strong>C:/MetahubData</strong> (or another location, if you prefer). It is a good idea to make a copy of the <strong>new-hr.mdb</strong> database, so that you can restore the original later on if the working copy becomes corrupted.</p>
</li>
<li>
<p>Define this HR database to be an ODBC database:</p>
</li>
<li>
<p>On Windows 32bit:</p>
</li>
<li>
<p>Go to <strong>Start</strong> &#8594; <strong>Settings</strong> &#8594; <strong>Control</strong> <strong>Panel</strong> and then double-click <strong>Administrative Tools</strong></p>
</li>
<li>
<p>Click on <strong>Data</strong> <strong>Sources</strong> <strong>(ODBC)</strong>.</p>
</li>
<li>
<p>On Windows 64bit:</p>
</li>
<li>
<p>Run <strong>C:/windows/sysWOW64/odbcad32.exe</strong>.</p>
</li>
<li>
<p>If you installed DirX Identity with the system account, select the <strong>System DSN</strong> tab and then click <strong>Add&#8230;&#8203;</strong> or use the <strong>User DSN</strong> tab.</p>
</li>
<li>
<p>Select <strong>Driver to Microsoft Access</strong> (<strong>*.mdb</strong>) and then click <strong>Finish</strong>.</p>
</li>
<li>
<p><strong>E</strong>nter <strong>new-hr</strong> into the field <strong>Data Source Name</strong>.</p>
</li>
<li>
<p>Click <strong>Select&#8230;&#8203;</strong>.</p>
</li>
<li>
<p>Navigate to the location where you have copied <strong>new-hr.mdb</strong>, select it and then click <strong>OK</strong>. A new ODBC source is created.</p>
</li>
<li>
<p>Click <strong>OK</strong> again.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch5_configuring_the_role_import_workflow"><a class="anchor" href="#_ch5_configuring_the_role_import_workflow"></a><a class="link" href="#_ch5_configuring_the_role_import_workflow">5.1.3.2.2. Configuring the Role Import Workflow</a></h6>
<div class="paragraph">
<p>In the activity, select the Full-Import controller, which imports all source entries into the Identity Store and also discovers deleted source entries.</p>
</div>
<div class="paragraph">
<p>In the Identity domain port, specify the following options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>URL path</strong>: the path of the URL that denotes the Provisioning Web Service. Normally this is: <strong>ProvisioningService/services/Spmlv2RequestService</strong>.</p>
</li>
<li>
<p>Specify <strong>roles</strong> as the SPMLv2 <strong>PSO Target ID</strong>.</p>
</li>
<li>
<p>The reference attributes are <strong>dxrPermissionLink</strong> and <strong>dxrRoleLink</strong>. For the reference handler class, specify the default <strong>com.siemens.dxm.connector.spmlv1tov2.handler.SimpleReferenceHandler</strong> or leave it empty.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Only one channel is used per connected directory. The default mapping considers only very few attributes for importing a role into the Identity domain:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The identifier is concatenated from the role root entry, configured as role_ts_account_base in the connected directory and the attribute "name" of the source entry.</p>
</li>
<li>
<p>The primary key of the source ("pk") is mapped to "dxrRoleId" and is therefore also used as one of the join conditions.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch5_deploying_the_identity_web_services"><a class="anchor" href="#_ch5_deploying_the_identity_web_services"></a><a class="link" href="#_ch5_deploying_the_identity_web_services">5.1.3.2.3. Deploying the Identity Web Services</a></h6>
<div class="paragraph">
<p>See the chapter "Web Services &#8594; Runtime Operation" in the <em>DirX Identity Integration Framework Guide</em> for information on how to deploy the Identity Web Services. You can deploy them to the built-in Tomcat in the IdS-J server or set up an additional Tomcat instance for the deployment.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch5_role_import_workflow_and_activities"><a class="anchor" href="#_ch5_role_import_workflow_and_activities"></a><a class="link" href="#_ch5_role_import_workflow_and_activities">5.1.3.3. Role Import Workflow and Activities</a></h5>
<div class="paragraph">
<p>The workflow <strong>Import Roles from database</strong> is a real-time workflow with two activities:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Join activity - implements the role import</p>
</li>
<li>
<p>Error activity - receives update requests that failed despite retries and issues notifications</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The join activity is controlled by the <strong>Full-Import</strong> controller. It exports entries via the connector configured in the <strong>TS</strong> port and performs updates via the connector configured in the <strong>IdentityDomain</strong> port, as illustrated in the following figure:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch5_sourceWFs/image7.png" alt="Role Import Workflow Ports and Channels">
</div>
<div class="title">Figure 53. Role Import Workflow Ports and Channels</div>
</div>
<div class="paragraph">
<p>The workflow is not intended to be started on events, since we do not expect change events from the database.</p>
</div>
<div class="paragraph">
<p>There are no global user hooks and no filters necessary.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch5_role_import_workflow_ports"><a class="anchor" href="#_ch5_role_import_workflow_ports"></a><a class="link" href="#_ch5_role_import_workflow_ports">5.1.3.4. Role Import Workflow Ports</a></h5>
<div class="paragraph">
<p>The role import workflow supports the following ports:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>TS port - represents the database that contains the roles. The JDBC connector is used to access the database.</p>
</li>
<li>
<p>IdentityDomain port - represents the DirX Identity domain and is accessed via the SPMLV1ToV2 connector. The SPMLv2 target identifier <strong>roles</strong> tell the SPMLv2 Web service to manage role objects. For roles, the references <strong>dxrRoleLink</strong> and <strong>dxrPermissionLink</strong> are supported. These items are simple references without attributes, so the simple reference handler is sufficient for the corresponding protocol elements. This workflow does not support any other SPMLv2 capabilities and it does not support passwords.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch5_role_import_workflow_channels"><a class="anchor" href="#_ch5_role_import_workflow_channels"></a><a class="link" href="#_ch5_role_import_workflow_channels">5.1.3.5. Role Import Workflow Channels</a></h5>
<div class="paragraph">
<p>The workflow needs only one channel per port. It represents the roles.</p>
</div>
<div class="sect5">
<h6 id="_ch5_ts_port_2"><a class="anchor" href="#_ch5_ts_port_2"></a><a class="link" href="#_ch5_ts_port_2">5.1.3.5.1. TS Port</a></h6>
<div class="paragraph">
<p>Direction: Identity Store &#8594; Database</p>
</div>
<div class="paragraph">
<p>This channel is only used for exporting roles from the database. The roles are expected to be stored in the table <strong>roles</strong>. No filter is required.</p>
</div>
<div class="paragraph">
<p>The column <strong>pk</strong> contains the primary key of a role and is expected to be created by the database on creation. Therefore this attribute must not be updated and the SPML identifier need not be set when a role is created. In addition, the table contains the columns <strong>name</strong> and <strong>description</strong>.</p>
</div>
<div class="paragraph">
<p>Although mapping is not needed, it is configured. It is very simple with only one-to-one mappings. Especially the SPML identifier (table name + primary key) is expected in the attribute <strong>dxrRoleID</strong> in the corresponding Identity channel.</p>
</div>
<div class="paragraph">
<p>There are two join conditions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The first join condition expects an existing primary key and uses the SPML identifier as its search base.</p>
</li>
<li>
<p>The second join condition tries to join using the mapped value of the <strong>name</strong> column, assuming that the name is unique in the table.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch5_identity_port_2"><a class="anchor" href="#_ch5_identity_port_2"></a><a class="link" href="#_ch5_identity_port_2">5.1.3.5.2. Identity Port</a></h6>
<div class="paragraph">
<p>Direction: Database &#8594; Identity Store</p>
</div>
<div class="paragraph">
<p>This channel is used for importing roles into an Identity domain.</p>
</div>
<div class="paragraph">
<p>Since only simple references are used, no user hook is necessary.</p>
</div>
<div class="paragraph">
<p><strong>Export:</strong></p>
</div>
<div class="paragraph">
<p>For exporting, the search base is taken from the environment property <strong>role_ts_account_base</strong> (in the connected directory <strong>Provisioning</strong> tab). The filter is needed to only export roles and no containers. Since the Web Services by default work with paged read, the appropriate flag is set to active (but can be omitted, since this is not configurable in the connector).</p>
</div>
<div class="paragraph">
<p><strong>Mapping:</strong></p>
</div>
<div class="paragraph">
<p>The SPML identifier must be set when a role is created. It is calculated using the <strong>name</strong> attribute of the source entry and the <strong>role_ts_account_base</strong> as the parent folder.</p>
</div>
<div class="paragraph">
<p>This name attribute is also stored in the attribute <strong>dxrReference</strong>, the primary key is stored in <strong>dxrRoleId</strong>. The following figure illustrates the channel mapping.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch5_sourceWFs/image8.png" alt="Role Import Workflow Channel Mapping">
</div>
<div class="title">Figure 54. Role Import Workflow Channel Mapping</div>
</div>
<div class="paragraph">
<p><strong>Join:</strong></p>
</div>
<div class="paragraph">
<p>The associated role for a source entry is first searched using the mapped SPML identifier and then via the primary key stored in <strong>dxrRoleID</strong>.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch5_ldif_user_import_workflow"><a class="anchor" href="#_ch5_ldif_user_import_workflow"></a><a class="link" href="#_ch5_ldif_user_import_workflow">5.1.4. LDIF User Import Workflow</a></h4>
<div class="paragraph">
<p>The LDIF user import workflow operates between the Users folder in the Identity Store and an LDIF content file as a connected system that contains user entries.</p>
</div>
<div class="paragraph">
<p>The workflow is based on Java real-time technology, with the LDIF connector accessing an LDIF file and the LDAP connector accessing a DirX Identity domain. The SyncOneWay2Identity controller is configured as the join engine. The controller exports all users from the source file system and then imports them into the Identity domain user tree. It works in "merge" mode, which means that it doesnât delete users in the Identity Store that do not exist in the source file. If "Replace" mode is desired, you can easily switch to the Full-Import controller in the Controller tab of the workflowâs Join activity.</p>
</div>
<div class="paragraph">
<p>This workflow can also be used as a template for other Java-based source workflows for user objects. Other user data sources instead of LDIF content file may be connected.</p>
</div>
<div class="paragraph">
<p>The connected directory LDIFfile represents the connected file system containing the users and the connected directory Identity Store represents the Identity domain.</p>
</div>
<div class="paragraph">
<p>The next sections describe</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Workflow prerequisites</p>
</li>
<li>
<p>How to configure the workflow</p>
</li>
<li>
<p>The workflow and its activities</p>
</li>
<li>
<p>Ports</p>
</li>
<li>
<p>Channels</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The workflow needs only one channel for users and a set of attributes to be imported.</p>
</div>
<div class="paragraph">
<p>The delivered workflow is:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Import Users from LDIF</strong> - exports all users from the LDIF file found under the specified search base and filter and then imports them into the Identity Store.</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="_ch5_ldif_user_import_workflow_prerequisites"><a class="anchor" href="#_ch5_ldif_user_import_workflow_prerequisites"></a><a class="link" href="#_ch5_ldif_user_import_workflow_prerequisites">5.1.4.1. LDIF User Import Workflow Prerequisites</a></h5>
<div class="paragraph">
<p>After performing the following steps, you can run the workflow without changing any configuration parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Copy it with the Global View from the default scenario to your domain.</p>
</li>
<li>
<p>Copy the sample source data file <em>install_path/</em>*data/data.ldif* to <strong>C:/MetahubData</strong>.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch5_ldif_user_import_workflow_configuration"><a class="anchor" href="#_ch5_ldif_user_import_workflow_configuration"></a><a class="link" href="#_ch5_ldif_user_import_workflow_configuration">5.1.4.2. LDIF User Import Workflow Configuration</a></h5>
<div class="paragraph">
<p>Start the LDIF User Import workflow configuration wizard from the Global View domain-specific Source Realtime Scenario by right-clicking on the workflow line between the <strong>LDIFfile</strong> and the <strong>Identity Store</strong> or from the Expert View by right-clicking on the workflow under your domain and then selecting the configuration wizard. By stepping through the wizard, you can activate or deactivate auditing, choose another controller for the join engine, change the export search conditions, adapt the mapping or change the target join criteria.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch5_ldif_user_import_workflow_and_activities"><a class="anchor" href="#_ch5_ldif_user_import_workflow_and_activities"></a><a class="link" href="#_ch5_ldif_user_import_workflow_and_activities">5.1.4.3. LDIF User Import Workflow and Activities</a></h5>
<div class="paragraph">
<p>The workflow Import <strong>Users from LDIF</strong> is a Java-based source workflow with two activities:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Join activity - implements the user import.</p>
</li>
<li>
<p>Error activity - receives update requests that failed despite retries and issues notifications.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The join activity is controlled by default by the <strong>SyncOneWay2Identity</strong> controller. It exports LDIF file user entries via the LDIF connector configured in the <strong>TS</strong> port and then performs updates via the LDAP connector configured in the <strong>IdentityDomain</strong> port, as illustrated in the following figure:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch5_sourceWFs/image9.png" alt="LDIF User Import Workflow Ports and Channels">
</div>
<div class="title">Figure 55. LDIF User Import Workflow Ports and Channels</div>
</div>
<div class="paragraph">
<p>You can start the workflow either manually or via a schedule.</p>
</div>
<div class="paragraph">
<p>There are no global user hooks and no filters necessary.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch5_ldif_user_import_workflow_ports"><a class="anchor" href="#_ch5_ldif_user_import_workflow_ports"></a><a class="link" href="#_ch5_ldif_user_import_workflow_ports">5.1.4.4. LDIF User Import Workflow Ports</a></h5>
<div class="paragraph">
<p>The workflow supports the following ports:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>TS port - represents the LDIF file that contains the users (accounts). The LDIF connector is used to access the LDIF file.</p>
</li>
<li>
<p>IdentityDomain port - represents the DirX Identity domain and is accessed via the LDAP connector.</p>
</li>
<li>
<p>Event - used for sending change events.</p>
</li>
<li>
<p>Notify - used for sending e-mails.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch5_ldif_user_import_workflow_channels"><a class="anchor" href="#_ch5_ldif_user_import_workflow_channels"></a><a class="link" href="#_ch5_ldif_user_import_workflow_channels">5.1.4.5. LDIF User Import Workflow Channels</a></h5>
<div class="paragraph">
<p>The workflow needs only one channel per port. It represents the user objects.</p>
</div>
<div class="sect5">
<h6 id="_ch5_users_channel_at_ts_port"><a class="anchor" href="#_ch5_users_channel_at_ts_port"></a><a class="link" href="#_ch5_users_channel_at_ts_port">5.1.4.5.1. Users Channel at TS Port</a></h6>
<div class="paragraph">
<p>This port represents the connection to LDIF. This workflow uses it for exporting users and attributes from the LDIF file.</p>
</div>
<div class="paragraph">
<p><strong>Export:</strong></p>
</div>
<div class="paragraph">
<p><strong>Searchbase:</strong></p>
</div>
<div class="paragraph">
<p>CN=Users,CN=My-Company.</p>
</div>
<div class="paragraph">
<p><strong>Filter:</strong></p>
</div>
<div class="paragraph">
<p>&amp;(objectClass=inetOrgPerson)(employeeNumber=*)(ou=Procurement).</p>
</div>
<div class="paragraph">
<p>Searching only users from the organizational unit Procurement is just a sample configuration and can be changed to search and import all users from the delivered sample source file data.ldif.</p>
</div>
<div class="paragraph">
<p><strong>Mapping:</strong></p>
</div>
<div class="paragraph">
<p>Mainly used by the LDIF User Export workflow, which performs the configured mapping from Identity to the configured LDIF data export file. This workflow only reads the selected attributes from the import data file as the source for the mapping to Identity.</p>
</div>
<div class="paragraph">
<p><strong>Join:</strong></p>
</div>
<div class="paragraph">
<p>Only used by the LDIF User Export workflow.</p>
</div>
<div class="paragraph">
<p><strong>Specific Attributes:</strong></p>
</div>
<div class="paragraph">
<p>export_file = C:/MetahubData/data_out.ldif</p>
</div>
<div class="paragraph">
<p>Only used by the LDIF User Export workflow as the data output file.</p>
</div>
<div class="paragraph">
<p>Import_file = C:/MetahubData/data.ldif</p>
</div>
<div class="paragraph">
<p>Used by this workflow as the data input file.</p>
</div>
<div class="paragraph">
<p>Used by an LDIF Change (not Content) User Export workflow as the source connected system user data base for search operations of the join engine to calculate add, modify and delete requests as usual depending on those search results representing the existing user data.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch5_users_channel_at_identity_port"><a class="anchor" href="#_ch5_users_channel_at_identity_port"></a><a class="link" href="#_ch5_users_channel_at_identity_port">5.1.4.5.2. Users Channel at Identity Port</a></h6>
<div class="paragraph">
<p>This port represents the connection to the Identity Store. This workflow uses it for importing users into an Identity domain.</p>
</div>
<div class="paragraph">
<p><strong>Export:</strong></p>
</div>
<div class="paragraph">
<p>This workflow uses the export settings for joining entries. The search base is composed of the environment property <strong>role_user_base</strong> (in the connected directory <strong>Provisioning</strong> tab) and the preceding subfolder âOU=Procurement,O=My-Companyâ resulting in the complete search base âOU=Procurement,O=My-Company,CN=Users,CN=My-Companyâ. As mentioned above, reducing the search on the organizational unit Procurement is just a sample and can be changed to search all users in the domain. It should correspond to the search base defined in the Export tab of the Users Channel at TS port.</p>
</div>
<div class="paragraph">
<p>The filter is needed to only export users from an Identity domain.</p>
</div>
<div class="paragraph">
<p><strong>Mapping:</strong></p>
</div>
<div class="paragraph">
<p>The SPML identifier must be set when a user is created. The id is mapped in a java source mapping, which just takes the id of the source entry and assigns it to the target id.</p>
</div>
<div class="paragraph">
<p>The attribute dxrState is set to âNEWâ in case an entry is created, otherwise it is not changed (flag onAddOnly=true).</p>
</div>
<div class="paragraph">
<p><strong>Join:</strong></p>
</div>
<div class="paragraph">
<p>The associated user for a source entry is searched using the mapped <strong>employeeNumber</strong> attribute.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch5_ldif_user_export_workflow"><a class="anchor" href="#_ch5_ldif_user_export_workflow"></a><a class="link" href="#_ch5_ldif_user_export_workflow">5.1.5. LDIF User Export Workflow</a></h4>
<div class="paragraph">
<p>The LDIF user export workflow operates between the Users folder in the Identity Store and an LDIF content file as the connected system that contains user entries.</p>
</div>
<div class="paragraph">
<p>The workflow is based on Java real-time technology, with the LDIF connector accessing an LDIF file and the LDAP connector accessing a DirX Identity domain. The <strong>SyncOneWay2TS</strong> controller is configured as the join engine. The controller exports all users from the Identity domain user tree and then imports them into the connected file system.</p>
</div>
<div class="paragraph">
<p>The connected directory <strong>LDIFfile</strong> represents the connected file system containing the users and the connected directory Identity Store represents the Identity domain.</p>
</div>
<div class="paragraph">
<p>The next sections describe</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Workflow prerequisites</p>
</li>
<li>
<p>How to configure the workflow</p>
</li>
<li>
<p>The workflow and its activities</p>
</li>
<li>
<p>Ports</p>
</li>
<li>
<p>Channels</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The workflow needs only one channel for users and a set of attributes to be exported.</p>
</div>
<div class="paragraph">
<p>The delivered workflow is:</p>
</div>
<div class="paragraph">
<p><strong>Export Users to LDIF</strong> - exports all users from the Identity Store found under the specified search base and filter and then writes them into the LDIF content file.</p>
</div>
<div class="sect4">
<h5 id="_ch5_ldif_user_export_workflow_prerequisites"><a class="anchor" href="#_ch5_ldif_user_export_workflow_prerequisites"></a><a class="link" href="#_ch5_ldif_user_export_workflow_prerequisites">5.1.5.1. LDIF User Export Workflow Prerequisites</a></h5>
<div class="paragraph">
<p>After performing the following steps, you can run the workflow without changing any configuration parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Copy it with the Global View from the default scenario to your domain.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch5_ldif_user_export_workflow_configuration"><a class="anchor" href="#_ch5_ldif_user_export_workflow_configuration"></a><a class="link" href="#_ch5_ldif_user_export_workflow_configuration">5.1.5.2. LDIF User Export Workflow Configuration</a></h5>
<div class="paragraph">
<p>Start the LDIF User Export workflow configuration wizard from the Global View domain-specific Source Realtime Scenario by right-clicking on the workflow line between the <strong>LDIFfile</strong> and the <strong>Identity Store</strong> or from the Expert View by right-clicking on the workflow under your domain and then selecting the configuration wizard. By stepping through the wizard, you can activate or deactivate auditing, change the export search conditions, adapt the mapping or change the target join criteria.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch5_ldif_user_export_workflow_and_activities"><a class="anchor" href="#_ch5_ldif_user_export_workflow_and_activities"></a><a class="link" href="#_ch5_ldif_user_export_workflow_and_activities">5.1.5.3. LDIF User Export Workflow and Activities</a></h5>
<div class="paragraph">
<p>The workflow <strong>Export Users to LDIF</strong> is a Java-based workflow with two activities:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Join activity - implements the user export.</p>
</li>
<li>
<p>Error activity - receives update requests that failed despite retries and issues notifications.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The join activity is controlled by the <strong>SyncOneWay2TS</strong> controller. It exports Identity Store user entries via the LDAP connector configured in the <strong>IdentityDomain</strong> port and then performs updates via the LDIF connector configured in the <strong>TS</strong> port, as illustrated in the following figure:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch5_sourceWFs/image9.png" alt="LDIF User Export Workflows Ports and Channels">
</div>
<div class="title">Figure 56. LDIF User Export Workflows Ports and Channels</div>
</div>
<div class="paragraph">
<p>You can start the workflow either manually or via a schedule.</p>
</div>
<div class="paragraph">
<p>There are no global user hooks and no filters necessary.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch5_ldif_user_export_workflow_ports"><a class="anchor" href="#_ch5_ldif_user_export_workflow_ports"></a><a class="link" href="#_ch5_ldif_user_export_workflow_ports">5.1.5.4. LDIF User Export Workflow Ports</a></h5>
<div class="paragraph">
<p>The workflow supports the following ports:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>IdentityDomain port - represents the DirX Identity domain and is accessed via the LDAP connector.</p>
</li>
<li>
<p>TS port - represents the LDIF file that contains the users (accounts). The LDIF connector is used to access the LDIF file.</p>
</li>
<li>
<p>Event - used for sending change events.</p>
</li>
<li>
<p>Notify - used for sending e-mails.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch5_ldif_user_export_workflow_channels"><a class="anchor" href="#_ch5_ldif_user_export_workflow_channels"></a><a class="link" href="#_ch5_ldif_user_export_workflow_channels">5.1.5.5. LDIF User Export Workflow Channels</a></h5>
<div class="paragraph">
<p>The workflow needs only one channel per port. It represents the user objects.</p>
</div>
<div class="sect5">
<h6 id="_ch5_users_channel_at_identity_port_2"><a class="anchor" href="#_ch5_users_channel_at_identity_port_2"></a><a class="link" href="#_ch5_users_channel_at_identity_port_2">5.1.5.5.1. Users Channel at Identity Port</a></h6>
<div class="paragraph">
<p>This port represents the connection to the Identity Store. This workflow uses it for exporting users from the Identity domain.</p>
</div>
<div class="paragraph">
<p><strong>Export:</strong></p>
</div>
<div class="paragraph">
<p>This workflow uses the export settings for searching the entries to be exported. The search base is composed of the environment property <strong>role_user_base</strong> (in the connected directory <strong>Provisioning</strong> tab) and the preceding subfolder âOU=Procurement,O=My-Companyâ resulting in the complete search base âOU=Procurement,O=My-Company,CN=Users,CN=My-Companyâ. Reducing the search on the organizational unit Procurement is just a sample and can of course be extended to search all users in the domain. It should correspond to the search base defined in the Export tab of the Users Channel at TS port.</p>
</div>
<div class="paragraph">
<p>The filter is needed to only export users from an Identity domain.</p>
</div>
<div class="paragraph">
<p><strong>Mapping:</strong></p>
</div>
<div class="paragraph">
<p>Mainly used by the LDIF User Import workflow, which performs the configured mapping from the LDIF data import file to Identity. This workflow only reads the selected attributes from Identity as the source for the mapping to the LDIF content data export file.</p>
</div>
<div class="paragraph">
<p><strong>Join:</strong></p>
</div>
<div class="paragraph">
<p>Only used by the LDIF User Import workflow.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch5_users_channel_at_ts_port_2"><a class="anchor" href="#_ch5_users_channel_at_ts_port_2"></a><a class="link" href="#_ch5_users_channel_at_ts_port_2">5.1.5.5.2. Users Channel at TS Port</a></h6>
<div class="paragraph">
<p>This port represents the connection to LDIF. This workflow uses it for exporting users and attributes from the LDIF file.</p>
</div>
<div class="paragraph">
<p><strong>Export:</strong></p>
</div>
<div class="paragraph">
<p><strong>Searchbase:</strong></p>
</div>
<div class="paragraph">
<p>CN=Users,CN=My-Company.</p>
</div>
<div class="paragraph">
<p><strong>Filter:</strong></p>
</div>
<div class="paragraph">
<p>&amp;(objectClass=inetOrgPerson)(employeeNumber=*)(ou=Procurement).</p>
</div>
<div class="paragraph">
<p>Searching only users from the organizational unit Procurement is just a sample configuration and can be changed to search and import all users from the delivered sample source file data.ldif.</p>
</div>
<div class="paragraph">
<p><strong>Mapping:</strong></p>
</div>
<div class="paragraph">
<p>The SPML identifier must be set when a user is created. The id is mapped in a simple expression mapping from the source id, $\{source.id}, to the target id.</p>
</div>
<div class="paragraph">
<p><strong>Join:</strong></p>
</div>
<div class="paragraph">
<p>The associated user for a source entry is searched using the mapped target id as first join criteria and then the source employeeNumber attribute as second join criteria.</p>
</div>
<div class="paragraph">
<p><strong>Specific Attributes:</strong></p>
</div>
<div class="paragraph">
<p>export_file = C:/MetahubData/data_out.ldif</p>
</div>
<div class="paragraph">
<p>Used by this workflow as the data output file.</p>
</div>
<div class="paragraph">
<p>Import_file = C:/MetahubData/data.ldif</p>
</div>
<div class="paragraph">
<p>Only used by the LDIF User Import workflow as the data input file.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch5_csv_workflows"><a class="anchor" href="#_ch5_csv_workflows"></a><a class="link" href="#_ch5_csv_workflows">5.1.6. CSV Workflows</a></h4>
<div class="paragraph">
<p>DirX Identity delivers Export and Import CSV workflows. This section describes the workflows features that are common to both types of workflow.</p>
</div>
<div class="paragraph">
<p>Rows of a CSV file do not usually have an identifier. The Specific Attribute namingAttr describes which column is used as the identifier. This column should contain a distinguished name. For searches, this column is evaluated for the base object and scope part of the search.</p>
</div>
<div class="paragraph">
<p>The columns and their order are defined by the mapping.Technical attribute. The columns are defined by the dxmselectedAttributes LDAP attribute.</p>
</div>
<div class="paragraph">
<p>You can also define which separator should be used in the CSV file and whether or not the CSV file should include a header line.</p>
</div>
<div class="sect4">
<h5 id="_ch5_csv_user_import_workflow"><a class="anchor" href="#_ch5_csv_user_import_workflow"></a><a class="link" href="#_ch5_csv_user_import_workflow">5.1.6.1. CSV User Import Workflow</a></h5>
<div class="paragraph">
<p>The CSV user import workflow operates between the Users folder in the Identity Store and a CSV file as the connected system that contains user entries.</p>
</div>
<div class="paragraph">
<p>The workflow is based on Java real-time technology, with the CSV connector accessing a CSV file and the LDAP connector accessing a DirX Identity domain. The SyncOneWay2Identity controller is configured as the join engine. The controller exports all users from the source file system and then imports them into the Identity domain user tree. It works in "Merge" mode, which means that it doesn&#8217;t delete users in the Identity Store that do not exist in the source file. If you want to run in "Replace" mode, you can switch to the Full-Import controller in the Controller tab of the workflowâs Join activity.</p>
</div>
<div class="paragraph">
<p>The connected directory CSV file represents the connected file system containing the users and the connected directory Identity Store represents the Identity domain.</p>
</div>
<div class="paragraph">
<p>The next sections describe</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Workflow prerequisites</p>
</li>
<li>
<p>How to configure the workflow</p>
</li>
<li>
<p>The workflow and its activities</p>
</li>
<li>
<p>Ports</p>
</li>
<li>
<p>Channels</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The workflow needs only one channel for users and a set of attributes to be imported.</p>
</div>
<div class="paragraph">
<p>The delivered workflow is:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Import Users from CSV</strong> - exports all users from the CSV file found under the specified search base and filter and then imports them into the Identity Store.</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="_ch5_csv_user_import_workflow_prerequisites"><a class="anchor" href="#_ch5_csv_user_import_workflow_prerequisites"></a><a class="link" href="#_ch5_csv_user_import_workflow_prerequisites">5.1.6.1.1. CSV User Import Workflow Prerequisites</a></h6>
<div class="paragraph">
<p>After performing the following steps, you can run the workflow without changing any configuration parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Copy it with the Global View from the default scenario to your domain.</p>
</li>
<li>
<p>Copy the sample source data file <em>install_path/</em>*data/datatest.csv* to <strong>C:/MetahubData</strong>.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch5_csv_user_import_workflow_configuration"><a class="anchor" href="#_ch5_csv_user_import_workflow_configuration"></a><a class="link" href="#_ch5_csv_user_import_workflow_configuration">5.1.6.1.2. CSV User Import Workflow Configuration</a></h6>
<div class="paragraph">
<p>Start the CSV User Import workflow configuration wizard from the Global View domain-specific Source Realtime Scenario by right-clicking on the workflow line between the <strong>CSVFile</strong> and the <strong>Identity Store</strong> or from the Expert View by right-clicking on the workflow under your domain and then selecting the configuration wizard. By stepping through the wizard, you can activate or deactivate auditing, choose another controller for the join engine, change the export search conditions, adapt the mapping or change the target join criteria.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch5_csv_user_import_workflow_and_activities"><a class="anchor" href="#_ch5_csv_user_import_workflow_and_activities"></a><a class="link" href="#_ch5_csv_user_import_workflow_and_activities">5.1.6.1.3. CSV User Import Workflow and Activities</a></h6>
<div class="paragraph">
<p>The workflow <strong>Import Users from CSV</strong> is a Java-based source workflow with two activities:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Join activity - implements the user import.</p>
</li>
<li>
<p>Error activity - receives update requests that failed despite retries and issues notifications.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The join activity is controlled by default by the <strong>SyncOneWay2Identity</strong> controller. It exports CSV file user entries via the CSV connector configured in the <strong>TS</strong> port and then performs updates via the LDAP connector configured in the <strong>IdentityDomain</strong> port, as illustrated in the following figure:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch5_sourceWFs/image9.png" alt="CSV User Import Workflow Ports and Channels">
</div>
<div class="title">Figure 57. CSV User Import Workflow Ports and Channels</div>
</div>
<div class="paragraph">
<p>You can start the workflow either manually or via a schedule.</p>
</div>
<div class="paragraph">
<p>There are no global user hooks and no filters necessary.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch5_csv_user_import_workflow_ports"><a class="anchor" href="#_ch5_csv_user_import_workflow_ports"></a><a class="link" href="#_ch5_csv_user_import_workflow_ports">5.1.6.1.4. CSV User Import Workflow Ports</a></h6>
<div class="paragraph">
<p>The workflow supports the following ports:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>TS port - represents the CSV file that contains the users (accounts). The CSV connector is used to access the CSV file.</p>
</li>
<li>
<p>IdentityDomain port - represents the DirX Identity domain and is accessed via the LDAP connector.</p>
</li>
<li>
<p>Event - used for sending change events.</p>
</li>
<li>
<p>Notify - used for sending e-mails.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch5_csv_user_import_workflow_channels"><a class="anchor" href="#_ch5_csv_user_import_workflow_channels"></a><a class="link" href="#_ch5_csv_user_import_workflow_channels">5.1.6.1.5. CSV User Import Workflow Channels</a></h6>
<div class="paragraph">
<p>The workflow needs only one channel per port. It represents the user objects.</p>
</div>
<div class="paragraph">
<p>1. Users Channel at TS Port</p>
</div>
<div class="paragraph">
<p>This port represents the connection to CSV. This workflow uses it for exporting users and attributes from the CSV file.</p>
</div>
<div class="paragraph">
<p><strong>Export:</strong></p>
</div>
<div class="paragraph">
<p><strong>Searchbase:</strong></p>
</div>
<div class="paragraph">
<p>CN=Users,CN=My-Company.</p>
</div>
<div class="paragraph">
<p><strong>Filter:</strong></p>
</div>
<div class="paragraph">
<p>&amp;(employeeNumber=*)(ou=Procurement).</p>
</div>
<div class="paragraph">
<p>Searching only users from the organizational unit Procurement is just a sample configuration and can of course be changed to search and import all users from the delivered sample source file datatest.csv.</p>
</div>
<div class="paragraph">
<p><strong>Mapping:</strong></p>
</div>
<div class="paragraph">
<p>Mainly used by the CSV User Export workflow, which performs the configured mapping from Identity to the configured CSV data export file. This workflow only reads the selected attributes from the import data file as the source for the mapping to Identity. Mapping includes all columns of the CSV file. The order in the mapping (technical the dxmSelectedAttributes) represents the order in the CSV file. The column specified by namingAttribute defines the identifier. Here a column dn is specified which contains a distinguished name. The value of this column is returned as SPML Id for the row.</p>
</div>
<div class="paragraph">
<p><strong>Join:</strong></p>
</div>
<div class="paragraph">
<p>Only used by the CSV User Export workflow.</p>
</div>
<div class="paragraph">
<p><strong>Specific Attributes:</strong></p>
</div>
<div class="paragraph">
<p>export_file = C:/MetahubData/datatest_out.csv</p>
</div>
<div class="paragraph">
<p>Only used by the CSV User Export workflow as the data output file.</p>
</div>
<div class="paragraph">
<p>Import_file = C/MetahubData/datatest.csv</p>
</div>
<div class="paragraph">
<p>Used by this workflow as the data input file.</p>
</div>
<div class="paragraph">
<p>Naming_attr = dn</p>
</div>
<div class="paragraph">
<p>The column containing the identifier.</p>
</div>
<div class="paragraph">
<p>The has_header attribute is not specified; that is, there is no header line in the CSV file. Define <strong>true</strong> if the CSV file contains a header line</p>
</div>
<div class="paragraph">
<p>The separator attribute is not specified; that is, the comma is the separator. Define | if the CSV file uses the pipe symbol as a separator</p>
</div>
<div class="paragraph">
<p>Comment: Not specified. When reading, no comment lines are skipped. If specified (for example, #â) every line containing this value is treated as a comment and is skipped during read. Sometines comments are used even though the CSV specification does not support comment lines.</p>
</div>
<div class="paragraph">
<p>2. Users Channel at Identity Port</p>
</div>
<div class="paragraph">
<p>This port represents the connection to the Identity Store. This workflow uses it for importing users into an Identity domain.</p>
</div>
<div class="paragraph">
<p><strong>Export:</strong></p>
</div>
<div class="paragraph">
<p>This workflow uses the export settings for joining entries. The search base is composed of the environment property <strong>role_user_base</strong> (in the connected directory <strong>Provisioning</strong> tab) and the preceding subfolder "OU=Procurement,O=My-Company" resulting in the complete search base "OU=Procurement,O=My-Company,CN=Users,CN=My-Company". As mentioned above reducing the search on the organizational unit Procurement is just a sample and can of course be extended to search all users in the domain. It should correspond to the search base defined in the Export tab of the Users Channel at TS port.</p>
</div>
<div class="paragraph">
<p>The filter is needed to only export users from an Identity domain.</p>
</div>
<div class="paragraph">
<p><strong>Mapping:</strong></p>
</div>
<div class="paragraph">
<p>The SPML identifier must be set when a user is created. The id is mapped in a Java source mapping, which just takes the id of the source entry and assigns it to the target id.</p>
</div>
<div class="paragraph">
<p>The attribute dxrState is set to "NEW" when an entry is created; otherwise, it is not changed (flag onAddOnly=true).</p>
</div>
<div class="paragraph">
<p><strong>Join:</strong></p>
</div>
<div class="paragraph">
<p>The associated user for a source entry is searched using the mapped <strong>employeeNumber</strong> attribute.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch5_customizing_the_workflow_to_handle_files_without_a_dn_column"><a class="anchor" href="#_ch5_customizing_the_workflow_to_handle_files_without_a_dn_column"></a><a class="link" href="#_ch5_customizing_the_workflow_to_handle_files_without_a_dn_column">5.1.6.1.6. Customizing the Workflow to Handle Files without a DN Column</a></h6>
<div class="paragraph">
<p>This section provides an example of how to customize the CSV User Import workflow to import users from CSV files that do not provide a DN column. In our example, we have a CSV file named <strong>Users.csv</strong> with user entries. We want to import these entries using the Java-based source workflows.</p>
</div>
<div class="paragraph">
<p>In <strong>Users.csv</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The first line is the header with the name of the fields. The separator is the semicolon (<strong>;</strong>).</p>
</li>
<li>
<p>The second line is a user entry</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Here is an example:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p><code>sn;givenName;cn;employeeNumber;employeeType;c;l;o;street;telephoneNumber;mail;ou;description;preferredLanguage;dxmOprMaster;dxrSalutation;postalCode;facsimileTelephoneNumber;dxrState</code></p>
</div>
<div class="paragraph">
<p><code>Muster;Henry;Muster Henry;5208;Internal;DE;My-Company Munich;My-Company;Teller Str. 1113;+49 89 323-42111;;Sales;Manager of Sales department;de;HR;Hr.;80157;+49 89 323-58564;NEW</code></p>
</div>
</div>
</div>
<div class="paragraph">
<p>To customize the workflow to import users from our example CSV file:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Copy <strong>Users.csv</strong> to <strong>C:/MetahubData</strong>.</p>
</li>
<li>
<p>In DirX Identity Manager, go to <strong>Connectivity</strong> &#8594; <strong>Global</strong> <strong>View</strong> &#8594; <strong>Scenarios</strong> &#8594; <strong>My</strong>-<strong>Company</strong> &#8594; <strong>Main</strong>.</p>
</li>
<li>
<p>Right click and then select <strong>New</strong> <strong>Connected</strong> <strong>Directory</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="../_images/ch5_sourceWFs/image11.png" alt="image11"></span></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Right click the new directory and then select <strong>Configure</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="../_images/ch5_sourceWFs/image12.png" alt="image12"></span></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Select <strong>CSVfile</strong> and click <strong>Next</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="../_images/ch5_sourceWFs/image13.png" alt="9"></span></p>
</div>
<div class="ulist">
<ul>
<li>
<p>In <strong>Name</strong>, enter <strong>UserCSV</strong> and then click <strong>Next</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="../_images/ch5_sourceWFs/image14.png" alt="image14"></span></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Step through the next configuration dialogs without changing anything until you arrive at the Supply Operational Attributes dialog.</p>
</li>
<li>
<p>Define the unique identifier field in your CSV file. In our example, it is <strong>employeeNumber</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="../_images/ch5_sourceWFs/image15.png" alt="image15"></span></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Click <strong>Next</strong> and then <strong>Finish</strong>.</p>
</li>
<li>
<p>Right click and select <strong>New Workflow Line.</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="../_images/ch5_sourceWFs/image16.png" alt="image16"></span></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Draw a line between <strong>UserCSV</strong> and <strong>IdentityStore</strong>. Select the line, right click and select <strong>New</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="../_images/ch5_sourceWFs/image17.png" alt="image17"></span></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Select <strong>Import Users from CSV</strong> and click <strong>Next</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="../_images/ch5_sourceWFs/image18.png" alt="image18"></span></p>
</div>
<div class="ulist">
<ul>
<li>
<p>In <strong>Name</strong>, enter <strong>Import Users from UserCSV</strong>. Click <strong>Next</strong> to step through the remaining dialogs. Click <strong>Finish</strong>.</p>
</li>
<li>
<p>In the Expert View, navigate to the Identity Store <strong>users</strong> channel as shown in the following figure:</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="../_images/ch5_sourceWFs/image19.png" alt="image19"></span></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Select the Export tab. Delete the contents of <strong>Search</strong> <strong>Base</strong> and set <strong>Filter</strong> to <strong>none</strong>:</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="../_images/ch5_sourceWFs/image20.png" alt="image20"></span></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Select the Mapping tab and then click <strong>Edit</strong>. Deselect <strong>ID mapping</strong> and delete the line with Mapping Source <strong>dummy</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="../_images/ch5_sourceWFs/image21.png" alt="image21"></span></p>
</div>
<div class="ulist">
<ul>
<li>
<p>In the Specific Attributes tab, add the following values to the following fields:</p>
</li>
<li>
<p>import_file - <strong>C:/MetahubData/Users.csv</strong></p>
</li>
<li>
<p>naming_attr - <strong>employeeNumber</strong></p>
</li>
<li>
<p>has_header - <strong>true</strong></p>
</li>
<li>
<p>separator - <strong>;</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="../_images/ch5_sourceWFs/image22.png" alt="image22"></span></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Click <strong>Save</strong>.</p>
</li>
<li>
<p>Select the corresponding UsrCSV user channel as shown in the next figure:</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="../_images/ch5_sourceWFs/image23.png" alt="image23"></span></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Select the Export tab and change <strong>Search</strong> <strong>Base</strong> to <strong>"o=My-Company," + $\{env.role_user_base}</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="../_images/ch5_sourceWFs/image24.png" alt="image24"></span></p>
</div>
<div class="ulist">
<ul>
<li>
<p>In the Mapping tab, change the value in the first line of the Mapping Source column that corresponds to <strong>Identifier:DN</strong> to the following:</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>"cn=" + ${source.givenName} + " " + ${source.sn} + "," + "ou=" + ${source.ou} + "," + ${env.user_base}"</strong></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../_images/ch5_sourceWFs/image25.png" alt="image25"></span></p>
</div>
<div class="ulist">
<ul>
<li>
<p>In the Specific Attributes tab, add the following parameter and save:</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>user_base : o=My-Company,cn=Users,cn=My-Company</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Go to the <strong>Import Users from UserCSV</strong> workflow as shown in the next figure. Click <strong>Edit</strong> and check <strong>Is</strong> <strong>Active</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="../_images/ch5_sourceWFs/image26.png" alt="image26"></span></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Right-click on <strong>Import Users from UserCSV</strong> and then select <strong>Load IDS-J Configuration</strong> from the context menu.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="../_images/ch5_sourceWFs/image27.png" alt="image27"></span></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Select <strong>Import Users from UserCSV</strong> and run the workflow.</p>
</li>
<li>
<p>Check to see if the user was created.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch5_csv_user_export_workflow"><a class="anchor" href="#_ch5_csv_user_export_workflow"></a><a class="link" href="#_ch5_csv_user_export_workflow">5.1.6.2. CSV User Export Workflow</a></h5>
<div class="paragraph">
<p>The CSV user export workflow operates between the Users folder in the Identity Store and a CSV file as the connected system that contains user entries.</p>
</div>
<div class="paragraph">
<p>The workflow is based on Java real-time technology, with the CSV connector accessing a CSV file and the LDAP connector accessing a DirX Identity domain. The <strong>SyncOneWay2TS</strong> controller is configured as the join engine. The controller exports all users from the Identity domain user tree and then imports them into the connected file system.</p>
</div>
<div class="paragraph">
<p>The connected directory <strong>CSVfile</strong> represents the connected file system containing the users and the connected directory Identity Store represents the Identity domain.</p>
</div>
<div class="paragraph">
<p>The next sections describe</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Workflow prerequisites</p>
</li>
<li>
<p>How to configure the workflow</p>
</li>
<li>
<p>The workflow and its activities</p>
</li>
<li>
<p>Ports</p>
</li>
<li>
<p>Channels</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The workflow needs only one channel for users and a set of attributes to be exported.</p>
</div>
<div class="paragraph">
<p>The delivered workflow is:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Export Users to CSV</strong> - exports all users from the Identity Store found under the specified search base and filter and then writes them into the CSV file.</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="_ch5_csv_user_export_workflow_prerequisites"><a class="anchor" href="#_ch5_csv_user_export_workflow_prerequisites"></a><a class="link" href="#_ch5_csv_user_export_workflow_prerequisites">5.1.6.2.1. CSV User Export Workflow Prerequisites</a></h6>
<div class="paragraph">
<p>After performing the following steps, you can run the workflow without changing any configuration parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Copy it with the Global View from the default scenario to your domain.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch5_csv_user_export_workflow_configuration"><a class="anchor" href="#_ch5_csv_user_export_workflow_configuration"></a><a class="link" href="#_ch5_csv_user_export_workflow_configuration">5.1.6.2.2. CSV User Export Workflow Configuration</a></h6>
<div class="paragraph">
<p>Start the CSV User Export workflow configuration wizard from the Global View domain-specific Source Realtime Scenario by right-clicking on the workflow line between the <strong>CSVfile</strong> and the <strong>Identity Store</strong> or from the Expert View by right-clicking on the workflow under your domain and then selecting the configuration wizard. By stepping through the wizard, you can activate or deactivate auditing, change the export search conditions, adapt the mapping or change the target join criteria.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch5_csv_user_export_workflow_and_activities"><a class="anchor" href="#_ch5_csv_user_export_workflow_and_activities"></a><a class="link" href="#_ch5_csv_user_export_workflow_and_activities">5.1.6.2.3. CSV User Export Workflow and Activities</a></h6>
<div class="paragraph">
<p>The workflow Export Users to CSV is a Java-based workflow with two activities:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Join activity - implements the user export.</p>
</li>
<li>
<p>Error activity - receives update requests that failed despite retries and issues notifications.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The join activity is controlled by the <strong>SyncOneWay2TS</strong> controller. It exports Identity Store user entries via the LDAP connector configured in the <strong>IdentityDomain</strong> port and performs updates via the CSV connector configured in the <strong>TS</strong> port as illustrated in the following figure:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch5_sourceWFs/image10.png" alt="CSV User Export Workflows Ports and Channels">
</div>
<div class="title">Figure 58. CSV User Export Workflows Ports and Channels</div>
</div>
<div class="paragraph">
<p>You can start the workflow either manually or via a schedule.</p>
</div>
<div class="paragraph">
<p>There are no global user hooks and no filters necessary.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch5_csv_user_export_workflow_ports"><a class="anchor" href="#_ch5_csv_user_export_workflow_ports"></a><a class="link" href="#_ch5_csv_user_export_workflow_ports">5.1.6.2.4. CSV User Export Workflow Ports</a></h6>
<div class="paragraph">
<p>The workflow supports the following ports:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>IdentityDomain port - represents the DirX Identity domain and is accessed via the LDAP connector.</p>
</li>
<li>
<p>TS port - represents the CSV file that contains the users (accounts). The CSV connector is used to access the CSV file.</p>
</li>
<li>
<p>Event - used for sending change events.</p>
</li>
<li>
<p>Notify - used for sending e-mails.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch5_csv_user_export_workflow_channels"><a class="anchor" href="#_ch5_csv_user_export_workflow_channels"></a><a class="link" href="#_ch5_csv_user_export_workflow_channels">5.1.6.2.5. CSV User Export Workflow Channels</a></h6>
<div class="paragraph">
<p>The workflow needs only one channel per port. It represents the user objects.</p>
</div>
<div class="paragraph">
<p>1. Users Channel at Identity Port</p>
</div>
<div class="paragraph">
<p>This port represents the connection to the Identity Store. This workflow uses it for exporting users from the Identity domain.</p>
</div>
<div class="paragraph">
<p><strong>Export:</strong></p>
</div>
<div class="paragraph">
<p>This workflow uses the export settings for searching the entries to be exported. The search base is composed of the environment property <strong>role_user_base</strong> (in the connected directory <strong>Provisioning</strong> tab) and the preceding subfolder "OU=Procurement,O=My-Company" resulting in the complete search base "OU=Procurement,O=My-Company,CN=Users,CN=My-Company". Reducing the search on the organizational unit Procurement is just a sample and can be changed to search all users in the domain. It should correspond to the search base defined in the Export tab of the Users Channel at TS port.</p>
</div>
<div class="paragraph">
<p>The filter is needed only to export users from an Identity domain.</p>
</div>
<div class="paragraph">
<p><strong>Mapping:</strong></p>
</div>
<div class="paragraph">
<p>Mainly used by the CSV User Import workflow, which performs the configured mapping from the CSV data import file to Identity. This workflow only reads the selected attributes from Identity as the source for the mapping to the CSV data export file.</p>
</div>
<div class="paragraph">
<p><strong>Join:</strong></p>
</div>
<div class="paragraph">
<p>Only used by the CSV User Import workflow.</p>
</div>
<div class="paragraph">
<p>2. Users Channel at TS Port</p>
</div>
<div class="paragraph">
<p>This port represents the connection to CSV. This workflow uses it for exporting users and attributes from the CSV file.</p>
</div>
<div class="paragraph">
<p><strong>Export:</strong></p>
</div>
<div class="paragraph">
<p><strong>Searchbase:</strong></p>
</div>
<div class="paragraph">
<p>CN=Users,CN=My-Company.</p>
</div>
<div class="paragraph">
<p><strong>Filter:</strong></p>
</div>
<div class="paragraph">
<p>&amp;(employeeNumber=*)(ou=Procurement).</p>
</div>
<div class="paragraph">
<p>Searching only users from the organizational unit Procurement is just a sample configuration and can be changed to search and import all users from the delivered sample source file <strong>datatest.csv</strong>.</p>
</div>
<div class="paragraph">
<p><strong>Mapping:</strong></p>
</div>
<div class="paragraph">
<p>The SPML identifier must be set when a user is created. The id is mapped in a simple expression mapping from the source id, $\{source.id}, to the target id.</p>
</div>
<div class="paragraph">
<p><strong>Join:</strong></p>
</div>
<div class="paragraph">
<p>The associated user for a source entry is searched using the mapped target id as first join criteria and then the source employeeNumber attribute as second join criteria.</p>
</div>
<div class="paragraph">
<p><strong>Specific Attributes:</strong></p>
</div>
<div class="paragraph">
<p>export_file = C:/MetahubData/datatest_out.csv</p>
</div>
<div class="paragraph">
<p>Used as data output file by this workflow.</p>
</div>
<div class="paragraph">
<p>Naming_attr = dn</p>
</div>
<div class="paragraph">
<p>The column that contains the identifier. The generated identifier is written to this column</p>
</div>
<div class="paragraph">
<p>The has_header attribute is not specified; that is, there is no header line in the CSV file. Define <strong>true</strong> if the CSV file contains a header line</p>
</div>
<div class="paragraph">
<p>The separator attribute is not specified; that is, the comma is the separator. Define | if the CSV file uses the pipe symbol as the separator</p>
</div>
<div class="paragraph">
<p>Import_file = C:/MetahubData/datatest.csv</p>
</div>
<div class="paragraph">
<p>Only used by the CSV User Import workflow as the data input file.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch5_remote_ad_workflow"><a class="anchor" href="#_ch5_remote_ad_workflow"></a><a class="link" href="#_ch5_remote_ad_workflow">5.1.7. Remote AD Workflow</a></h4>
<div class="paragraph">
<p>The Remote AD workflow is not a typical source workflow: it is a combination of workflows (AD export and LDIF import) with special data transfer (Web service).</p>
</div>
<div class="paragraph">
<p>DirX Identity can be deployed as part of the Atos Cloud Service Identity Management as a Service (IDMaaS). Provisioning targets can be in the providerâs (Atos) cloud infrastructure, in a public cloud or on customer premises outside of any cloud. The Remote AD workflow is intended for use at customer sites outside of a cloud.</p>
</div>
<div class="paragraph">
<p>The Remote AD connector must be able to work without online (LDAP) connection to the DirX Identity configuration database. On the customer side, a standard framework-based job implements the export to file function. The job obtains its configuration from XML files: one for the job and one for the search request with the filter conditions. An LDIF import workflow imports the file to DirX Directory.</p>
</div>
<div class="paragraph">
<p>The following figure illustrates the Remote AD connector operation:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch5_sourceWFs/image28.png" alt="Remote AD Connector Operation">
</div>
<div class="title">Figure 59. Remote AD Connector Operation</div>
</div>
<div class="paragraph">
<p>See the Remote AD Connector description in the <em>DirX Identity Connectivity Reference</em> for more details.</p>
</div>
</div>
<div class="sect3">
<h4 id="_ch5_external_ldap_user_import_workflows"><a class="anchor" href="#_ch5_external_ldap_user_import_workflows"></a><a class="link" href="#_ch5_external_ldap_user_import_workflows">5.1.8. External LDAP User Import Workflows</a></h4>
<div class="paragraph">
<p>DirX Identity delivers two workflows for importing users from an external LDAP to the Identity Store. They are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Full Import of external LDAP Users</strong> - the workflow is started from DirX Identity Manager (either manually or by a schedule) and performs either the initial load of users from an external LDAP directory or the complete re-synchronization of the external LDAP directory. In complete re-synchronization, users may be deleted or marked as to-be-deleted in the Identity Store.</p>
</li>
<li>
<p><strong>Import Users from external LDAP</strong> - The workflow is normally started by an event and imports a user (or updates a user or deletes a user or marks a user as to-be-deleted) depending on the incoming event and the existence of that user in the Identity Store. If the workflow is started by DirX Identity Manager manually or triggered by the scheduler, it performs a re-synchronization of the external LDAP users (without deleting users or marking users as deleted).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The next sections describe the configuration of the two workflows and how to send events using <strong>metacp</strong> to trigger the synchronization of an external user.</p>
</div>
<div class="sect4">
<h5 id="_ch5_external_ldap_user_full_import_workflow"><a class="anchor" href="#_ch5_external_ldap_user_full_import_workflow"></a><a class="link" href="#_ch5_external_ldap_user_full_import_workflow">5.1.8.1. External LDAP User Full Import Workflow</a></h5>
<div class="paragraph">
<p>The <strong>Full Import of external LDAP Users</strong> workflow operates between the Users folder in the <strong>Identity Store</strong> and an external LDAP directory accessing organizational persons in that directory.</p>
</div>
<div class="paragraph">
<p>The workflow is based on Java real-time technology, with two LDAP connectors accessing the external LDAP directory and the Identity Store. The <strong>FullImport</strong> controller is configured as the join engine. The controller exports all users from the external LDAP directory and then imports them into the user tree of the Identity Store. It performs the following operations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Adds a user if the entry does not exist in the Identity Store.</p>
</li>
<li>
<p>Modifies a user if the user exists in the Identity Store but has different attribute values.</p>
</li>
<li>
<p>Marks a user as to-be-deleted (dxrState=âTBDELâ) if the user is no longer available in the external LDAP directory (this is the default behavior of the workflow)</p>
</li>
<li>
<p>Deletes a user if it is no longer available in the external LDAP directory. (This mode for external users that have been deleted requires changes to the workflow configuration; specifically, mapping of the <strong>dxrState</strong> attribute and post mapping)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This workflow can also be used as a template for other Java-based source workflows for synchronization of objects other than users.</p>
</div>
<div class="paragraph">
<p>The next sections describe</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Workflow prerequisites</p>
</li>
<li>
<p>How to configure the workflow</p>
</li>
<li>
<p>The workflow and its activities</p>
</li>
<li>
<p>Ports</p>
</li>
<li>
<p>Channels</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The workflow needs only one channel for users and a set of attributes to be imported.</p>
</div>
<div class="sect5">
<h6 id="_ch5_external_ldap_user_full_import_workflow_prerequisites"><a class="anchor" href="#_ch5_external_ldap_user_full_import_workflow_prerequisites"></a><a class="link" href="#_ch5_external_ldap_user_full_import_workflow_prerequisites">5.1.8.1.1. External LDAP User Full Import Workflow Prerequisites</a></h6>
<div class="paragraph">
<p>If you did not create a new Connected Directory when you configured the workflow, you need to create one as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Go to the Global View and configure a new Connected Directory by choosing the template <strong>UserLDAP</strong> from the default folder.</p>
</li>
<li>
<p>In <strong>General</strong> <strong>Parameters</strong>, configure <strong>LDAP</strong> <strong>External</strong> <strong>Service</strong> by entering values for <strong>IP</strong> <strong>Address</strong> and <strong>Data</strong> <strong>Port</strong>. You can also set the <strong>SSL</strong>, <strong>Secure</strong> <strong>Port</strong> and <strong>Client</strong> <strong>Authentication</strong> fields if necessary.</p>
</li>
<li>
<p>In <strong>Provisioning</strong>, define the search bases for searching the users:</p>
</li>
<li>
<p>In <strong>Identity</strong> &#8594; <strong>Account Base</strong>, define the search bases for searching the users in the Identity Store.</p>
</li>
<li>
<p>In <strong>Target</strong> <strong>System</strong> &#8594; <strong>UserBase</strong>, define the search bases for searching the users in the external LDAP directory.</p>
</li>
<li>
<p>In <strong>Bind</strong> <strong>Profile</strong>, define the credentials of <strong>LDAPAdmin</strong> (the administrator of the external LDAP directory). Set at least <strong>User</strong>, <strong>Password</strong>, <strong>Authentication</strong> and <strong>Protocol</strong>.</p>
</li>
<li>
<p>In <strong>Set</strong> <strong>Directory</strong> <strong>Name</strong>, set the name of the Connected Directory (if you have not yet already done so).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Create a new workflow line between the Connected Directory and the Identity Store.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch5_external_ldap_user_full_import_workflow_configuration"><a class="anchor" href="#_ch5_external_ldap_user_full_import_workflow_configuration"></a><a class="link" href="#_ch5_external_ldap_user_full_import_workflow_configuration">5.1.8.1.2. External LDAP User Full Import Workflow Configuration</a></h6>
<div class="paragraph">
<p>Start the <strong>Full Import of external LDAP Users</strong> workflow configuration wizard: right-click on the workflow line (select <strong>New</strong>) and then select the <strong>Full Import of external LDAP Users</strong> template of the default folder. Alternatively you can select the workflow in the Expert View by right-clicking on the workflow under your domain and then selecting the configuration wizard. By stepping through the wizard, you can activate or deactivate auditing, choose another controller for the join engine (not recommended), change the export search conditions, adapt the mapping or change the target join criteria. Keep in mind that you donât need to set <strong>Cluster</strong> and <strong>Domain</strong> in <strong>Is Applicable for</strong> when defining the <strong>General Info</strong> parameters.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch5_external_ldap_user_full_import_workflow_and_activities"><a class="anchor" href="#_ch5_external_ldap_user_full_import_workflow_and_activities"></a><a class="link" href="#_ch5_external_ldap_user_full_import_workflow_and_activities">5.1.8.1.3. External LDAP User Full Import Workflow and Activities</a></h6>
<div class="paragraph">
<p>The <strong>Full Import of external LDAP Users</strong> workflow is a Java-based source workflow with two activities:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Join activity - implements the user import.</p>
</li>
<li>
<p>Error activity - receives update requests that failed despite retries and issues notifications.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The join activity is controlled by default by the <strong>FullImport</strong> controller. It exports user entries of the external LDAP directory via the LDAP connector configured in the <strong>TS</strong> port and then performs updates via the LDAP connector configured in the <strong>IdentityDomain</strong> port, as illustrated in the following figure:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch5_sourceWFs/image29.png" alt="External LDAP Users Full Import Workflow Ports and Channels">
</div>
<div class="title">Figure 60. External LDAP Users Full Import Workflow Ports and Channels</div>
</div>
<div class="paragraph">
<p>You can start the workflow either manually or via a schedule.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch5_external_ldap_user_full_import_workflow_ports"><a class="anchor" href="#_ch5_external_ldap_user_full_import_workflow_ports"></a><a class="link" href="#_ch5_external_ldap_user_full_import_workflow_ports">5.1.8.1.4. External LDAP User Full Import Workflow Ports</a></h6>
<div class="paragraph">
<p>The workflow supports the following ports:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>TS port - represents the external LDAP directory that contains the users. The LDAP connector is used to access that LDAP directory.</p>
</li>
<li>
<p>IdentityDomain port - represents the DirX Identity domain and is accessed via the LDAP connector.</p>
</li>
<li>
<p>Event - used for sending change events.</p>
</li>
<li>
<p>Notify - used for sending e-mails.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch5_external_ldap_user_full_import_workflow_channels"><a class="anchor" href="#_ch5_external_ldap_user_full_import_workflow_channels"></a><a class="link" href="#_ch5_external_ldap_user_full_import_workflow_channels">5.1.8.1.5. External LDAP User Full Import Workflow Channels</a></h6>
<div class="paragraph">
<p>The workflow needs only one channel per port. It represents the user objects.</p>
</div>
<div class="paragraph">
<p>1. Users Channel at TS Port</p>
</div>
<div class="paragraph">
<p>This port represents the connection to the external LDAP directory. This workflow uses it for exporting users and attributes.</p>
</div>
<div class="paragraph">
<p><strong>Export:</strong></p>
</div>
<div class="paragraph">
<p>Searchbase:</p>
</div>
<div class="paragraph">
<p>$\{env.user_base} matches the definition in the new Connected Directory.</p>
</div>
<div class="paragraph">
<p><strong>Filter:</strong></p>
</div>
<div class="paragraph">
<p>(objectClass=organizationalPerson)</p>
</div>
<div class="paragraph">
<p>Searching all organizational persons below the search base.</p>
</div>
<div class="paragraph">
<p><strong>Mapping:</strong></p>
</div>
<div class="paragraph">
<p>Mainly used by the workflow to perform the mapping to an entry in the <strong>Identity Store</strong>. The following attributes are defined here (with the <strong>ReadOnly</strong> flag): <strong>cn</strong>, <strong>description</strong>, <strong>employeeNumber</strong>, <strong>facsimileTelephoneNumber</strong>, <strong>gn</strong>, <strong>postalCode</strong>, <strong>postalAddress</strong>, <strong>sn</strong>, <strong>st</strong>, <strong>street</strong>, <strong>telephoneNumber</strong>, <strong>title</strong> and <strong>userCertificate;binary</strong>.</p>
</div>
<div class="paragraph">
<p><strong>Join:</strong></p>
</div>
<div class="paragraph">
<p>Not used by the workflow.</p>
</div>
<div class="paragraph">
<p>2. Users Channel at Identity Port</p>
</div>
<div class="paragraph">
<p>This port represents the connection to the Identity Store. This workflow uses it for importing users into an Identity domain.</p>
</div>
<div class="paragraph">
<p><strong>Channel Userhook:</strong></p>
</div>
<div class="paragraph">
<p>The following user hook (as part of <strong>dxmJoin.jar</strong>) is used: <strong>net.atos.dxm.join.userhook.ldap.UserHookLdapUsers</strong>.</p>
</div>
<div class="paragraph">
<p>The user hook has implemented two interfaces:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>preUpdate:</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If entries should be marked as deleted (state TBDEL) then additionally the attribute <strong>dxrDeleteDate</strong> is set. Therefore the domain value of <strong>Maximum time in days to delete an object</strong> needs to be evaluated first.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>postUpdate:</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>After successful execution of the update operation in the <strong>Identity Store</strong>, the attribute <strong>businessCategory</strong> is set at the user object of the external LDAP directory. The value is <strong>updated at</strong> <em>time stamp</em>. That interface should be adapted according to your requirements. If you donât need any information in the external LDAP directory about successful execution of the operation in <strong>Identity Store</strong>, then simply drop <strong>postUpdate</strong>.</p>
</div>
<div class="paragraph">
<p><strong>Export:</strong></p>
</div>
<div class="paragraph">
<p><strong>Searchbase:</strong></p>
</div>
<div class="paragraph">
<p>${env.role_ts_account_base} matches the definition in the new Connected Directory.</p>
</div>
<div class="paragraph">
<p><strong>Filter:</strong></p>
</div>
<div class="paragraph">
<p>((objectClass=derUser)(!(objectClass=dxrPersona)) (!(objectClass=dxrPersona)) (!(objectClass=dxrFunctionalUser))(!(objectClass=dxrUserFacet))</p>
</div>
<div class="paragraph">
<p>The workflow searches all organizational persons below the search base. Consequently, you should carefully adapt your workflow to your requirements. If you import the users to an existing subtree, you should mark these users with an additional attribute and use that attribute in the filter. Otherwise the <strong>FullImport</strong> controller will delete users (or mark the users as deleted) that already exist in that subtree and which have not been imported from the external LDAP directory.</p>
</div>
<div class="paragraph">
<p><strong>Mapping:</strong></p>
</div>
<div class="paragraph">
<p>The SPML identifier is mapped by a simple expression as follows:</p>
</div>
<div class="paragraph">
<p>${joinedEntry.id}</p>
</div>
<div class="paragraph">
<p>"cn=" + ${source.cn} + ",o=LDAP-External,cn=Users,cn=My-Company"</p>
</div>
<div class="paragraph">
<p>If the entry is already available, then the DN of the existing entry is used. If it is a new entry, then the second expression applies.</p>
</div>
<div class="paragraph">
<p>The workflow uses several 1:1 mappings for the attributes <strong>cn</strong>, <strong>description</strong>, <strong>employeeNumber</strong>, <strong>facsimileTelephoneNumber</strong>, <strong>gn</strong>, <strong>postalCode</strong>, <strong>postalAddress</strong>, <strong>sn</strong>, <strong>st</strong>, <strong>street</strong>, <strong>telephoneNumber</strong>, <strong>title</strong> and <strong>userCertificate;binary</strong>.</p>
</div>
<div class="paragraph">
<p>The <strong>dxrPrimaryKey</strong> attribute is set be the expression â$\{source.id}. Note that <strong>dxrPrimaryKey</strong> is also used in the join conditions.</p>
</div>
<div class="paragraph">
<p>The <strong>dxrState</strong> attribute is either set to NEW for new entries or TBDEL if the entry no longer exists in the external LDAP directory. For state TBDEL, the attribute <strong>dxrEndDate</strong> is set to <strong>now</strong> and the <strong>dxrDeleteDate</strong> is set according to the domain value of <strong>Maximum time in days to delete an object</strong>. If you want to delete the object directly, then you should adapt the mapping for âdxrStateâ and/or the post mapping (by changing the operation from MODIFY to DELETE).</p>
</div>
<div class="paragraph">
<p><strong>Join:</strong></p>
</div>
<div class="paragraph">
<p>The associated user for a source entry is searched, first with <strong>dxrPrimaryKey</strong> matching the dn of the external LDAP user and then if not found with the mapped cn attribute.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch5_external_ldap_user_import_workflow"><a class="anchor" href="#_ch5_external_ldap_user_import_workflow"></a><a class="link" href="#_ch5_external_ldap_user_import_workflow">5.1.8.2. External LDAP User Import Workflow</a></h5>
<div class="paragraph">
<p>The <strong>Import Users from external LDAP</strong> workflow operates between the Users folder in the Identity Store and an external LDAP directory accessing organizational persons in that directory.</p>
</div>
<div class="paragraph">
<p>The workflow is based on Java real-time technology, with two LDAP connectors accessing the external LDAP directory and the Identity Store. The <strong>SyncOneWay2Identity</strong> controller is configured as the join engine. The controller exports all users from the external LDAP directory and then imports them into the user tree of the Identity Store if it is started manually in DirX Identity Manager or triggered by the scheduler. It processes just one user if the workflow is triggered by an event.</p>
</div>
<div class="paragraph">
<p>The workflow performs the following operations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Adds a user if the entry does not exist in the Identity Store.</p>
</li>
<li>
<p>Modifies a user if the user exists in the Identity Store but has different attribute values.</p>
</li>
<li>
<p>Marks a user as to-be-deleted (dxrState=âTBDELâ) if the user is no longer available in the external LDAP directory (this is the default behavior of the workflow).</p>
</li>
<li>
<p>Deletes a user if it is no longer available in the external LDAP directory. (This mode for external users that been deleted requires changes to the workflow configuration; specifically, mapping of the attribute <strong>dxrState</strong> and post mapping.)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This workflow can also be used as a template for other Java-based source workflows for synchronization of objects other than users.</p>
</div>
<div class="paragraph">
<p>The next sections describe</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Workflow prerequisites</p>
</li>
<li>
<p>How to configure the workflow</p>
</li>
<li>
<p>The workflow and its activities</p>
</li>
<li>
<p>Ports</p>
</li>
<li>
<p>Channels</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The workflow needs only one channel for users and a set of attributes to be imported.</p>
</div>
<div class="sect5">
<h6 id="_ch5_external_ldap_user_import_workflow_prerequisites"><a class="anchor" href="#_ch5_external_ldap_user_import_workflow_prerequisites"></a><a class="link" href="#_ch5_external_ldap_user_import_workflow_prerequisites">5.1.8.2.1. External LDAP User Import Workflow Prerequisites</a></h6>
<div class="paragraph">
<p>If you did not create a new Connected Directory when you configured the External LDAP User Full Import Workflow, you need to create one as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Go to the Global View and configure a new Connected Directory by choosing the template <strong>UserLDAP</strong> from the default folder.</p>
</li>
<li>
<p>In <strong>General Parameters</strong>, configure <strong>LDAP External Service</strong> by entering values in <strong>IP</strong> <strong>Address</strong> and <strong>Data</strong> <strong>Port</strong>. You can also set <strong>SSL</strong>, <strong>Secure</strong> <strong>Port</strong> and <strong>Client</strong> <strong>Authentication</strong> if necessary.</p>
</li>
<li>
<p>In <strong>Provisioning</strong>, define the search bases for searching the users:</p>
</li>
<li>
<p>In <strong>Identity &#8594; Account Base</strong>, define the search bases for searching the users in the Identity Store.</p>
</li>
<li>
<p>In <strong>Target</strong> <strong>System</strong> &#8594; <strong>UserBase</strong>, define the search bases for searching the users in the external LDAP directory.</p>
</li>
<li>
<p>In <strong>Bind</strong> <strong>Profile</strong>, define the credentials of <strong>LDAPAdmin</strong> (the administrator of the external LDAP directory). Set at least <strong>User</strong>, <strong>Password</strong>, <strong>Authentication</strong> and <strong>Protocol</strong>.</p>
</li>
<li>
<p>In <strong>Set</strong> <strong>Directory</strong> <strong>Name</strong>, set the name of the Connected Directory (if you have not yet already done so).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Create a new workflow line between the Connected Directory and the Identity Store.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch5_external_ldap_user_import_workflow_configuration"><a class="anchor" href="#_ch5_external_ldap_user_import_workflow_configuration"></a><a class="link" href="#_ch5_external_ldap_user_import_workflow_configuration">5.1.8.2.2. External LDAP User Import Workflow Configuration</a></h6>
<div class="paragraph">
<p>Start the <strong>Import Users from external LDAP</strong> workflow configuration wizard: right-click on the workflow line (select <strong>New</strong>) and then select the <strong>Import Users from external LDAP</strong> template of the default folder. Alternatively you can select the workflow in the Expert View by right-clicking on the workflow under your domain and then selecting the configuration wizard. By stepping through the wizard, you can activate or deactivate auditing, choose another controller for the join engine (not recommended), change the export search conditions, adapt the mapping or change the target join criteria. Keep in mind that you need to set <strong>Cluster</strong> and <strong>Domain</strong> in <strong>Is Applicable for</strong> when defining the <strong>General Info</strong> parameters.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch5_external_ldap_user_import_workflow_and_activities"><a class="anchor" href="#_ch5_external_ldap_user_import_workflow_and_activities"></a><a class="link" href="#_ch5_external_ldap_user_import_workflow_and_activities">5.1.8.2.3. External LDAP User Import Workflow and Activities</a></h6>
<div class="paragraph">
<p>The workflow <strong>Import Users from external LDAP</strong> is a Java-based source workflow with two activities:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Join activity - implements the user import.</p>
</li>
<li>
<p>Error activity - receives update requests that failed despite retries and issues notifications.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The join activity is controlled by default by the <strong>SyncOneWay2Identity</strong> controller. It exports user entries of the external LDAP directory via the LDAP connector configured in the TS port and then performs updates via the LDAP connector configured in the <strong>IdentityDomain</strong> port, as illustrated in the following figure:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch5_sourceWFs/image29.png" alt="External LDAP User Import Workflow Ports and Channels">
</div>
<div class="title">Figure 61. External LDAP User Import Workflow Ports and Channels</div>
</div>
<div class="paragraph">
<p>You can start the workflow either manually or via a schedule or set it up to be triggered by an incoming event.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch5_external_ldap_user_import_workflow_ports"><a class="anchor" href="#_ch5_external_ldap_user_import_workflow_ports"></a><a class="link" href="#_ch5_external_ldap_user_import_workflow_ports">5.1.8.2.4. External LDAP User Import Workflow Ports</a></h6>
<div class="paragraph">
<p>The workflow supports the following ports:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>TS port - represents the external LDAP directory that contains the users. The LDAP connector is used to access that LDAP directory.</p>
</li>
<li>
<p>IdentityDomain port - represents the DirX Identity domain and is accessed via the LDAP connector.</p>
</li>
<li>
<p>Event - used for sending change events.</p>
</li>
<li>
<p>Notify - used for sending e-mails.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch5_external_ldap_user_import_workflow_channels"><a class="anchor" href="#_ch5_external_ldap_user_import_workflow_channels"></a><a class="link" href="#_ch5_external_ldap_user_import_workflow_channels">5.1.8.2.5. External LDAP User Import Workflow Channels</a></h6>
<div class="paragraph">
<p>The workflow needs only one channel per port. It represents the user objects.</p>
</div>
<div class="paragraph">
<p>1. Users Channel at TS Port</p>
</div>
<div class="paragraph">
<p>This port represents the connection to the external LDAP directory. This workflow uses it for exporting users and attributes.</p>
</div>
<div class="paragraph">
<p><strong>Export:</strong></p>
</div>
<div class="paragraph">
<p><strong>Searchbase:</strong></p>
</div>
<div class="paragraph">
<p>${env.user_base} matches the definition in the new Connected Directory.</p>
</div>
<div class="paragraph">
<p><strong>Filter:</strong></p>
</div>
<div class="paragraph">
<p>(objectClass=organizationalPerson)</p>
</div>
<div class="paragraph">
<p>Searching all organizational persons below the search base.</p>
</div>
<div class="paragraph">
<p><strong>Mapping:</strong></p>
</div>
<div class="paragraph">
<p>Mainly used by the workflow to perform the mapping to an entry in the <strong>Identity Store</strong>. Consequently, the following attributes are defined here (with the <strong>ReadOnly</strong> flag): <strong>cn</strong>, <strong>description</strong>, <strong>employeeNumber</strong>, <strong>facsimileTelephoneNumber</strong>, <strong>gn</strong>, <strong>postalCode</strong>, <strong>postalAddress</strong>, <strong>sn</strong>, <strong>st</strong>, <strong>street</strong>, <strong>telephoneNumber</strong>, <strong>title</strong> and <strong>userCertificate;binary</strong>.</p>
</div>
<div class="paragraph">
<p><strong>Join:</strong></p>
</div>
<div class="paragraph">
<p>Not used by the workflow.</p>
</div>
<div class="paragraph">
<p>2. Users Channel at Identity Port</p>
</div>
<div class="paragraph">
<p>This port represents the connection to the Identity Store. This workflow uses it for importing users into an Identity domain.</p>
</div>
<div class="paragraph">
<p><strong>Channel Userhook:</strong></p>
</div>
<div class="paragraph">
<p>The following user hook (as part of <strong>dxmJoin.jar</strong> is used: <strong>net.atos.dxm.join.userhook.ldap.UserHookLdapUsers</strong>.</p>
</div>
<div class="paragraph">
<p>The user hook has implemented two interfaces:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>preUpdate</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If entries should be marked as deleted (state TBDEL) then additionally the attribute <strong>dxrDeleteDate</strong> is set. Therefore the domain value of <strong>Maximum time in days to delete an object</strong> needs to be evaluated first.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>postUpdate</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>After successful execution of the update operation in the Identity Store, the attribute <strong>businessCategory</strong> is set at the user object of the external LDAP directory. The value is <strong>updated at</strong> <em>time stamp</em>. Adapt this interface according to your requirements or simply drop it if you donât need any information in the external LDAP directory about successful execution of the operation in Identity Store.</p>
</div>
<div class="paragraph">
<p><strong>Export:</strong></p>
</div>
<div class="paragraph">
<p><strong>Searchbase:</strong></p>
</div>
<div class="paragraph">
<p>${env.role_ts_account_base} matches the definition in the new Connected Directory.</p>
</div>
<div class="paragraph">
<p><strong>Filter:</strong></p>
</div>
<div class="paragraph">
<p>objectClass=derUser)(!(objectClass=dxrPersona (!(objectClass=dxrPersona)) (!(objectClass=dxrFunctionalUser))(!(objectClass=dxrUserFacet))</p>
</div>
<div class="paragraph">
<p>The workflow searches all organizational persons below the search base. Therefore you should carefully adapt your workflow to your requirements.</p>
</div>
<div class="paragraph">
<p><strong>Mapping:</strong></p>
</div>
<div class="paragraph">
<p>The SPML identifier is mapped by a simple expression as follows:</p>
</div>
<div class="paragraph">
<p>${joinedEntry.id}</p>
</div>
<div class="paragraph">
<p>"cn=" + $\{source.cn} + ",o=LDAP-External,cn=Users,cn=My-Company"</p>
</div>
<div class="paragraph">
<p>If the entry is already available, the DN of the existing entry is used. If it is a new entry, the second expression applies.</p>
</div>
<div class="paragraph">
<p>The workflow uses several 1:1 mappings for the attributes <strong>cn</strong>, <strong>description</strong>, <strong>employeeNumber</strong>, <strong>facsimileTelephoneNumber</strong>, <strong>gn</strong>, <strong>postalCode</strong>, <strong>postalAddress</strong>, <strong>sn</strong>, <strong>st</strong>, <strong>street</strong>, <strong>telephoneNumber</strong>, <strong>title</strong> and <strong>userCertificate;binary</strong>.</p>
</div>
<div class="paragraph">
<p>The attribute <strong>dxrPrimaryKey</strong> is set be the expression â$\{source.id}. Note that <strong>dxrPrimaryKey</strong> is also used in the join conditions.</p>
</div>
<div class="paragraph">
<p>The attribute <strong>dxrState</strong> is either set to ENABLED for new entries or TBDEL if the entry no longer exists in the external LDAP directory. For state TBDEL, the attribute <strong>dxrEndDate</strong> is set to <strong>now</strong> and the <strong>dxrDeleteDate</strong> is set according to the domain value of <strong>Maximum time in days to delete an object</strong>. If you want to delete the object directly, then you should adapt the mapping for <strong>dxrState</strong> and/or the post mapping (by changing the operation from MODIFY to DELETE).</p>
</div>
<div class="paragraph">
<p><strong>Join:</strong></p>
</div>
<div class="paragraph">
<p>The associated user for a source entry is searched first with <strong>dxrPrimaryKey</strong> matching the DN of the external LDAP user and then if not found with the mapped cn attribute.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch5_sending_events_to_synchronize_external_users"><a class="anchor" href="#_ch5_sending_events_to_synchronize_external_users"></a><a class="link" href="#_ch5_sending_events_to_synchronize_external_users">5.1.8.3. Sending Events to Synchronize External Users</a></h5>
<div class="paragraph">
<p>This section describes how to use <strong>metacp</strong> to send events that trigger the synchronization of an external user.</p>
</div>
<div class="sect5">
<h6 id="_ch5_event_types"><a class="anchor" href="#_ch5_event_types"></a><a class="link" href="#_ch5_event_types">5.1.8.3.1. Event Types</a></h6>
<div class="paragraph">
<p>An event is an XML document compliant with the XML namespace "urn:siemens:dxm:EVENT:1:0". This namespace is proprietary and extends the standard namespace SPML v1 "urn:oasis:names:tc:SPML:1:0". There are three types of events according the change it wants to notify: entry was created (<code>&lt;addEvent&gt;</code>), changed (<code>&lt;modifyEvent&gt;</code>) or deleted (<code>&lt;deleteEvent&gt;</code>). Each event extends the corresponding SPML request: <code>&lt;addRequest&gt;</code>, <code>&lt;modifyRequest&gt;</code> or <code>&lt;deleteRequest&gt;</code>. For details about SPML v1, see the standard specification; for example, <a href="https://www.oasis-open.org/committees/download.php/4137/os-pstc-spml-core-1.0.pdf" class="bare">https://www.oasis-open.org/committees/download.php/4137/os-pstc-spml-core-1.0.pdf</a>.</p>
</div>
<div class="paragraph">
<p>Each event document should contain the necessary XML namespaces at the beginning of the document in its first element. These are:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">xmlns:dsml="urn:oasis:names:tc:DSML:2:0:core"
xmlns:spml="urn:oasis:names:tc:SPML:1:0"
xmlns:event="urn:siemens:dxm:EVENT:1:0"</code></pre>
</div>
</div>
<div class="paragraph">
<p>The remainder of this section assumes the namespace prefixes <strong>event</strong>, <strong>spml</strong> and <strong>dsml</strong>.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch5_identifier_and_requestid"><a class="anchor" href="#_ch5_identifier_and_requestid"></a><a class="link" href="#_ch5_identifier_and_requestid">5.1.8.3.2. Identifier and requestID</a></h6>
<div class="paragraph">
<p>Each SPML request and the corresponding events contain an &lt;identifier&gt; element that represents the identifier of the changed entry in the source system. For an LDAP or Active Directory source - as expected in these workflows - it is of type DN. Here is a sample:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;spml:identifier type="urn:oasis:names:tc:SPML:1:0#DN"&gt;
    &lt;spml:id&gt;cn=Abele,ou=Sales,o=My-Company&lt;/spml:id&gt;
&lt;/spml:identifier&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Normal SPML add and modify requests need to contain the list of attributes or modifications. They are not needed here; the identifier is sufficient. The import workflow uses it to read the entry and all configured attributes from the source system.</p>
</div>
<div class="paragraph">
<p>SPML requests and the events can contain a requestID parameter. It is not necessary and might occur in some debug logs.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch5_name_and_source"><a class="anchor" href="#_ch5_name_and_source"></a><a class="link" href="#_ch5_name_and_source">5.1.8.3.3. Name and Source</a></h6>
<div class="paragraph">
<p>In addition to SPML requests, events contain a mandatory name attribute and an optional &lt;source&gt; element. Both are used for identifying the appropriate workflow that is started to handle the event.</p>
</div>
<div class="paragraph">
<p>The name attribute has the following structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;domain&gt;.dxm.request.importToIdentity.&lt;type&gt;.cluster='&lt;cluster&gt;'.resource='&lt;resource&gt;'.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here is an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">my-company.dxm.request.importToIdentity.LDAP.cluster='External'.resource='External'.</code></pre>
</div>
</div>
<div class="paragraph">
<p>The part that follows the domain is the queue name to which to send the event and also characterizes the workflow type. Type, cluster and domain normally identify the target system and here identify the workflow. Think about importing users from different sources or importing users and roles. Make sure that these values match the corresponding ones in the <strong>Is applicable for</strong> section of the workflow definition.</p>
</div>
<div class="paragraph">
<p>The &lt;source&gt; element gives some information about the source of the event. It contains the application as a separate XML attribute as well as type, cluster and resource, which contain the same values as described for the name attribute. The application contains the name of the sending application. When sending the event with <strong>metacp</strong>, please use the name <strong>metacp</strong>.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch5_a_complete_sample_event"><a class="anchor" href="#_ch5_a_complete_sample_event"></a><a class="link" href="#_ch5_a_complete_sample_event">5.1.8.3.4. A Complete Sample Event</a></h6>
<div class="paragraph">
<p>The following example shows an add event:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;event:addEvent xmlns:spml="urn:oasis:names:tc:SPML:1:0"
    xmlns:event="urn:siemens:dxm:EVENT:1:0"
    requestID="svc.add.uid-123"
    name="my-company.dxm.request.importToIdentity.LDAP.cluster='External'.resource='External'"&gt;
  &lt;spml:identifier type="urn:oasis:names:tc:SPML:1:0#DN"&gt;
    &lt;spml:id&gt;cn=Abele,ou=Sales,o=My-Company&lt;/spml:id&gt;
  &lt;/spml:identifier&gt;
  &lt;event:source application="metacp" type="LDAP" resource="external" cluster="external"/&gt;
&lt;/event:addEvent&gt;</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_ch5_sent_event_with_metacp"><a class="anchor" href="#_ch5_sent_event_with_metacp"></a><a class="link" href="#_ch5_sent_event_with_metacp">5.1.8.3.5. Sent Event with metacp</a></h6>
<div class="paragraph">
<p>For sending an event with <strong>metacp</strong>, you should prepare a template with the event analogous to the example shown in the previous section. Use placeholders for the event type and "DN of changed entry" variables.</p>
</div>
<div class="paragraph">
<p>For a specific entry, replace the placeholders and send them with a Tcl script such as the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-tcl hljs" data-lang="tcl">set topic "my-company.dxm.request.importToIdentity.LDAP.cluster='External'.resource='External'"
set event â¦

ats init
ats send -topic $topic -message "$event"
ats term</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_understanding-the-tcl-based-source-workflows"><a class="anchor" href="#_understanding-the-tcl-based-source-workflows"></a><a class="link" href="#_understanding-the-tcl-based-source-workflows">5.2. Understanding the Tcl-based Source Workflows</a></h3>
<div class="paragraph">
<p>DirX Identity&#8217;s Tcl-based source scheduled workflows provided with the default Connectivity scenario include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Creation workflows - workflows that extract user information from existing identity sources (for example, an HR or CRM database) and populate the Identity Store with user information.</p>
</li>
<li>
<p>Update workflows - workflows that transfer specific information from the Identity Store to the identity sources (for example, e-mail addresses or telephone numbers) to enable them to use the joined, high-quality information in the Identity Store.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The creation workflows described here all work the same way. They:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Extract identity information from the identity source.</p>
</li>
<li>
<p>Merge the extracted information into the Identity Store (the merge mode of the meta controller is used).</p>
</li>
<li>
<p>Use the employeeNumber as join criteria.</p>
</li>
<li>
<p>Create a local GUID for each identity (into the attribute dxmGuid) that is composed of a fixed string and the employeeNumber.</p>
</li>
<li>
<p>Mark all created and modified user entries in the Identity Store for privilege resolution (dxrTBA=TRUE).</p>
</li>
<li>
<p>Set the start and end dates of the identities (setting the end date prepares an identity to be deleted).</p>
</li>
<li>
<p>Set the dxmOprMaster attribute that indicates which identity source controls this identity. This avoids additionally that the same identity is controlled by several masters which would lead to oscillating identity information and to confusion.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>DirX Identity provides the following pre-configured creation and update workflows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>LDIFfile2Ident</strong> - imports data from an LDIF content file to the Identity Store and creates or updates the corresponding identities (this file acts as identity master for all German persons from Munich).</p>
</li>
<li>
<p><strong>Ident2LDIFfile</strong> - exports all German persons from Munich from the Identity Store to an LDIF content file. Use this information to update the identity source (for example the e-mail addresses or telephone numbers).</p>
</li>
<li>
<p><strong>CSVfile2Ident</strong> - imports data from a CSV file to the Identity Store and creates or updates the corresponding identities (this file acts as identity master for all German persons from Berlin).</p>
</li>
<li>
<p><strong>dent2CSVfile</strong> - exports all German persons from Berlin from the Identity Store to a CSV file. Use this information to update the identity source (for example the e-mail addresses or telephone numbers).</p>
</li>
<li>
<p><strong>XMLfile2Ident</strong> - imports data from an XML file to the Identity Store and creates or updates the corresponding identities (this file acts as identity master for all German persons from Frankfurt). Please note that the DDN must be the first attribute in the Selected Attributes list for this workflow to function properly.</p>
</li>
<li>
<p><strong>Ident2XMLfile</strong> - exports all German persons from Frankfurt from the Identity Store to an XML file. Use this information to update the identity source (for example the e-mail addresses or telephone numbers). Please note that the DDN must be the first attribute in the Selected Attributes list for this workflow to function properly.</p>
</li>
<li>
<p><strong>Ident2XSLT</strong> - exports all German persons from Frankfurt from the Identity Store to an XML file. Use this information to update the identity source (for example the e-mail addresses or telephone numbers). In contrast to the <strong>Ident2XMLfile</strong> workflow, an additional XSLT conversion is possible. Please note that the DDN must be the first attribute in the Selected Attributes list for this workflow to function properly.</p>
</li>
<li>
<p><strong>DSMLfile2Ident</strong> - imports data from a DSML V1 file to the Identity Store and creates or updates the corresponding identities (this file acts as identity master for all German persons from Frankfurt). Please note that the DDN must be the first attribute in the Selected Attributes list for this workflow to function properly.</p>
</li>
<li>
<p><strong>Ident2DSMLfile</strong> - exports all German persons from Frankfurt from the Identity Store to a DSML file. Use this information to update the identity source (for example the e-mail addresses or telephone numbers). Please note too that the DDN must be the first attribute in the Selected Attributes list for this workflow to function properly.</p>
</li>
<li>
<p><strong>CorpDir2Ident</strong> - copies all entries that were imported by the LDIFfile2Ident workflow to the tree ou=newTree in the Identity Store. Note that this workflow can only run after a successful run of the LDIFfile2Ident workflow.</p>
</li>
<li>
<p><strong>DirXLDIF2Ident</strong> - imports entries in an LDIF content or change file generated by the DirX directory service into the Identity Store.</p>
</li>
<li>
<p><strong>SAP-R3-HR2Ident</strong> - imports data from an LDIF file that was generated by DirX Identity&#8217;s SAP HR agent to the Identity Store and creates or updates the corresponding identities (this file acts as identity master for all persons from Rome).</p>
</li>
<li>
<p><strong>SAP-R3-OM2Ident</strong> - imports organizational data from an LDIF file that was generated by DirX Identity&#8217;s SAP HR agent from the SAP OM subsystem to the identity store. It creates a structure of organizational units.</p>
</li>
<li>
<p><strong>LDIFfile2CSVfile</strong> - transfers information from an LDIF file to a CSV file. This is an example of a workflow that works without any intermediate Identity Store.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_ch5_configuring_the_corporate_directory_workflow"><a class="anchor" href="#_ch5_configuring_the_corporate_directory_workflow"></a><a class="link" href="#_ch5_configuring_the_corporate_directory_workflow">5.2.1. Configuring the Corporate Directory Workflow</a></h4>
<div class="paragraph">
<p>The default Connectivity scenario&#8217;s CorpDir2Ident workflow synchronizes user entries from an LDAP-enabled corporate directory into the Identity Store. By default, the workflow processes only new and modified users. Users that have been physically deleted from the corporate directory are not recognized, but you can extend the workflow if the deleted users in the source directory are marked with a special attribute. The workflow consists of a <strong>metacp</strong> activity that exports users from the corporate directory and creates or modifies users in the Identity Store. The workflow performs delta synchronization based on modification time stamps.</p>
</div>
<div class="paragraph">
<p>To run the CorpDir2Ident workflow successfully, you must perform these steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Go to the connected directory icon <strong>CorpDir</strong>.</p>
</li>
<li>
<p>In the wizard window, open the <strong>Service</strong> object and set the correct address and port information.</p>
</li>
<li>
<p>Click the <strong>Bind Profiles</strong> step. Open the bind profile and set the correct user and password information.</p>
</li>
<li>
<p>Click <strong>OK</strong>, and then click <strong>Finish</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Now you must define an LDIF agreement before this workflow can run. See the section "Configuring the DirXdelta Provisioning Workflow" for details.</p>
</div>
</div>
<div class="sect3">
<h4 id="_ch5_configuring_the_dirx_ldif_directory_workflow"><a class="anchor" href="#_ch5_configuring_the_dirx_ldif_directory_workflow"></a><a class="link" href="#_ch5_configuring_the_dirx_ldif_directory_workflow">5.2.2. Configuring the DirX LDIF Directory Workflow</a></h4>
<div class="paragraph">
<p>The default Connectivity scenario&#8217;s DirXLDIF2Ident workflow synchronizes LDIF content and change files supplied by the DirX directory service into the Identity Store. The workflow processes new, deleted and modified users. The workflow consists of one <strong>metacp</strong> activity that processes all LDIF files supplied in a specific location and creates or modifies users in the Identity Store. All created and modified user entries in the Identity Store are marked for role resolution (dxrTBA=TRUE). The workflow performs delta synchronization based on LDIF change files.</p>
</div>
<div class="paragraph">
<p>To run the DirXLDIF2Ident workflow successfully, you must perform these steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Go to the connected directory icon <strong>DirXLDIF</strong>.</p>
</li>
<li>
<p>In the wizard window, click <strong>LDIF Agreement Parameters</strong>.</p>
</li>
<li>
<p>Change the <strong>LDIF Agreement Folder</strong> path to suit your DirX installation and the related LDIF agreement (normally the LDIF Agreement Folder should be <em>dirx_install_path</em>*/server/ldif*).</p>
</li>
<li>
<p>Click <strong>OK</strong>, and then click <strong>Finish</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Now you must define an LDIF agreement before this workflow can run. For details, see the section "Configuring the DirXdelta Workflow".</p>
</div>
</div>
<div class="sect3">
<h4 id="_ch5_configuring_the_dirxdelta_workflow"><a class="anchor" href="#_ch5_configuring_the_dirxdelta_workflow"></a><a class="link" href="#_ch5_configuring_the_dirxdelta_workflow">5.2.3. Configuring the DirXdelta Workflow</a></h4>
<div class="paragraph">
<p>The DirX Identity DirXdelta synchronization workflow <strong>DirXdelta2Ident</strong> handles synchronization between a DirX LDAP directory that creates LDIF change files based on an LDIF agreement and imports this information into an LDAP directory. Before you can run this workflow, you must set up a DirX LDIF agreement. The following sections describe the rules you need to follow for DirXdelta LDIF agreements and describes how to set up an agreement. The workflow checks the defined directory to which the LDIF change files are written and processes all files with the correct LDIF agreement identifier (by default, 88).</p>
</div>
<div class="sect4">
<h5 id="_ch5_dirxdelta_ldif_agreement_rules"><a class="anchor" href="#_ch5_dirxdelta_ldif_agreement_rules"></a><a class="link" href="#_ch5_dirxdelta_ldif_agreement_rules">5.2.3.1. DirXdelta LDIF Agreement Rules</a></h5>
<div class="paragraph">
<p>In general, you must observe the following rules when creating an LDIF agreement suitable for the pre-configured DirXdelta workflow:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The replication area (context prefix + subtree base) must match the workflow&#8217;s input base object. Job &#8594; Input Channel &#8594; Import/Export contains by default a setting "base_obj ou=Sales, o=PQR" which is suitable for the samples described in the previous section.<br>
<br>
Note: It is essential to decide whether or not to place a blank space after the comma in the setting. Place a blank if the LDIF content/change files are generated by the DirX Server (via LDIF agreements). Donât place a blank if the LDIF change files are written by <strong>metacp</strong>.<br>
<br>
For example, you must change this setting to "base_obj ou=Controlling, o=PQR" if the related LDIF agreement is designed to process changes of subordinates of "ou=Controlling, o=PQR"</p>
</li>
<li>
<p>If your LDIF agreement is configured for both full and incremental refresh, the LDIF policy of this agreement must be "Save user attributes plus Creation-Time and Modification-Time only".</p>
</li>
<li>
<p>The LDIF agreement must be specified so that the LDIF files are generated in Latin-1 (ISO 8859-1) format.</p>
</li>
<li>
<p>The workflow is designed to synchronize persons only. Where necessary, intermediate nodes like organizational units are created with dummy attribute values according to the workflow&#8217;s superior_info setting. As a result, the LDIF agreement should be defined with a refinement filter to an object class representing a person (as in the sample script create-iper.adm - see the next section "Setting Up the LDIF Agreement"). This action prevents confusing ânaming violationâ error messages during the creation of intermediate nodes. If you intend to synchronize objects other than persons, you must change the mapping so that it is consistent for all objects (for example, one-to-one mapping using lStringEscapeLDIF for all attributes to be synchronized).</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch5_setting_up_the_ldif_agreement"><a class="anchor" href="#_ch5_setting_up_the_ldif_agreement"></a><a class="link" href="#_ch5_setting_up_the_ldif_agreement">5.2.3.2. Setting Up the LDIF Agreement</a></h5>
<div class="paragraph">
<p>You can create LDIF agreements with <strong>dirxadm</strong> scripts or with DirXmanage. For details, see the DirX documentation.</p>
</div>
<div class="paragraph">
<p>The default <strong>DirXdelta2Ident</strong> workflow requires an LDIF agreement that matches the workflow&#8217;s default settings. Our sample agreement writes an LDIF file every hour and has the agreement ID 88.</p>
</div>
<div class="paragraph">
<p>See the section "DirXdelta LDIF Agreement Rules" for information about how to set up LDIF agreements correctly.</p>
</div>
<div class="paragraph">
<p>Note: Be sure that the directory to which the DirX server writes the LDIF change files grants read <strong>and write</strong> access to the DirXdelta workflow (<strong>metacp</strong>).</p>
</div>
<div class="paragraph">
<p>To create the sample agreement with DirXmanage:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Start DirXmanage</p>
</li>
<li>
<p>Open <strong>Policies</strong> &#8594; <strong>Shadow Operational Bindings</strong></p>
</li>
<li>
<p>Perform <strong>Local Operations</strong> &#8594; <strong>Add</strong> &#8594; <strong>Primary</strong> &#8594; <strong>LDIF agreement</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Input Data</strong>:</p>
</div>
<div class="paragraph">
<p><strong>General</strong>: Shadowing Status=Activated, Identifier=88</p>
</div>
<div class="paragraph">
<p><strong>Shadowing Agreement</strong>: Context prefix=/o=pqr</p>
</div>
<div class="paragraph">
<p>Update mode: Window time &#8230;&#8203; = 10 sec</p>
</div>
<div class="paragraph">
<p>Update interval &#8230;&#8203; = 3600 sec</p>
</div>
<div class="paragraph">
<p><strong>Replication Area</strong>: Subtree base=/ou=mthb/ou=Sales</p>
</div>
<div class="paragraph">
<p>Refinement=Internet-Organizational-Person</p>
</div>
<div class="paragraph">
<p><strong>LDIF policy</strong>: Click <strong>Save user attributes plus Creation-Time and Modification-Time only</strong>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Click <strong>OK</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The LDIF agreement is now active and running. You can start the workflow to process the initial LDIF content file.</p>
</div>
<div class="paragraph">
<p>To edit the agreement again:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Start DirXmanage</p>
</li>
<li>
<p>Click <strong>Policies</strong> &#8594; <strong>Shadow</strong> <strong>Operational</strong> <strong>Bindings</strong></p>
</li>
<li>
<p>Click the line with the agreement number 88</p>
</li>
<li>
<p>Click <strong>Local</strong> <strong>Operations</strong> &#8594; <strong>Terminate</strong></p>
</li>
<li>
<p>Now you can edit the agreement.</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="_ch5_sample_scripts_to_handle_the_sample_agreement"><a class="anchor" href="#_ch5_sample_scripts_to_handle_the_sample_agreement"></a><a class="link" href="#_ch5_sample_scripts_to_handle_the_sample_agreement">5.2.3.2.1. Sample Scripts to Handle the Sample Agreement</a></h6>
<div class="paragraph">
<p>The following sample scripts illustrate how to create, activate, deactivate and delete the sample agreement:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>agrenv.tcl</strong> - contains the central definition of the agreement identifier (in DirX terminology, this is an operational binding identifier)</p>
</li>
<li>
<p><strong>create.adm</strong> - creates the agreement.</p>
</li>
<li>
<p><strong>create-iper.adm</strong> - similar to <strong>create.adm</strong> with the scope of the agreement limited to objects of class inetOrgPerson</p>
</li>
<li>
<p><strong>establish.adm</strong> - activates the agreement</p>
</li>
<li>
<p><strong>show.adm</strong> - displays the agreement</p>
</li>
<li>
<p><strong>terminate.adm</strong> - script for deactivating the agreement</p>
</li>
<li>
<p><strong>delete.adm</strong> - script for deleting the agreement</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Assumptions: Administrator <strong>cn=admin,o=pqr</strong> with Password <strong>dirx</strong></p>
</div>
<div class="paragraph">
<p>Instructions for use:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Copy the scripts from the folder <em>install_path</em>*/data/ldifagr/dirx* or <em>install_path</em>*/data/ldifagr/dirx-ee* into a folder of your choice.</p>
</li>
<li>
<p>Open an MS/DOS Command Prompt window or a UNIX shell and navigate to the script folder.</p>
</li>
<li>
<p>Change agreement identifier in <strong>agrenv.tcl</strong> if necessary. If you change the identifier, don&#8217;t forget to update the agreement number in the workflow definition.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Create the agreement:</p>
</div>
<div class="paragraph">
<p><code><strong>dirxadm create-iper.adm</strong></code> (or <code><strong>dirxadm create.adm</strong></code>)</p>
</div>
<div class="paragraph">
<p>-&#8594; An agreement will be created that writes an LDIF change file every hour</p>
</div>
<div class="paragraph">
<p>Activate the agreement:</p>
</div>
<div class="paragraph">
<p><code><strong>dirxadm establish.adm</strong></code></p>
</div>
<div class="paragraph">
<p>Display the agreement:</p>
</div>
<div class="paragraph">
<p><code><strong>dirxadm show.adm</strong></code></p>
</div>
<div class="paragraph">
<p>Deactivate the agreement:</p>
</div>
<div class="paragraph">
<p><code><strong>dirxadm terminate.adm</strong></code></p>
</div>
<div class="paragraph">
<p>Delete the agreement:</p>
</div>
<div class="paragraph">
<p><code><strong>dirxadm delete.adm</strong></code></p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch5_configuring_the_file_based_source_workflows"><a class="anchor" href="#_ch5_configuring_the_file_based_source_workflows"></a><a class="link" href="#_ch5_configuring_the_file_based_source_workflows">5.2.4. Configuring the File-Based Source Workflows</a></h4>
<div class="paragraph">
<p>The default Connectivity scenario provides a set of creation and update workflows that allow for connectivity to various systems that support data exchange via LDIF, CSV or XML/DSML V1 file formats. Other structured file formats are possible but are not pre-configured.</p>
</div>
<div class="paragraph">
<p>Before you can run these workflows successfully, you need to copy some sample data files to a default location:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Open the file directory <strong>data</strong> in the DirX Identity installation path.</p>
</li>
<li>
<p>Copy the files <strong>data.ldif</strong>, <strong>sapr3_full.ldif</strong>, <strong>sapr3_om.ldif</strong>, <strong>data.csv</strong>, <strong>dsml_data.xml</strong>, <strong>xml_data.xml</strong> to the location <strong>C:/ MetahubData</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following file-based source workflows are available and can run without any further configuration steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>LDIFfile2Ident</p>
</li>
<li>
<p>Ident2LDIFfile</p>
</li>
<li>
<p>CSVfile2Ident</p>
</li>
<li>
<p>Ident2CSVfile</p>
</li>
<li>
<p>XMLfile2Ident</p>
</li>
<li>
<p>Ident2XMLfile</p>
</li>
<li>
<p>Ident2XSLT</p>
</li>
<li>
<p>DSMLfile2Ident</p>
</li>
<li>
<p>Ident2DSMLfile</p>
</li>
<li>
<p>SAP-R3-HR2Ident</p>
</li>
<li>
<p>SAP-R3-OM2Ident</p>
</li>
<li>
<p>LDIFfile2CSVfile</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_ch5_configuring_the_relational_database_workflows"><a class="anchor" href="#_ch5_configuring_the_relational_database_workflows"></a><a class="link" href="#_ch5_configuring_the_relational_database_workflows">5.2.5. Configuring the Relational Database Workflows</a></h4>
<div class="paragraph">
<p>The relational database workflows provided with the default Connectivity scenario can synchronize user entries from a relational database that is either accessible via ODBC or JDBC into the Identity Store. By default, the workflows process only new and modified users. Users that have been physically deleted from the relational database are not recognized, but you can extend the workflows if the deleted users in the source directory are marked with a special attribute.</p>
</div>
<div class="paragraph">
<p>The import workflows consist of a JDBC or ODBC agent activity that exports the information from the source and a <strong>metacp</strong> activity that creates or modifies users in the Identity Store.</p>
</div>
<div class="paragraph">
<p>The default Connectivity scenario ODBC/JDBC workflows are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ODBC2Ident</p>
</li>
<li>
<p>Ident2ODBC</p>
</li>
<li>
<p>ODBC_Ident (a sequential combination of the two previous workflows)</p>
</li>
<li>
<p>JDBC2Ident</p>
</li>
<li>
<p>Ident2JDBC</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To complete and use these workflows, Microsoft Access 20xx must be installed on your computer.</p>
</div>
<div class="paragraph">
<p>The example HR database used in the default scenario is delivered with DirX Identity and has the pathname <em>install_path</em>*/data/personal.mdb*. It is protected with the password <strong>dirx</strong> to show the ODBC agent&#8217;s password feature.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Copy this database to <strong>C:/MetahubData</strong> (or another location, if you prefer). It is a good idea to make a copy of the <strong>personal.mdb</strong> database, so that you can restore the original later on if the working copy becomes corrupted.</p>
</li>
<li>
<p>Define this HR database to be an ODBC database:</p>
</li>
<li>
<p>Go to <strong>Start</strong> &#8594; <strong>Settings</strong> &#8594; <strong>Control</strong> <strong>Panel</strong> and double-click <strong>Administrative Tools</strong></p>
</li>
<li>
<p>Click on <strong>Data</strong> <strong>Sources</strong> <strong>(ODBC)</strong>.</p>
</li>
<li>
<p>If you installed DirX Identity with the system account, select the <strong>System-DSN</strong> tab and click <strong>Add&#8230;&#8203;</strong> otherwise use the <strong>User DSN</strong> tab.</p>
</li>
<li>
<p>Select <strong>Driver to Microsoft Access</strong> (<strong>*.mdb</strong>) and then click <strong>Finish</strong>.</p>
</li>
<li>
<p>Enter <strong>personal</strong> into the field <strong>Data Source Name</strong>.</p>
</li>
<li>
<p>Click <strong>Select&#8230;&#8203;</strong>.</p>
</li>
<li>
<p>Navigate to the location where you have copied <strong>personal.mdb</strong>, select it and click <strong>OK</strong>. A new ODBC source is created.</p>
</li>
<li>
<p>Click <strong>OK</strong> again.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Your ODBC workflows should now run.</p>
</div>
<div class="paragraph">
<p>Note: The password of the Access 20xx database provided with DirX Identity is <strong>dirx</strong>. To change it, perform these steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Start Microsoft Access.</p>
</li>
<li>
<p>Click <strong>File</strong> &#8594; <strong>Open</strong>.</p>
</li>
<li>
<p>Select the database.</p>
</li>
<li>
<p>Click <strong>Open</strong> <strong>Exclusive</strong>.</p>
</li>
<li>
<p>Click <strong>Tools</strong> &#8594; <strong>Security</strong> &#8594; <strong>Set</strong> <strong>Database</strong> <strong>Password</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Don&#8217;t forget to change the relevant bind profile to the same value.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_the_maintenance_workflows"><a class="anchor" href="#_using_the_maintenance_workflows"></a><a class="link" href="#_using_the_maintenance_workflows">6. Using the Maintenance Workflows</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>DirX Identity maintenance workflows help to maintain your identity system to ensure consistent and current data of high quality.This chapter provides detailed information about maintenance workflow configuration, special features and user hooks.The sections in this chapter include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Understanding the Java-based Maintenance Workflows - describes configuration, features, and user hooks for Java-based maintenance workflows.</p>
</li>
<li>
<p>Understanding the Tcl-based Maintenance Workflows - describes configuration, features, and user hooks for Tcl-based maintenance workflows.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For information about these workflows' theory of operation, see the <em>DirX Identity Connectivity Administration Guide</em> and the <em>DirX Identity Provisioning Administration Guide.</em></p>
</div>
<div class="sect2">
<h3 id="_understanding_java_based_maintenance_workflows"><a class="anchor" href="#_understanding_java_based_maintenance_workflows"></a><a class="link" href="#_understanding_java_based_maintenance_workflows">6.1. Understanding the Java-based Maintenance Workflows</a></h3>
<div class="paragraph">
<p>Maintenance workflows provided with the Identity Store default Connectivity scenario include workflows that run as threads in the Java-based server (IdS-J). They can run as the result of events and in many cases can be scheduled. The Java-based maintenance workflows include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Entry change workflows</strong> - special workflows for each type of entry (user, organization, and so on) that apply provisioning and / or consistency rules, check for broken links or update associated entries (for example, the user, if an organizational unit changed the privilege). Deploying these workflows allows you to minimize how often the Privilege Resolution or the Consistency Rule workflow runs (see the section <strong>"Privilege Resolution Workflow"</strong> for details).</p>
</li>
<li>
<p>Process Tickets Internal - a workflow that processes DirX Identity&#8217;s internal tickets.</p>
</li>
<li>
<p><strong>Account Password Manager</strong> - a workflow that changes account passwords generated by user requests (event-based mode). Alternatively, it can run scheduled on a specific number of account objects and creates new passwords for accounts whose passwords have expired.</p>
</li>
<li>
<p><strong>Reset Account Passwords</strong> - a workflow that resets passwords of either functional or personal accounts. It runs scheduled on a specific number of account objects.</p>
</li>
<li>
<p><strong>Reset Password If Displayed</strong> - a workflow that resets passwords of privileged accounts (for example, within 24 hours) after the password has been read by Web Center. It runs scheduled on a specific set of privileged account objects (defined by an LDAP filter).</p>
</li>
<li>
<p><strong>User Password Event Manager</strong> - a workflow that changes user passwords and all related account passwords based on user requests (event-based mode).</p>
</li>
<li>
<p><strong>User Password Expiration Notification</strong> - a workflow that finds users whose passwords are about to expire and informs the users about it by sending a notification mail.</p>
</li>
<li>
<p>Transport Workflows - a workflow that transfers data between Identity Store instances.</p>
</li>
<li>
<p>Joint Backup - a workflow that performs a synchronized backup of the Java-based Serverâs repository and the LDAP Connectivity and Provisioning data store.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_ch6_entry_change_workflows"><a class="anchor" href="#_ch6_entry_change_workflows"></a><a class="link" href="#_ch6_entry_change_workflows">6.1.1. Entry Change Workflows</a></h4>
<div class="paragraph">
<p>Workflows for normal entry changes (not password changes) exist for various types of entries: users, organizations, organizational units and contexts. They are invoked by the same mechanism and their processing is very similar. The following figure illustrates how these workflows are invoked:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch6_maintWFs/image1.png" alt="Invoking an Entry Maintenance Workflow">
</div>
<div class="title">Figure 62. Invoking an Entry Maintenance Workflow</div>
</div>
<div class="paragraph">
<p>Various clients that create, update or delete entries in the Identity domain publish events after their changes. This action is controlled by the <strong>Event Policy</strong> in the domain. The event is only sent if the corresponding object type is activated in the event policy. Clients that send these types of events are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Web Center and Identity Manager.</p>
</li>
<li>
<p>Provisioning Web Services.</p>
</li>
<li>
<p>Import workflows, both Tcl-based and Java-based workflows. Note that</p>
</li>
<li>
<p>For Tcl-based workflows, <strong>metacp</strong> must be configured accordingly.</p>
</li>
<li>
<p>For Java-based workflows, the audit object type in the channel that configures the mapping for import into DirX Identity domain must be set.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It does not make sense to start these workflows by hand or on a schedule because they only evaluate events. As with other real-time workflows, they are deployed to the IdS-J server if their <strong>Is Active</strong> flags are set in the configuration.</p>
</div>
<div class="paragraph">
<p>The clients send an event after an entry has been updated successfully. The topic of the event contains:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The object description name of the changed object: for example, dxrUser, ctxOrganizationalUnit.</p>
</li>
<li>
<p>The host name of the LDAP server. The clients use the host name as it is configured in their binding configuration.</p>
</li>
<li>
<p>The root DN of the DirX Identity domain (for example "cn=My-Company").</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There is one deviation from these rules: the Java-based workflows that import accounts and groups use the cluster and domain attribute of the target system rather than the host name and the domain root of the LDAP server.</p>
</div>
<div class="paragraph">
<p>Make sure that the <strong>When Applicable</strong> section of the workflows contains the proper information.</p>
</div>
<div class="paragraph">
<p>The actions of the workflows depend on the entry type, the event type (add, modify or delete) and on the changed attributes. But typically they:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Apply provisioning and / or consistency rules whose filters match the entry attributes.</p>
</li>
<li>
<p>Check for broken links from the entries and especially for links to such an entry, if it has been deleted.</p>
</li>
<li>
<p>Update associated users, if a critical attribute has changed. This is particularly important if a privilege link of a business object has been added or deleted.</p>
</li>
<li>
<p>Call a user hook, if one has been configured.</p>
</li>
<li>
<p>Store the changes for the entry made during this workflow&#8217;s operation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Deploying these workflows allows you to avoid having to start a privilege resolution or consistency check workflow on a regular basis (see the section "<strong>Privilege Resolution Workflow"</strong>). The resulting privilege changes and account updates are performed in real time.</p>
</div>
<div class="paragraph">
<p>For more details on the configuration and processing of these workflows, see the following sections.</p>
</div>
<div class="sect4">
<h5 id="_ch6_accounts"><a class="anchor" href="#_ch6_accounts"></a><a class="link" href="#_ch6_accounts">6.1.1.1. Accounts</a></h5>
<div class="paragraph">
<p>The following sections describe how to configure the event-based maintenance workflow for accounts and the tasks this workflow performs.</p>
</div>
<div class="sect5">
<h6 id="_ch6_configuring_the_event_based_maintenance_workflow_for_accounts"><a class="anchor" href="#_ch6_configuring_the_event_based_maintenance_workflow_for_accounts"></a><a class="link" href="#_ch6_configuring_the_event_based_maintenance_workflow_for_accounts">6.1.1.1.1. Configuring the Event-based Maintenance Workflow for Accounts</a></h6>
<div class="paragraph">
<p>To configure the workflow:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use the Identity Manager to copy the workflow to your scenario (<strong>Connectivity</strong> &#8594; <strong>Global View</strong>).</p>
</li>
<li>
<p>Select <strong>Connectivity</strong> &#8594; <strong>Expert View</strong> and then select the copied workflow object.</p>
</li>
<li>
<p>Select the <strong>join</strong> activity and then adjust the settings in the following tabs:</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>General</strong> tab:</p>
</div>
<div class="paragraph">
<p>Enter an appropriate resource family into <strong>Resource Family</strong>. It is a good idea to have a separate resource family for this type of workflow to ensure that the corresponding threads do not compete with threads performing other workflows.</p>
</div>
<div class="paragraph">
<p>In the <strong>Error Handling</strong> section, specify the timeout for the activity, the retry limit and the waiting time between retries.</p>
</div>
<div class="paragraph">
<p><strong>Controller</strong> tab:</p>
</div>
<div class="paragraph">
<p>The join engine type <strong>AccountEventController</strong> should be selected. It automatically determines the proper class name.</p>
</div>
<div class="paragraph">
<p>If you want a user hook to be called during event processing, enter its full class name into <strong>Userhook Class Name</strong>. Make sure the library (jar file) containing your classes and all others on which they depend are deployed in the following folder beneath the installation:</p>
</div>
<div class="paragraph">
<p><em>install_path</em>/<strong>ids-j</strong>-<em>domain</em>-<strong>S</strong><em>n</em>/<strong>confdb/jobs/eventBasedRules/lib</strong></p>
</div>
<div class="paragraph">
<p>For information on how to write a user hook, see the <em>DirX Identity Customization Guide</em>.</p>
</div>
<div class="paragraph">
<p><strong>Event Attributes</strong> tab:</p>
</div>
<div class="paragraph">
<p><strong>Attributes for finding Users</strong> determines a sequence of attribute names that are used for finding the associated user of given account. Each line contains a comma-separated list of attribute names. The event controller searches for users where the values of these attributes match those of the account. If it finds exactly one, it associates the account with the user; that is, it sets the account&#8217;s user link. If it finds none or more than one user, it continues with the next list of attributes.</p>
</div>
<div class="paragraph">
<p><strong>Sort Key</strong> defines the sort attribute for sorting rules. The default value is âcnâ</p>
</div>
<div class="paragraph">
<p><strong>Sort Ascending</strong> defines the sort order ascending. The default value is âtrueâ so sorting is ascending.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In the <strong>General</strong> tab of the workflow:</p>
</li>
<li>
<p>Adjust the <strong>Is applicable for</strong> parameters. In particular, make sure <strong>type</strong> is set to the object description name <strong>SvcTSAccount</strong> and the resource and cluster are set to the server and domain name respectively.</p>
</li>
<li>
<p>Set the <strong>Active</strong> flag of the workflow.</p>
</li>
<li>
<p>Right-click the workflow object and select <strong>Load IdS-J Configuration</strong> to load the workflow into the Java-based Server.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch6_event_based_maintenance_workflow_operation_for_accounts"><a class="anchor" href="#_ch6_event_based_maintenance_workflow_operation_for_accounts"></a><a class="link" href="#_ch6_event_based_maintenance_workflow_operation_for_accounts">6.1.1.1.2. Event-based Maintenance Workflow Operation for Accounts</a></h6>
<div class="paragraph">
<p>The following figure illustrates how the event-based maintenance workflow operates for accounts:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch6_maintWFs/image2.png" alt="Event-based Maintenance Workflow Operation: Accounts">
</div>
<div class="title">Figure 63. Event-based Maintenance Workflow Operation: Accounts</div>
</div>
<div class="paragraph">
<p>The workflow performs the following operations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It checks the links from this entry to other entries. If a referenced entry cannot be found, the workflow removes the reference.</p>
</li>
<li>
<p>It applies the consistency rules whose filters match the entry&#8217;s attributes.</p>
</li>
<li>
<p>It applies the accept and cleanup rules. If one of the account&#8217;s group memberships is in the IMPORTED state and the account and the group match an accept or cleanup rule, the workflow changes the state to IGNORE or DELETED respectively. Note that this action occurs only if the memberships are stored at the account.</p>
</li>
<li>
<p>It applies the validation rules. If the account matches a validation rule&#8217;s account filter, it becomes an imported member of the respective group(s). If the account does not match the filter, but is an imported member of a matching group for no other reason, it is deleted: the membership state is changed to DELETED. This action triggers a real-time provisioning workflow and updates the state at the connected system.</p>
</li>
<li>
<p>It calls the user hook, if one is configured. The user hook has access to the affected entry and can change it. The user hook does not need to store its changes to the LDAP server because the workflow performs this task in the next step.</p>
</li>
<li>
<p>If the entry was modified, the workflow saves it to the LDAP server.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch6_organizations"><a class="anchor" href="#_ch6_organizations"></a><a class="link" href="#_ch6_organizations">6.1.1.2. Organizations</a></h5>
<div class="paragraph">
<p>This section describes how to configure the event-based maintenance workflow for organizations and the tasks this workflow performs.</p>
</div>
<div class="sect5">
<h6 id="_ch6_configuring_the_event_based_maintenance_workflow_for_organizations"><a class="anchor" href="#_ch6_configuring_the_event_based_maintenance_workflow_for_organizations"></a><a class="link" href="#_ch6_configuring_the_event_based_maintenance_workflow_for_organizations">6.1.1.2.1. Configuring the Event-based Maintenance Workflow for Organizations</a></h6>
<div class="paragraph">
<p>To configure the workflow:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use the Identity Manager to copy the workflow to your scenario (<strong>Connectivity</strong> &#8594; <strong>Global View</strong>).</p>
</li>
<li>
<p>Select <strong>Connectivity</strong> &#8594; <strong>Expert View</strong> and then select the copied workflow object.</p>
</li>
<li>
<p>Select the <strong>join</strong> activity and then adjust the settings in the following tabs:</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>General</strong> tab:</p>
</div>
<div class="paragraph">
<p>Enter a proper resource family into <strong>Resource Family</strong>. It is a good idea to have a separate resource family for this type of workflow to ensure that the corresponding threads do not compete with threads performing other workflows.</p>
</div>
<div class="paragraph">
<p>In the <strong>Error Handling</strong> section, specify the timeout for the activity, the retry limit and the waiting time between retries.</p>
</div>
<div class="paragraph">
<p><strong>Controller</strong> tab:</p>
</div>
<div class="paragraph">
<p>Select the join engine type <strong>OrganizationEventController</strong>. It automatically determines the proper class name.</p>
</div>
<div class="paragraph">
<p>If you want a user hook to be called during event processing, enter its full class name into <strong>Userhook Class Name</strong>. Make sure the library (jar file) containing your classes and all others on which they depend are deployed in the following folder beneath the installation:</p>
</div>
<div class="paragraph">
<p><em>install_path</em>/<strong>ids-j</strong>-<em>domain-</em><strong>S</strong><em>n</em>/<strong>confdb/jobs/eventBasedRules/lib</strong></p>
</div>
<div class="paragraph">
<p>For details on how to write a user hook, see the <em>DirX Identity Customization Guide</em>.</p>
</div>
<div class="paragraph">
<p><strong>Event Attributes</strong> tab:</p>
</div>
<div class="paragraph">
<p><strong>Attributes to update Users</strong> determines the list of attributes that result in the update of all associated users when one of them has been changed.</p>
</div>
<div class="paragraph">
<p><strong>Sort Key</strong> defines the sort attribute for sorting rules. The default value is âcnâ</p>
</div>
<div class="paragraph">
<p><strong>Sort Ascending</strong> defines the sort order ascending. The default value is âtrueâ so sorting is ascending.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In the <strong>General</strong> tab of the workflow:</p>
</li>
<li>
<p>Adjust the <strong>Is applicable for</strong> parameters. Make sure <strong>type</strong> is set to the object description name <strong>ctxOrganization</strong> and the resource and cluster are set to the server and domain name respectively.</p>
</li>
<li>
<p>Set the <strong>Active</strong> flag of the workflow.</p>
</li>
<li>
<p>Right-click the workflow object and select <strong>Load IdS-J Configuration</strong> to load the workflow into the Java-based Server.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch6_event_based_maintenance_workflow_operation_for_organizations"><a class="anchor" href="#_ch6_event_based_maintenance_workflow_operation_for_organizations"></a><a class="link" href="#_ch6_event_based_maintenance_workflow_operation_for_organizations">6.1.1.2.2. Event-based Maintenance Workflow Operation for Organizations</a></h6>
<div class="paragraph">
<p>The following figure illustrates how the event-based maintenance workflow operates for organizations:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch6_maintWFs/image3.png" alt="Event-based Maintenance Workflow Operation: Organizations">
</div>
<div class="title">Figure 64. Event-based Maintenance Workflow Operation: Organizations</div>
</div>
<div class="paragraph">
<p>The workflow performs the following operations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It checks the links from this entry to other entries. If a referenced entry cannot be found, the workflow removes the reference.</p>
</li>
<li>
<p>It applies the consistency rules whose filters match the entry&#8217;s attributes.</p>
</li>
<li>
<p>If the privilege link or one of the configured attributes has been changed, it updates all associated users. (Users are associated if they have a reference (dxrOrganizationLink or dxrSecOrganizationLink) to this entry.) The update contains the resolution of the user privileges and includes those privileges referenced from the organization.</p>
</li>
<li>
<p>It calls the user hook, if one is configured. The user hook has access to the affected entry and can change it. The user hook does not need to store its changes to the LDAP server because the workflow performs this task in the next step.</p>
</li>
<li>
<p>If the entry was modified, the workflow saves it to the LDAP server.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch6_organizational_units"><a class="anchor" href="#_ch6_organizational_units"></a><a class="link" href="#_ch6_organizational_units">6.1.1.3. Organizational Units</a></h5>
<div class="paragraph">
<p>The following sections describe how to configure the event-based maintenance workflow for organizational units and describe the tasks this workflow performs.</p>
</div>
<div class="sect5">
<h6 id="_ch6_configuring_the_event_based_maintenance_workflow_for_organizational_units"><a class="anchor" href="#_ch6_configuring_the_event_based_maintenance_workflow_for_organizational_units"></a><a class="link" href="#_ch6_configuring_the_event_based_maintenance_workflow_for_organizational_units">6.1.1.3.1. Configuring the Event-based Maintenance Workflow for Organizational Units</a></h6>
<div class="paragraph">
<p>To configure the workflow:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use the Identity Manager to copy the workflow to your scenario (<strong>Connectivity</strong> &#8594; <strong>Global View</strong>).</p>
</li>
<li>
<p>Select <strong>Connectivity</strong> &#8594; <strong>Expert View</strong> and then select the copied workflow object.</p>
</li>
<li>
<p>Select the <strong>join</strong> activity and then adjust the settings in the following tabs:</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>General</strong> tab:</p>
</div>
<div class="paragraph">
<p>Enter a proper resource family into <strong>Resource Family</strong>. It is a good idea to have a separate resource family for this type of workflow to ensure that the corresponding threads do not compete with threads performing other workflows.</p>
</div>
<div class="paragraph">
<p>In the <strong>Error Handling</strong> section, specify the timeout for the activity, the retry limit and the waiting time between retries.</p>
</div>
<div class="paragraph">
<p><strong>Controller</strong> tab:</p>
</div>
<div class="paragraph">
<p>Select the join engine type <strong>OUEventController</strong>. It automatically determines the proper class name.</p>
</div>
<div class="paragraph">
<p>If you want a user hook to be called during event processing, enter its full class name into <strong>Userhook Class Name</strong>. Make sure the library (jar file) containing your classes and all others on which they depend are deployed in the following folder beneath the installation:</p>
</div>
<div class="paragraph">
<p><em>install_path</em>/<strong>ids-j</strong>-<em>domain-</em><strong>S</strong><em>n</em>/<strong>confdb/jobs/eventBasedRules/lib</strong></p>
</div>
<div class="paragraph">
<p>For information on how to write a user hook, see the <em>DirX Identity Customization Guide</em>.</p>
</div>
<div class="paragraph">
<p><strong>Event Attributes</strong> tab:</p>
</div>
<div class="paragraph">
<p><strong>Attributes to update Users</strong> determines the list of attributes that result in the update of all associated users when one of them has been changed.</p>
</div>
<div class="paragraph">
<p><strong>Sort Key</strong> defines the sort attribute for sorting rules. The default value is âcnâ</p>
</div>
<div class="paragraph">
<p><strong>Sort Ascending</strong> defines the sort order ascending. The default value is âtrueâ so sorting is ascending.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In the <strong>General</strong> tab of the workflow:</p>
</li>
<li>
<p>Adjust the <strong>Is applicable for</strong> parameters. In particular, make sure <strong>type</strong> is set to the object description name <strong>ctxOrganizationalUnit</strong> and the resource and cluster are set to the server and domain name respectively.</p>
</li>
<li>
<p>Set the <strong>Active</strong> flag of the workflow.</p>
</li>
<li>
<p>Right-click the workflow object and select <strong>Load IdS-J Configuration</strong> to load the workflow into the Java-based Server.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch6_event_based_maintenance_workflow_operation_for_organizational_units"><a class="anchor" href="#_ch6_event_based_maintenance_workflow_operation_for_organizational_units"></a><a class="link" href="#_ch6_event_based_maintenance_workflow_operation_for_organizational_units">6.1.1.3.2. Event-based Maintenance Workflow Operation for Organizational Units</a></h6>
<div class="paragraph">
<p>The following figure illustrates how the event-based maintenance workflow operates for organizational units:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch6_maintWFs/image4.png" alt="Event-based Maintenance Workflow Operation: Organizational Units">
</div>
<div class="title">Figure 65. Event-based Maintenance Workflow Operation: Organizational Units</div>
</div>
<div class="paragraph">
<p>The workflow performs the following operations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It checks the links from this entry to other entries. If a referenced entry cannot be found, the workflow removes the reference.</p>
</li>
<li>
<p>It applies the consistency rules whose filters match the entry&#8217;s attributes.</p>
</li>
<li>
<p>If the privilege link or one of the configured attributes has changed, the workflow updates all associated users. Users are associated with an entry if they have a reference (dxrOrganizationalUnitLink or dxrSecOrganizationalUnitLink) to it. The update contains the resolution of the user privileges and includes those privileges referenced from the organizational unit.</p>
</li>
<li>
<p>It calls the user hook, if one is configured. The user hook has access to the affected entry and can change it. The user hook does not need to store its changes to the LDAP server because the workflow performs this task in the next step.</p>
</li>
<li>
<p>If the entry was modified, the workflow saves it to the LDAP server.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch6_context_objects"><a class="anchor" href="#_ch6_context_objects"></a><a class="link" href="#_ch6_context_objects">6.1.1.4. Context Objects</a></h5>
<div class="paragraph">
<p>The following sections describe how to configure the event-based maintenance workflow for context objects and describe the tasks this workflow performs.</p>
</div>
<div class="sect5">
<h6 id="_ch6_configuring_the_event_based_maintenance_workflow_for_context_objects"><a class="anchor" href="#_ch6_configuring_the_event_based_maintenance_workflow_for_context_objects"></a><a class="link" href="#_ch6_configuring_the_event_based_maintenance_workflow_for_context_objects">6.1.1.4.1. Configuring the Event-based Maintenance Workflow for Context Objects</a></h6>
<div class="paragraph">
<p>To configure the workflow:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use the Identity Manager to copy the workflow to your scenario (<strong>Connectivity</strong> &#8594; <strong>Global View</strong>).</p>
</li>
<li>
<p>Select <strong>Connectivity</strong> &#8594; <strong>Expert View</strong> and then select the copied workflow object.</p>
</li>
<li>
<p>Select the <strong>join</strong> activity and then adjust the settings in the following tabs:</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>General</strong> tab:</p>
</div>
<div class="paragraph">
<p>Enter a proper resource family into <strong>Resource Family</strong>. It is a good idea to have a separate resource family for this type of workflow to ensure that the corresponding threads do not compete with threads performing other workflows.</p>
</div>
<div class="paragraph">
<p>In the <strong>Error Handling</strong> section, specify the timeout for the activity, the retry limit and the waiting time between retries.</p>
</div>
<div class="paragraph">
<p><strong>Controller</strong> tab:</p>
</div>
<div class="paragraph">
<p>The join engine type <strong>ContextEventController</strong> should be selected. It automatically determines the proper class name.</p>
</div>
<div class="paragraph">
<p>If you want a user hook to be called during event processing, enter its full class name into <strong>Userhook Class Name</strong>. Make sure the library (jar file) containing your classes and all others on which they depend are deployed in the following folder beneath the installation:</p>
</div>
<div class="paragraph">
<p><em>install_path</em>/<strong>ids-j</strong>-<em>domain-</em><strong>S</strong><em>n</em>/<strong>confdb/jobs/eventBasedRules/lib</strong></p>
</div>
<div class="paragraph">
<p>For information on how to write a user hook, see the <em>DirX Identity Customization Guide</em>.</p>
</div>
<div class="paragraph">
<p><strong>Event Attributes</strong> tab:</p>
</div>
<div class="paragraph">
<p><strong>Attributes to update Users</strong> determines the list of attributes that result in the update of all associated users when one of them has been changed.</p>
</div>
<div class="paragraph">
<p><strong>Sort Key</strong> defines the sort attribute for sorting rules. The default value is âcnâ</p>
</div>
<div class="paragraph">
<p><strong>Sort Ascending</strong> defines the sort order ascending. The default value is âtrueâ so sorting is ascending.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In the <strong>General</strong> tab of the workflow:</p>
</li>
<li>
<p>Adjust the <strong>Is applicable for</strong> parameters. In particular, make sure <strong>type</strong> is set to the object description name <strong>dxrContext</strong> and the resource and cluster are set to the server and domain name respectively.</p>
</li>
<li>
<p>Set the <strong>Active</strong> flag of the workflow.</p>
</li>
<li>
<p>Right-click the workflow object and select <strong>Load IdS-J Configuration</strong> to load the workflow into the Java-based Server.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch6_event_based_maintenance_workflow_operation_for_context_objects"><a class="anchor" href="#_ch6_event_based_maintenance_workflow_operation_for_context_objects"></a><a class="link" href="#_ch6_event_based_maintenance_workflow_operation_for_context_objects">6.1.1.4.2. Event-based Maintenance Workflow Operation for Context Objects</a></h6>
<div class="paragraph">
<p>The following figure illustrates how the event-based maintenance workflow operates for context objects:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch6_maintWFs/image5.png" alt="Event-based Maintenance Workflow Operation: Context Objects">
</div>
<div class="title">Figure 66. Event-based Maintenance Workflow Operation: Context Objects</div>
</div>
<div class="paragraph">
<p>The workflow performs the following operations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It checks the links from this entry to other entries. If a referenced entry cannot be found, the workflow removes the reference.</p>
</li>
<li>
<p>It applies the consistency rules whose filters match the entry&#8217;s attributes.</p>
</li>
<li>
<p>If the privilege link or one of the configured attributes has changed, it updates all associated users. Users are associated if they have a reference (<strong>dxrContextLink</strong>) to this entry: the reference can be contained in the attributes <strong>dxrContextLink</strong> (standard) and in <strong>dxrExtensionLink1</strong>, &#8230;&#8203;, <strong>dxrExtensionLink10</strong>. The update contains resolution of the user privileges and includes those privileges referenced from the context.<br></p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The dxrExtensionLink attributes are not indexed per default. If you intend to use these links, set the corresponding directory indexes.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>It calls the user hook, if one is configured. The user hook has access to the affected entry and can change it. The user hook does not need to store its changes to the LDAP server because the workflow performs this task in the next step.</p>
</li>
<li>
<p>If the entry was modified, the workflow saves it to the directory server.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch6_location_objects"><a class="anchor" href="#_ch6_location_objects"></a><a class="link" href="#_ch6_location_objects">6.1.1.5. Location Objects</a></h5>
<div class="paragraph">
<p>The following sections describe how to configure the event-based maintenance workflow for location objects and describe the tasks this workflow performs.</p>
</div>
<div class="sect5">
<h6 id="_ch6_configuring_the_event_based_maintenance_workflow_for_location_objects"><a class="anchor" href="#_ch6_configuring_the_event_based_maintenance_workflow_for_location_objects"></a><a class="link" href="#_ch6_configuring_the_event_based_maintenance_workflow_for_location_objects">6.1.1.5.1. Configuring the Event-based Maintenance Workflow for Location Objects</a></h6>
<div class="paragraph">
<p>To configure the workflow:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use the Identity Manager to copy the workflow to your scenario (<strong>Connectivity</strong> &#8594; <strong>Global View</strong>).</p>
</li>
<li>
<p>Select <strong>Connectivity</strong> &#8594; <strong>Expert View</strong> and then select the copied workflow object.</p>
</li>
<li>
<p>Select the <strong>join</strong> activity and then adjust the settings in the following tabs:</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>General</strong> tab:</p>
</div>
<div class="paragraph">
<p>Enter a proper resource family into <strong>Resource Family</strong>. It is a good idea to have a separate resource family for this type of workflow to ensure that the corresponding threads do not compete with threads performing other workflows.</p>
</div>
<div class="paragraph">
<p>In the <strong>Error Handling</strong> section, specify the timeout for the activity, the retry limit and the waiting time between retries.</p>
</div>
<div class="paragraph">
<p><strong>Controller</strong> tab:</p>
</div>
<div class="paragraph">
<p>Select the join engine type <strong>LocationEventController</strong>. It automatically determines the proper class name.</p>
</div>
<div class="paragraph">
<p>If you want a user hook to be called during event processing, enter its full class name into <strong>Userhook Class Name</strong>. Make sure the library (jar file) containing your classes and all others on which they depend are deployed in the following folder beneath the installation:</p>
</div>
<div class="paragraph">
<p><em>install_path</em>/<strong>ids-j</strong>-<em>domain-</em><strong>S</strong><em>n</em>/<strong>confdb/jobs/eventBasedRules/lib</strong></p>
</div>
<div class="paragraph">
<p>For information on how to write a user hook, see the <em>DirX Identity Customization Guide</em>.</p>
</div>
<div class="paragraph">
<p><strong>Event Attributes</strong> tab:</p>
</div>
<div class="paragraph">
<p><strong>Attributes to update Users</strong> determines the list of attributes that result in the update of all associated users when one of them has been changed.</p>
</div>
<div class="paragraph">
<p><strong>Sort Key</strong> defines the sort attribute for sorting rules. The default value is âcnâ</p>
</div>
<div class="paragraph">
<p><strong>Sort Ascending</strong> defines the sort order ascending. The default value is âtrueâ so sorting is ascending.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In the <strong>General</strong> tab of the workflow:</p>
</li>
<li>
<p>Adjust the <strong>Is applicable for</strong> parameters. In particular, make sure <strong>type</strong> is set to the object description name <strong>ctxLocation</strong> and the resource and cluster are set to the server and domain name respectively.</p>
</li>
<li>
<p>Set the <strong>Active</strong> flag of the workflow.</p>
</li>
<li>
<p>Right-click the workflow object and select <strong>Load IdS-J Configuration</strong> to load the workflow into the Java-based Server.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch6_event_based_maintenance_workflow_operation_for_location_objects"><a class="anchor" href="#_ch6_event_based_maintenance_workflow_operation_for_location_objects"></a><a class="link" href="#_ch6_event_based_maintenance_workflow_operation_for_location_objects">6.1.1.5.2. Event-based Maintenance Workflow Operation for Location Objects</a></h6>
<div class="paragraph">
<p>The following figure illustrates how the event-based maintenance workflow operates for location objects:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch6_maintWFs/image6.png" alt="Event-based Maintenance Workflow Operation: Locations">
</div>
<div class="title">Figure 67. Event-based Maintenance Workflow Operation: Locations</div>
</div>
<div class="paragraph">
<p>The workflow performs the following operations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It checks the links from this entry to other entries. If a referenced entry cannot be found, the workflow removes the reference.</p>
</li>
<li>
<p>It applies the consistency rules whose filters match the entry&#8217;s attributes.</p>
</li>
<li>
<p>If the privilege link or one of the configured attributes has changed, it updates all associated users. Users are associated if they have a reference (dxrLocationLink or dxrSecLocationLink) to this entry. The update contains the resolution of the user privileges and includes those privileges referenced from the location.</p>
</li>
<li>
<p>It calls the user hook, if one is configured. The user hook has access to the affected entry and can change it. The user hook does not need to store its changes to the LDAP server because the workflow performs this task in the next step.</p>
</li>
<li>
<p>If the entry was modified, the workflow saves it to the LDAP server.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch6_cost_unit_objects"><a class="anchor" href="#_ch6_cost_unit_objects"></a><a class="link" href="#_ch6_cost_unit_objects">6.1.1.6. Cost Unit Objects</a></h5>
<div class="paragraph">
<p>The following sections describe how to configure the event-based maintenance workflow for cost unit objects and describe the tasks this workflow performs.</p>
</div>
<div class="sect5">
<h6 id="_ch6_configuring_the_event_based_maintenance_workflow_for_cost_unit_objects"><a class="anchor" href="#_ch6_configuring_the_event_based_maintenance_workflow_for_cost_unit_objects"></a><a class="link" href="#_ch6_configuring_the_event_based_maintenance_workflow_for_cost_unit_objects">6.1.1.6.1. Configuring the Event-based Maintenance Workflow for Cost Unit Objects</a></h6>
<div class="paragraph">
<p>To configure the workflow:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use the Identity Manager to copy the workflow to your scenario (<strong>Connectivity</strong> &#8594; <strong>Global View</strong>).</p>
</li>
<li>
<p>Select <strong>Connectivity</strong> &#8594; <strong>Expert View</strong> and then select the copied workflow object.</p>
</li>
<li>
<p>Select the <strong>join</strong> activity and then adjust the settings in the following tabs:</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>General</strong> tab:</p>
</div>
<div class="paragraph">
<p>Enter a proper resource family into <strong>Resource Family</strong>. It is a good idea to have a separate resource family for this type of workflow to ensure that the corresponding threads do not compete with threads performing other workflows.</p>
</div>
<div class="paragraph">
<p>In the <strong>Error Handling</strong> section, specify the timeout for the activity, the retry limit and the waiting time between retries.</p>
</div>
<div class="paragraph">
<p><strong>Controller</strong> tab:</p>
</div>
<div class="paragraph">
<p>Select the join engine type <strong>CostUnitEventController</strong>. It automatically determines the proper class name.</p>
</div>
<div class="paragraph">
<p>If you want a user hook to be called during event processing, enter its full class name into <strong>Userhook Class Name</strong>. Make sure the library (jar file) containing your classes and all others on which they depend are deployed in the following folder beneath the installation:</p>
</div>
<div class="paragraph">
<p><em>install_path</em>/<strong>ids-j</strong>-<em>domain</em>-<strong>S</strong><em>n</em>/<strong>confdb/jobs/eventBasedRules/lib</strong></p>
</div>
<div class="paragraph">
<p>For information on how to write a user hook, see the <em>DirX Identity Customization Guide</em>.</p>
</div>
<div class="paragraph">
<p><strong>Event Attributes</strong> tab:</p>
</div>
<div class="paragraph">
<p><strong>Attributes to update Users</strong> determines the list of attributes that result in the update of all associated users when one of them has been changed.</p>
</div>
<div class="paragraph">
<p><strong>Sort Key</strong> defines the sort attribute for sorting rules. The default value is âcnâ</p>
</div>
<div class="paragraph">
<p><strong>Sort Ascending</strong> defines the sort order ascending. The default value is âtrueâ so sorting is ascending.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In the <strong>General</strong> tab of the workflow:</p>
</li>
<li>
<p>Adjust the <strong>Is applicable for</strong> parameters. In particular, make sure <strong>type</strong> is set to the object description name <strong>dxrCostUnit</strong> and the resource and cluster are set to the server and domain name respectively.</p>
</li>
<li>
<p>Set the <strong>Active</strong> flag of the workflow.</p>
</li>
<li>
<p>Right-click the workflow object and select <strong>Load IdS-J Configuration</strong> to load the workflow into the Java-based Server.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch6_event_based_maintenance_workflow_operation_for_cost_unit_objects"><a class="anchor" href="#_ch6_event_based_maintenance_workflow_operation_for_cost_unit_objects"></a><a class="link" href="#_ch6_event_based_maintenance_workflow_operation_for_cost_unit_objects">6.1.1.6.2. Event-based Maintenance Workflow Operation for Cost Unit Objects</a></h6>
<div class="paragraph">
<p>The following figure illustrates how the event-based maintenance workflow operates for location objects:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch6_maintWFs/image7.png" alt="Event-based Maintenance Workflow Operation: Cost Units">
</div>
<div class="title">Figure 68. Event-based Maintenance Workflow Operation: Cost Units</div>
</div>
<div class="paragraph">
<p>The workflow performs the following operations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It checks the links from this entry to other entries. If a referenced entry cannot be found, the workflow removes the reference.</p>
</li>
<li>
<p>It applies the consistency rules whose filters match the entry&#8217;s attributes.</p>
</li>
<li>
<p>If the privilege link or one of the configured attributes has changed, it updates all associated users. Users are associated if they have a reference (<strong>dxrCostUnitLink</strong> or <strong>dxrSecCostUnitLink</strong>) to this entry. The update contains the resolution of the user privileges and includes those privileges referenced from the location.</p>
</li>
<li>
<p>It calls the user hook, if one is configured. The user hook has access to the affected entry and can change it. The user hook does not need to store its changes to the LDAP server because the workflow performs this task in the next step.</p>
</li>
<li>
<p>If the entry was modified, the workflow saves it to the LDAP server.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch6_project_objects"><a class="anchor" href="#_ch6_project_objects"></a><a class="link" href="#_ch6_project_objects">6.1.1.7. Project Objects</a></h5>
<div class="paragraph">
<p>The following sections describe how to configure the event-based maintenance workflow for project objects and describe the tasks this workflow performs.</p>
</div>
<div class="sect5">
<h6 id="_ch6_configuring_the_event_based_maintenance_workflow_for_project_objects"><a class="anchor" href="#_ch6_configuring_the_event_based_maintenance_workflow_for_project_objects"></a><a class="link" href="#_ch6_configuring_the_event_based_maintenance_workflow_for_project_objects">6.1.1.7.1. Configuring the Event-based Maintenance Workflow for Project Objects</a></h6>
<div class="paragraph">
<p>To configure the workflow:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use the Identity Manager to copy the workflow to your scenario (<strong>Connectivity</strong> &#8594; <strong>Global View</strong>).</p>
</li>
<li>
<p>Select <strong>Connectivity</strong> &#8594; <strong>Expert View</strong> and then select the copied workflow object.</p>
</li>
<li>
<p>Select the <strong>join</strong> activity and then adjust the settings in the following tabs:</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>General</strong> tab:</p>
</div>
<div class="paragraph">
<p>Enter a proper resource family into <strong>Resource Family</strong>. It is a good idea to have a separate resource family for this type of workflow to ensure that the corresponding threads do not compete with threads performing other workflows.</p>
</div>
<div class="paragraph">
<p>In the <strong>Error Handling</strong> section, specify the timeout for the activity, the retry limit and the waiting time between retries.</p>
</div>
<div class="paragraph">
<p><strong>Controller</strong> tab:</p>
</div>
<div class="paragraph">
<p>Select the join engine type <strong>ProjectEventController</strong>. It automatically determines the proper class name.</p>
</div>
<div class="paragraph">
<p>If you want a user hook to be called during event processing, enter its full class name into <strong>Userhook Class Name</strong>. Make sure the library (jar file) containing your classes and all others on which they depend are deployed in the following folder beneath the installation:</p>
</div>
<div class="paragraph">
<p><em>install_path</em>/<strong>ids-j</strong>-<em>domain-</em><strong>S</strong><em>n</em>/<strong>confdb/jobs/eventBasedRules/lib</strong></p>
</div>
<div class="paragraph">
<p>For information on how to write a user hook, see the <em>DirX Identity Customization Guide</em>.</p>
</div>
<div class="paragraph">
<p><strong>Event Attributes</strong> tab:</p>
</div>
<div class="paragraph">
<p><strong>Attributes to update Users</strong> determines the list of attributes that result in the update of all associated users when one of them has been changed.</p>
</div>
<div class="paragraph">
<p><strong>Sort Key</strong>: defines the sort attribute for sorting rules. The default value is âcnâ</p>
</div>
<div class="paragraph">
<p><strong>Sort Ascending</strong>: defines the sort order ascending. The default value is âtrueâ so sorting is ascending.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In the <strong>General</strong> tab of the workflow:</p>
</li>
<li>
<p>Adjust the <strong>Is applicable for</strong> parameters. In particular, make sure <strong>type</strong> is set to the object description name <strong>dxrProject</strong> and the resource and cluster are set to the server and domain name respectively.</p>
</li>
<li>
<p>Set the <strong>Active</strong> flag of the workflow.</p>
</li>
<li>
<p>Right-click the workflow object and select <strong>Load IdS-J Configuration</strong> to load the workflow into the Java-based Server.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch6_event_based_maintenance_workflow_operation_for_projects"><a class="anchor" href="#_ch6_event_based_maintenance_workflow_operation_for_projects"></a><a class="link" href="#_ch6_event_based_maintenance_workflow_operation_for_projects">6.1.1.7.2. Event-based Maintenance Workflow Operation for Projects</a></h6>
<div class="paragraph">
<p>The following figure illustrates how the event-based maintenance workflow operates for project objects:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch6_maintWFs/image8.png" alt="Event-based Maintenance Workflow Operation: Projects">
</div>
<div class="title">Figure 69. Event-based Maintenance Workflow Operation: Projects</div>
</div>
<div class="paragraph">
<p>The workflow performs the following operations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It checks the links from this entry to other entries. If a referenced entry cannot be found, the workflow removes the reference.</p>
</li>
<li>
<p>It applies the consistency rules whose filters match the entry&#8217;s attributes.</p>
</li>
<li>
<p>If the privilege link or one of the configured attributes has changed, it updates all associated users. Users are associated if they have a reference (<strong>dxrProjectLink</strong>) to this entry. The update contains the resolution of the user privileges and includes those privileges referenced from the project.</p>
</li>
<li>
<p>It calls the user hook, if one is configured. The user hook has access to the affected entry and can change it. The user hook does not need to store its changes to the LDAP server because the workflow performs this task in the next step.</p>
</li>
<li>
<p>If the entry was modified, the workflow saves it to the LDAP server.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch6_users"><a class="anchor" href="#_ch6_users"></a><a class="link" href="#_ch6_users">6.1.1.8. Users</a></h5>
<div class="paragraph">
<p>The event-based maintenance workflow for users accepts user change events, applies provisioning and consistency rules, resolves the users as far as necessary and updates the account attributes. Deploying this workflow allows you to avoid having to start a privilege resolution workflow on a regular basis (see the section "Privilege Resolution Workflow"). The resulting privilege changes and account updates are performed in real time. If no relevant attributes are changed, users are not resolved and accounts are not updated; this procedure may save a lot of time. You only need privilege resolution if you change the role hierarchy or group attributes and defer the resolution of affected users. The resolution or propagation process in the previous step can start additional provisioning processes to connected systems.</p>
</div>
<div class="sect5">
<h6 id="_ch6_configuring_the_event_based_user_resolution_workflow"><a class="anchor" href="#_ch6_configuring_the_event_based_user_resolution_workflow"></a><a class="link" href="#_ch6_configuring_the_event_based_user_resolution_workflow">6.1.1.8.1. Configuring the Event-based User Resolution Workflow</a></h6>
<div class="paragraph">
<p>To configure the workflow:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use the Identity Manager to copy the workflow to your scenario (<strong>Connectivity</strong> &#8594; <strong>Global View</strong>).</p>
</li>
<li>
<p>Select <strong>Connectivity</strong> &#8594; <strong>Expert View</strong> and then select the copied workflow object.</p>
</li>
<li>
<p>Select the <strong>join</strong> activity and then select the <strong>Event Attributes</strong> tab. Adjust the following configuration items, which determine when accounts are to be updated:</p>
</li>
<li>
<p><strong>Attributes to include:</strong> defines all attributes that should be processed.</p>
</li>
<li>
<p><strong>Attributes to ignore:</strong> defines all attributes that should be ignored, if they are not in the previous set</p>
</li>
<li>
<p><strong>Attribute prefixes to include:</strong> defines the prefixes to use to update attributes; all attributes starting with these prefixes result in account update if they are not in the "ignore" list.</p>
</li>
<li>
<p><strong>Attribute prefixes to ignore:</strong> defines the prefixes to use to ignore attributes; if the attributes are not in any of the previous lists, but match one of these prefixes, they are ignored.</p>
</li>
<li>
<p><strong>Searchbase for Consistency Rules</strong>: defines the top level folder of the consistency rules that the workflow performs.</p>
</li>
<li>
<p><strong>Searchbase for Provisioning Rules</strong>: defines the top level folder of the provisioning rules that the workflow performs. Note that the rules must contain all grant- and deny rules for a given privilege, because they are executed in one common algorithm.</p>
</li>
<li>
<p><strong>Sort Key</strong> defines the sort attribute for sorting rules. The default value is âcnâ</p>
</li>
<li>
<p><strong>Sort Ascending</strong> defines the sort order ascending. The default value is âtrueâ so sorting is ascending.</p>
</li>
<li>
<p>In the <strong>General</strong> tab of the workflow, set the <strong>Active</strong> flag.</p>
</li>
<li>
<p>Right-click the workflow object and then select <strong>Load IdS-J Configuration</strong> to load the workflow into the Java-based Server.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch6_event_based_user_resolution_workflow_operation"><a class="anchor" href="#_ch6_event_based_user_resolution_workflow_operation"></a><a class="link" href="#_ch6_event_based_user_resolution_workflow_operation">6.1.1.8.2. Event-based User Resolution Workflow Operation</a></h6>
<div class="paragraph">
<p>The following figure illustrates how the event-based user resolution workflow operates:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch6_maintWFs/image9.png" alt="Event-based User Resolution Workflow Operation">
</div>
<div class="title">Figure 70. Event-based User Resolution Workflow Operation</div>
</div>
<div class="paragraph">
<p>The workflow performs the following operations for an add or modify event:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It checks the links from this entry to other entries. If a referenced entry cannot be found, the workflow removes the reference.</p>
</li>
<li>
<p>It applies the consistency rules whose filters match the entry&#8217;s attributes.</p>
</li>
<li>
<p>It calls the user hook, if one is configured. The user hook has access to the affected entry and can change it. The user hook should not store its changes to the LDAP server because the workflow performs this task in the next step.</p>
</li>
<li>
<p>The workflow applies the matching provisioning rules, assigns new privileges or removes existing privilege assignments based on the new attribute values and at the end resolves the user, if either in the received event or after applying rules and user hook</p>
<div class="ulist">
<ul>
<li>
<p>at least one of the changed attributes is among the domain&#8217;s permission parameters,</p>
</li>
<li>
<p>is a state attribute,</p>
</li>
<li>
<p>a date,</p>
</li>
<li>
<p>a privilege link</p>
</li>
<li>
<p>or the attribute dxrTBA is enabled.</p>
</li>
</ul>
</div>
</li>
<li>
<p>If the user was modified, the workflow stores it to the LDAP server.</p>
</li>
<li>
<p>If one of the attributes has changed that are configured as to be included in the <strong>Event Attributes</strong> tab of the activity, the attributes of the user&#8217;s accounts are updated. This step applies particularly to attributes that are mastered by the user. The user is not resolved.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The rules on when to update accounts are as follows: accounts are updated if at least one of the changed attributes</p>
</div>
<div class="ulist">
<ul>
<li>
<p>is among the configured "include" parameters;</p>
</li>
<li>
<p>matches an "include prefix", but is not among the "ignore" parameters;</p>
</li>
<li>
<p>doesn&#8217;t match any of the "ignore" and "ignore prefix" parameters.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If a delete event is received, the workflow:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Removes links from associated entries to the deleted entry</p>
</li>
<li>
<p>Calls the user hook.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch6_personas"><a class="anchor" href="#_ch6_personas"></a><a class="link" href="#_ch6_personas">6.1.1.9. Personas</a></h5>
<div class="paragraph">
<p>The event-based maintenance workflow for personas accepts persona change events, applies provisioning and consistency rules, resolves the personas as far as necessary and updates the account attributes.</p>
</div>
<div class="paragraph">
<p>Since personas are just another representation of users, the PersonaResolverController uses the same implementation as the UserResolverController. The PersonaResolverController uses an additional configuration field <strong>Link Attribute for Owner</strong> in the join activityâs <strong>Event Attributes</strong> tab. It uses this attribute (owner) to check if attributes that are mastered from the owner are part of the eventâs modifications. In this case, the persona is saved to update this set of attributes.</p>
</div>
<div class="paragraph">
<p>The use of different workflows for users, personas and functional users enables the use of different folders for consistency rules and provisioning rules for the three user representations.</p>
</div>
<div class="paragraph">
<p>All other aspects of event-based maintenance workflow for personas are common to the event-based maintenance workflow for users, as described in the section "Users".</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch6_functional_users"><a class="anchor" href="#_ch6_functional_users"></a><a class="link" href="#_ch6_functional_users">6.1.1.10. Functional Users</a></h5>
<div class="paragraph">
<p>The event-based maintenance workflow for functional users accepts functional user change events, applies provisioning and consistency rules, resolves the functional users as far as necessary and updates the account attributes.</p>
</div>
<div class="paragraph">
<p>Since functional users are just another representation of users, the FunctionalUserResolverController uses the same implementation as the UserResolverController. The FunctionalUserResolverController uses an additional configuration field <strong>Link Attribute for Sponsor</strong> in the join activityâs <strong>Event Attributes</strong> tab. It uses this attribute (dxrSponsor) to check if attributes that are mastered from the sponsor are part of the eventâs modifications. In this case, the functional user is saved to update this set of attributes.</p>
</div>
<div class="paragraph">
<p>The use of different workflows for users, personas and functional users enables the use of different folders for consistency rules and provisioning rules for the three user representations.</p>
</div>
<div class="paragraph">
<p>All other aspects of event-based maintenance workflow for functional users are common to the event-based maintenance workflow for users as described in the section "Users".</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch6_generic_objects"><a class="anchor" href="#_ch6_generic_objects"></a><a class="link" href="#_ch6_generic_objects">6.1.1.11. Generic Objects</a></h5>
<div class="paragraph">
<p>The following sections describe how to configure a generic event-based maintenance workflow for any object type and describe the tasks this workflow performs. Typical use of this workflow is to run consistency rules after an object is created or modified.</p>
</div>
<div class="sect5">
<h6 id="_ch6_configuring_the_generic_event_based_processing_workflow"><a class="anchor" href="#_ch6_configuring_the_generic_event_based_processing_workflow"></a><a class="link" href="#_ch6_configuring_the_generic_event_based_processing_workflow">6.1.1.11.1. Configuring the Generic Event-based Processing Workflow</a></h6>
<div class="paragraph">
<p>Configuration is possible for any type of object. Use the object description name to define the applicability of the workflow.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>You want to run consistency rules whenever a role is created or modified.</p>
</div>
<div class="paragraph">
<p>Then you must perform the following steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Login into the Provisioning view group of the DirX Identity Manager.</p>
</li>
<li>
<p>Configure or extend the event policy: add <strong>dxrRole</strong> to the Selected area in the <strong>Configuration</strong> tab.<br>
Note that dxrRole is the standard name of the role object description. If you use several different types of object descriptions, use the appropriate object description name here.</p>
</li>
<li>
<p>Create a folder for the consistency rules to be run with this workflow. Create the consistency rules in this folder.</p>
</li>
<li>
<p>Create a new event-based processing workflow:</p>
</li>
<li>
<p>Log in into the <strong>Connectivity</strong> view group of the DirX Identity Manager.</p>
</li>
<li>
<p>Click <strong>Global View</strong> and then select the scenario where you want to create the workflow.</p>
</li>
<li>
<p>Click the line between the two <strong>Identity Stores</strong> and select <strong>New</strong> from the context menu.</p>
</li>
<li>
<p>Select the <strong>GenericEventBasedProcessing</strong> template and click <strong>Next</strong>.</p>
</li>
<li>
<p>In the <strong>General Workflow Info</strong> tab define a name and a description, set the active flag.</p>
</li>
<li>
<p>In the <strong>Is applicable</strong> section configure <strong>dxrRole</strong> as <strong>Type</strong>. As above, use here the object description name that defines your object. Set the Cluster field to '*'.</p>
</li>
<li>
<p>In the <strong>Event parameters</strong> tab set the path to the folder with your previously created consistency rules (<strong>Searchbase for Consistency Rules</strong>).</p>
</li>
<li>
<p>Click <strong>Next</strong> and then <strong>Finish</strong>.</p>
</li>
<li>
<p>Perform <strong>Load IdS-J Configuration</strong> to load the newly created workflow into the Java-based Server.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>Now your workflow is ready to be tested.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch6_generic_event_based_processing_workflow_operation"><a class="anchor" href="#_ch6_generic_event_based_processing_workflow_operation"></a><a class="link" href="#_ch6_generic_event_based_processing_workflow_operation">6.1.1.11.2. Generic Event-based Processing Workflow Operation</a></h6>
<div class="paragraph">
<p>The following figure illustrates how the generic event-based processing workflow operates:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch6_maintWFs/image10.png" alt="Generic Event-based Processing Workflow Operation">
</div>
<div class="title">Figure 71. Generic Event-based Processing Workflow Operation</div>
</div>
<div class="paragraph">
<p>The workflow performs the following operations for an add or modify event:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It applies the consistency rules whose filters match the entry&#8217;s attributes.</p>
</li>
<li>
<p>It calls the user hook, if one is configured. The user hook has access to the affected entry and can change it. The user hook does not need to store its changes to the LDAP server because the workflow performs this task in the next step.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If a delete event is received, the workflow:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Calls the user hook.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch6_process_tickets_internal_workflow"><a class="anchor" href="#_ch6_process_tickets_internal_workflow"></a><a class="link" href="#_ch6_process_tickets_internal_workflow">6.1.2. Process Tickets Internal Workflow</a></h4>
<div class="paragraph">
<p>The Process Tickets Internal workflow runs regularly and processes all tickets where the condition for processing is fulfilled. The figure shows the architecture.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch6_maintWFs/image11.png" alt="Process Tickets Internal Workflow">
</div>
<div class="title">Figure 72. Process Tickets Internal Workflow</div>
</div>
<div class="paragraph">
<p>The Process Tickets Internal workflow runs typically scheduled and performs these steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It reads all tickets that are to process.</p>
</li>
<li>
<p>It processes the tickets.</p>
</li>
<li>
<p>Processing of a ticket might trigger other processes, for example a privilege resolution on a user object. In this case other objects might be created and messages for further processing might be initiated (for example provisioning requests).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For a detailed definition of the procedure see the "Process Tickets Internal Workflow Operation" chapter.</p>
</div>
<div class="sect4">
<h5 id="_ch6_configuring_the_process_tickets_internal_workflow"><a class="anchor" href="#_ch6_configuring_the_process_tickets_internal_workflow"></a><a class="link" href="#_ch6_configuring_the_process_tickets_internal_workflow">6.1.2.1. Configuring the Process Tickets Internal Workflow</a></h5>
<div class="paragraph">
<p>To configure the workflow:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use the Identity Manager to copy the workflow to your scenario (<strong>Connectivity</strong> &#8594; <strong>Global View</strong>).</p>
</li>
<li>
<p>Select your scenario (if not yet present, use the target system wizard from the Provisioning view group to create the scenario).</p>
</li>
<li>
<p>Click the workflow line between the Identity Stores and select <strong>New</strong> from the context menu.</p>
</li>
<li>
<p>Select the <strong>ProcessTicketsInternal</strong> workflow template and then click <strong>Next</strong>.</p>
</li>
<li>
<p>Define the <strong>Name</strong> and <strong>Description</strong> fields and set the <strong>Is</strong> <strong>Active</strong> flag.</p>
</li>
<li>
<p>Click <strong>Next</strong> and then <strong>Finish</strong> to complete the copy operation.</p>
</li>
<li>
<p>Perform <strong>Load IdS-J Configuration</strong> to load the workflow into the Java-based Server.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Now you can run the workflow either by hand or regularly triggered by a schedule.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch6_process_tickets_internal_workflow_operation"><a class="anchor" href="#_ch6_process_tickets_internal_workflow_operation"></a><a class="link" href="#_ch6_process_tickets_internal_workflow_operation">6.1.2.2. Process Tickets Internal Workflow Operation</a></h5>
<div class="paragraph">
<p>The Process Tickets Internal workflow works in two steps:</p>
</div>
<div class="paragraph">
<p>Procedure on Request Workflows That are Related to Tickets</p>
</div>
<div class="ulist">
<ul>
<li>
<p>During each run, it checks the status (state and application state) of all request workflows that are associated to tickets.</p>
</li>
<li>
<p>It sets the state of the ticket accordingly. This means that:</p>
</li>
<li>
<p>Workflow <strong>State=RUNNING</strong>: ticket state is not changed</p>
</li>
<li>
<p>Workflow <strong>State=SUCCEEDED</strong> and <strong>Application State=ACCEPTED</strong>: ticket <strong>State=Approval.Completed</strong></p>
</li>
<li>
<p>Workflow <strong>State=SUCCEEDED</strong> and <strong>Application State=REJECTED</strong>: ticket <strong>State=Approval.Rejected</strong></p>
</li>
<li>
<p>Workflow <strong>State=FAILED.</strong>*: ticket <strong>State=Approval.Error</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Procedure on Tickets</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It reads all tickets where the due date is reached.</p>
</li>
<li>
<p>It processes the ticket:</p>
</li>
<li>
<p>For ticket <strong>State=Approval.Completed</strong> it actualizes the order data from the workflow instance and then it processes the ticket.</p>
</li>
<li>
<p>For ticket <strong>State=Input.Completed</strong> it processes the ticket.</p>
</li>
<li>
<p>Processing the ticket means that the ticket data is applied to the subject; for example, the service changes some attributes at a user entry or some privilege assignments are assigned to a user.</p>
</li>
<li>
<p>If necessary, the subject is further processed; for example, a privilege resolution is performed for a user entry to calculate any changes coming from changed attributes or privilege assignments. Other processes might be triggered via JMS messages; for example, real-time provisioning to connected systems.</p>
</li>
<li>
<p>After successful processing, it sets the ticket <strong>State=ApplyChange.Completed</strong>. and the <strong>DeleteDate</strong>=<em>today</em>+<strong>TicketLifeTime</strong> where Ticket Life Time is the defined value at the domain object.</p>
</li>
<li>
<p>If an error occurs during processing, it does not change the status.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch6_account_password_manager_workflow"><a class="anchor" href="#_ch6_account_password_manager_workflow"></a><a class="link" href="#_ch6_account_password_manager_workflow">6.1.3. Account Password Manager Workflow</a></h4>
<div class="paragraph">
<p>The Account Password Manager workflow creates new passwords for DirX Identity accounts after the old password has expired. The following figure illustrates this workflow.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch6_maintWFs/image12.png" alt="Account Password Management: Account Password Manager Workflow">
</div>
<div class="title">Figure 73. Account Password Management: Account Password Manager Workflow</div>
</div>
<div class="paragraph">
<p>If run scheduled, the <strong>Account Password Manager</strong> workflow searches for accounts with expired passwords according to the configured search settings, it generates a new password, stores it at the account if it is privileged and triggers the target system-specific password change workflows (setPassword workflow).</p>
</div>
<div class="paragraph">
<p>If run event-based, it handles "password expired" events (topic dxm.event.SvcTSAccount.pwd.expired) and "password changed" events (topic dxm.event.SvcTSAccount.pwd.changed). For a password expired event, it generates a new password, stores it at the account if it is privileged and sets the password reset flag to false. For a password changed event, it takes the password from the event, changes it at the account if it is privileged and sets the password reset flag as desired in the event. In both cases, it then triggers the target system-specific password change (setPassword) workflow.</p>
</div>
<div class="paragraph">
<p>Note that the message topics can contain a domain extension. For more information, see the section "Message Topics" in the <em>DirX Identity Connectivity Administration Guide</em>.</p>
</div>
<div class="sect4">
<h5 id="_ch6_configuring_the_account_password_manager_workflow"><a class="anchor" href="#_ch6_configuring_the_account_password_manager_workflow"></a><a class="link" href="#_ch6_configuring_the_account_password_manager_workflow">6.1.3.1. Configuring the Account Password Manager Workflow</a></h5>
<div class="paragraph">
<p>To run the Account Password Manager workflow successfully, you must perform these steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use the Identity Manager to copy the workflow to your scenario (<strong>Connectivity</strong> &#8594; <strong>Global View</strong>).</p>
</li>
<li>
<p>Select <strong>Connectivity</strong> &#8594; <strong>Expert View</strong> and then select the copied workflow object.</p>
</li>
<li>
<p>Select the <strong>join</strong> activity and then select the <strong>Controller</strong> tab. Adjust the settings in this tab as follows:</p>
</li>
<li>
<p>Set the search base to the desired value.</p>
</li>
<li>
<p>Do not change the scope and filter.</p>
</li>
<li>
<p>Set the correct <strong>Domain</strong> (default: <strong>My-Company</strong>).</p>
</li>
<li>
<p>Set the parameter <strong>Days before Expiration</strong> (default: 1 day).</p>
</li>
<li>
<p>Set the parameter <strong>Keep Password History at the Account</strong> to true if you want to keep a password history at the account. The history is then used to check if the new password has not been used in the past <em>x</em> times where <em>x</em> is defined by the policy. This history keeping is performed by default for privileged accounts but not otherwise.</p>
</li>
<li>
<p>Do not change the topic prefix for the "to be built" request that triggers the setPassword workflows.</p>
</li>
<li>
<p>If you want to use own attributes sent to the <strong>setPassword</strong> workflow, which uses them for resolving placeholders in itâs <strong>Notify</strong> activity, right click the <strong>join</strong> activity and choose <strong>Edit Content</strong>. Go to the controller section of the <strong>PwdAccountExpireController</strong> and add the multi-value property <strong>accountAttrs</strong> with the desired attribute list outside the operation section.</p>
</li>
<li>
<p>Set the <strong>Active</strong> flag of the workflow.</p>
</li>
<li>
<p>Right-click the workflow object and select <strong>Load IdS-J Configuration</strong> to load the workflow into the Java-based Server.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch6_account_password_manager_workflow_operation"><a class="anchor" href="#_ch6_account_password_manager_workflow_operation"></a><a class="link" href="#_ch6_account_password_manager_workflow_operation">6.1.3.2. Account Password Manager Workflow Operation</a></h5>
<div class="paragraph">
<p>Password expiration for privileged or personal accounts (see the <em>DirX Identity Provisioning Administration Guide</em> for more information on these accounts) depends on the assigned account password policies and on a set of attributes at the policy and the account.</p>
</div>
<div class="paragraph">
<p>If run scheduled, the workflow searches for accounts with expired passwords according to the configured search settings. It generates a new password, stores it at the account if it is privileged and triggers the target system-specific setPassword workflow. If run event-based, it handles "password expired" and "password changed" requests for a specific account and then proceeds as in the scheduled case.</p>
</div>
<div class="paragraph">
<p>The password policy is assigned via the password policy link (attribute dxrPwdPolicyLink). If no password policy is assigned, the default password policy is used.</p>
</div>
<div class="paragraph">
<p>The expiration calculation depends on the following attributes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>dxrPwdMaxAge</strong> at the password policy, which defines the maximum allowed age of the password.</p>
</li>
<li>
<p><strong>Days before expire</strong> at the join activity, which specifies the time when to reset the account passwords before they expire. If the specified number of days before expiration is reached or passed for an account password, the workflow resets that password.</p>
</li>
<li>
<p><strong>dxrPwdChangedTime</strong> at the account, which specifies the last time the password was changed.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the current date is greater than the value (dxrPwdChangedTime+pwdMaxAge-Days before expire), the workflow sets the password to a randomly-generated new value. The password reset flag is not set and the dxrPwdChangedTime is set to the current date and time.</p>
</div>
<div class="paragraph">
<p>The workflow generates a password change event that is to be processed by the corresponding setPassword workflow.</p>
</div>
<div class="paragraph">
<p>The identifier attributes of the password change event are set either with the attributes configured in the multi-value property <strong>accountAttrs</strong> described above or if not specified (default) with the default list of attributes described in the <strong>setPassword Notify</strong> activity (see "Context-senitive Help &#8594; Java-based Workflows &#8594; Real-time Port &#8594; Notification (optional)" (for Java-based Set Password Workflows) in the <em>DirX Identity Connectivity Administration Guide</em> for details). These attributes - for example mail, cn, sn or givenName - can be used as placeholders (for example, $\{IDATTR(mail)} ) in the <strong>to</strong>, <strong>from</strong> or <strong>body</strong> fields of the <strong>Notify</strong> activity.</p>
</div>
<div class="paragraph">
<p>If <strong>accountAttrs</strong> are specified, they are extended by the list of the above-mentioned default attributes if not already contained. The attributes "dxrPwdChangedTime","dxrPwdPolicyLink","dxrTSState","dxrName" and "dxrPrimaryKey" are also appended by the <strong>Account Password Manager</strong> and the <strong>Reset Account Passwords</strong> workflows and can therefore also be used as placeholder attributes for notification messages.</p>
</div>
<div class="paragraph">
<p>Note that the accountAttrs must be specified in the controller section outside the operation section. For example, set:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;controller className="com.siemens.dxm.pwdexpire.PwdAccountExpireController"&gt;
  &lt;mvproperty name="accountAttrs"&gt;
    &lt;value&gt;description&lt;/value&gt;
    &lt;value&gt;givenName&lt;/value&gt;
  &lt;/mvproperty&gt;
  &lt;operation&gt;
    &lt;property name="searchBase" value="...â /&gt;
    ...
  &lt;/operation&gt;
&lt;/controller&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>if you want to add the attributes description and givenName to the default list of identifier attributes.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch6_reset_account_passwords_workflow"><a class="anchor" href="#_ch6_reset_account_passwords_workflow"></a><a class="link" href="#_ch6_reset_account_passwords_workflow">6.1.4. Reset Account Passwords Workflow</a></h4>
<div class="paragraph">
<p>The Reset Account Passwords workflow resets passwords of DirX Identity accounts. This workflow can be used if a restore of a connected system has occurred, for example, due to a system failure that required restoration of the previous backup. The following figure illustrates this workflow.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch6_maintWFs/image13.png" alt="Account Password Management: Reset Account Passwords Workflow">
</div>
<div class="title">Figure 74. Account Password Management: Reset Account Passwords Workflow</div>
</div>
<div class="paragraph">
<p>The Reset Account Passwords workflow runs only scheduled and searches for accounts according to the configured search settings. When the account is privileged, the workflow generates a new password and stores it at the account. Otherwise it takes the password from the referenced user. Then it triggers the target system-specific password change (setPassword) workflow.</p>
</div>
<div class="sect4">
<h5 id="_ch6_configuring_the_reset_account_passwords_workflow"><a class="anchor" href="#_ch6_configuring_the_reset_account_passwords_workflow"></a><a class="link" href="#_ch6_configuring_the_reset_account_passwords_workflow">6.1.4.1. Configuring the Reset Account Passwords Workflow</a></h5>
<div class="paragraph">
<p>To configure the workflow:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use the Identity Manager to copy the workflow to your scenario (<strong>Connectivity</strong> &#8594; <strong>Global View</strong>).</p>
</li>
<li>
<p>Select <strong>Connectivity</strong> &#8594; <strong>Expert View</strong> and then select the copied workflow object.</p>
</li>
<li>
<p>Select the <strong>join</strong> activity and then select the <strong>Controller</strong> tab. Adjust the following settings in this tab:</p>
</li>
<li>
<p>Set the search base to the desired value.</p>
</li>
<li>
<p>Set the filter accordingly. By default, the workflow selects all objects of type <strong>dxrTargetSystemAccount</strong> with <strong>dxrType=Privileged</strong>. Set <strong>dxrType=Personal</strong> if you intend to handle personal accounts.</p>
</li>
<li>
<p>Set the correct <strong>Domain</strong> (default: <strong>My-Company</strong>).</p>
</li>
<li>
<p>If you want to use own attributes sent to the <strong>setPassword</strong> workflow, which uses them for resolving placeholders in its <strong>Notify</strong> activity, right click the <strong>join</strong> activity and choose <strong>Edit Content</strong>. Go to the controller section of the <strong>PwdAccountResetController</strong> and add the multi value property <strong>accountAttrs</strong> with the desired attribute list outside the operation section.</p>
</li>
<li>
<p>Set the <strong>Active</strong> flag of the workflow.</p>
</li>
<li>
<p>Right-click the workflow object and then select <strong>Load IdS-J Configuration</strong> to load the workflow into the Java-based Server.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch6_reset_account_passwords_workflow_operation"><a class="anchor" href="#_ch6_reset_account_passwords_workflow_operation"></a><a class="link" href="#_ch6_reset_account_passwords_workflow_operation">6.1.4.2. Reset Account Passwords Workflow Operation</a></h5>
<div class="paragraph">
<p>The Reset Account Passwords workflow searches for accounts according to the configured search settings. Depending on the account type, the workflow performs these actions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For a personal account, it reads the password from the user. The password reset flag is set accordingly to the user&#8217;s password reset flag.</p>
</li>
<li>
<p>For a privileged account, it generates a new password and sets it at the account. The password reset flag is set to true.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The workflow generates a password change event that is to be processed by the corresponding setPassword workflow. . For the list of identifier attributes contained in the password change event and used by the <strong>setPassword</strong> workflow to resolve placeholders for the notification messages see the description in the "Account Password Manager Workflow" section above. For more information on personal and privileged accounts, see the <em>DirX Identity Provisioning Administration Guide</em>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch6_reset_password_if_displayed_workflow"><a class="anchor" href="#_ch6_reset_password_if_displayed_workflow"></a><a class="link" href="#_ch6_reset_password_if_displayed_workflow">6.1.5. Reset Password If Displayed Workflow</a></h4>
<div class="paragraph">
<p>The Reset Password If Displayed workflow resets passwords of privileged DirX Identity accounts. This workflow can be used if the password of a privileged account has been read and must be changed within a given time frame (for example, within 24 hours).</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch6_maintWFs/image14.png" alt="Account Password Management: Reset Password If Displayed Workflow">
</div>
<div class="title">Figure 75. Account Password Management: Reset Password If Displayed Workflow</div>
</div>
<div class="paragraph">
<p>The Reset Password If Displayed workflow only runs scheduled. Alternatively, it can be started directly using the <strong>Run Workflow</strong> menu operation in the DirX Identity Manager. It searches for (privileged) accounts according to the configured search settings where the password has been displayed before the last <em>n</em> hours (see the option <strong>Hours before Reset</strong>). For each such account, it generates a new password. If the account is privileged, it stores the password at the account. It then triggers the password change (setPassword) workflow that is responsible for this target system.</p>
</div>
<div class="sect4">
<h5 id="_ch6_configuring_the_reset_password_if_displayed_workflow"><a class="anchor" href="#_ch6_configuring_the_reset_password_if_displayed_workflow"></a><a class="link" href="#_ch6_configuring_the_reset_password_if_displayed_workflow">6.1.5.1. Configuring the Reset Password If Displayed Workflow</a></h5>
<div class="paragraph">
<p>To configure the workflow:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use the Identity Manager to copy the workflow to your scenario (<strong>Connectivity</strong> &#8594; <strong>Global View</strong>).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The workflow wizard guides you through all the required configuration steps. It displays the following steps:</p>
</div>
<div class="paragraph">
<p><strong>Template</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Select the <strong>Reset Password If Displayed</strong> workflow</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>General Info</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Set the workflow name (<strong>Name</strong> field).</p>
</li>
<li>
<p>Set the <strong>Is Active</strong> flag.</p>
</li>
<li>
<p>Adapt the workflow timeout (<strong>Timeout</strong> field).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Join Activity General Info</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Assign the resource family, if necessary (<strong>Resource family</strong> field).</p>
</li>
<li>
<p>Adapt the <strong>Error Handling</strong> parameters, if necessary (<strong>Timeout</strong>, <strong>Retry Limit</strong>, <strong>Wait before Retry</strong> fields).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Join Activity Search Parameters / Days before Reset</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Adapt the parameters for retrieving the privileged accounts (<strong>Search Base</strong>, <strong>Scope</strong>, <strong>Filter</strong>).</p>
</li>
<li>
<p>Adapt the <strong>Hours before Reset</strong> parameter.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This parameter defines the minimum time in hours that must have passed before the password is reset. The time at which the password was read is stored in the attribute dxrPwdDisplayTime. A parameter value <strong>0</strong> implies that all accounts are searched where the attribute dxrPwdDisplayTime is set. A value &gt; <strong>0</strong> defines the number of hours that must have passed from now so that the account will be part of the search result.</p>
</div>
<div class="paragraph">
<p><strong>Set Workflow Name</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Set the workflow name, if not yet done in the <strong>General Info</strong> step (<strong>Name</strong> field).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Once the workflow has been created successfully, select <strong>Connectivity</strong> &#8594; <strong>Expert View</strong> and then select the copied workflow object.</p>
</div>
<div class="paragraph">
<p>Right-click the workflow object and then select <strong>Load IdS-J Configuration</strong> to load the workflow into the Java-based Server.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch6_reset_password_if_displayed_operation"><a class="anchor" href="#_ch6_reset_password_if_displayed_operation"></a><a class="link" href="#_ch6_reset_password_if_displayed_operation">6.1.5.2. Reset Password If Displayed Operation</a></h5>
<div class="paragraph">
<p>The Reset Password If Displayed workflow searches for (privileged) accounts according to the configured search settings whose password was displayed before the last <em>n</em> hours.</p>
</div>
<div class="paragraph">
<p>For each account in the search result, it obtains the appropriate password policy and then generates a new password that complies with the password policy.</p>
</div>
<div class="paragraph">
<p>The password policy is retrieved as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the account has set the attribute dxrPwdPolicyLink, then that policy is used.</p>
</li>
<li>
<p>Otherwise it looks for the target system&#8217;s password policy; that is, the password policy assigned in the target system&#8217;s attribute dxrPwdPolicyLink.</p>
</li>
<li>
<p>If the target system has no password policy assigned and the account has an associated user, it takes the password policy referenced from the user.</p>
</li>
<li>
<p>If it does not find any password policy, it takes the default password policy of the domain.</p>
</li>
<li>
<p>If there is no default policy, it generates an error.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the account is privileged, the workflow stores the new password at the account.</p>
</div>
<div class="paragraph">
<p>The workflow generates a password change event that is to be processed by the corresponding setPassword workflow.</p>
</div>
<div class="paragraph">
<p>Note that the setPassword workflow is started so that it does not send e-mails after successful reset of the password in the connected system.</p>
</div>
<div class="paragraph">
<p>For more information on personal and privileged accounts, see the <em>DirX Identity Provisioning Administration Guide</em>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch6_user_password_event_manager_workflow"><a class="anchor" href="#_ch6_user_password_event_manager_workflow"></a><a class="link" href="#_ch6_user_password_event_manager_workflow">6.1.6. User Password Event Manager Workflow</a></h4>
<div class="paragraph">
<p>The <strong>User Password Event Manager</strong> workflow is part of the password provisioning scenario. For more information about the complete scenario, see the chapter "Managing Passwords" in the <em>DirX Identity Connectivity Administration Guide.</em></p>
</div>
<div class="sect4">
<h5 id="_ch6_configuring_the_user_password_event_manager_workflow"><a class="anchor" href="#_ch6_configuring_the_user_password_event_manager_workflow"></a><a class="link" href="#_ch6_configuring_the_user_password_event_manager_workflow">6.1.6.1. Configuring the User Password Event Manager Workflow</a></h5>
<div class="paragraph">
<p>To configure the workflow:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use the Identity Manager to copy the workflow to your scenario (<strong>Connectivity</strong> &#8594; <strong>Global View</strong>).</p>
</li>
<li>
<p>Select <strong>Connectivity</strong> &#8594; <strong>Expert View</strong> and then select the copied workflow object.</p>
</li>
<li>
<p>Select the <strong>join</strong> activity and then adjust the settings in the following tabs:</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>General</strong> tab:</p>
</div>
<div class="paragraph">
<p>Enter a proper resource family into <strong>Resource Family</strong>. It is a good idea to have a separate resource family for this type of workflow to ensure that the corresponding threads do not compete with threads performing other workflows.</p>
</div>
<div class="paragraph">
<p>In the <strong>Error Handling</strong> section, specify the timeout for the activity, the retry limit and the waiting time between retries.</p>
</div>
<div class="paragraph">
<p><strong>Controller</strong> tab:</p>
</div>
<div class="paragraph">
<p>Select the join engine type <strong>UserPasswordEventManagerController</strong>. It automatically determines the proper class name.</p>
</div>
<div class="paragraph">
<p>If you want a user hook to be called during event processing, enter its full class name into <strong>Userhook Class Name</strong>. Make sure the library (jar file) containing your classes and all others on which they depend are deployed in the following folder beneath the installation:</p>
</div>
<div class="paragraph">
<p><em>install_path</em>/<strong>ids-j</strong>-<em>domain</em>-<strong>S</strong><em>n</em>/<strong>confdb/common/lib</strong></p>
</div>
<div class="paragraph">
<p>For information on how to write a user hook, see the <em>DirX Identity Customization Guide</em>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Select the <strong>notify</strong> part of the join activity and then adjust the settings in the following tabs:</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Notification</strong> tab:</p>
</div>
<div class="paragraph">
<p>Define the mail to be sent on common user password changes.</p>
</div>
<div class="paragraph">
<p><strong>Notification on Reset</strong> tab:</p>
</div>
<div class="paragraph">
<p>Define the mail to be sent on reset of a user password.</p>
</div>
<div class="paragraph">
<p><strong>Recipients</strong> tab:</p>
</div>
<div class="paragraph">
<p>Define recipients of the notifications for password change and reset operations.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In the <strong>General</strong> tab of the workflow:</p>
</li>
<li>
<p>Set the <strong>Active</strong> flag of the workflow.</p>
</li>
<li>
<p>Right-click the workflow object and then select <strong>Load IdS-J Configuration</strong> to load the workflow into the Java-based Server.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch6_user_password_expiration_notification_workflow"><a class="anchor" href="#_ch6_user_password_expiration_notification_workflow"></a><a class="link" href="#_ch6_user_password_expiration_notification_workflow">6.1.7. User Password Expiration Notification Workflow</a></h4>
<div class="paragraph">
<p>The <strong>User Password Expiration Notification</strong> workflow is running in the Java-based Server and has replaced the older PwExpirationNotification workflow running in the C++-based Server. It finds users whose passwords are about to expire and informs the users about it by sending a notification mail. Unlike the old workflow, which used the MailConnector, the new one sends the notifications over the <strong>notify</strong> port using the NotifyChannelConnector as it is done for almost all other realtime workflows.</p>
</div>
<div class="paragraph">
<p>More information about the <strong>notify</strong> port functionality can be found in the "Context Sensitive Help" in the <em>DirX Identity Connectivity Administration Guide</em>.</p>
</div>
<div class="sect4">
<h5 id="_ch6_configuring_the_user_password_expiration_notification_workflow"><a class="anchor" href="#_ch6_configuring_the_user_password_expiration_notification_workflow"></a><a class="link" href="#_ch6_configuring_the_user_password_expiration_notification_workflow">6.1.7.1. Configuring the User Password Expiration Notification Workflow</a></h5>
<div class="paragraph">
<p>To run the User Password Expiration Notification workflow successfully you must perform these steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use the Identity Manager to copy the workflow to your scenario (<strong>Connectivity</strong> &#8594; <strong>Global View</strong>).</p>
</li>
<li>
<p>Select <strong>Connectivity</strong> &#8594; <strong>Expert View</strong> and then select the copied workflow object.</p>
</li>
<li>
<p>Select the join activity and then select the <strong>Controller</strong> tab. Adjust the settings in this tab as follows:</p>
</li>
<li>
<p>Set the <strong>Number of Notifications</strong> to the desired value.</p>
</li>
<li>
<p>Do not change the selected Join Engine controller <strong>PwdUserExpireController</strong> unless you have changed the component description <strong>PwdUserExpireController.xml</strong> of that controller under <strong>Expert View</strong> &#8594; <strong>Configuration</strong> &#8594; <strong>GUI</strong> &#8594; <strong>system</strong> &#8594; <strong>componentDescriptions</strong> to adjust for example the initial content for the controllerâs properties. Those changes would become active then for every newly created workflow.</p>
</li>
<li>
<p>Right-click the join activity and then select <strong>Edit Content</strong> if you want to adjust the following properties of the <strong>PwdUserExpireController</strong>âs controller section:</p>
</li>
<li>
<p><strong>searchBase</strong> - set to *cn=Users,cn=*<em>domain</em> by default, where <em>domain</em> automatically resolves to the domain to which your workflow was copied. Must not be changed usually.</p>
</li>
<li>
<p><em>domain</em> - set by default to the domain to which your workflow was copied. It is used for searching the password policies and should not be changed.</p>
</li>
<li>
<p><strong>userAttrs</strong> - the multi value property contains the list of all attributes either the <strong>PwdUserExpireController</strong> needs to calculate the password expiration date, which are <strong>dxrPwdChangedTime</strong> and <strong>dxrPwdExpiryNotified</strong>, or those to be used in <strong>${IDATTR(&lt;<strong><em>attr_name</em></strong>&gt;)}</strong> expressions in the mail parameters of the notify port, for example, in the mail body or mail subject. The attributes configured by default are <strong>sn</strong>, <strong>givenName</strong>, <strong>mail</strong>.<br>
If you want to use more attributes, you can extend this multi-value property.<br>
<br>
There are two pseudo attributes (not in LDAP) that the <strong>PwdUserExpireController</strong> automatically adds to the <strong>userAttrs</strong> list which can also be used in the <strong>IDATTR</strong> expressions of the mail parameters:<br>
<strong>daysToExpire</strong> - the number of days after which the userâs password will expire.<br>
<strong>expirationDate</strong> - the expiration date of the userâs password.</p>
</li>
<li>
<p>Beneath the join activity, select the <strong>notify</strong> port, then select the <strong>Notification</strong> tab and adjust the mail parameters to your needs. The <strong>${IDATTR(&lt;<strong><em>attr_name</em></strong>&gt;)}</strong> expressions can be used for any attributes, that are contained in <strong>userAttrs</strong>.</p>
</li>
<li>
<p>Set the <strong>Active</strong> flag of the workflow.</p>
</li>
<li>
<p>Right-click the workflow object and select <strong>Load IdS-J Configuration</strong> to load the workflow into the Java-based Server.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch6_user_password_expiration_notification_workflow_operation"><a class="anchor" href="#_ch6_user_password_expiration_notification_workflow_operation"></a><a class="link" href="#_ch6_user_password_expiration_notification_workflow_operation">6.1.7.2. User Password Expiration Notification Workflow Operation</a></h5>
<div class="paragraph">
<p>The workflow only runs scheduled and searches for users under the configured search base whose passwords are about to expire and notifies the affected users about it.</p>
</div>
<div class="paragraph">
<p>Password expiration for users depends on the assigned user password policy and on a set of attributes at the policy and the user.</p>
</div>
<div class="paragraph">
<p>The password policy is assigned via the password policy link (attribute dxrPwdPolicyLink). If no password policy is assigned, the default password policy is used.</p>
</div>
<div class="paragraph">
<p>The expiration calculation depends on the following attributes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>dxrPwdMaxAge</strong> (Maximum age) - at the password policy. It defines the maximum allowed age of the password.</p>
</li>
<li>
<p><strong>dxrPwdExpireWarning</strong> (Expiration Warning Time) - at the password policy. It defines the time at which to warn about a pending password expiration.</p>
</li>
<li>
<p><strong>dxrPwdChangedTime</strong> (Password Changed Time) - at the user entry. It defines the last time the password was changed.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the current date is greater than (<strong>dxrPwdChangedTime+dxrPwdMaxAge-dxrPwdExpireWarning</strong>), the workflow sends a notification e-mail.</p>
</div>
<div class="paragraph">
<p>After sending the e-mail, the <strong>dxrPwdExpiryNotified</strong> (Password Expiration Notified) attribute of the user entry is incremented. If the configured <strong>Number of Notifications</strong> is reached no more mails are sent on subsequent workflow runs.</p>
</div>
<div class="paragraph">
<p>When the user changes the password or an administrator resets the password with Web Center the <strong>dxrPwdExpiryNotified</strong> attribute is reset to <strong>0</strong> again.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch6_transport_workflows"><a class="anchor" href="#_ch6_transport_workflows"></a><a class="link" href="#_ch6_transport_workflows">6.1.8. Transport Workflows</a></h4>
<div class="paragraph">
<p>You can transfer data between Identity Store instances with several methods. For an overview see the chapter "Transporting Data" in the chapter "Using Utilities" of the <em>DirX Identity User Interfaces Guide</em>.</p>
</div>
<div class="paragraph">
<p>This section describes the available transport workflow samples. You can transport data between Connectivity and Provisioning domains. Because this is slightly different, we provide four sample workflows that you can use to set up your own procedures:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Export Connectivity Collections - shows how to export data from a Connectivity configuration domain.</p>
</li>
<li>
<p>Import Connectivity Collections - shows how to import data into a Connectivity configuration domain.</p>
</li>
<li>
<p>Export Provisioning Collections - shows how to export data from a Provisioning configuration domain.</p>
</li>
<li>
<p>Import Provisioning Collections - shows how to import data into a Provisioning configuration domain.</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="_ch6_export_connectivity_collections"><a class="anchor" href="#_ch6_export_connectivity_collections"></a><a class="link" href="#_ch6_export_connectivity_collections">6.1.8.1. Export Connectivity Collections</a></h5>
<div class="paragraph">
<p>This sample workflow exports by default Java-based LDAP workflows based on a collection rule. To configure the workflow:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use the Identity Manager to copy the workflow to your scenario (<strong>Connectivity</strong> &#8594; <strong>Global View</strong>).</p>
</li>
<li>
<p>Make sure your scenario includes an existing <strong>ConfDB</strong> connected directory from where you want to export. Your scenario should have two instances of this connected directory with an intermediate workflow line between them. Right-click the workflow line and then select <strong>New</strong> to copy the workflow <strong>Export Connectivity Collections</strong>.</p>
</li>
<li>
<p>The first tab asks for a new workflow name. Enter your desired name.</p>
</li>
<li>
<p>In the <strong>General Workflow Info</strong> tab, check the <strong>Timeout</strong> parameter if appropriate and activate the workflow.</p>
</li>
<li>
<p>In the <strong>Connection</strong> tab:</p>
</li>
<li>
<p>Open <strong>Bind profile</strong> and check the bind profile parameters.</p>
</li>
<li>
<p>Open <strong>Connected directory</strong> and follow the link to <strong>Service</strong>. Check for correct parameters.</p>
</li>
<li>
<p>In the <strong>Export Definitions</strong> tab</p>
</li>
<li>
<p>Define either a search in the <strong>Filter</strong> area to retrieve a set of Connectivity collections to export (you need not define the object class dxmIDMWorkflow, define only additional criteria) or select a list of Connectivity collections in the <strong>Collections</strong> area. Note that you can only use one of these options.</p>
</li>
<li>
<p>Determine whether to create standard LDIF format with Base64 content or use the default readable format. Because readable format works best for configuration management systems and data that must be changed during import transport workflows, we recommend that you keep the default (no standard LDIF format).</p>
</li>
<li>
<p>If you want to generate data for a configuration management system, restrict the generated line length. Check the configuration management documentation. For ClearCase, we recommend a line length of 2000.</p>
</li>
<li>
<p>Click <strong>Finish</strong> to store your new workflow.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Now you can run the workflow either manually or via a schedule.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch6_import_connectivity_collections"><a class="anchor" href="#_ch6_import_connectivity_collections"></a><a class="link" href="#_ch6_import_connectivity_collections">6.1.8.2. Import Connectivity Collections</a></h5>
<div class="paragraph">
<p>This sample workflow imports by default the previously exported set of Java-based LDAP workflows (see the Export Connectivity Collections workflow).</p>
</div>
<div class="paragraph">
<p>To configure the workflow:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use the Identity Manager to copy the workflow to your scenario (<strong>Connectivity</strong> &#8594; <strong>Global View</strong>).</p>
</li>
<li>
<p>Make sure your scenario includes an existing <strong>ConfDB</strong> connected directory from where you want to export. Your scenario should have two instances of this connected directory with an intermediate workflow line between them. Right-click the workflow line and then select <strong>New</strong> to copy the workflow <strong>Import Connectivity Collections</strong>.</p>
</li>
<li>
<p>The first tab asks for a new workflow name. Enter your desired name.</p>
</li>
<li>
<p>In the <strong>General Workflow Info</strong> tab, check the <strong>Timeout</strong> parameter if appropriate and activate the workflow.</p>
</li>
<li>
<p>In the <strong>Connection</strong> tab:</p>
</li>
<li>
<p>Open <strong>Bind profile</strong> and check the bind profile parameters for your target connected directory.</p>
</li>
<li>
<p>Open <strong>Connected directory</strong> and follow the link to <strong>Service</strong>. Check for correct parameters.</p>
</li>
<li>
<p>In the <strong>Deletion</strong> tab:</p>
</li>
<li>
<p>Enable the <strong>Is Active</strong> flag if you intend to delete a set of entries before the import operation.</p>
</li>
<li>
<p>In the <strong>Collection</strong> area, list all collection definitions (its DNs) that are to be used to delete the entries.</p>
</li>
<li>
<p>In the <strong>Import Definitions</strong> tab:</p>
</li>
<li>
<p>In the <strong>Import</strong> area, select all files you want to import.</p>
</li>
<li>
<p>By default, the files are type LDIF. In the <strong>SPML</strong> area, you can select SPML format and you can select that the SPML file is to be validated before the import.</p>
</li>
<li>
<p>Set the required options in the <strong>LDIF</strong> area; for example, an input filter that retrieves only specific object types from your files.</p>
</li>
<li>
<p>You can use the <strong>dryrun</strong> option of the <strong>Simulation Mode</strong> for a dry run. Use the log file to check the effects.</p>
</li>
<li>
<p>Click <strong>Finish</strong> to store your new workflow.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Import workflows help to filter and adapt the data. To control the mappings, perform these steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Click the <strong>Expert</strong> view and locate your workflow in your workflow folder.</p>
</li>
<li>
<p>Open this entry and then open the <strong>perform</strong> activity.</p>
</li>
<li>
<p>All mappings are located under this entry. Either change one of the existing mappings or create or delete mappings.</p>
</li>
<li>
<p>The sample workflow sets all imported workflows to active and changes the cluster and resource values (as an example).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Now you can run the workflow either manually or via a schedule.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch6_export_provisioning_collections"><a class="anchor" href="#_ch6_export_provisioning_collections"></a><a class="link" href="#_ch6_export_provisioning_collections">6.1.8.3. Export Provisioning Collections</a></h5>
<div class="paragraph">
<p>This sample workflow exports by default the complete privilege tree based on a collection rule.</p>
</div>
<div class="paragraph">
<p>To configure the workflow:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use the Identity Manager to copy the workflow to your scenario (<strong>Connectivity</strong> &#8594; <strong>Global View</strong>).</p>
</li>
<li>
<p>Make sure your scenario includes an existing <strong>Identity Store</strong> connected directory from where you want to export. Your scenario should have two instances of this connected directory with an intermediate workflow line between them. Right-click the workflow line and then select <strong>New</strong> to copy the workflow <strong>Export Provisioning Collections</strong>.</p>
</li>
<li>
<p>The first tab asks for a new workflow name. Enter your desired name.</p>
</li>
<li>
<p>In the <strong>General Workflow Info</strong> tab, check the <strong>Timeout</strong> parameter if appropriate and activate the workflow.</p>
</li>
<li>
<p>In the <strong>Connection</strong> tab:</p>
</li>
<li>
<p>Open <strong>Bind profile</strong> and check the bind profile parameters.</p>
</li>
<li>
<p>Open <strong>Connected directory</strong> and follow the link to <strong>Service</strong>. Check for correct parameters.</p>
</li>
<li>
<p>In the <strong>Export Definitions</strong> tab:</p>
</li>
<li>
<p>Define either a search in the <strong>Filter</strong> area to retrieve a set of Connectivity collections to export (you need not define the object class dxmIDMWorkflow, define only additional criteria) or select a list of Connectivity collections in the <strong>Collections</strong> area. Note that you can only use one of these options. To get the DNs of the collection objects, right-click the object in the Provisioning view and then select <strong>Goto DataView</strong> to retrieve the DN of the object.</p>
</li>
<li>
<p>Determine whether to create standard LDIF format with Base64 content or use the default readable format. Because readable format works best for configuration management systems and data that needs to be adapted during import transport workflows, we recommend that you keep the default (no standard LDIF format).</p>
</li>
<li>
<p>If you want to generate data for a configuration management system, restrict the generated line length. Check the configuration management documentation. For ClearCase, we recommend a line length of 2000.</p>
</li>
<li>
<p>Click <strong>Finish</strong> to store your new workflow.</p>
</li>
<li>
<p>Now you can execute the workflow either manually or via a schedule.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch6_import_provisioning_collections"><a class="anchor" href="#_ch6_import_provisioning_collections"></a><a class="link" href="#_ch6_import_provisioning_collections">6.1.8.4. Import Provisioning Collections</a></h5>
<div class="paragraph">
<p>This sample workflow imports by default the previously exported complete privilege tree (see the Export Provisioning Collections workflow).</p>
</div>
<div class="paragraph">
<p>To configure the workflow, perform these steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use the Identity Manager to copy the workflow to your scenario (<strong>Connectivity &#8594; Global View</strong>).</p>
</li>
<li>
<p>Make sure your scenario includes an existing <strong>Identity Store</strong> connected directory from where you want to export. Your scenario should have two instances of this connected directory with an intermediate workflow line between them. Right-click the workflow line and then select <strong>New</strong> to copy the workflow <strong>Import Provisioning Collections</strong>.</p>
</li>
<li>
<p>The first tab asks for a new workflow name. Enter your desired name.</p>
</li>
<li>
<p>In the <strong>General Workflow Info</strong> tab, check the <strong>Timeout</strong> parameter if appropriate and activate the workflow.</p>
</li>
<li>
<p>In the <strong>Connection</strong> tab:</p>
</li>
<li>
<p>Open <strong>Bind profile</strong> and check the bind profile parameters for your target connected directory.</p>
</li>
<li>
<p>Open <strong>Connected directory</strong> and follow the link to <strong>Service</strong>. Check for correct parameters.</p>
</li>
<li>
<p>In the <strong>Deletion</strong> tab:</p>
</li>
<li>
<p>Enable the <strong>Is Active</strong> flag if you intend to delete a set of entries before the import operation.</p>
</li>
<li>
<p>List in the <strong>Collection</strong> area all collection definitions (it&#8217;s DNs) that shall be used to delete the entries.</p>
</li>
<li>
<p>In the <strong>Import Definitions</strong> tab:</p>
</li>
<li>
<p>In the <strong>Import</strong> area, select all files you want to import.</p>
</li>
<li>
<p>By default, the files are type LDIF. In the <strong>SPML</strong> area, you can select SPML format and you can select that the SPML file is to be validated before the import.</p>
</li>
<li>
<p>Set the required options in the <strong>LDIF</strong> area; for example, an input filter that retrieves only specific object types from your files.</p>
</li>
<li>
<p>You can use the <strong>dryrun</strong> option of the <strong>Simulation Mode</strong> for a dry run. Use the log file to check the effects.</p>
</li>
<li>
<p>Set the correct Domain Mappings. The default workflow changes all occurrences from "My-Company" to "Customer Domain". If you have data from different domains, you can define multiple mappings to your target domain.</p>
</li>
<li>
<p>Click <strong>Finish</strong> to store your new workflow.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Import workflows help to filter and adapt the data. To control the mappings, perform these steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Click the <strong>Expert</strong> view and locate your workflow in your workflow folder.</p>
</li>
<li>
<p>Open this entry and then open the <strong>perform</strong> activity.</p>
</li>
<li>
<p>All mappings are located under this entry. Either change one of the existing mappings or create or delete mappings.</p>
</li>
<li>
<p>The sample workflow deletes all <strong>dxrGroupMember</strong> attribute values (we use the wildcard dxrGroupMember* here). Only the structure is imported, not the specific group members because these are different in your target domain.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Now you can run the workflow either manually or via a schedule.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch6_joint_backup_workflow"><a class="anchor" href="#_ch6_joint_backup_workflow"></a><a class="link" href="#_ch6_joint_backup_workflow">6.1.9. Joint Backup Workflow</a></h4>
<div class="paragraph">
<p>The Joint Backup workflow performs a synchronized backup of the Java-based Serverâs repository and the LDAP connectivity and provisioning data store. It can also transfer the generated files to a target backup system via the Java-based Server (not currently supported) or via your own user hook class.</p>
</div>
<div class="paragraph">
<p>To transfer all generated backup files to the destination system, you can:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Manually transfer the generated files. With this method, files are not automatically cleaned up.</p>
</li>
<li>
<p>Let the IdS-J service transfer the generated files. To use this method, the IdS-J service must have the rights to access all files and the target path. If the system landscape is distributed, the IdS-J service needs to run under an appropriate account with access rights to network shares.<br>
With this method, created files are cleaned up if the file transfer fails for any reason.</p>
</li>
<li>
<p>Implement your own Java user class to transfer the files. This method is currently not supported. Contact technical support for more information.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Remote LDAP backup has the following constraint: The remote backup of an LDAP data store is performed via an LDAP extended operation. Only DirX Directory V8.1A or newer supports this operation. The DNs of users that are allowed to do a remote backup are maintained in the ldapConfiguration subentry in the attribute ldapExtOpAdmins. See the section "LDAP Extended Operations Admins" in the <em>DirX Directory Administration Reference</em> for details.</p>
</div>
<div class="paragraph">
<p>On Windows, you must install gzip 1.3.12 or newer. A suitable gzip is available on <a href="http://www.gnu.org" class="bare">http://www.gnu.org</a>. <strong>gzip.exe</strong> must be found via the <strong>PATH</strong> environment variable.</p>
</div>
<div class="sect4">
<h5 id="_ch6_configuring_the_joint_backup_workflow"><a class="anchor" href="#_ch6_configuring_the_joint_backup_workflow"></a><a class="link" href="#_ch6_configuring_the_joint_backup_workflow">6.1.9.1. Configuring the Joint Backup Workflow</a></h5>
<div class="paragraph">
<p>To configure the workflow:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Activate the backup in the Java-based server. (See the section "Java-based Server - Repository" in the appendix "Context Sensitive Help" in the <em>DirX Identity Connectivity Administration Guide</em> for details.)</p>
</li>
<li>
<p>Administer the LDAP servers: Enter the DNs of the Connectivity Domain Administrator used by IdS-J (<strong>cn=DomainAdmin,cn=*<em>your_domain</em></strong>,dxmC=Users,dxmC=DirXmetahub*) and, if necessary, of the Provisioning Domain Administrator used by the IdS-J *(cn=DomainAdmin, cn=*<em>your_domain</em>) in the multi-value attribute ldapExtOpAdmins of the ldapConfiguration subentry of the appropriate DirX LDAP Server.</p>
</li>
<li>
<p>In the <strong>Controller</strong> tab of the <strong>perform</strong> activity, ensure that the fully-qualified pathname of the controller is correct: <strong>com.siemens.idm.jobs.Backup</strong>.</p>
</li>
<li>
<p>In the <strong>Backup Parameters</strong> tab of the <strong>perform</strong> activity you must set the folders where to store the backups and indicate whether this folder is located on a Windows system. Ignore the settings for the message server and leave them empty.<br>
Note: The location of the Java-based Server&#8217;s backup file is configured with the server&#8217;s configuration.</p>
</li>
<li>
<p>In the field <strong>Connectivity Configuration / Backup Path</strong>, specify the fully-qualified pathname of an existing folder for the backup location of the DirX Server that hosts the Connectivity data store.<br>
Note that the pathname must not be a part of the installation tree of the DirX Server. This is a mandatory field.<br>
Check <strong>On Windows System</strong> if the DirX Server runs on Windows.</p>
</li>
<li>
<p>If the Provisioning part is hosted on a different LDAP server, specify the fully-qualified pathname of an existing folder for the backup location in the field <strong>Provisioning Configuration / Backup Path</strong>. See also the notes above.<br>
Check <strong>On Windows System</strong> if the DirX Server runs on Windows.</p>
</li>
<li>
<p>Create a schedule for the workflow. (See the section "Schedule" in the appendix "Context Sensitive Help" in the <em>DirX Identity Connectivity Administration Guide</em> for details.)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you are letting the IdS-J service transfer the generated files, provide the following information:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In the field <strong>Target Backup System Path</strong> of the <strong>Post Operation</strong> tab, specify the fully-qualified pathname of an existing folder for the transfer location. On Windows, you can use a shared network drive, but then the IdS-J service must run under a different account from the system account and you must use the UNC syntax for the transfer folder.</p>
</li>
<li>
<p>Check <strong>On Windows System</strong> if the transfer location is hosted on Windows.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you implemented your own Java user class to transfer the generated files, provide the following information:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In <strong>Userhook Class Name</strong>, specify the name of your own class.<br>
Note: This method is not currently supported. Contact technical support for more information.</p>
</li>
<li>
<p>Set the <strong>Active</strong> flag of the workflow and perform <strong>Load IdS-J Configuration</strong> from the context menu of the workflow object to load the workflow into the Java-based Server.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch6_consistency_management_workflows"><a class="anchor" href="#_ch6_consistency_management_workflows"></a><a class="link" href="#_ch6_consistency_management_workflows">6.1.10. Consistency Management Workflows</a></h4>
<div class="paragraph">
<p>The Java-based consistency management workflows include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The Check Consistency workflow</p>
</li>
<li>
<p>The Mark Affected Users workflow</p>
</li>
<li>
<p>The User Resolution Workflow</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These workflows are described in the <em>DirX Identity Provisioning Administration Guide</em> in the section "Managing Consistency" in the chapter "Managing the Provisioning System".</p>
</div>
<div class="paragraph">
<p>Compared to the Tcl-based maintenance workflows, the Java-based consistency management workflows allow for:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Subsetting of objects for deletion and particularly consistency checks.</p>
</li>
<li>
<p>Separate user resolution workflows for clear user subsets.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The Java-based and Tcl-based consistency maintenance workflows use common storage mechanisms. For optimization information, see the section "Using the Maintenance Workflows" &#8594; "Understanding the Tcl-based Maintenance Workflows" &#8594; "Consistency Check Workflow" &#8594; "Consistency Check Workflow Optimization".</p>
</div>
<div class="sect4">
<h5 id="_ch6_check_consistency_workflow"><a class="anchor" href="#_ch6_check_consistency_workflow"></a><a class="link" href="#_ch6_check_consistency_workflow">6.1.10.1. Check Consistency Workflow</a></h5>
<div class="paragraph">
<p>The Java-based consistency management workflow Check Consistency applies configured consistency rules and performs basic hard-coded consistency checks. Compared to the Tcl-based Consistency Check workflow:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The Java-based workflow is a combination of a policy execution workflow handling consistency policies and the Tcl consistencyCheck workflow.</p>
</li>
<li>
<p>The workflow performs no user resolution.</p>
</li>
<li>
<p>You can select to run only part of the checks this workflow performs.</p>
</li>
<li>
<p>You can select to run the checks on a subset of objects.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For more information about this workflow, see the section "Consistency Check and Consistency Rules" in the <em>DirX Identity Provisioning Administration Guide</em>.</p>
</div>
<div class="sect5">
<h6 id="_ch6_configuring_the_check_consistency_workflow"><a class="anchor" href="#_ch6_configuring_the_check_consistency_workflow"></a><a class="link" href="#_ch6_configuring_the_check_consistency_workflow">6.1.10.1.1. Configuring the Check Consistency Workflow</a></h6>
<div class="paragraph">
<p>To configure the workflow:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use the Identity Manager to copy the workflow to your scenario (<strong>Connectivity</strong> &#8594; <strong>Global</strong> <strong>View</strong>).</p>
</li>
<li>
<p>Select <strong>Connectivity</strong> &#8594; <strong>Expert</strong> <strong>View</strong> and then select the copied workflow object.</p>
</li>
<li>
<p>Select the <strong>join</strong> activity and then select the <strong>Check</strong> <strong>Consistency</strong> <strong>Attributes</strong> tab to modify the configuration. See the context-sensitive help for details about configuration parameters.</p>
</li>
<li>
<p>Right-click the workflow object and then select <strong>Load IdS-J Configuration</strong> to load the workflow into the Java-based Server.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Because the workflow runs in the Java-based Server, you can configure tracing via Identity WebAdmin. The following packages may be involved:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>com.siemens.idm.jobs.consistencyCheck</strong></p>
</li>
<li>
<p><strong>siemens.dxr.agents</strong></p>
</li>
<li>
<p><strong>siemens.dxm.ruleprocessing.rules</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following default values are used for empty attributes in the <strong>Check</strong> <strong>Consistency</strong> <strong>Attributes</strong> tab:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>LDAP Page Size - <strong>50</strong></p>
</li>
<li>
<p>Batch Accumulator Size - <strong>500</strong></p>
</li>
<li>
<p>Cache MRU Size - <strong>10000</strong></p>
</li>
<li>
<p>Check Users Search Base - <strong>cn=users,cn=my-company</strong></p>
</li>
<li>
<p>Check Users Filter - <strong>(objectClass=dxrUser)</strong></p>
</li>
<li>
<p>Search Base for Roles - <strong>cn=RoleCatalogue,cn=my-company</strong></p>
</li>
<li>
<p>Filter for Roles - <strong>(objectClass=dxrRole)</strong></p>
</li>
<li>
<p>Search Base for Permissions - <strong>cn=Permissions,cn=my-company</strong></p>
</li>
<li>
<p>Filter for Permissions - <strong>(objectClass=dxrPermission)</strong></p>
</li>
<li>
<p>Search Base for Target Systems - <strong>cn=TargetSystems,cn=my-company</strong></p>
</li>
<li>
<p>Filter for Target Systems - <strong>(objectClass=dxrTargetSystem)</strong></p>
</li>
<li>
<p>Apply Consistency Rules Search Base - no default</p>
</li>
<li>
<p>Apply Consistency Rules Filter - <strong>(objectClass=dxrConsistencyRule)</strong></p>
</li>
<li>
<p>Apply Consistency Rules sort attribute - <strong>cn</strong></p>
</li>
<li>
<p>Apply Consistency Rules sort ascending - <strong>true</strong></p>
</li>
<li>
<p>Apply Consistency Rules LDAP Page Size - <strong>300</strong></p>
</li>
<li>
<p>Apply Consistency Rules MRU Size - <strong>500</strong></p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch6_check_consistency_workflow_operation"><a class="anchor" href="#_ch6_check_consistency_workflow_operation"></a><a class="link" href="#_ch6_check_consistency_workflow_operation">6.1.10.1.2. Check Consistency Workflow Operation</a></h6>
<div class="paragraph">
<p>Check Consistency workflow operation depends on the selections configured in the Consistency Check Workflow Attributes tab (visible in the workflow&#8217;s join activity).</p>
</div>
<div class="paragraph">
<p>If <strong>Check for Privileges To Be Deleted</strong> is selected, the workflow:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Searches for roles, permissions, and groups in the state TBDEL.</p>
</li>
<li>
<p>For each privilege in the state TBDEL, the workflow:</p>
</li>
<li>
<p>Removes the incoming assignments to users and/or senior privileges and then sets the To Be Analyzed (TBA) flag for the affected objects.</p>
</li>
<li>
<p>Deletes roles/permissions or sets the state to DELETED if history is configured.</p>
</li>
<li>
<p>Sets the state of groups to DELETED.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If <strong>Check</strong> <strong>Users</strong> is selected, the workflow performs the following steps for users that match the given search base (<strong>cn=users,cn=my-company</strong> if empty) and filter (<strong>(objectClass=dxrUser)</strong> if empty):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Searches all privilege assignments with relevant start or end dates. The exact filter is:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ldap hljs" data-lang="ldap">(&amp;(|(objectClass=dxrUserToRole)(objectClass=dxrUserToGroup)(objectClass=dxrUserToPermission))(|(dxrEndDate=*)(dxrStartDate=*)))</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Deletes outdated start dates, removes assignments with outdated end dates, and marks this user for privilege resolution.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Next, the workflow checks the consistency of the matching users. It:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Deletes users in the state TBDEL with an expired <strong>DeleteDate</strong>.</p>
</li>
<li>
<p>Sets the <strong>DeleteDate</strong> for users in the state TBDEL that do not yet have a <strong>DeleteDate</strong> set.</p>
</li>
<li>
<p>Sets as the <strong>StartDate</strong> the current date for users in state NEW that do not yet have a <strong>StartDate</strong> set.</p>
</li>
<li>
<p>Checks whether the various date fields of the user are consistent with the user state. If not, the user is flagged with TBA for a succeeding privilege resolution.</p>
</li>
<li>
<p>Checks whether the various date fields of the user are consistent, which means that the sequence of the date fields must be <strong>StartDate</strong>, <strong>DisableStartDate</strong>, <strong>DisableEndDate</strong>, <strong>EndDate</strong>, <strong>DeleteDate</strong>.</p>
</li>
<li>
<p>Checks for broken references of privilege assignments.</p>
</li>
<li>
<p>Checks for the correct user state and then migrates the old state DELETED to TBDEL.</p>
</li>
<li>
<p>Flags users with TBA if the <strong>ErrorExpirationDate</strong> is reached.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If <strong>Check Roles/Permissions</strong> is selected, the workflow performs the following steps for objects that match the specified search base and filter:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Analyzes the role structures:</p>
</li>
<li>
<p>Works on all matching roles.</p>
</li>
<li>
<p>Checks whether the role is valid, that means it must have a permission or junior role assigned.</p>
</li>
<li>
<p>Checks for broken references to junior roles and assigned permissions.</p>
</li>
<li>
<p>Analyzes the permission structures:</p>
</li>
<li>
<p>Works on all matching permissions.</p>
</li>
<li>
<p>Checks whether the permission is valid, that means it must have a group assigned.</p>
</li>
<li>
<p>Checks for broken references to assigned groups.</p>
</li>
<li>
<p>Checks whether the permission is assigned to users if it is not flagged for user assignment.</p>
</li>
<li>
<p>Checks for correct permission parameters.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If <strong>Check Accounts/Groups</strong> is selected, the workflow performs the following steps for all accounts/groups of the target systems that match the specified search base and filter:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Checks whether the <strong>Local</strong> <strong>Admin</strong> link of a target system is broken.</p>
</li>
<li>
<p>Works on all matching target system accounts.</p>
</li>
<li>
<p>Deletes all accounts that are marked with <strong>Managed in Target System Only</strong> that are in state <strong>Deleted</strong> in the target system.</p>
</li>
<li>
<p>Checks whether the target system of this account is of the correct type and exists.</p>
</li>
<li>
<p>Checks for multiple primary accounts for a user.</p>
</li>
<li>
<p>Checks whether the <strong>User</strong> <strong>Link</strong> of the account is broken.</p>
</li>
<li>
<p>Checks for correct account states.</p>
</li>
<li>
<p>Deletes accounts that are in the state DELETED and whose <strong>EndDate</strong> is expired.</p>
</li>
<li>
<p>Checks that the account is either marked <strong>Managed in Target System Only</strong> and has no user link assigned or that it is not marked <strong>Managed in Target System Only</strong> and has a user link assigned.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When analyzing target system groups, the workflow:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Works on all matching target system groups.</p>
</li>
<li>
<p>Deletes all groups that are marked <strong>Managed</strong> <strong>in</strong> <strong>Target</strong> <strong>System</strong> <strong>Only</strong> that are in the state <strong>Deleted</strong> in the target system.</p>
</li>
<li>
<p>Checks whether all permission parameter values (<strong>dxrRPValues</strong>) are consistent with the permission parameter definition at the domain root object.</p>
</li>
<li>
<p>Checks for broken obligation links.</p>
</li>
<li>
<p>Checks for broken group members.</p>
</li>
<li>
<p>Checks whether the groups state has a correct value.</p>
</li>
<li>
<p>Deletes groups in the states DELETED or DISABLED with expired <strong>EndDate</strong>s.</p>
</li>
<li>
<p>Updates the distribution list of a virtual group.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If Apply Consistency Rules is selected, the workflow applies all consistency rules that match the specified search base and filter.</p>
</div>
<div class="paragraph">
<p>Rule processing works in the <strong>Assign</strong> <strong>privilege</strong> <strong>only</strong> provisioning mode with <strong>Suppress</strong> <strong>Change</strong> <strong>Events</strong> set to <strong>true</strong>. This processing mode means that no user resolution is performed and no user change events are initiated.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch6_mark_affected_users_workflow"><a class="anchor" href="#_ch6_mark_affected_users_workflow"></a><a class="link" href="#_ch6_mark_affected_users_workflow">6.1.10.2. Mark Affected Users Workflow</a></h5>
<div class="paragraph">
<p>The Java-based consistency management workflow Mark Affected Users finds privileges with <strong>dxrTBA = true</strong>, finds the users that might be affected by a change and sets the <strong>flag dxrTBA = true</strong> for these users. The User Resolution workflow will then subsequently ensure their resolution.</p>
</div>
<div class="paragraph">
<p>This functionality is the same as provided in the Consistency Check Tcl-based maintenance workflow. In the Mark Affected Users workflow, the functionality is separated into a single workflow and can be run more frequently. It is best to run it before the User Resolution workflow. For more information about this workflow, see the section "Consistency Check and Consistency Rules" in the <em>DirX Identity Provisioning Administration Guide</em>.</p>
</div>
<div class="sect5">
<h6 id="_ch6_configuring_the_mark_affected_users_workflow"><a class="anchor" href="#_ch6_configuring_the_mark_affected_users_workflow"></a><a class="link" href="#_ch6_configuring_the_mark_affected_users_workflow">6.1.10.2.1. Configuring the Mark Affected Users Workflow</a></h6>
<div class="paragraph">
<p>To configure the Java-based Mark Affected Users workflow:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use the Identity Manager to copy the workflow to your scenario (<strong>Connectivity</strong> &#8594; <strong>Global</strong> <strong>View</strong>).</p>
</li>
<li>
<p>Select <strong>Connectivity</strong> &#8594; <strong>Expert</strong> <strong>View</strong> and then select the copied workflow object.</p>
</li>
<li>
<p>Select the join activity and then select the <strong>Optimization</strong> <strong>Attributes</strong> tab to modify the configuration. See the context-sensitive help for details about the configuration parameters provided in this tab.</p>
</li>
<li>
<p>Right-click the workflow object and then select <strong>Load IdS-J Configuration</strong> to load the workflow into the Java-based Server.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Because the workflow runs in the Java-based Server, you can configure tracing via Identity WebAdmin. The following packages may be involved:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>com.siemens.idm.jobs.consistencyCheck</strong></p>
</li>
<li>
<p>siemens.dxr.agents</p>
</li>
<li>
<p>siemens.dxm.ruleprocessing.rules</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following default values are used for empty attributes in the <strong>Optimization</strong> <strong>Attributes</strong> tab:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>LDAP Page Size - <strong>50</strong></p>
</li>
<li>
<p>Batch Accumulator Size - <strong>500</strong></p>
</li>
<li>
<p>Cache MRU Size - <strong>10000</strong></p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch6_mark_affected_users_workflow_operation"><a class="anchor" href="#_ch6_mark_affected_users_workflow_operation"></a><a class="link" href="#_ch6_mark_affected_users_workflow_operation">6.1.10.2.2. Mark Affected Users Workflow Operation</a></h6>
<div class="paragraph">
<p>The Mark Affected Users workflow performs the following steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Searches the entire user and privilege database.</p>
</li>
<li>
<p>Sets the To Be Analyzed) (TBA) flag for all users that have a privilege assigned that is itself flagged with TBA. The workflow considers direct and indirect relationships (indirect relationships go via a role or permission).</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch6_user_resolution_workflow"><a class="anchor" href="#_ch6_user_resolution_workflow"></a><a class="link" href="#_ch6_user_resolution_workflow">6.1.10.3. User Resolution Workflow</a></h5>
<div class="paragraph">
<p>The Java-based consistency management workflow User Resolution performs the following tasks:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Applies provisioning rules to users.</p>
</li>
<li>
<p>Enables or removes user-privilege assignments where start or end dates are reached.</p>
</li>
<li>
<p>Finds users where the state must be changed because one of the corresponding start or end dates has been changed.</p>
</li>
<li>
<p>Triggers user-privilege resolution for all matching users by sending a message to the Resolution Adapter per user.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Compared to its Tcl-based counterpart, the Java-based User Resolution workflow is a combination of a policy execution workflow handling Provisioning rules and parts of the Tcl PrivilegeResolution workflow. You can use configuration parameters to limit the set of users and rules to be evaluated. For more information about this workflow, see the section "Consistency Check and Consistency Rules" in the <em>DirX Identity Provisioning Administration Guide</em>.</p>
</div>
<div class="sect5">
<h6 id="_ch6_configuring_the_user_resolution_workflow"><a class="anchor" href="#_ch6_configuring_the_user_resolution_workflow"></a><a class="link" href="#_ch6_configuring_the_user_resolution_workflow">6.1.10.3.1. Configuring the User Resolution Workflow</a></h6>
<div class="paragraph">
<p>To configure the Java-based User Resolution workflow:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use the Identity Manager to copy the workflow to your scenario (<strong>Connectivity</strong> &#8594; <strong>Global</strong> <strong>View</strong>).</p>
</li>
<li>
<p>Select <strong>Connectivity</strong> &#8594; <strong>Expert</strong> <strong>View</strong> and then select the copied workflow object.</p>
</li>
<li>
<p>Select the join activity and then select the <strong>Resolution</strong> <strong>Attributes</strong> tab to modify the configuration. See the context-sensitive help for details about the configuration parameters provided in this tab.</p>
</li>
<li>
<p>Right-click the workflow object and then select <strong>Load</strong> <strong>IdS-J</strong> <strong>Configuration</strong> to load the workflow into the Java-based Server.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Because the workflow runs in the Java-based Server, you can configure tracing via Identity WebAdmin. The following packages may be involved:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>com.siemens.idm.jobs.consistencyCheck</strong></p>
</li>
<li>
<p><strong>siemens.dxr.agents</strong></p>
</li>
<li>
<p><strong>siemens.dxm.ruleprocessing.rules</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following default values are used for empty attributes in the <strong>Resolution</strong> <strong>Attributes</strong> tab:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Filter for users - <strong>(objectClass=dxrUser)</strong></p>
</li>
<li>
<p>LDAP Page Size for Provisioning Rules-<strong>300</strong></p>
</li>
<li>
<p>Cache MRU Size for Provisioning Rules - <strong>10000</strong></p>
</li>
<li>
<p>Batch Accumulator Size for Provisioning Rules - <strong>500</strong></p>
</li>
<li>
<p>LDAP Page Size for User Resolution - <strong>50</strong></p>
</li>
<li>
<p>Cache MRU Size for User Resolution - <strong>10000</strong></p>
</li>
<li>
<p>Batch Accumulator Size for User Resolution- <strong>500</strong></p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch6_user_resolution_workflow_operation"><a class="anchor" href="#_ch6_user_resolution_workflow_operation"></a><a class="link" href="#_ch6_user_resolution_workflow_operation">6.1.10.3.2. User Resolution Workflow Operation</a></h6>
<div class="paragraph">
<p>To analyze users and assignments, the workflow performs the following actions for the given user filter and search base:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Searches all privilege assignments with relevant start or end dates. The exact filter is:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ldap hljs" data-lang="ldap">(&amp;(|(objectClass=dxrUserToRole)(objectClass=dxrUserToGroup)(objectClass=dxrUserToPermission))(|(dxrEndDate&lt;=today)(dxrStartDate&lt;=today)))</code></pre>
</div>
</div>
<div class="paragraph">
<p>where <em>today</em> is replaced with the current date</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Deletes the start date or privilege assignment and marks this user for privilege resolution.</p>
</li>
<li>
<p>Searches for matching users that must undergo a state transition: it searches for all matching users with an inconsistent state and dates and flags these users with TBA. The exact filter is:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ldap hljs" data-lang="ldap">(&amp;(objectClass=dxrUser)(|(&amp;(dxrEndDate&lt;=today)(|(dxrState=ENABLED)(dxrState=DISABLED)))(&amp;(dxrStartDate&lt;=today)(dxrState=NEW))(&amp;(dxrDisableEndDate&lt;=today)(dxrState=DISABLED))(&amp;(dxrDisableStartDate&lt;=today)(dxrState=ENABLED))(dxrDeleteDate&lt;=today)(&amp;(dxrState=TBDEL)(!(dxrEndDate&lt;=today)))))</code></pre>
</div>
</div>
<div class="paragraph">
<p>Next, the workflow applies the selected Provisioning rules. The rules are implicitly combined with the given user filter and search base, which means that rules are only applied for the given subset of users.</p>
</div>
<div class="paragraph">
<p>Finally, the workflow sends a message to the Resolution Adapter for all users that match the given search base and filter and are flagged with <strong>dxrTBA=true</strong>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_understanding_tcl_based_maintenance_workflows"><a class="anchor" href="#_understanding_tcl_based_maintenance_workflows"></a><a class="link" href="#_understanding_tcl_based_maintenance_workflows">6.2. Understanding the Tcl-based Maintenance Workflows</a></h3>
<div class="paragraph">
<p>A Tcl-based maintenance workflow typically runs scheduled and as a process in the C++-based Server (IdS-C). The pre-configured Tcl-based maintenance workflows include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>CleanupObjects</strong> - a workflow that cleans up all deleted or outdated objects. If auditing is enabled, the objects are only cleaned if all audit trail records are removed. This workflow is a special configuration for the policy execution service.</p>
</li>
<li>
<p><strong>ConsistencyCheck</strong> (Java workflow) <strong>-</strong> a workflow that checks the Identity Store for consistency and performs role resolution.</p>
</li>
<li>
<p><strong>ExtractAuditTrail</strong> - a workflow that checks the Identity Store for audit trail records (auditing information), writes them to the audit trail database and cleans up the audit trail records in the Identity Store.</p>
</li>
<li>
<p><strong>FullSoDCheck</strong> - a workflow that checks the entire DirX Identity user database for SoD violations.</p>
</li>
<li>
<p><strong>InitializeReapproval</strong> - a workflow that checks that all user-to-privilege assignments from privileges with checked re-approval are flagged correctly.</p>
</li>
<li>
<p><strong>PwdExpirationNotification</strong> - a workflow that checks for passwords that are about to expire and warns the corresponding users to change them before the expiration date. This workflow has been replaced by the <strong>UserPasswordExpirationNotification</strong> workflow, which runs in the Java-based Server, but can still be used if the customer has already copied it to his scenario.</p>
</li>
<li>
<p><strong>PolicyExecution -</strong> a workflow that applies a set of rules to a set of provisioning objects in the Identity Store and can also perform privilege resolution. This workflow is part of the "policy execution service".</p>
</li>
<li>
<p><strong>PrivilegeResolution -</strong> a workflow that performs privilege resolution without checking the Identity Store for consistency.</p>
</li>
<li>
<p><strong>RunWorkflowExternally</strong> - a workflow that can start workflows in another Connectivity domain that is based on another Connectivity configuration database.</p>
</li>
<li>
<p><strong>StartReapprovalWorkflows</strong> - a workflow that checks for necessary re-approval. It starts the corresponding request workflows.</p>
</li>
<li>
<p><strong>Status Report Generation -</strong> a workflow that writes a report in XML or HTML format for objects of the Provisioning or Connectivity view group to a file.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_ch6_cleanup_objects_workflow"><a class="anchor" href="#_ch6_cleanup_objects_workflow"></a><a class="link" href="#_ch6_cleanup_objects_workflow">6.2.1. Cleanup Objects Workflow</a></h4>
<div class="paragraph">
<p>The Cleanup Objects workflow runs the policy execution service. By default, the workflow is configured for all consistency rules whose names start with "cleanup". The default rules are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>cleanupDeletedObjects</strong> - removes all objects in state DELETED without history and whose endDate empty or passed.<br>
Note that User objects are not handled by this rule. The service agent deletes User objects that are in state TBDEL and whose endDate has passed.</p>
</li>
<li>
<p><strong>cleanupOutDatedDelegations</strong> - removes Delegations whose drxDeleteDate is reached.</p>
</li>
<li>
<p><strong>cleanupOutDatedRequWflowInstances</strong> - removes all request workflow instances whose dxmStatusExpirationTime has been reached.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This workflow runs in the C++-based Server but does not run in conjunction with the meta controller and thus does not use Tcl code.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_ch6_configuring_the_cleanup_objects_workflow"><a class="anchor" href="#_ch6_configuring_the_cleanup_objects_workflow"></a><a class="link" href="#_ch6_configuring_the_cleanup_objects_workflow">6.2.1.1. Configuring the Cleanup Objects Workflow</a></h5>
<div class="paragraph">
<p>To configure this workflow, run the workflow configuration wizard (option <strong>Configure</strong> in the context menu):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In the <strong>Rule Search Parameters</strong> tab, you can change the cleanup rules to be executed. By default, the workflow uses three standard rules whose names start with "cleanup".</p>
</li>
<li>
<p>In the <strong>User Search Parameters</strong> tab, you can set several parameters to optimize runs. See the section "Policy Agent Optimization" in the <em>DirX Identity Provisioning Administration Guide</em>.</p>
</li>
<li>
<p>In the <strong>Tracing</strong> tab, set the tracing parameters. By default, the workflow reports errors and warnings.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We recommend that you run this workflow once daily to remove all objects whose lifetime has expired.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch6_consistency_check_workflow"><a class="anchor" href="#_ch6_consistency_check_workflow"></a><a class="link" href="#_ch6_consistency_check_workflow">6.2.2. Consistency Check Workflow</a></h4>
<div class="paragraph">
<p>The Consistency Check workflow runs the service agent in <strong>checkConsistency</strong> mode. This section describes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>How to configure the workflow</p>
</li>
<li>
<p>The service agent configuration (*.ini) file</p>
</li>
<li>
<p>How the workflow operates</p>
</li>
<li>
<p>How to optimize the workflow</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This workflow runs in the C++-based Server but does not run in conjunction with the meta controller and thus does not use Tcl code.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_ch6_configuring_the_consistency_check_workflow"><a class="anchor" href="#_ch6_configuring_the_consistency_check_workflow"></a><a class="link" href="#_ch6_configuring_the_consistency_check_workflow">6.2.2.1. Configuring the Consistency Check Workflow</a></h5>
<div class="paragraph">
<p>To configure this workflow, run the workflow configuration wizard (option <strong>Configure</strong> in the context menu):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In the <strong>Consistency Check Parameters</strong> tab, set the <strong>Subject Filter</strong>. This setting allows you to define the number of users the service agent is to check. The default filter checks all users that are flagged with the <strong>dxrTBA</strong> flag (this flag indicates that the entry is "to be analyzed").</p>
</li>
<li>
<p>In the <strong>Consistency Check Limits</strong> tab, you can set several parameters that you can use to optimize runs. See the section "Service Agent Configuration File" for a detailed explanation.</p>
</li>
<li>
<p>In the <strong>Tracing</strong> tab, set the tracing parameters. By default, only errors are reported.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For a detailed description of the consistency check procedure, see the section "Consistency Check Workflow Operation".</p>
</div>
<div class="paragraph">
<p>The complete list of INI file parameters is shown in the next section.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch6_service_agent_configuration_file"><a class="anchor" href="#_ch6_service_agent_configuration_file"></a><a class="link" href="#_ch6_service_agent_configuration_file">6.2.2.2. Service Agent Configuration File</a></h5>
<div class="paragraph">
<p>The service agent initialization file (*.ini) file is a Java property file. Each property is described by <em>property name</em>=<em>property value</em>. Lines can be commented with a leading #. The following table describes the supported properties.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. DirX Identity Provisioning Service Agent INI File</caption>
<colgroup>
<col style="width: 19%;">
<col style="width: 34%;">
<col style="width: 47%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Section:</strong></th>
<th class="tableblock halign-left valign-top"><strong>Key:</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description:</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Tracing</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">trace.filename</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the trace file. All messages are written into one file. It is located in the working directory of the workflow activity.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">trace.level</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Trace level values are:</p>
</div>
<div class="paragraph">
<p>0 - no trace, no errors</p>
</div>
<div class="paragraph">
<p>1 - error (is default)</p>
</div>
<div class="paragraph">
<p>2-4: - warnings</p>
</div>
<div class="paragraph">
<p>5-8: - flow trace</p>
</div>
<div class="paragraph">
<p>9: - debug</p>
</div>
<div class="paragraph">
<p>Higher levels include the content of lower levels. This means: if you specify 5, errors and warnings are also written.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">trace.timestamp.format</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">When defined, precedes each line in the trace file with a timestamp. For details about the format specification, see below.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Request Properties</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">request</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Activity the agent is to perform:</p>
</div>
<div class="paragraph">
<p><strong>resolution</strong> - the agents evaluates many object types and resolves users and its privileges at the end.</p>
</div>
<div class="paragraph">
<p><strong>userResolution</strong> - the agent evaluates only users and their privileges.</p>
</div>
<div class="paragraph">
<p><strong>checkConsistency</strong> - the agent checks the consistency of the Identity Store (Provisioning Configuration) and performs a privilege resolution at the end.</p>
</div>
<div class="paragraph">
<p><strong>generateReport</strong> - the agent generates a report.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">report.name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DN of report configuration object in Identity Store (Provisioning Configuration).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">report.filename</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of report output file (optional), overwrites name in report configuration object, if present.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">report.outputFormat</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Format of report output. Valid options are:</p>
</div>
<div class="paragraph">
<p><strong>XML</strong> - XML format for further processing</p>
</div>
<div class="paragraph">
<p><strong>HTML</strong> - HTML format ready to view with browsers</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">report.sizelimit</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The maximum number of objects a report can retrieve.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Connection properties</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">domainRootDN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Distinguished name of DirX Identity Provisioning domain.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">user.expert.filter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of users to be checked or resolved. This parameter is not relevant for report mode.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bindProfile.hostname</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Host name of DirX Identity Provisioning Configuration</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bindProfile.isSSL</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>SSL switch:</p>
</div>
<div class="paragraph">
<p><strong>false</strong> - do not use SSL to connect to directory server (default)</p>
</div>
<div class="paragraph">
<p><strong>true</strong> - use SSL to connect to directory server</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bindProfile.securePort</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Port number (default 636) of DirX Identity Provisioning Configuration for SSL connections.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bindProfile.port</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Port number (default 389) of DirX Identity Provisioning Configuration for non-SSL connections.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bindProfile.user</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Distinguished name of DirX Identity Provisioning Configuration domain administrator.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bindProfile.pwd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Password of DirX Identity Provisioning Configuration domain administrator.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bindProfile.authenticationType</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Authentication type. Valid options are:</p>
</div>
<div class="paragraph">
<p><strong>SIMPLE</strong> - simple authentication (user and password)</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Performance properties</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">batch.accumulator.size</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of objects (default 500) to be read in advance before role resolution processing continues.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ldap.pagesize</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Page size (default 300) in paged search operations.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cache.update</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Cache update policy:</p>
</div>
<div class="paragraph">
<p><strong>always</strong> - Always update cached entry. The cached entry will be updated every time it is requested.</p>
</div>
<div class="paragraph">
<p><strong>never</strong> - Never update cached entry (default). An entry is read only once.</p>
</div>
<div class="paragraph">
<p><strong>timestamp</strong> Update cached entry if the entry in the directory server is newer.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cache.mru.size</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number of objects (default 10,000) to be cached</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Other Properties</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">suppressChangeEvents</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If set to <strong>true</strong>, no change events are fired for the resolved users.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_ch6_time_format_syntax"><a class="anchor" href="#_ch6_time_format_syntax"></a><a class="link" href="#_ch6_time_format_syntax">6.2.2.3. Time Format Syntax</a></h5>
<div class="paragraph">
<p>To specify the time format use a time pattern string. In this pattern, all ASCII letters are reserved as pattern letters, which are defined as the following:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 10%;">
<col style="width: 30%;">
<col style="width: 30%;">
<col style="width: 30%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Symbol</th>
<th class="tableblock halign-left valign-top">Meaning</th>
<th class="tableblock halign-left valign-top">Presentation</th>
<th class="tableblock halign-left valign-top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">G</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">era designator</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Text)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">AD</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">y</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">year</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Number)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1996</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">M</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">month in year</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Text &amp; Number)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">July &amp; 07</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">d</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">day in month</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Number)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">h</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">hour in am/pm</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(1~12)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">H</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">hour in day</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(0~23)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">m</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">minute in hour</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Number)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">30</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">s</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">second in minute</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Number)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">55</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">S</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">millisecond</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Number)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">978</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">E</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">day in week</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Text)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tuesday</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">D</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">day in year</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Number)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">189</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">day of week in month</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Number)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2 (2nd Wed in July)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">w</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">week in year</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Number)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">27</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">W</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">week in month</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Number)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">a</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">am/pm marker</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Text)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PM</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">k</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">hour in day</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(1~24)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">24</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">K</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">hour in am/pm</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(0~11)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">z</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">time zone</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Text)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pacific Standard Time</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">'</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">escape for text</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Delimiter)</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">''</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">single quote</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Literal)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'</p></td>
</tr>
</tbody>
</table>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>The definition</p>
</div>
<div class="paragraph">
<p><strong>trace.timestamp.format=EEE MMM d HH:mm:ss.SSS yyyy:</strong></p>
</div>
<div class="paragraph">
<p>results in</p>
</div>
<div class="paragraph">
<p>Wed Mar 3 11:30:21.323 2004: &#8230;&#8203; (rest of trace file line)</p>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch6_consistency_check_workflow_operation"><a class="anchor" href="#_ch6_consistency_check_workflow_operation"></a><a class="link" href="#_ch6_consistency_check_workflow_operation">6.2.2.4. Consistency Check Workflow Operation</a></h5>
<div class="paragraph">
<p>Running the DirX Identity service agent in <strong>consistency</strong> mode consists of these steps:</p>
</div>
<div class="paragraph">
<p><strong>Analyze Privileges toBeDeleted</strong></p>
</div>
<div class="paragraph">
<p>This module:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Searches for roles, permissions, and groups in state TBDEL</p>
</li>
<li>
<p>For each privilege in state TBDEL it</p>
</li>
<li>
<p>Removes the incoming assignments to users and / or senior privileges and sets the TBA (to-be-analyzed) flag for the affected objects.</p>
</li>
<li>
<p>Deletes roles / permissions or sets its state to DELETED if history is configured.</p>
</li>
<li>
<p>Sets the state of groups to DELETED.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Mark Affected Users</strong></p>
</div>
<div class="paragraph">
<p>This module:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Searches the whole user and privilege database.</p>
</li>
<li>
<p>Sets the TBA (to-be-analyzed) flag for all users that have a privilege assigned that is itself flagged with TBA. Considers direct and indirect relationships (indirect relationships go via a role or permission).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Analyze Users and Assignments</strong></p>
</div>
<div class="paragraph">
<p>This module analyzes assignments:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Searches all privilege assignments with relevant start or end dates. The exact filter is:<br>
(&amp;(|(objectClass=dxrUserToRole)(objectClass=dxrUserToGroup)(objectClass=dxrUserToPermission))<br>
(|(dxrEndDate=<strong>)(dxrStartDate=</strong>)))</p>
</li>
<li>
<p>Deletes out-dated start dates, removes assignments with out-dated end dates, and marks this user for privilege resolution.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Then it checks the consistency of the whole user database with the filter: (objectClass=dxrUser)</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Deletes users in state TBDEL with expired DeleteDate.</p>
</li>
<li>
<p>Sets the DeleteDate for users in state TBDEL that do not yet have a DeleteDate set.</p>
</li>
<li>
<p>Sets as StartDate the current date for users in state NEW that do not yet have a StartDate set.</p>
</li>
<li>
<p>Checks whether the various date fields of the user are consistent with the user state. If not, the user is flagged with TBA for a succeeding privilege resolution.</p>
</li>
<li>
<p>Checks whether the various date fields of the user are consistent, which means the sequence of the date fields must be StartDate, DisableStartDate, DisableEndDate, EndDate, DeleteDate.</p>
</li>
<li>
<p>Checks for broken references of privilege assignments.</p>
</li>
<li>
<p>Checks for correct user state and migrates the old state DELETED to TBDEL.</p>
</li>
<li>
<p>Flags users with TBA if the ErrorExpirationDate is reached. During the next privilege resolution, it stores the assigned groups even if the user is in error.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Analyze the Privilege Structure</strong></p>
</div>
<div class="paragraph">
<p>This module:</p>
</div>
<div class="paragraph">
<p>Analyzes the role structures:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Works on all roles within the database (filter: (objectClass=dxrRole)).</p>
</li>
<li>
<p>Checks whether the role is valid, that means it must have a permission or junior role assigned.</p>
</li>
<li>
<p>Checks for broken references to junior roles and assigned permissions.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Analyzes the permission structures:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Works on all permissions within the database (filter: (objectClass=dxrPermission)).</p>
</li>
<li>
<p>Checks whether the permission is valid, that means it must have a group assigned.</p>
</li>
<li>
<p>Checks for broken references to assigned groups.</p>
</li>
<li>
<p>Checks whether the permission is assigned to users if it is not flagged for user assignment.</p>
</li>
<li>
<p>Checks for correct permission parameters.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Analyze Target System Accounts</strong></p>
</div>
<div class="paragraph">
<p>This module:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Checks whether the <strong>Local Admin</strong> link of a target system is broken.</p>
</li>
<li>
<p>Works on all target system accounts within the database (filter: (objectClass=dxrTargetSystemAccount)).</p>
</li>
<li>
<p>Deletes all accounts that are marked with <strong>Managed in Target System Only</strong> that are in state <strong>Deleted</strong> in the target system.</p>
</li>
<li>
<p>Checks whether the target system of this account is of correct type and exists.</p>
</li>
<li>
<p>Checks for multiple primary accounts for a user.</p>
</li>
<li>
<p>Checks whether the <strong>User Link</strong> of the account is broken.</p>
</li>
<li>
<p>Checks for correct account states.</p>
</li>
<li>
<p>Deletes accounts that are in state DELETED and whose EndDate is expired.</p>
</li>
<li>
<p>Checks that the account is either marked for <strong>Managed in Target System Only</strong> and has no user link assigned or that it is not marked <strong>Managed in Target System Only</strong> and has a user link assigned.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Analyze Target System Groups</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Works on all target system groups within the database (filter: (objectClass=dxrTargetSystemGroup)).</p>
</li>
<li>
<p>Deletes all groups that are marked for <strong>Managed in Target System Only</strong> that are in state <strong>Deleted</strong> in the target system.</p>
</li>
<li>
<p>Checks whether all permission parameter values (dxrRPValues) are consistent with the permission parameter definition at the domain root object.</p>
</li>
<li>
<p>Checks for broken obligation links.</p>
</li>
<li>
<p>Checks for broken group members.</p>
</li>
<li>
<p>Checks whether the groups state has a correct value.</p>
</li>
<li>
<p>Deletes groups in state DELETED or DISABLED with expired EndDate.</p>
</li>
<li>
<p>Updates the distribution list of a virtual group.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Analyze User Changes</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Sends a resolve message to the Resolution Adapter for all users that match the expert filter of this consistency run.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch6_consistency_check_workflow_optimization"><a class="anchor" href="#_ch6_consistency_check_workflow_optimization"></a><a class="link" href="#_ch6_consistency_check_workflow_optimization">6.2.2.5. Consistency Check Workflow Optimization</a></h5>
<div class="paragraph">
<p>A set of parameters exist that optimize the role resolution in batch mode (as executed in the Service Agent or in the Policy Agent). Read this section carefully and perform the proposed actions. The names in brackets are the parameter names in the agents INI file.</p>
</div>
<div class="paragraph">
<p><strong>Object Accumulator Size (batch.accumulator.size; default=500)</strong></p>
</div>
<div class="paragraph">
<p>This parameter controls the algorithm that calculates the affected users from the privileges to be analyzed. Increasing this parameter reduces the number of LDAP searches but increases the length of the search filters.</p>
</div>
<div class="paragraph">
<p>We recommend keeping the default value as long as the searches are successful. You&#8217;ll need to reduce this parameter if the search for affected users results in an "Unwilling to perform" error returned by the LDAP Server.</p>
</div>
<div class="paragraph">
<p><strong>Object LDAP Page Size (ldap.pagesize; default=50)</strong></p>
</div>
<div class="paragraph">
<p>The effects of the LDAP page size parameter include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Increasing the LDAP page size reduces the number of LDAP searches.</p>
</li>
<li>
<p>The reduction of searches reduces the client-server communication overhead and thus improves performance.</p>
</li>
<li>
<p>Increasing the LDAP page size leads to increased heap space.</p>
</li>
<li>
<p>Furthermore, the time from one paged search to the next increases, since more users must be resolved until the next page is requested. Thus, it is more likely that a paging policy timeout at the LDAP server can occur. This timeout results in a fatal error in the ServiceAgent and processing is stopped.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The optimum LDAP page size depends on the customer&#8217;s data profile (privilege structure, number of accounts/groups assigned to a user, number of target systems). Thus, it should be optimized at the customer&#8217;s site:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Check the service agent runtime with LDAP page size of 50, 100, 150, 200, 250, 300.</p>
</li>
<li>
<p>Run the tests with full logging and check the time between subsequent paged user searches.</p>
</li>
<li>
<p>Ensure that the paging policy timeout does not abort the agent run. You may increase the paging policy timeout configured at the server or reduce the LDAP page size if the paging policy timeout is hit.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Object Cache MRU Size (cache.mru.size; default=10000)</strong></p>
</div>
<div class="paragraph">
<p>The objects being read via LDAP are stored in a cache in the storage layer. The Object Cache MRU Size defines the size of the most recently used cache, holding the objects that are not affected by the garbage collector. If the Object Cache MRU Size is too low, the objects are removed by the garbage collector and are restored from LDAP when they are accessed the next time. This slows down the agent considerably.</p>
</div>
<div class="paragraph">
<p>A debug message "gc: recovering properties for <em>dn</em>" is issued in this case.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Periodically run the ServiceAgent with full logging and check for that message. This task must be done from time to time since additional privileges / target systems may require a change in this setting.</p>
</li>
<li>
<p>In case the garbage collector message often occurs, increase the Object Cache MRU Size (cache.mru.size) to a higher value, until the message disappears.</p>
</li>
<li>
<p>An increase of the Object Cache MRU Size may require an increase of the maximum heap space of the Service Agent, since more objects are held in the cache that are not removed by the garbage collector.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Further Optimization</strong></p>
</div>
<div class="paragraph">
<p>In a scenario with a target system holding a small number of groups that keep almost every user as a member (the account memberships are stored with the groups) the XXLGroups flag should be checked at the target system&#8217;s advanced tab.</p>
</div>
<div class="paragraph">
<p>Checking this flag will result in caching all the groups of this target system during role resolution. If you have hundreds of groups in a TS, the XXLGroups flag must not be checked since the initial load of this large number of groups is time- and memory consuming then.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch6_extract_audit_trail_workflow"><a class="anchor" href="#_ch6_extract_audit_trail_workflow"></a><a class="link" href="#_ch6_extract_audit_trail_workflow">6.2.3. Extract Audit Trail Workflow</a></h4>
<div class="paragraph">
<p>The Extract Audit Trail workflow checks the Identity Store for audit trail records in the Provisioning view. It writes these records to the audit trail database (a file store) and performs a cleanup of the audit trail records in the Identity Store.</p>
</div>
<div class="paragraph">
<p>You can define the objects to be audited via audit policies. See the section "Managing the Audit Trail" in the <em>DirX Identity Provisioning Administration Guide</em>.</p>
</div>
<div class="paragraph">
<p>If you work with DirX Audit, you do not need to run this workflow. In this case, the LDAP binding component is used to extract the audit records.</p>
</div>
<div class="paragraph">
<p>Read the following sections to learn more about how to configure the workflow.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This workflow runs in the C++-based Identity Server but does not run in conjunction with the meta controller and thus does not use Tcl code.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_ch6_configuring_the_extract_audit_trail_workflow"><a class="anchor" href="#_ch6_configuring_the_extract_audit_trail_workflow"></a><a class="link" href="#_ch6_configuring_the_extract_audit_trail_workflow">6.2.3.1. Configuring the Extract Audit Trail Workflow</a></h5>
<div class="paragraph">
<p>To configure this workflow, run the workflow configuration wizard (option <strong>Configure</strong> in the context menu):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In the <strong>Export Properties</strong> tab, you can define the base objects at which to start the search, the subset and the filter. Modify the base object if you want to run several Extract Audit Trail workflows in parallel on different parts of the Identity Store.</p>
</li>
<li>
<p>In the <strong>Import Properties</strong> tab, you can define the file path at which to write the extracted information.*<br>
Note*: It makes sense to place the audit trail database on a separate disk to prevent all other processes from stopping when this disk is full.</p>
</li>
<li>
<p>In the <strong>Tracing</strong> tab, you can define the tracing parameters.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>By default, the workflow produces the history audit record format of version 8.0C and earlier. Beginning with 8.0C SP1, an extended history audit format is available. This format is used in conjunction with the DirX Audit product but you can also use it in your custom audit environment. To configure it, perform these steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Select the <strong>job object</strong> of your Extract Audit Trail workflow.</p>
</li>
<li>
<p>Select the <strong>Specific Attributes</strong> tab.</p>
</li>
<li>
<p>Click <strong>Edit</strong> and set the parameter name to <strong>transformToPre80CSP0</strong> and the value to <strong>false</strong>.</p>
</li>
<li>
<p>Click <strong>Save</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Now the workflow produces the new audit format.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch6_full_sod_check_workflow"><a class="anchor" href="#_ch6_full_sod_check_workflow"></a><a class="link" href="#_ch6_full_sod_check_workflow">6.2.4. Full SoD Check Workflow</a></h4>
<div class="paragraph">
<p>This workflow runs the policy execution service. By default, the workflow is configured for the following consistency rule:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>FullSoDCheck</strong> - processes all active SoD policies. For each policy, all users are checked. Found violations result in approval workflow start for all according privileges.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This workflow runs in the C++-based Server but does not run in conjunction with the meta controller and thus does not use Tcl code.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_ch6_configuring_the_full_sod_check_workflow"><a class="anchor" href="#_ch6_configuring_the_full_sod_check_workflow"></a><a class="link" href="#_ch6_configuring_the_full_sod_check_workflow">6.2.4.1. Configuring the Full SoD Check Workflow</a></h5>
<div class="paragraph">
<p>To configure this workflow, run the workflow configuration wizard (option <strong>Configure</strong> in the context menu):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In the <strong>Rule Search Parameters</strong> tab, you can change the rule to be executed. By default, the standard FullSoDCheck rule is used.</p>
</li>
<li>
<p>In the <strong>User Search Parameters</strong> tab, you can set several parameters to optimize runs. See the section "Policy Agent Optimization" in the <em>DirX Identity Provisioning Administration Guide</em>.</p>
</li>
<li>
<p>In the <strong>Tracing</strong> tab, set the tracing parameters. By default, the workflow reports errors and warnings.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We recommend that you run this workflow once a day to check for SoD violations.</p>
</div>
<div class="paragraph">
<p>Be sure that your user database is prepared for SoD checks. If you are in doubt, run the <strong>MigrateUsersForSoD</strong> rule once.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch6_initialize_re_approval_workflow"><a class="anchor" href="#_ch6_initialize_re_approval_workflow"></a><a class="link" href="#_ch6_initialize_re_approval_workflow">6.2.5. Initialize Re-approval Workflow</a></h4>
<div class="paragraph">
<p>This workflow runs the policy execution service. By default, the workflow is configured for the following consistency rule:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>InitializePrivilegeForReapproval</strong> - this rule processes all privileges that require re-approval. Each assignment to such a privilege is initialized for re-approval, which sets their reapproval and end date or period attributes.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This workflow runs in the C++-based Server but does not run in conjunction with the meta controller and thus does not use Tcl code.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_ch6_configuring_the_initialize_re_approval_workflow"><a class="anchor" href="#_ch6_configuring_the_initialize_re_approval_workflow"></a><a class="link" href="#_ch6_configuring_the_initialize_re_approval_workflow">6.2.5.1. Configuring the Initialize Re-approval Workflow</a></h5>
<div class="paragraph">
<p>To configure this workflow, run the workflow configuration wizard (option <strong>Configure</strong> in the context menu):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In the <strong>Rule Search Parameters</strong> tab, you can change the rule to be executed. By default, the standard InitializeReapproval rule is used.</p>
</li>
<li>
<p>In the <strong>User Search Parameters</strong> tab, you can set several parameters to optimize runs. See the section "Policy Agent Optimization" in the <em>DirX Identity Provisioning Administration Guide</em>.</p>
</li>
<li>
<p>In the <strong>Tracing</strong> tab, set the tracing parameters. By default, the workflow reports errors and warnings.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We recommend that you run this workflow once a day to initialize re-approval. After running this workflow, you should run the Start Reapproval Workflow.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch6_password_expiration_notification_workflow"><a class="anchor" href="#_ch6_password_expiration_notification_workflow"></a><a class="link" href="#_ch6_password_expiration_notification_workflow">6.2.6. Password Expiration Notification Workflow</a></h4>
<div class="paragraph">
<p>The Password Expiration Notification workflow checks user entries for passwords that are about to expire and sends a notification (e-mail) to the affected users. The workflow:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Sends a configurable number of notifications (the time between the notifications depends on the schedule frequency).</p>
</li>
<li>
<p>Allows you to define e-mail format.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This workflow runs in the C++-based Server but does not run in conjunction with the meta controller and thus does not use Tcl code.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_ch6_configuring_the_password_expiration_notification_workflow"><a class="anchor" href="#_ch6_configuring_the_password_expiration_notification_workflow"></a><a class="link" href="#_ch6_configuring_the_password_expiration_notification_workflow">6.2.6.1. Configuring the Password Expiration Notification Workflow</a></h5>
<div class="paragraph">
<p>To complete the configuration for this workflow, you must adapt some values in the DirX Identity Connectivity configuration to your environment. Use the configuration wizard in the Identity Manager global view as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Double-click the connected directory icon <strong>Mail Server</strong>.</p>
</li>
<li>
<p>In the wizard window, click the icon to the right of the <strong>Service</strong> field.</p>
</li>
<li>
<p>Change the <strong>IP Address</strong> and <strong>Port</strong> fields to define the mail server.</p>
</li>
<li>
<p>Click <strong>OK</strong>.</p>
</li>
<li>
<p>In the wizard window, click <strong>Bind Profiles</strong>.</p>
</li>
<li>
<p>In <strong>Bind</strong> <strong>Profiles</strong>, click <strong>Admin</strong>, and then click the button on the right to open the property window for this entry.</p>
</li>
<li>
<p>Set the <strong>User</strong> and <strong>Password</strong> fields if your mail server requires authentication.</p>
</li>
<li>
<p>Click <strong>OK</strong> and then click <strong>Finish</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can also set the notification parameters of the workflow:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Right-click the workflow line between the connected directory icons <strong>Identity</strong> <strong>Store</strong> and <strong>Mail Server</strong>.</p>
</li>
<li>
<p>In the pop-up menu, select the workflow <strong>PwExpirationNotification</strong> and then click <strong>Configure</strong>.</p>
</li>
<li>
<p>Click <strong>MailConfiguration</strong> and/or <strong>MailContent</strong>.</p>
</li>
<li>
<p>Adjust the values as required.</p>
</li>
<li>
<p>Click <strong>Finish</strong> to close the wizard and save your changes.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>At last you must go to the Mail Server Connected Directory in the <strong>Expert View</strong> and either set the specific attribute <strong>mapmailaddress</strong> to a valid administrator mail address if you want that all mails about expired passwords are sent to that administrator or delete the preconfigured value âdummyâ if you want the mails to be sent to each userâs mail address specified in the âtoâ field of the <strong>Mail Configuration</strong> tab of the <strong>PwExpirationNotification</strong> job.</p>
</div>
<div class="paragraph">
<p>Now the workflow should run.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch6_password_expiration_notification_workflow_operation"><a class="anchor" href="#_ch6_password_expiration_notification_workflow_operation"></a><a class="link" href="#_ch6_password_expiration_notification_workflow_operation">6.2.6.2. Password Expiration Notification Workflow Operation</a></h5>
<div class="paragraph">
<p>You can assign to each user a password policy. The password policy is assigned via the password policy link (attribute <strong>dxrPwdPolicyLink</strong>). If no password policy is assigned, the default password policy is used. The expiration calculation depends on the following attributes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>dxrPwdMaxAge</strong> (Maximum age) - at the password policy. It defines the maximum allowed age of the password.</p>
</li>
<li>
<p><strong>dxrPwdExpireWarning</strong> (Expiration Warning Time) - at the password policy. The time to warn before the password expires.</p>
</li>
<li>
<p><strong>dxrPwdChangedTime</strong> (Password Changed Time) - at the user entry. The last time the password was changed.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the current date is greater than (<strong>dxrPwdChangedTime+dxrPwdMaxAge-dxrPwdExpireWarning</strong>), the workflow generates a warning e-mail.</p>
</div>
<div class="paragraph">
<p>After sending the warning, the <strong>dxrPwdExpiryNotified</strong> (Password Expiration Notified) attribute of the user entry is incremented. If the configured <strong>Number of Notifications</strong> is reached no more warnings are sent on subsequent workflow runs.</p>
</div>
<div class="paragraph">
<p>If the user changes the password or an administrator resets the password with Web Center the <strong>dxrPwdExpiryNotified</strong> attribute is reset to <strong>0</strong> again.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch6_policy_execution_workflow"><a class="anchor" href="#_ch6_policy_execution_workflow"></a><a class="link" href="#_ch6_policy_execution_workflow">6.2.7. Policy Execution Workflow</a></h4>
<div class="paragraph">
<p>This workflow runs the policy execution service to assign and remove privileges automatically. By default, the workflow is configured for the following provisioning rules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>cn=Role based scenario,cn=Rules,cn=Policies,cn=My-Company</strong> - the workflow executes all provisioning rules under this specified node.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This workflow runs in the C++-based Server but does not run in conjunction with the meta controller and thus does not use Tcl code.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_ch6_configuring_the_policy_execution_workflow"><a class="anchor" href="#_ch6_configuring_the_policy_execution_workflow"></a><a class="link" href="#_ch6_configuring_the_policy_execution_workflow">6.2.7.1. Configuring the Policy Execution Workflow</a></h5>
<div class="paragraph">
<p>To configure this workflow, run the workflow configuration wizard (option <strong>Configure</strong> in the context menu):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In the <strong>Policy Agent Parameters</strong> tab, you can define whether the workflow runs in simulation mode (<strong>Simulate rules</strong>) or in real mode (<strong>Process rules</strong>). In simulation mode it only logs information and makes no changes in the Identity Store.<br>
<br>
Additionally you can define if, after an assignment, the user should be immediately resolved (<strong>Assign Privilege and Resolve</strong>). You should use this feature only when your Provisioning domain uses simple privilege structures and has a small Identity Store. The service assigns a privilege to a user and then resolves the user. Assignment of several privileges to the same user results in multiple resolutions of this user, which can result in low performance. To optimize performance, you can build a nested workflow that consists of a policy execution step and a privilege resolution step.<br></p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If SoD is enabled at the domain object, the option <strong>Assign Privilege and Resolve</strong> is enforced because SoD works hierarchically and therefore a resolution is always necessary. If possible assign several privileges with one rule instead of assigning each privilege with a separate rule. The result is a faster running policy engine process.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If <strong>Suppress Change Events</strong> is set to true no âUser Change Eventsâ are initiated.</p>
</div>
</li>
<li>
<p>In the <strong>Rule Search Parameters</strong> tab, you can select the set of rules to be executed.</p>
</li>
<li>
<p>In the <strong>User Search Parameters</strong> tab, you can set several parameters to optimize runs. See the section "Policy Agent Optimization" in the <em>DirX Identity Provisioning Administration Guide</em>.</p>
</li>
<li>
<p>In the <strong>Tracing</strong> tab, set the tracing parameters. By default, the workflow reports errors and warnings.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We recommend that you run this workflow once a day to check for SoD violations.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch6_policy_execution_workflow_optimization"><a class="anchor" href="#_ch6_policy_execution_workflow_optimization"></a><a class="link" href="#_ch6_policy_execution_workflow_optimization">6.2.7.2. Policy Execution Workflow Optimization</a></h5>
<div class="paragraph">
<p>For optimization or in case of specific errors read the section "Consistency Check Workflow Optimization".</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch6_privilege_resolution_workflow"><a class="anchor" href="#_ch6_privilege_resolution_workflow"></a><a class="link" href="#_ch6_privilege_resolution_workflow">6.2.8. Privilege Resolution Workflow</a></h4>
<div class="paragraph">
<p>The Privilege Resolution workflow runs the service agent in <strong>resolution</strong> mode. The next sections describe:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>how to configure the workflow</p>
</li>
<li>
<p>how the workflow operates</p>
</li>
<li>
<p>how to optimize the workflow</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This workflow runs in the C++-based Server but does not run in conjunction with the meta controller and thus does not use Tcl code.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_ch6_configuring_the_privilege_resolution_workflow"><a class="anchor" href="#_ch6_configuring_the_privilege_resolution_workflow"></a><a class="link" href="#_ch6_configuring_the_privilege_resolution_workflow">6.2.8.1. Configuring the Privilege Resolution Workflow</a></h5>
<div class="paragraph">
<p>To configure this workflow, run the workflow configuration wizard (option <strong>Configure</strong> in the context menu):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In the <strong>Privilege Resolution Parameters</strong> tab, set the <strong>Subject Filter</strong>. This setting allows you to define the number of users the service agent is to check. The default filter checks all users that are flagged with the <strong>dxrTBA</strong> flag (this flag indicates that the entry is "to be analyzed").</p>
</li>
<li>
<p>In the <strong>Provisioning Resolution Limits</strong> tab, you can set several parameters that you can use to optimize runs. See the section "Service Agent Configuration File" for a detailed explanation.</p>
</li>
<li>
<p>In the <strong>Tracing</strong> tab, set the tracing parameters. By default, only errors are reported.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For a detailed description of the privilege resolution procedure, see the section "Privilege Resolution Workflow Operation".</p>
</div>
<div class="paragraph">
<p>The complete list of INI file parameters is shown in the section "Service Agent Configuration File".</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch6_privilege_resolution_workflow_operation"><a class="anchor" href="#_ch6_privilege_resolution_workflow_operation"></a><a class="link" href="#_ch6_privilege_resolution_workflow_operation">6.2.8.2. Privilege Resolution Workflow Operation</a></h5>
<div class="paragraph">
<p>How privilege resolution works regarding accounts and account-group-memberships and its related states is described in detail in the chapter "Managing Provisioning &#8594; Managing States &#8594; How Privilege Resolution Works" <em>DirX Identity Provisioning Administration Guide</em>.</p>
</div>
<div class="paragraph">
<p>Running the DirX Identity service agent in <strong>user</strong> <strong>resolution</strong> mode consists of these steps:</p>
</div>
<div class="paragraph">
<p><strong>Analyze User Changes</strong></p>
</div>
<div class="paragraph">
<p>This module:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Executes a privilege resolution on all users that match the expert filter of this run.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Running the DirX Identity service agent in <strong>resolution</strong> mode consists of these steps:</p>
</div>
<div class="paragraph">
<p><strong>Analyze Privileges toBeDeleted</strong></p>
</div>
<div class="paragraph">
<p>This module:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Searches for roles, permissions, and groups in state TBDEL.</p>
</li>
<li>
<p>For each privilege in state TBDEL it</p>
</li>
<li>
<p>Removes the incoming assignments to users and / or senior privileges and sets the TBA (to-be-analyzed) flag for the affected objects.</p>
</li>
<li>
<p>Deletes roles / permissions or sets it state to DELETED if history is configured.</p>
</li>
<li>
<p>Sets the state of groups to DELETED.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Mark Affected Users</strong></p>
</div>
<div class="paragraph">
<p>This module:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Searches the whole user and privilege database.</p>
</li>
<li>
<p>Sets the TBA (to-be-analyzed) flag for all users that have a privilege assigned that is itself flagged with TBA. Considers direct and indirect relationships (indirect relationships go via an assignment object).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Analyze Users and Assignments</strong></p>
</div>
<div class="paragraph">
<p>This module analyzes assignments:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Searches all privilege assignments with relevant start or end dates. The exact filter is:<br></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ldap hljs" data-lang="ldap">(&amp;(|(objectClass=dxrUserToRole)(objectClass=dxrUserToGroup)(objectClass=dxrUserToPermission))(|(dxrEndDate&lt;=today)(dxrStartDate&lt;=today)))</code></pre>
</div>
</div>
<div class="paragraph">
<p>where <em>today</em> is replaced with the current date</p>
</div>
</li>
<li>
<p>Deletes the start date or privilege assignment and marks this user for privilege resolution.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Then it searches for users that must undergo a state transition:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Is searches for all users with inconsistent state and dates and flags these users with TBA. The exact filter is:<br></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ldap hljs" data-lang="ldap">(&amp;(objectClass=dxrUser)(|(&amp;(dxrEndDate&lt;=today)(|(dxrState=ENABLED)(dxrState=DISABLED)))(&amp;(dxrStartDate&lt;=today)(dxrState=NEW))(&amp;(dxrDisableEndDate&lt;=today)(dxrState=DISABLED))(&amp;(dxrDisableStartDate&lt;=today)(dxrState=ENABLED))(dxrDeleteDate&lt;=today)(&amp;(dxrState=TBDEL)(!(dxrEndDate&lt;=today)))))</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Analyze Target System Accounts</strong></p>
</div>
<div class="paragraph">
<p>This module:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Deletes accounts that are in state DELETED and whose EndDate is expired.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Analyze Target System Groups</strong></p>
</div>
<div class="paragraph">
<p>This module:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Deletes groups in state DELETED or DISABLED with expired EndDate.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Analyze User Changes</strong></p>
</div>
<div class="paragraph">
<p>This module:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Executes a privilege resolution on all users that match the expert filter of this run.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch6_privilege_resolution_workflow_optimization"><a class="anchor" href="#_ch6_privilege_resolution_workflow_optimization"></a><a class="link" href="#_ch6_privilege_resolution_workflow_optimization">6.2.8.3. Privilege Resolution Workflow Optimization</a></h5>
<div class="paragraph">
<p>For optimization or in case of specific errors read the section "Consistency Check Workflow Optimization".</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch6_run_workflow_externally_workflow"><a class="anchor" href="#_ch6_run_workflow_externally_workflow"></a><a class="link" href="#_ch6_run_workflow_externally_workflow">6.2.9. Run Workflow Externally Workflow</a></h4>
<div class="paragraph">
<p>Use the Run Workflow Externally workflow to start Tcl-based workflows in another Connectivity domain. This workflow allows you to control processes between independent DirX Identity Connectivity domains.</p>
</div>
<div class="paragraph">
<p><strong>Note:</strong> This workflow runs in the C++-based Server but does not run in conjunction with the meta controller and thus does not use Tcl code.</p>
</div>
<div class="sect4">
<h5 id="_ch6_configuring_the_run_workflow_externally_workflow"><a class="anchor" href="#_ch6_configuring_the_run_workflow_externally_workflow"></a><a class="link" href="#_ch6_configuring_the_run_workflow_externally_workflow">6.2.9.1. Configuring the Run Workflow Externally Workflow</a></h5>
<div class="paragraph">
<p>To configure this workflow, run the workflow configuration wizard (option <strong>Configure</strong> in the context menu).</p>
</div>
<div class="paragraph">
<p>In the <strong>runWf</strong> tab, define the following parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>WorkflowName</strong> - defines the path of the workflow definition. For example, "Default/Source Scheduled/LDIFfile/LDIFfile2Ident" starts the LDIFfile2Ident workflow.</p>
</li>
<li>
<p><strong>Instantiator</strong> - defines the name of the foreign domain (or any other meaningful name) that is later visible in the status entry.</p>
</li>
<li>
<p><strong>MessageServer</strong> - selects your type of message server.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the <strong>Tracing</strong> tab, you can change the tracing parameters.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch6_start_re_approval_workflow"><a class="anchor" href="#_ch6_start_re_approval_workflow"></a><a class="link" href="#_ch6_start_re_approval_workflow">6.2.10. Start Re-approval Workflow</a></h4>
<div class="paragraph">
<p>This workflow runs the policy execution service. By default, the workflow is configured for the following consistency rule:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>StartWorkflowsForReapproval</strong> - this rule starts the request workflow that has been configured for the privilege that requires re-approval.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This workflow runs in the C++-based Server but does not run in conjunction with the meta controller and thus does not use Tcl code.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_ch6_configuring_the_start_reapproval_workflow"><a class="anchor" href="#_ch6_configuring_the_start_reapproval_workflow"></a><a class="link" href="#_ch6_configuring_the_start_reapproval_workflow">6.2.10.1. Configuring the Start Reapproval Workflow</a></h5>
<div class="paragraph">
<p>To configure this workflow, run the workflow configuration wizard (option <strong>Configure</strong> in the context menu):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In the <strong>Rule Search Parameters</strong> tab, you can change the rule to be executed. By default, the standard StartWorkflowsForReapproval rule is used.</p>
</li>
<li>
<p>In the <strong>User Search Parameters</strong> tab, you can set several parameters to optimize runs. See the section "Policy Agent Optimization" in the <em>DirX Identity Provisioning Administration Guide</em>.</p>
</li>
<li>
<p>In the <strong>Tracing</strong> tab, set the tracing parameters. By default, the workflow reports errors and warnings.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We recommend that you run this workflow once a day to run all necessary re-approval workflows. Before running this workflow, you should run the Initialize Reapproval Workflow.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch6_status_report_generation_workflow"><a class="anchor" href="#_ch6_status_report_generation_workflow"></a><a class="link" href="#_ch6_status_report_generation_workflow">6.2.11. Status Report Generation Workflow</a></h4>
<div class="paragraph">
<p>This workflow allows you to run reports by hand or automatically. DirX Identity provides a pre-configured status report workflow for both the Provisioning and the Connectivity views:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>ReportGeneration</strong> - this workflow is an example of a Provisioning status report that works on the users tree. The Status Report Generation workflow for the <strong>Provisioning view</strong> runs the service agent in the <strong>generateReports</strong> mode.</p>
</li>
<li>
<p><strong>Ident2Report</strong> - this workflow is an example of a Connectivity configuration status report. The Status Report Generation workflow for the <strong>Connectivity view</strong> runs a special report agent.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The next sections describe how to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Configure the workflow for the Provisioning view</p>
</li>
<li>
<p>Configure the workflow for the Connectivity view</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This workflow runs in the C++-based Server but does not run in conjunction with the meta controller and thus does not use Tcl code.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_ch6_configuring_the_status_report_generation_workflow_for_the_provisioning_view"><a class="anchor" href="#_ch6_configuring_the_status_report_generation_workflow_for_the_provisioning_view"></a><a class="link" href="#_ch6_configuring_the_status_report_generation_workflow_for_the_provisioning_view">6.2.11.1. Configuring the Status Report Generation Workflow for the Provisioning View</a></h5>
<div class="paragraph">
<p>To configure this workflow, run the workflow configuration wizard (option <strong>Configure</strong> in the context menu):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In the <strong>Report Parameters</strong> tab, you can set the report definition path, the output format and the size limit. See the section "Service Agent Configuration File" for a detailed explanation.</p>
</li>
<li>
<p>In the <strong>Report Output File Properties</strong> tab, set the file name to which the report is to be written.</p>
</li>
<li>
<p>In the <strong>Tracing</strong> tab, set the tracing parameters. By default, only errors are reported.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For a detailed description of the privilege resolution procedure, see the section "Privilege Resolution Workflow Operation".</p>
</div>
<div class="paragraph">
<p>The complete list of INI file parameters is shown in the Consistency Check Workflow section. See the section "Service Agent Configuration File".</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch6_configuring_the_status_report_generation_workflow_for_the_connectivity_view"><a class="anchor" href="#_ch6_configuring_the_status_report_generation_workflow_for_the_connectivity_view"></a><a class="link" href="#_ch6_configuring_the_status_report_generation_workflow_for_the_connectivity_view">6.2.11.2. Configuring the Status Report Generation Workflow for the Connectivity View</a></h5>
<div class="paragraph">
<p>To configure this workflow, run the workflow configuration wizard (option <strong>Configure</strong> in the context menu):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In the <strong>Report Properties</strong> tab, you can set the search base, the report name and the output format.</p>
</li>
<li>
<p>In the <strong>Tracing</strong> tab, set the tracing parameters. By default, no trace is performed.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_the_target_system_provisioning_workflows"><a class="anchor" href="#_using_the_target_system_provisioning_workflows"></a><a class="link" href="#_using_the_target_system_provisioning_workflows">7. Using the Target System (Provisioning) Workflows</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>DirX Identity target system (Provisioning) workflows synchronize information from connected systems with the Identity Store.</p>
</div>
<div class="paragraph">
<p>The DirX Identity target system workflows provided with the default Connectivity scenario include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Initial load/validation workflows - workflows that perform an initial load or a validation from the connected system.In <strong>initial load</strong> mode, existing accounts and groups can be loaded from the connected system into the Identity Store.In <strong>validation</strong> mode, the workflow compares accounts and group information from the connected system with the current content of the Identity Store and updates the objects in DirX Identity or marks the differences for later reconciliation.</p>
</li>
<li>
<p>Synchronization workflows - workflows that synchronize accounts and groups from the Identity Store to the corresponding connected system.This type of workflow runs in full, delta or event-triggered mode to provision the changed information as quickly as possible.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This chapter provides detailed information about target system workflow configuration, special features and user hooks.The sections in this chapter include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Extending the Schema for Target System Workflows - describes the procedure for extending the DirX Identity Store schema with target system-specific information required by most (but not all) of the Java-based and Tcl-based target system workflows.</p>
</li>
<li>
<p>Understanding Java-based Target System Workflows - describes the Java-based target system workflows.</p>
</li>
<li>
<p>Understanding Tcl-based Target System Workflows - describes the Tcl-based target system workflows.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="extending_the_schema_for_target_system_workflows"><a class="anchor" href="#extending_the_schema_for_target_system_workflows"></a><a class="link" href="#extending_the_schema_for_target_system_workflows">7.1. Extending the Schema for the Target System Workflows</a></h3>
<div class="paragraph">
<p>Most of the target system provisioning workflows require you to extend the schema for the DirX Identity Store so that it can store target system-specific information. Setting up the Identity Store schema depending on the type of target systems you&#8217;d like to provision is a task that you should plan thoroughly. You should only set up the required object classes and attributes to guarantee high performance and easy handling.</p>
</div>
<div class="paragraph">
<p>If you selected to install the Sample Domain when you installed and configured DirX Identity, the configuration procedure has automatically extended the Identity Store schema with a minimal set of attributes and object classes for most of the supported target systems. You should check these schema extensions to make sure they meet your provisioning requirements. If you do not install the Sample Domain, no automatic schema extensions are performed. As a result, if you have not installed the Sample Domain or you want to use additional target system-specific attributes that are not present in the Identity Store schema, you need to extend the schema manually by:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Customizing the target system-specific schema LDIF files provided with DirX Identity to your requirements.</p>
</li>
<li>
<p>Running the agent schema tool to install your schema customizations.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The next sections describe how to perform these tasks.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
We strongly recommend that you back up your directory before you run any scripts. You cannot reverse schema extensions in a directory.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_ch7_customizing_the_ldif_schema_files"><a class="anchor" href="#_ch7_customizing_the_ldif_schema_files"></a><a class="link" href="#_ch7_customizing_the_ldif_schema_files">7.1.1. Customizing the LDIF Schema Files</a></h4>
<div class="paragraph">
<p>DirX Identity provides several complete sets of attribute and object class extensions for each supported target system type, delivered as LDIF files. The first step in extending the schema is to update these schema definitions according to your requirements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Open the directory <em>install_path</em>*/schema/tools*.</p>
</li>
<li>
<p>Open the subdirectory that corresponds to your directory installation: <strong>dirx-ee</strong> for a DirX Directory installation.</p>
</li>
<li>
<p>Copy the entire <strong>Customer</strong> <strong>Domain</strong> subdirectory and name it <strong>Customer Domain.orig</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Now you can update the schema definitions in the <strong>Customer</strong> <strong>Domain</strong> subdirectory according to your requirements.</p>
</div>
<div class="paragraph">
<p>For a DirX Directory installation (dirx-ee is DirX Directory V8.3 or newer):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In the <strong>ldif</strong> subdirectory, select the LDIF file that corresponds to your DirX Identity Connectivity package. For example, <strong>dirx.nt.ldif</strong>.</p>
</li>
<li>
<p>Remove the attributes you don&#8217;t want to use by removing their corresponding <strong>MODIFY</strong> records that refer to <strong>attributeTypes</strong> creations.</p>
</li>
<li>
<p>Remove these attributes from the object class definitions by removing their corresponding LDAP attribute names from the <strong>MODIFY</strong> records that refer to <strong>objectClasses</strong> creations.</p>
</li>
<li>
<p>If indexes have been defined for these attributes, remove the attribute types from the <strong>dbconfig_opt</strong> statements in the <strong>dirxadm</strong> script of your DirX Identity Connectivity package. For example, <strong>DirXmetahub-schema.Nt.adm</strong> for Windows NT.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Now you can use the agent schema tool to install your schema extensions.</p>
</div>
</div>
<div class="sect3">
<h4 id="_ch7_installing_the_ldif_schema_extensions"><a class="anchor" href="#_ch7_installing_the_ldif_schema_extensions"></a><a class="link" href="#_ch7_installing_the_ldif_schema_extensions">7.1.2. Installing the LDIF Schema Extensions</a></h4>
<div class="paragraph">
<p>To install your schema extensions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Under <em>install_path</em>/<strong>schema/tools</strong>, run the script <strong>agent-schema.bat</strong> (on Windows) or <strong>agent-schema.sh</strong> (on UNIX).</p>
</li>
<li>
<p>Type the password of the DirX Identity administrator <strong>admin</strong>.</p>
</li>
<li>
<p>Select the appropriate DirX Identity Connectivity package to install this part of the schema extension. If you have multiple Connectivity packages to extend, you must select each Connectivity package separately.</p>
</li>
<li>
<p>Select whether or not to create the attribute indexes.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The schema extensions are now installed. Check the <strong>trace.txt</strong> file for errors (the exit codes at the end should be <strong>0</strong>).</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_understanding_java_based_target_system_workflows"><a class="anchor" href="#_understanding_java_based_target_system_workflows"></a><a class="link" href="#_understanding_java_based_target_system_workflows">7.2. Understanding the Java-based Target System Workflows</a></h3>
<div class="paragraph">
<p>This section provides configuration hints and details about the Java-based target system (provisioning) workflows, including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ADS workflows (Microsoft) - default workflows that provision the Microsoft Active Directory including the Exchange Server and the Skype for Business Server (formerly the Lync Server).</p>
</li>
<li>
<p>Citrix ShareFile workflows - default workflows that provision a Citrix ShareFile system.</p>
</li>
<li>
<p>DirX Access workflows - there exist two methods to connect DirX Access with DirX Identity.</p>
</li>
<li>
<p>Evidian Single Sign-on (ESSO) workflows - workflows that provision an Evidian ESSO system.</p>
</li>
<li>
<p>Google Apps workflows - default workflows that provision a target system of type <strong>Google</strong> <strong>Apps</strong> in the Identity Store and the corresponding connected Google Apps endpoint.</p>
</li>
<li>
<p>Imprivata workflows - default workflows that synchronize data between a target system of type <strong>SPMLv1</strong> in the Identity Store and the corresponding connected Imprivata OneSign system.</p>
</li>
<li>
<p>JDBC workflows - default workflows that provision three predefined tables in any relational database that provides a JDBC connection.</p>
</li>
<li>
<p>LDAP workflows - default workflows that provision any LDAP directory.</p>
</li>
<li>
<p>IBM Notes workflows (IBM) - workflows that provision IBM Notes.</p>
</li>
<li>
<p>Medico workflows (Siemens) - workflows that provision the Siemens healthcare medico//s system.</p>
</li>
<li>
<p>Office 365 workflows - workflows that provision a target system of type <strong>Office365</strong> in the Identity Store and the corresponding connected Office 365 endpoint.</p>
</li>
<li>
<p>OpenICF Windows Local Accounts workflows - workflows that synchronize data between a target system of type <strong>OpenICF</strong> in the Identity Store and the corresponding connected Windows local accounts and groups system accessible through a .Net OpenICF connector server.</p>
</li>
<li>
<p>RACF workflows - default workflows that provision RACF systems via the IBM Tivoli Directory Server (LDAP).</p>
</li>
<li>
<p>Salesforce workflows - workflows that provision a target system of type <strong>Salesforce</strong> in the Identity Store and the corresponding connected Salesforce system.</p>
</li>
<li>
<p>SAP ECC (R/3) UM workflows - workflows that synchronize data between a target system of type SAPR3UM in the Identity Store and the corresponding connected SAP R/3 system.</p>
</li>
<li>
<p>Service Management workflows - workflows that allow for manual provisioning of offline (not connected) target systems.</p>
</li>
<li>
<p>SharePoint workflows (Microsoft) - workflows that provision Microsoft SharePoint server sites in conjunction with the ADS workflows.</p>
</li>
<li>
<p>Unify Office workflows - workflows that provision a target system of type <strong>Unify Office</strong> in the Identity Store and the corresponding connected Unify Office (RingCentral) endpoint.</p>
</li>
<li>
<p>UNIX-OpenICF workflows - workflows that provision a target system of type <strong>OpenICF</strong> in the Identity Store and the corresponding connected OpenICF connector server.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_ch7_general_information"><a class="anchor" href="#_ch7_general_information"></a><a class="link" href="#_ch7_general_information">7.2.1. General Information</a></h4>
<div class="paragraph">
<p>This section covers features that are common for all or a subset of the Java Provisioning Workflows, including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>How the workflows automatically create superior folders</p>
</li>
<li>
<p>How to configure the workflows that support a central proxy server configuration</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="_ch7_superior_folder_creation"><a class="anchor" href="#_ch7_superior_folder_creation"></a><a class="link" href="#_ch7_superior_folder_creation">7.2.1.1. Superior Folder Creation</a></h5>
<div class="paragraph">
<p>This section describes how the workflows automatically create superior folders in connected systems and in the Identity Store.</p>
</div>
<div class="sect5">
<h6 id="_ch7_in_the_connected_system"><a class="anchor" href="#_ch7_in_the_connected_system"></a><a class="link" href="#_ch7_in_the_connected_system">7.2.1.1.1. In the Connected System</a></h6>
<div class="paragraph">
<p>When the creation of new objects fails due to missing superior nodes, the realtime workflows automatically try to create them. But there is one limitation: the same structure is required in both in the Identity Store and in the connected system and therefore the individual nodes are mapped one-to-one.</p>
</div>
<div class="paragraph">
<p>When creating the missing entry in the connected system, the workflows use the following attributes from the appropriate entry in the Identity Store:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>dxrOCLinTS: defines the object classes in the connected system</p>
</li>
<li>
<p>dxrOptions: defines default values for other mandatory attributes</p>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>DN in Identity Store: cn=Miller,ou=sales,o=My-Company,cn=Accounts,cn=My-TS,cn=TargetSystems,cn=My-Company</p>
</div>
<div class="paragraph">
<p>DN in connected system: cn=Miller Peter,ou=sales,o=My-Company,c=de</p>
</div>
</div>
</div>
<div class="paragraph">
<p>Assume that "c=de" exists, but nothing else. Then:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For creation of "o=My-Company,c=de", the workflows use the attributes "dxrOCLinTS" and "dxrOptions" of the entry "o=My-Company,cn=Accounts,cn=My-TS,cn=TargetSystems,cn=My-Company".</p>
</li>
<li>
<p>For creation of "ou=sales,o=My-Company,c=de", the workflows use the attributes "dxrOCLinTS" and "dxrOptions" of the entry "ou=sales,o=My-Company,cn=Accounts,cn=My-TS,cn=TargetSystems,cn=My-Company".</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_in_the_identity_store"><a class="anchor" href="#_ch7_in_the_identity_store"></a><a class="link" href="#_ch7_in_the_identity_store">7.2.1.1.2. In the Identity Store</a></h6>
<div class="paragraph">
<p>The realtime workflows will create the missing superiors as far as possible.</p>
</div>
<div class="paragraph">
<p>A) If a superior node doesn&#8217;t exist in the connected system, they create the relevant entry in the Identity Store with a default attribute list:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>dxrType=dxrTSAccountGroupContainer</p>
</li>
<li>
<p>objectClass=dxrTSContainer</p>
</li>
<li>
<p>objectClass=dxrContainer</p>
</li>
<li>
<p>objectClass=top</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>B) If the superior node exists in the connected system, the workflows use the following attributes from the appropriate entry in the connected system:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The attributes "c", "o", "ou", "l", "dc" are stored in the same attribute types .</p>
</li>
<li>
<p>The attribute "objectClass" is mapped to "dxrOCLinTS".</p>
</li>
<li>
<p>The naming attribute value in the Connected System is mapped to "dxrRDNinTS".</p>
</li>
<li>
<p>The attributes "dxrType" and "objectClass" are mapped in the same way as the previous step.</p>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>DN in connected system: cn=Miller Peter,ou=sales germany,o=My-Company,c=de</p>
</div>
<div class="paragraph">
<p>DN in Identity Store: cn=Miller,ou=sales germany,ou=sales europe,o=My-Company,,cn=Accounts,cn=My-TS,cn=TargetSystems,cn=My-Company [defined by Identifier mapping]</p>
</div>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The entry "o=My-Company,cn=Accounts,cn=My-TS,cn=TargetSystems,cn=My-Company" is created with information as defined in B.</p>
</li>
<li>
<p>The entry "ou=sales europe,o=My-Company,cn=Accounts,cn=My-TS,cn=TargetSystems,cn=My-Company" (which has no appropriate entry in the connected system) is created with information as defined in A.</p>
</li>
<li>
<p>The entry "ou=sales germany,ou=sales europe,o=My-Company,cn=Accounts,cn=My-TS,cn=TargetSystems,cn=My-Company" is created with information as defined in B.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_http_proxy_server_configuration"><a class="anchor" href="#_ch7_http_proxy_server_configuration"></a><a class="link" href="#_ch7_http_proxy_server_configuration">7.2.1.2. HTTP Proxy Server Configuration</a></h5>
<div class="paragraph">
<p>Some of the target system workflows - such as the Google Apps, Office 365 and Salesforce workflows - support a central proxy server configuration. If your organization requires the use of an HTTP proxy server for Web access, configure the host and port of the HTTP proxy server represented by a connected directory within the Identity Store folder for your Provisioning domain:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Go to the Expert View and then create a new proxy server entry as a copy of an existing template from Connectivity Configuration Data &#8594; Connected Directories &#8594; Default &#8594; Identity Store &#8594; Proxy Server if necessary.</p>
</li>
<li>
<p>On the HTTP/HTTPS Proxy Server tab for each connected directory that supports a central proxy server configuration, set a link to the proxy server entry.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Do not use an authenticated proxy server. Configure and deploy a local transparent HTTP proxy server that can handle authentication and can forward requests to the corporate HTTP proxy server if necessary. Configure this local proxy server as the one used with DirX Identity.</p>
</div>
<div class="paragraph">
<p>If you have direct access to the HTTP/HTTPS servers needed to run the relevant workflows, remove any links to proxy servers from the HTTP/HTTPS Proxy Server tab of the relevant connected directories.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch7_active_directory_ads_workflows"><a class="anchor" href="#_ch7_active_directory_ads_workflows"></a><a class="link" href="#_ch7_active_directory_ads_workflows">7.2.2. Active Directory (ADS) Workflows</a></h4>
<div class="paragraph">
<p>The Active Directory (ADS) Provisioning workflows operate between a target system of type "ADS" in the Identity Store and the corresponding Active Directory connected system.</p>
</div>
<div class="paragraph">
<p>The ADS connector used in the workflows communicates with the ADS server (AD LDAP provider) across the native LDAP protocol, as illustrated in the following figure.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch7_targetWFs/image1.png" alt="Active Directory Workflow Architecture">
</div>
<div class="title">Figure 76. Active Directory Workflow Architecture</div>
</div>
<div class="paragraph">
<p>The workflows allow you to synchronize Identity account and group objects with ADS standard users, mail- or mailbox-enabled users, groups or distribution lists depending on the attributes set.</p>
</div>
<div class="sect4">
<h5 id="_ch7_ads_workflow_prerequisites_and_limitations"><a class="anchor" href="#_ch7_ads_workflow_prerequisites_and_limitations"></a><a class="link" href="#_ch7_ads_workflow_prerequisites_and_limitations">7.2.2.1. ADS Workflow Prerequisites and Limitations</a></h5>
<div class="paragraph">
<p>The ADS Provisioning workflows have the following prerequisites:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Before you can use the workflows, you must extend the DirX Identity Store schema with ADS target system-specific attributes and object classes so that the workflows can store Active Directory-specific information in the Identity Store. For instructions, see the section "Extending the Schema for the Target System Workflows".</p>
</li>
<li>
<p>If you plan to create mailbox-enabled users and groups or other mailbox-enabled object types like shared, room or equipment mailboxes in Active Directory, you must install an Exchange Server in the Active Directory Domain, which extends the Active Directory schema with mail-enabling attributes.</p>
</li>
<li>
<p>If you plan to create lync-enabled users in Active Directory, you must install a Skype for Business Server, formerly Lync Server, in your environment, which extends the Active Directory schema with lync-enabling attributes.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_connecting_to_active_directory"><a class="anchor" href="#_ch7_connecting_to_active_directory"></a><a class="link" href="#_ch7_connecting_to_active_directory">7.2.2.2. Connecting to Active Directory</a></h5>
<div class="paragraph">
<p>This section provides information about ADS workflow configuration on the Connectivity side.</p>
</div>
<div class="paragraph">
<p><strong>Connection to the target system:</strong></p>
</div>
<div class="paragraph">
<p>Specify the IP address and the data port at the ADS service object (ADS CD &#8594; Service). The IP address may contain the server name - full qualified or not - or a TCP/IP address.</p>
</div>
<div class="paragraph">
<p>In the Bind Profile (ADS CD &#8594; Bind Profile) specify a user in DN format. This user must have administrative rights in Active Directory.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you want to enable/disable SSL for one of the workflows, don&#8217;t use the SSL flag in the Bind Profile, which is kept there for compatibility reasons with the Tcl-based workflows. Use the SSL flag in the TS port of the join activity of the selected workflow instead.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_configuring_the_ads_target_system"><a class="anchor" href="#_ch7_configuring_the_ads_target_system"></a><a class="link" href="#_ch7_configuring_the_ads_target_system">7.2.2.3. Configuring the ADS Target System</a></h5>
<div class="paragraph">
<p>This section provides information about ADS target system configuration on the Provisioning side.</p>
</div>
<div class="sect5">
<h6 id="_ch7_setting_match_properties"><a class="anchor" href="#_ch7_setting_match_properties"></a><a class="link" href="#_ch7_setting_match_properties">7.2.2.3.1. Setting Match Properties</a></h6>
<div class="paragraph">
<p>In the <strong>Advanced</strong> tab of the target system object, the properties <strong>Type</strong>, <strong>Forest</strong> and <strong>Domain</strong> must be set correctly according to your connected system. The event-based workflows on the Connectivity side assigned to this target system must hold the same values in their <strong>Is applicable for</strong> section. If a Windows Password Listener is also active in the related Active Directory domain, the property <strong>Forest</strong> must be specified in the full qualified form, for example â<strong>dc=your-company,dc=net</strong>â and the property <strong>Domain</strong> must contain just the name of the domain, like â<em>your-company</em>â to correctly receive the password change requests - keeping this information in their topics- sent by the Password Listener.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_special_attributes"><a class="anchor" href="#_ch7_special_attributes"></a><a class="link" href="#_ch7_special_attributes">7.2.2.3.2. Special Attributes</a></h6>
<div class="paragraph">
<p>dxrPrimaryKey</p>
</div>
<div class="paragraph">
<p>The <strong>dxrPrimaryKey</strong> attribute of accounts and groups contains the objects' connected system DN. It is also used as the member attribute of groups. On account creation, it is generated by the <strong>tsaccount.xml</strong> object description using the target system-specific attributes <strong>Account Root in TS</strong> and <strong>Group Root in TS</strong> in the <strong>Options</strong> tab.</p>
</div>
<div class="paragraph">
<p>dxrName</p>
</div>
<div class="paragraph">
<p>The <strong>dxrName</strong> attribute of accounts and groups contains the target system-unique attribute <strong>samAccountName</strong>. It is generated with the Java script <strong>dxrNameForAccounts</strong> if the account or group is created in DirX Identity. It is used for joining in the Identity direction.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_setting_account_and_group_root_in_ts"><a class="anchor" href="#_ch7_setting_account_and_group_root_in_ts"></a><a class="link" href="#_ch7_setting_account_and_group_root_in_ts">7.2.2.3.3. Setting Account- and Group Root in TS</a></h6>
<div class="paragraph">
<p>In the <strong>Options</strong> tab of the target system object, the DN values for the <strong>Account Root in TS</strong> and <strong>Group Root in TS</strong> properties must be set correctly. They are used to generate the <strong>dxrPrimaryKey</strong> attribute on creation or modification of an account or group in DirX Identity. The <strong>dxrPrimaryKey</strong> attribute holds the DN of the object in the connected system.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_setting_exchange_base_properties"><a class="anchor" href="#_ch7_setting_exchange_base_properties"></a><a class="link" href="#_ch7_setting_exchange_base_properties">7.2.2.3.4. Setting Exchange Base Properties</a></h6>
<div class="paragraph">
<p>If an Exchange system is to be provisioned, some basic Exchange attributes must be configured in the <strong>Options</strong> tab of the target system object. They are used as base values for generating mailbox-specific attributes for an account when the "dxr mailbox users", "dxr shared mailbox creation", "dxr room mailbox creation" or "dxr equipment mailbox creation" groups are assigned to the related user.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_enabling_user_mailboxes"><a class="anchor" href="#_ch7_enabling_user_mailboxes"></a><a class="link" href="#_ch7_enabling_user_mailboxes">7.2.2.3.5. Enabling User Mailboxes</a></h6>
<div class="paragraph">
<p>To enable an account in DirX Identity for Exchange mailbox functionality, assign the "dxr mailbox users" group to the related user. To make this assignment, you usually create a corresponding role assigned to this group or you assign this group directly. On assignment, the obligations linked to this group set all of the mailbox-enabling attributes that are required to create a mailbox-enabled user in Active Directory. On revocation, these attributes are cleared or set according to revocation.</p>
</div>
<div class="paragraph">
<p>There are two levels of obligations assigned:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The base obligations common to all mailbox types (user, shared, room, equipment mailboxes) held in the obligation object <strong>Configuration</strong> &#8594; <strong>Obligations</strong> &#8594; <strong>Mailbox-enabling</strong> to which each mailbox-enabling group links.</p>
</li>
<li>
<p>The obligations specified directly in the Obligations tab of each mailbox-enabling group specific to the mailbox type.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_creating_shared_room_and_equipment_mailboxes"><a class="anchor" href="#_ch7_creating_shared_room_and_equipment_mailboxes"></a><a class="link" href="#_ch7_creating_shared_room_and_equipment_mailboxes">7.2.2.3.6. Creating Shared, Room and Equipment Mailboxes</a></h6>
<div class="paragraph">
<p>To create a shared, a room or an equipment mailbox in Exchange 2013 or newer, assign the âdxr shared mailbox creationâ, âdxr room mailbox creationâ or âdxr equipment mailbox creationâ group to a user representing this mailbox object in Active Directory. On assignment, the obligation rules for this group calculate and set all attributes required for the relevant mailbox type. On revocation, these attributes are cleared or set to the appropriate value.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_enabling_share_room_and_equipment_mailboxes"><a class="anchor" href="#_ch7_enabling_share_room_and_equipment_mailboxes"></a><a class="link" href="#_ch7_enabling_share_room_and_equipment_mailboxes">7.2.2.3.7. Enabling Share, Room and Equipment Mailboxes</a></h6>
<div class="paragraph">
<p>To grant permissions to a user in DirX Identity to access a specific shared, room or equipment mailbox in Exchange, create a related rights assigning group in DirX Identity by copying the existing âdxr shared mailbox team1â group and adapt its obligation rules.</p>
</div>
<div class="paragraph">
<p>The âdxr shared mailbox team1â group is a sample for giving an account the right to share the specific mailbox named SharedMailbox_team1, which must exist already in Exchange. For every shared, room or equipment mailbox in your Exchange system that you want to share, you need to create a shared-mailbox-enabling group - for example, by copying and renaming the sample âdxr shared mailbox team1â group - and adapt the name of the mailbox to be shared in the OnAssignment rule of the Obligations tab, which sets the mailbox name to be shared to the dxmADsExtensionAttribute2. This attribute is then mapped in the ADS synchronization workflow account channel to the target virtual (not in the schema) attribute ps_script_param1 and passed as the first parameter to the specified PowerShell script. The PowerShell script name is set in the OnAssignment rule to the dxmADsExtensionAttribute1 attribute, which is mapped to the target non-schema attribute ps_script_name. The dxmADsExtensionAttribute3 attribute is filled with the cn of the assigned user, which is mapped to the target attribute ps_script_param2 and passed as the second parameter to the PowerShell script <strong>AddSharedMailboxPermission.ps1</strong> (running the <strong>Add-MailboxPermission</strong> cmdlet). The script is executed after the account has been created or updated in the connected system and assigns the rights to access the shared mailbox to the account.</p>
</div>
<div class="paragraph">
<p>On unassigning these rights, the script <strong>RemoveSharedMailboxPermission.ps1</strong> (running the Remove-MailboxPermission cmdlet) is called. This is specified in the OnRevocation rules of the obligations.</p>
</div>
<div class="paragraph">
<p>The PowerShell scripts <strong>AddSharedMailboxPermission.ps1</strong> and <strong>RemoveSharedMailboxPermission.ps1</strong> are installed under <em>install_path</em><strong>\samples\ADS\scripts\</strong> and must be copied into the Java-based Server&#8217;s <strong>repository\scripts</strong> folder.</p>
</div>
<div class="paragraph">
<p>For assigning and unassigning rights for room and equipment mailboxes, you perform the analogous actions and create a rights-assigning group for each Exchange room or equipment mailbox to be shared. The same PowerShell scripts for any mailbox types used for sharing (shared, room or equipment mailbox types) can be used for rights assignment and unassignment.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Only mailbox-enabled accounts can get permissions on other mailboxes. Standard Active Directory accounts with no mailbox-enabling attributes set cannot be given permissions on other shared mailboxes.
</td>
</tr>
</table>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_setting_lync_base_properties"><a class="anchor" href="#_ch7_setting_lync_base_properties"></a><a class="link" href="#_ch7_setting_lync_base_properties">7.2.2.3.8. Setting Lync Base Properties</a></h6>
<div class="paragraph">
<p>If an Active Directory system hosting a Skype for Business Server (formerly Lync Server) is to be provisioned, some basic lync-enabling attributes must be configured in the Options tab of the target system object. They are used as base values for generating lync-enabling attributes for an account when the "dxr lync users" group is assigned to that account.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_lync_enabling"><a class="anchor" href="#_ch7_lync_enabling"></a><a class="link" href="#_ch7_lync_enabling">7.2.2.3.9. Lync Enabling</a></h6>
<div class="paragraph">
<p>To enable an account in DirX Identity for Skype (formerly Lync) functionality, assign the "dxr lync users" group to this account. To make this assignment, you usually create a corresponding role assigned to this group or you assign this group directly. On assignment, the obligations linked to this group set all of the lync-enabling attributes that are required to create a lync-enabled user in Active Directory. On revocation, these attributes are cleared.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_ads_workflows_and_activities"><a class="anchor" href="#_ch7_ads_workflows_and_activities"></a><a class="link" href="#_ch7_ads_workflows_and_activities">7.2.2.4. ADS Workflows and Activities</a></h5>
<div class="paragraph">
<p>The following figure shows the layout of the channels that are used by the ADS workflow&#8217;s join activity.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch7_targetWFs/image2.png" alt="ADS Workflow Channels and Objects">
</div>
<div class="title">Figure 77. ADS Workflow Channels and Objects</div>
</div>
<div class="paragraph">
<p>As the figure shows, there is a pair of channels between accounts, groups and members on each side. The members are linked to the groups on both sides.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_ads_workflow_ports"><a class="anchor" href="#_ch7_ads_workflow_ports"></a><a class="link" href="#_ch7_ads_workflow_ports">7.2.2.5. ADS Workflow Ports</a></h5>
<div class="paragraph">
<p>This section provides information about ADS workflow ports.</p>
</div>
<div class="paragraph">
<p>TS Port</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>CF - Crypt Filter</strong><br>
The configured Crypt Filter is used to send the password attribute unicodePwd decrypted to the ADS server.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_ads_workflow_channels"><a class="anchor" href="#_ch7_ads_workflow_channels"></a><a class="link" href="#_ch7_ads_workflow_channels">7.2.2.6. ADS Workflow Channels</a></h5>
<div class="paragraph">
<p>This section provides information about ADS workflow channels.</p>
</div>
<div class="sect5">
<h6 id="_ch7_account_and_group_channels"><a class="anchor" href="#_ch7_account_and_group_channels"></a><a class="link" href="#_ch7_account_and_group_channels">7.2.2.6.1. Account and Group Channels</a></h6>
<div class="paragraph">
<p>Both Directions</p>
</div>
<div class="paragraph">
<p>a. Master attributes</p>
</div>
<div class="paragraph">
<p>You can master attributes by setting the <strong>OnAddOnly</strong> flag in the according mapping direction. For example, if you want Identity to master a certain attribute, you set this flag in the mapping direction to Identity to let the connected system only set the attribute on an add operation in Identity and vice versa.</p>
</div>
<div class="paragraph">
<p>If the mapping is more complex, mastering can also be implemented in a Java mapping, as done for the Identifier mapping. The Identifier is mastered by DirX Identity in the default real-time synchronization workflow. In the target system direction, it is set by Identity with the <strong>dxrPrimaryKey</strong> attribute value and results in moving the object in the target system if <strong>dxrPrimaryKey</strong> changes. In the Identity direction, the Identifier is calculated only on an add operation, otherwise the joined object&#8217;s Identifier is taken.</p>
</div>
<div class="paragraph">
<p><strong>Special caution is necessary for the attribute proxyAddresses:</strong></p>
</div>
<div class="paragraph">
<p>The <strong>proxyAddresses</strong> multi-value attribute is handled as case-sensitive in Active Directory because a value starting with the uppercase letters "SMTP:" is considered to be the primary e-mail address of a user in contrast to possible further values starting with the lowercase letters "smtp:". In DirX Identity, the corresponding attribute <strong>dxmEX2kProxyAddresses</strong> is not defined to be case-sensitive but is case-insensitive in the schema; this definition should not be changed in DirX Identity for compatibility reasons. Provisioning it can cause the primary address of a user, which possibly might have been changed by an administrator in Active Directory, to be overwritten with the wrong value of lowercase letters on the next synchronization run to Active Directory, regardless of whether or not a validation has been previously performed.</p>
</div>
<div class="paragraph">
<p>To solve this problem, the <strong>OnAddOnly</strong> flag can be set in the mapping direction to Active Directory for the <strong>proxyAddresses</strong> attribute. This setting can be made because the attribute does not belong to the mailbox-enabling attributes, which must be able to be assigned and unassigned at any time during the lifetime of the user.</p>
</div>
<div class="paragraph">
<p>If you want to set <strong>proxyAddresses</strong> on both an add and a modify operation, you can uncheck the flag <strong>checkModification</strong>. In this case, the join engine does not compare the values of the joined entry in Active Directory with the mapped values but just replaces the values as they are in the mapped entry. Then uppercase and lowercase letters are preserved and must just be provided correctly on synchronization to Active Directory.</p>
</div>
<div class="paragraph">
<p>b. Moving objects</p>
</div>
<div class="paragraph">
<p>The default ADS real-time synchronization workflow can perform a rename/move in AD as follows:</p>
</div>
<div class="paragraph">
<p>If the <strong>dxrPrimaryKey</strong> attribute of the account is changed in Identity (as a result of a user resolution and new calculation of the account attributes, which can have <strong>dependsOn</strong> or <strong>masteredBy</strong> settings in the accounts object description), the workflow performs the following tasks:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Takes this as the new DN in AD.</p>
</li>
<li>
<p>Tries to find (join) the account with the configured join attributes (trying one after the other).</p>
</li>
<li>
<p>Takes the <strong>samAccountName</strong> attribute as the default, which is unique in the whole AD domain (that&#8217;s why it shouldn&#8217;t change on user resolution in Identity, otherwise another unique attribute must be taken for joining).</p>
</li>
<li>
<p>When the account has been found in AD, takes that DN as the old DN and renames/moves the account from this old DN to the new DN.</p>
</li>
<li>
<p>Puts the current AD DN into the <strong>dxrPrimaryKey</strong> and <strong>dxrPrimaryKeyOld</strong> attributes in Identity on the way back.</p>
</li>
<li>
<p>The dxrPrimaryKeyOld attribute is not taken for synchronization to the connected system but only for other purposes.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Direction: Identity &#8594; Connected System</p>
</div>
<div class="paragraph">
<p>a. PostMapping</p>
</div>
<div class="paragraph">
<p>A PostMapping exists only for the group channel in the target system direction. It is used for changing the request type to <strong>DELETE</strong> if the <strong>dxrState</strong> attribute in Identity contains the value <strong>DELETED</strong>. This results in deleting the object in the target system.</p>
</div>
<div class="paragraph">
<p>For accounts, the deletion of objects in the connected system is handled in the userAccountControl Java mapping.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_password_channel"><a class="anchor" href="#_ch7_password_channel"></a><a class="link" href="#_ch7_password_channel">7.2.2.6.2. Password Channel</a></h6>
<div class="paragraph">
<p>The password channel updates the Active Directory account passwords.</p>
</div>
<div class="paragraph">
<p>The associated SetPassword workflow is started by either the User or the Account Password Event Manager workflow listening for Web Center or Password Listener requests. The Active Directory attributes <strong>unicodePwd</strong> and <strong>pwdLastSet</strong> are mapped from the pseudo source attributes <strong>dxmPassword</strong> and <strong>dxmPasswordExpired</strong>, which are contained only in the password change request and not read from an LDAP attribute.</p>
</div>
<div class="paragraph">
<p>The ADS Set Password workflow also resets the <strong>lockoutTime</strong> attribute to zero (<strong>0</strong>) to finish the user&#8217;s lockout period immediately and to enable him to log in again after his password has been updated.</p>
</div>
<div class="paragraph">
<p>A password channel can also be configured backwards from the connected system to Identity to be able to update some attributes in Identity after a password change or a reset has taken place in the connected system. The join engine then synchronizes the attributes specified in the corresponding password channel mapping to Identity after the account with its password relevant attributes was updated in the connected system.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_customizing_the_ads_workflows"><a class="anchor" href="#_ch7_customizing_the_ads_workflows"></a><a class="link" href="#_ch7_customizing_the_ads_workflows">7.2.2.7. Customizing the ADS Workflows</a></h5>
<div class="paragraph">
<p>This section provides:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A description about delta workflows.</p>
</li>
<li>
<p>Hints and guidelines on how to configure selected versions of Microsoft Exchange.</p>
</li>
<li>
<p>A description of how to run PowerShell scripts.</p>
</li>
<li>
<p>A description of how to manage remote folders with external tools that can execute remote commands.</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="_ch7_ads_delta_workflows"><a class="anchor" href="#_ch7_ads_delta_workflows"></a><a class="link" href="#_ch7_ads_delta_workflows">7.2.2.7.1. ADS Delta Workflows</a></h6>
<div class="paragraph">
<p>For a general explanation of the delta workflows, see the sections under "Java-based Workflow Architecture" in "Understanding the Default Application Workflows" in this guide.</p>
</div>
<div class="paragraph">
<p>The default delta workflow for Active Directory <strong>ADS_Ident_Realtime_Delta</strong> is configured with the delta type <strong>SearchAttributes</strong> in the account and group channels. With this setting and the default search attributes <strong>uSNchanged</strong> and <strong>uSNcreated</strong>, the export search filter is extended by searching only for those objects whose <strong>uSNchanged</strong> or <strong>uSNcreated</strong> attribute values are greater than or equal to the highest value of the last delta run stored in the Identity domain for each channel.</p>
</div>
<div class="paragraph">
<p>If you also want to export the objects that were deleted after the last delta run - in addition to the ones that were changed - you must change the delta type to <strong>Expert Operational Attributes</strong>. This action generates and shows the operational attributes section for the attribute <strong>dxm.delta</strong> and the placeholder value <strong>${LastDeltaValue}</strong>. At runtime, the join engine replaces the placeholder with the last delta state value stored in the Identity domain as a base64-encoded binary value (cookie). It reflects the last value that was returned by Active Directory at the end of the previous delta search.</p>
</div>
<div class="paragraph">
<p>If operational attributes are used for delta searches, several adaptations must be made at the workflow configuration:</p>
</div>
<div class="paragraph">
<p>Search Base Adaptations</p>
</div>
<div class="paragraph">
<p>The ADS connector uses the DirSync LDAP control for doing delta searches. This has the restriction that only root searches are allowed. As a result, the specified search base must be a domain or subdomain; for example, <strong>dc=domain1,dc=munich,dc=my-company,dc=net</strong>. In the default delta workflow configuration, the search base configured at the ADS Connected Directory channels is beneath an organizational unit.</p>
</div>
<div class="paragraph">
<p>To restrict the search result to a certain set of objects, any filter can be specified.</p>
</div>
<div class="paragraph">
<p>Filter Adaptations</p>
</div>
<div class="paragraph">
<p>In the default workflow, the filter <strong>(&amp;(objectClass=user)(objectCategory=person))</strong> is specified. Since deleted objects lose the objectCategory <strong>person</strong>, eliminate that part of the filter.</p>
</div>
<div class="paragraph">
<p>Mapping Adaptations</p>
</div>
<div class="paragraph">
<p>Extend the mapping to Active Directory with the <strong>isDeleted</strong> attribute by inserting a direct mapping <strong>null&#8594;isDeleted</strong> with the attribute flags <strong>readOnly</strong> and <strong>retrievable</strong> set. The mapping function for the <strong>dxrTSState</strong> attribute in Identity evaluates the flag and sets the value <strong>DELETED</strong> for the deleted objects.</p>
</div>
<div class="paragraph">
<p>Mapping Flags Adaptations</p>
</div>
<div class="paragraph">
<p>Since the DirSync LDAP control returns only changed attributes for an object, you must remove the flag <strong>checkModification</strong> for every attribute in the mapping to Identity; otherwise, the attributes are deleted in Identity if they have not been changed in Active Directory and hence do not exist in the list of exported attributes.</p>
</div>
<div class="paragraph">
<p>Hints for Deciding which Delta Type to Use</p>
</div>
<div class="paragraph">
<p>Technical conditions:</p>
</div>
<div class="paragraph">
<p>If you want to integrate the delta workflow into an existing target system with real-time workflows configured to synchronize accounts and groups beneath an organizational unit (like the default ADS real-time workflows do), you must use the default settings of the delta workflow (filter extension type) for this target system, because the search base is configured at the channels and used by all workflows of the target system.</p>
</div>
<div class="paragraph">
<p>Consequently, a delta workflow using operational attributes is</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Appropriate primarily for a target system provisioning a complete Active Directory domain,</p>
</li>
<li>
<p>Possible also for a target system with at least the search base specified as the domain root and the search filter specified to get only a subset of objects. Remember that users and groups in Active Directory usually do not have the attribute <strong>ou</strong> configured holding their organizational unit, which would make it possible to set the search filter appropriately and get only objects beneath a certain organizational unit. You can either configure this behavior or use other filters.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Scenario considerations:</p>
</div>
<div class="paragraph">
<p>The validation workflow can also recognize changes and deletions made in Active Directory by calculating the differences of the complete set of objects on both sides. It does not evaluate the delta settings resulting in delta exports like the delta workflow does. As a result, there are different possibilities for which workflows and configurations to use depending on your scenario.</p>
</div>
<div class="paragraph">
<p>If you have a scenario with a validation workflow scheduled to run very infrequently - for example, because it takes a long time due to a high number of users and groups to synchronize - and you want to react to changes - especially deletions - made in Active Directory more often, you should choose the delta type of operational attributes.</p>
</div>
<div class="paragraph">
<p>If you have the same scenario without the need to react quickly to deleted and moved objects but with the need to react quickly to changed objects, you can use the default delta type of filter extensions.</p>
</div>
<div class="paragraph">
<p>Moreover, if you have a scenario with a fairly limited set of users, you could schedule a validation workflow more often to recognize the deleted objects and leave the delta workflow with the default settings to recognize the changed objects.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_configuring_exchange"><a class="anchor" href="#_ch7_configuring_exchange"></a><a class="link" href="#_ch7_configuring_exchange">7.2.2.7.2. Configuring Exchange</a></h6>
<div class="paragraph">
<p>The default Java-based synchronization workflow mapping is configured to provision an Exchange 2016/2019 connected system. The configuration in Provisioning regarding object descriptions and obligation rules for the mailbox-enabling groups is also set up for an Exchange 2016/2019 connected system. This does not affect your existing ADS target systems and workflows.</p>
</div>
<div class="paragraph">
<p>If you create a new ADS target system with the target system wizard (the type in DirX Identity is still called Windows 2000), the base properties of your specific Exchange system have been set - or can be set afterwards - in the Options tab of the new target system.</p>
</div>
<div class="paragraph">
<p>The following section describes other issues related to customizations.</p>
</div>
<div class="paragraph">
<p>Common aspects for all versions greater than or equal to Exchange 2007</p>
</div>
<div class="paragraph">
<p>The ADS connector and the ADS agent (which is used in the Tcl-based workflows) both generate the mandatory attributes msExchMailboxSecurityDescriptor and msExchMailboxGuid automatically when a user is to be mailbox-enabled. The connecto and the agent determine whether or not a user is to be mailbox-enabled by checking whether the attribute msExchRecipientTypeDetails is contained in the list of attributes to be set, which is true only if a mailbox-enabling group was assigned. All other attributes mandatory for creating a fully-functioning Exchange mailbox are created through the standard obligation rules used as source attributes in the mapping to the AD attributes. For a user update in Active Directory, the ADS connector uses the LDAP interface and the ADS Agent uses the ADSI Interface.</p>
</div>
<div class="paragraph">
<p>If you want to synchronize additional Exchange attributes, you have the following choices:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If you just want to see the content of some more Exchange attributes on the Identity side, you don&#8217;t have to deal with obligation rules at all. You only need to map them towards Identity either to related Identity attributes if they exist in the Identity schema or to some of the various extension attributes (dxmADsExtensionAttribute1-15 and dxmEX2013ExtensionAttribute16-20). You can also adapt the <strong>tsaccount.xml</strong> object description to make them visible in the Active Directory tab of the account.</p>
</li>
<li>
<p>If you want to provision more Exchange attributes towards Active Directory and their related attributes exist in the DirX Identity schema, you can just add obligation rules to fill them and then use them in the mapping in both directions.</p>
</li>
<li>
<p>If their related attributes don&#8217;t exist in the schema on Identity side, you can either extend the Identity schema or just use the various extension attributes by setting them through obligation rules and then mapping them to the desired AD attributes.</p>
</li>
<li>
<p>If you only need to set constant values for some attributes and the related attributes don&#8217;t exist in the schema on the Identity side, be aware that if you just set those values in the mapping towards the connected system, these attributes are then always contained in the requests towards the connected system for "non mailbox- enabled" users provisioned with the same workflow, which can cause problems on user modification. To avoid this situation, you can set the attributes in a Postmapping depending on whether a specific Exchange attribute, for example msExchRecipientTypeDetails, is set, which is only true if a mail-enabling group was assigned. The easiest and recommended way, however, is to fill some extension attributes in obligation rules and map them to AD attributes instead of defining a Postmapping.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Customizing Exchange 2016/2019</p>
</div>
<div class="paragraph">
<p>If you want to provision an Exchange 2016/2019 connected system and you created a new target system with the target system wizard of the current version, you must apply the following customizations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In the Obligations tab of all mailbox-enabling groups you intend to use (dxr mailbox users, dxr shared mailbox creation, dxr room mailbox creation and dxr equipment mailbox creation), adapt the OnAssignment rule generating the multi-value attribute dxmEX2kShowInAddressBook to the values appropriate to your specific Exchange system (DNs of the default Exchange address books).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note: Since multi-values can now be directly assigned in obligation rules, the former method of assigning the values in the updateAddressbook.js java script is no longer needed.</p>
</div>
<div class="paragraph">
<p>Customizing Exchange 2013</p>
</div>
<div class="paragraph">
<p>If you want to provision an Exchange 2013 connected system and you created a new target system with the target system wizard of the current version, you must apply the following customizations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In the Obligations tab of all mailbox-enabling groups you intend to use, adapt the OnAssignment rule generating the multi-value attribute dxmEX2kShowInAddressBook to the values appropriate to your specific Exchange system (DNs of the default Exchange address books).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Customizing Exchange 2010</p>
</div>
<div class="paragraph">
<p>If you want to provision an Exchange 2010 connected system and you created a new target system with the target system wizard of the current version, you must apply the following customizations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Add the attribute <strong>homeMTA</strong> to the mapping of both directions and to the obligation rules of the dxr mailbox users group. From Exchange 2013 on, the attribute must not be provisioned because the Transport Server Role can no longer reside on a different server than the Database Server Role.</p>
</li>
<li>
<p>Set the attribute <strong>msExchVersion</strong> in the obligation <strong>onAssignment</strong> rule of the dxr mailbox users group to the value <strong>44220983382016</strong>.</p>
</li>
<li>
<p>Adapt the Java script <strong>updateAddressbook.js</strong> in <strong>Domain</strong> <strong>Configuration</strong> &#8594; <strong>TargetSystems</strong> &#8594; <strong>Windows</strong> <strong>2000</strong> &#8594; <strong>JavaScripts</strong> with the DNs of the default Exchange address books of your Exchange system.</p>
</li>
<li>
<p>In the Obligations tab of all mailbox-enabling groups you intend to use, adapt the OnAssignment rule generating the multi-value attribute dxmEX2kShowInAddressBook to the values appropriate to your specific Exchange system.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Customizing Exchange 2007 or Exchange 2003</p>
</div>
<div class="paragraph">
<p>If you want to provision an Exchange 2007 or Exchange 2003 connected system and you created a new target system with the target system wizard of the current version, you must apply the following customizations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Add the attribute <strong>homeMTA</strong> to the mapping of both directions and to the obligation rules of the dxr mailbox users group.</p>
</li>
<li>
<p>Delete the attribute <strong>msExchRecipientTypeDetails</strong> from the mapping and the obligation rules.</p>
</li>
<li>
<p>Delete the attribute <strong>msExchVersion</strong> from the mapping and the obligation rules.</p>
</li>
<li>
<p>Adapt the Java script <strong>updateAddressbook.js</strong> in <strong>Domain Configuration</strong> &#8594; <strong>TargetSystems</strong> &#8594; <strong>Windows 2000</strong> &#8594; <strong>JavaScripts</strong> with the DNs of the default Exchange address books of your Exchange system.</p>
</li>
<li>
<p>In the Obligations tab of all mailbox-enabling groups you intend to use, adapt the OnAssignment rule generating the multi-value attribute dxmEX2kShowInAddressBook to the values appropriate to your specific Exchange system.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_running_powershell_scripts"><a class="anchor" href="#_ch7_running_powershell_scripts"></a><a class="link" href="#_ch7_running_powershell_scripts">7.2.2.7.3. Running PowerShell Scripts</a></h6>
<div class="paragraph">
<p>DirX Identity provides a general user hook class UserHookRunExecutable, which allows running any executable configured in a realtime workflow channel object. For the preUpdate and the postUpdate methods of the user hook, an executable with a command line can be configured in the specific attributes pre_executable and/or post_executable of the channel. The corresponding command lines are specified in pre_cmdline and/or post_cmdline. In the postUpdate case, the executable is only called if the update (add or modify) of the object was successful.</p>
</div>
<div class="paragraph">
<p>The UserHookRunExecutable class starts <strong>powershell.exe</strong> - as a specific executable - only if a PowerShell script name is passed to it as a parameter; otherwise it just logs that nothing needs to be done. This configuration allows always specifying the UserHookRunExecutable class in the General tab of the Accounts channel (and of course any other channel), because the PowerShell script name is now only set with a non-empty value in the standard mapping if a permission-granting mailbox group is assigned to the associated user. In all other cases, the script name is not populated and hence <strong>powershell.exe</strong> is not started.</p>
</div>
<div class="paragraph">
<p>This behavior, along with setting the script name depending on whether or not other (rights-representing) attributes are set, is also useful for modeling other customer-specific requirements.</p>
</div>
<div class="paragraph">
<p>Common Architecture for Running Executables</p>
</div>
<div class="paragraph">
<p>The common architecture and features for running executables from a user hook are described in "Running Executables from a User Hook" in "Understanding the Default Application Workflow Technology".</p>
</div>
<div class="paragraph">
<p>PowerShell Prerequisites</p>
</div>
<div class="paragraph">
<p>A PowerShell script can use the cmdlets that are part of the locally-installed PowerShell instance and it can also use and remotely run cmdlets that are only part of the remotely-installed PowerShell instance. You can even call PowerShell 64-bit cmdlets from clients running a PowerShell 32-bit version.</p>
</div>
<div class="paragraph">
<p>You need to have the Windows Management Framework installed to use PowerShell cmdlets that reside only on the remote server and not on the client machine&#8217;s locally installed PowerShell instance. An example is to administer Exchange using the remote Exchange management cmdlets without having them installed locally.</p>
</div>
<div class="paragraph">
<p>Windows Management Framework includes Windows PowerShell V2 and Windows Remote Management (WinRM) 2.0, which is the Microsoft implementation of the SOAP-based WS (=Web Services)-Management Protocol.</p>
</div>
<div class="paragraph">
<p>For Windows 7 or Windows Server 2008 R2 and newer, the correct version of the Windows Management Framework is already installed.</p>
</div>
<div class="paragraph">
<p>Required PowerShell Settings</p>
</div>
<div class="paragraph">
<p>Apply the following settings to enable the remote server to execute PowerShell commands. For Windows versions greater than or equal to Windows Server 2012, this is usually already enabled by default and so none of the following settings need to be explicitly applied.</p>
</div>
<div class="paragraph">
<p>Server-side settings:</p>
</div>
<div class="paragraph">
<p>Call the command <strong>enable-psremoting</strong> in the Administrator PowerShell of the remote server. It creates a listener for HTTP connections and sets firewall exceptions for Http port 80 and Https port 443.</p>
</div>
<div class="paragraph">
<p>Client-side settings:</p>
</div>
<div class="paragraph">
<p>Call the command <strong>set-executionpolicy remotesigned</strong> in the Administrator PowerShell of the client to enable it to run scripts.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_specifying_powershell_script_names_in_the_standard_ads_workflows"><a class="anchor" href="#_ch7_specifying_powershell_script_names_in_the_standard_ads_workflows"></a><a class="link" href="#_ch7_specifying_powershell_script_names_in_the_standard_ads_workflows">7.2.2.7.4. Specifying PowerShell Script Names in the Standard ADS Workflows</a></h6>
<div class="paragraph">
<p>The standard ADS real-time workflow account channel is pre-configured to run any PowerShell script - after the account is updated in the connected system - that is passed as a parameter in the source attribute dxmADsExtensionAttribute1 mapped to the target attribute ps_script_name. The script parameters are set in additional extension attributes depending on the groups that are assigned to the accountsâ associated user. Script name and parameters are then passed to the post_cmdline specific attribute, which is taken as input for running <strong>powershell.exe</strong> specified as the executable in post_executable. The extension attributes are cleared in the mapping back to Identity to prevent the PowerShell script from being started again on the next synchronization run.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>User Hook name:<br>
The user hook class name com.siemens.dxm.join.userhook.common.UserHookRunExecutable is specified by default in the General tab of the account channel in the ADS direction. If no PowerShell script name is passed in the dxmADsExtensionAttribute1 source attribute in the mapping - which is the case for "normal" accounts with no special mailbox rights assigned or for those accounts that the script has already run once - the UserHookRunExecutable class does not start <strong>powershell.exe</strong> unnecessarily.</p>
</li>
<li>
<p>Specific attribute post_executable:<br>
The PowerShell executable <strong>powershell.exe</strong> is already specified in the specific attribute post_executable. Nothing must be changed here.<br>
<br>
Specific attribute post_cmdline:<br>
The name of the script to run is set through the mapping and passed to post_cmdline as the first parameter. The "$\{env.scripts}" placeholder resolves to the scripts subfolder of the Java-based Serverâs repository folder. Consequently, you must:</p>
</li>
<li>
<p>Copy the scripts to run from <em>install_path</em>*\samples\ADS\scripts\* or from your own folder with possibly your own scripts to the scripts subfolder of the Java-based Serverâs repository folder if you want to leave the setting, or</p>
</li>
<li>
<p>Specify an absolute path where your scripts reside, or</p>
</li>
<li>
<p>Copy the scripts to a folder contained in the Path variable; for example, into the <strong>bin</strong> subfolder of the associated Java-based Server.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If the script path contains a blank, PowerShell expects a <strong>"&amp;"</strong> before the script name and the script name to be enclosed in double quotes and parameters containing blanks to be enclosed in triple double quotes if the script is called from the command line, like this:</p>
</div>
<div class="paragraph">
<p><code><strong>powershell "&amp; ""C:\Documents and Settings\myscript.ps1""" """param 1""" """param 2"""</strong></code></p>
</div>
<div class="paragraph">
<p>If the script is called from within the PowerShell, it is done as follows:</p>
</div>
<div class="paragraph">
<p><code><strong>&amp; "C:\Documents and Settings\script1.ps1" "param 1" "param 2"</strong></code></p>
</div>
<div class="paragraph">
<p>The delivered batch script <strong>runPSS.bat</strong> to start and test PowerShell scripts standalone (not started by the Java-based Server) handles this correctly.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Adaptation of the delivered PowerShell sample scripts to run:<br>
Adapt the variables $server, $binduser and $pwd to your environment. Note that you must generate the encrypted password file yourself, for example <strong>cred.txt</strong>, by running the delivered sample PowerShell script <strong>CreatePasswordFile.ps1</strong> installed under <em>install_path</em><strong>\samples\ADS\scripts\</strong> in the Administrator PowerShell.<br>
<br>
If you do not want to use the PowerShell encrypting password feature, you can also extend the parameter list of the script and pass username and password from the ADS bind profile by adapting the UserHookRunExecutable class, as described in "Running Executables from a User Hook" in "Understanding the Default Application Workflow Technology".</p>
</li>
<li>
<p>Java Server service account:<br>
If your PowerShell script - like the delivered script <strong>AddSharedMailboxPermission.ps1</strong>- reads a password from a file (for example, from <strong>cred.txt</strong> as previously described), that was encrypted by PowerShell running under a specific account, the Java-based Server must also run under this account.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Running an Exchange cmdlet in the Java-based Server</p>
</div>
<div class="paragraph">
<p>In addition to the PowerShell scripts <strong>AddSharedMailboxPermission.ps1</strong> and <strong>RemoveSharedMailboxPermission.ps1</strong>, which are used in the standard ADS realtime synchronization workflow for assigning mailbox rights, DirX Identity delivers sample scripts that contain Exchange cmdlets. These scripts are installed under <em>install_path</em>*\samples\ads\scripts*.</p>
</div>
<div class="paragraph">
<p>The <strong>DisableMailbox.ps1</strong> sample script expects two parameters: one for identifying the mailbox (user principal name) and one for identifying whether or not the mailbox shall be disabled. This parameter can also be set independently from the msExchHideFromAddressLists attribute. It is taken here as one reasonable way for specifying enabling or disabling a mailbox, because a disabled mailbox should also not appear in the global address lists.</p>
</div>
<div class="paragraph">
<p>The <strong>DisableMailbox.ps1</strong> script uses the Disable-Mailbox cmdlet. In addition to removing all mailbox-enabling attributes from the Active Directory user, the Disable-Mailbox cmdlet also performs a cleanup task on the mailbox, disconnecting the mailbox immediately from the user so that you don&#8217;t need to wait for a nightly maintenance complete mailbox database cleanup task.</p>
</div>
<div class="paragraph">
<p>The <strong>ConnectMailbox.ps1</strong> script uses the Connect-Mailbox cmdlet, which reconnects a disconnected mailbox to an Active Directory user.</p>
</div>
<div class="paragraph">
<p>If you want to create a new mailbox for an existing Active Directory user, the Enable-Mailbox cmdlet must be used. You can easily create a new PowerShell script for this task simply by copying the <strong>ConnectMailbox.ps1</strong> script to a new script - for example, <strong>EnableMailbox.ps1</strong> - and then exchanging the Connect-Mailbox cmdlet with Enable-Mailbox, which expects the same parameters as Connect-Mailbox.</p>
</div>
<div class="paragraph">
<p>Note: If you want to mailbox-enable a user by running an Exchange cmdlet (for example, Enable-Mailbox for an existing user or New-Mailbox for a new user) instead of setting the mailbox-enabling attributes with the standard ADS synchronization workflow, adapt the workflow mapping and the obligation rules of the dxr mailbox users group appropriately depending on the attributes you want to pass to the cmdlet as parameters. Cmdlets usually offer a lot of variation on which parameters can be passed and which are set with default values. Read the Microsoft documentation about the complete functionality of each cmdlet you want to use.</p>
</div>
<div class="paragraph">
<p>Running a Lync cmdlet in the Java-based Server</p>
</div>
<div class="paragraph">
<p>You can also extend the standard ADS real-time workflow to run a PowerShell script containing Lync cmdlets to be executed on the remote Skype for Business Server (formerly Lync Server). For an explanation about how to pass parameters to the script, how to provide credentials and where to place the script, see the instructions given in "Running an Exchange cmdlet in the Java-based Server".</p>
</div>
<div class="paragraph">
<p>The sample script <strong>LyncEnableUser.ps1</strong> is installed under <em>install_path</em>*\samples\ads\scripts*. Running it is an alternative way to lync-enable a user instead of doing it by mapping all lync-enabling attributes produced by the obligation rules of the dxr lync enabling group as done in the default ADS real-time workflow.</p>
</div>
<div class="paragraph">
<p>The <strong>LyncEnableUser.ps1</strong> script uses the Enable-CsUser cmdlet for lync-enabling a user. The Disable-CsUser cmdlet is also described in this script as well as other lync-handling cmdlet samples.</p>
</div>
<div class="paragraph">
<p>In order to be allowed to remotely execute the cmdlets, a secure connection to the Lync Server over https is required. As a prerequisite for such a secure connection, the root CA certificate that issued the lync-related certificates must be imported into the Trusted Root Store of the workstation running the script.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
A user in Active Directory with administrative rights can only be lync-enabled by using either the AdsConnector to set the lync-enabling attributes or by running the Enable-CsUser PowerShell cmdlet. It cannot be lync-enabled by using the Skype for Business (formerly Lync Server) "Control Panel" admin tool.
</td>
</tr>
</table>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_remote_folder_management"><a class="anchor" href="#_ch7_remote_folder_management"></a><a class="link" href="#_ch7_remote_folder_management">7.2.2.7.5. Remote Folder Management</a></h6>
<div class="paragraph">
<p>Remote Folder Management can be performed using the related PowerShell cmdlets, but you can also use this older tool described here.</p>
</div>
<div class="paragraph">
<p>The functionality described here allows the management of folders and shares on a remote computer running the Windows 2003 Server operating system or newer. You can use it in a user hook or in the attribute mapping code of a Java-based workflow. It can create and delete folders on a remote computer and copy/move folders between remote computers.</p>
</div>
<div class="paragraph">
<p>Architecture</p>
</div>
<div class="paragraph">
<p>The remote execution works over $ADMIN and $IPC shares on the remote computer. The external CLI utility accesses the $ADMIN share to set up the remote listener service and then passes remote commands via $IPC share. Results and outputs from these commands are returned to the Java code. The following figure illustrates this control flow:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch7_targetWFs/image3.png" alt="Remote Folder Management Architecture">
</div>
<div class="title">Figure 78. Remote Folder Management Architecture</div>
</div>
<div class="paragraph">
<p>With the exception of <strong>ssh</strong>, all of the tools use $IPC and $ADMIN shares. The remote management functionality that has been used and tested in customer projects includes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>create folder</p>
</li>
<li>
<p>delete folder</p>
</li>
<li>
<p>move/copy folder</p>
<div class="ulist">
<ul>
<li>
<p>inside partition</p>
</li>
<li>
<p>over partition</p>
</li>
<li>
<p>over machines</p>
</li>
</ul>
</div>
</li>
<li>
<p>check if folder exists</p>
</li>
<li>
<p>set folder file system permissions</p>
<div class="ulist">
<ul>
<li>
<p>account name/SID support</p>
</li>
</ul>
</div>
</li>
<li>
<p>create share</p>
</li>
<li>
<p>set share permissions</p>
<div class="ulist">
<ul>
<li>
<p>account name/SID support</p>
</li>
</ul>
</div>
</li>
<li>
<p>delete share</p>
</li>
<li>
<p>convert share name to local path</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>CLI Tools</p>
</div>
<div class="paragraph">
<p>To enable remote management, you need to select a toolkit. The following list evaluates tools that can be used to execute commands remotely. <strong>xCmd</strong> is the preferred tool.</p>
</div>
<div class="paragraph">
<p><strong>xCmd</strong></p>
</div>
<div class="paragraph">
<p>+ freeware<br>
+ nothing required on target machine (service is copied automatically)<br>
+ sources are available<br>
- works only between Windows machines</p>
</div>
<div class="paragraph">
<p>For more information and for download, visit: <a href="http://www.codeguru.com/Cpp/I-N/network/remoteinvocation/article.php/c5433" class="bare">http://www.codeguru.com/Cpp/I-N/network/remoteinvocation/article.php/c5433</a></p>
</div>
<div class="paragraph">
<p><strong>PsExec</strong></p>
</div>
<div class="paragraph">
<p>+ nothing required on target machine (service is copied automatically)<br>
- works only on Windows machines</p>
</div>
<div class="paragraph">
<p>For more information and for download, visit: <a href="http://technet.microsoft.com/en-us/sysinternals/bb897553.aspx" class="bare">http://technet.microsoft.com/en-us/sysinternals/bb897553.aspx</a></p>
</div>
<div class="paragraph">
<p><strong>winexe</strong></p>
</div>
<div class="paragraph">
<p>+ freeware<br>
+ sources available<br>
+ nothing required on target machine<br>
- works only from UNIX to Windows machines</p>
</div>
<div class="paragraph">
<p>For more information and for download, visit: <a href="http://sourceforge.net/projects/winexe" class="bare">http://sourceforge.net/projects/winexe</a>.</p>
</div>
<div class="paragraph">
<p><strong>ssh</strong></p>
</div>
<div class="paragraph">
<p>+ freeware<br>
+ sources available<br>
+ reliable<br>
+ works from any of the supported platforms to any other<br>
- needs ssh-keygen to prepare ssh keys so that it doesn&#8217;t prompt for a password.<br>
- manual sshd installation on remote machine required</p>
</div>
<div class="paragraph">
<p>Support Utilities</p>
</div>
<div class="paragraph">
<p>The following set of utilities provides useful functions on a remote machine.</p>
</div>
<div class="paragraph">
<p>Part of standard Windows installation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>mkdir</p>
</li>
<li>
<p>rmdir</p>
</li>
<li>
<p>dir</p>
</li>
<li>
<p>xcopy</p>
</li>
<li>
<p>move</p>
</li>
<li>
<p>cacls</p>
</li>
<li>
<p>net share</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>External utilities:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>setacl 2.x (supports SID identifiers in place of account names, <a href="http://setacl.sourceforge.net/" class="bare">http://setacl.sourceforge.net/</a>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Requirements</p>
</div>
<div class="paragraph">
<p>To set up and use folder management based on the xCmd utilities:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Reference the dxmJoin.jar package, which contains the necessary classes, in com.siemens.dxm.join.userhook.ads.</p>
</li>
<li>
<p>The xCmd utility must be available in the executable path of the IdS-J server.</p>
</li>
<li>
<p>The account that will be used to access a remote computer must have admin privileges on the remote computer. The account is not to be specified in DN format.</p>
</li>
<li>
<p>The IdS-J server must run under an account with set password to be able to connect to the network. The default LocalSystem account is therefore not suitable.</p>
</li>
<li>
<p>When setting the account permission to a folder or share, note that the account must be visible on the remote computer unless you are using the account SID and the correct domain prefix must be specified if necessary.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Deployment</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Copy the xCmd utility to the path where the IdS-J server can find it.</p>
</li>
<li>
<p>If necessary, copy the setacls utility to all target machines that will be managed.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Usage Sample</p>
</div>
<div class="paragraph">
<p>This functionality can be used, for example, to implement the creation of user home and profile folders with appropriate shares on a given user home server within Active Directory target system provisioning:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>create account</p>
</li>
<li>
<p>change account attributes</p>
</li>
<li>
<p>delete account</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Some permanent configuration information is stored as target system environment variables (root of home folders, default permissions to be set). Account credentials to connect remotely to the home server are extracted from the target system connection obtained from the environment (same account used).</p>
</div>
<div class="paragraph">
<p>The user hook is bound to the account channel of the target system. The channel mapping manages the <strong>homeFolder</strong> and <strong>profilePath</strong> attributes of Active Directory. When creating the folders after a new account is created, permissions are not set within the given user account name, but within the user SID, because the home server does not know about the new account immediately.</p>
</div>
<div class="paragraph">
<p>The user hook handles the following situations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Add request: the source entry is searched for the home folder attribute and when found, folder and share are created.</p>
</li>
<li>
<p>Modify request: the account state modification is checked first. If it is presented, it is evaluated first (see below). If not, the request is searched for the home folder modification and when found and it differs from the source entry value, folders are moved and shares are recreated in a new location.</p>
</li>
<li>
<p>If the account state changes to DISABLED: no action is performed.</p>
</li>
<li>
<p>If the account state changes to ENABLED: folder and share are checked for existence and created if necessary.</p>
</li>
<li>
<p>Delete request: the source entry is searched for the home folder attribute and when found, folders and shares are deleted.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Additional Information</p>
</div>
<div class="paragraph">
<p>For additional information, search for the FolderManager.java class under the Additions\RealtimeWorkflows folder of the DirX Identity delivery media. It contains a channel user hook template for creation of the account home folder and share.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch7_citrix_sharefile_workflows"><a class="anchor" href="#_ch7_citrix_sharefile_workflows"></a><a class="link" href="#_ch7_citrix_sharefile_workflows">7.2.3. Citrix ShareFile Workflows</a></h4>
<div class="paragraph">
<p>The Citrix ShareFile Provisioning workflows operate between a target system of type <strong>LDAP</strong> in the Identity Store and the corresponding connected Citrix ShareFile application.</p>
</div>
<div class="paragraph">
<p>The workflows use the Citrix ShareFile connector for provisioning. This connector communicates with the Citrix ShareFile across the HTTP protocol.</p>
</div>
<div class="paragraph">
<p>The workflows handle the following objects:</p>
</div>
<div class="paragraph">
<p><strong>Users</strong> - the Citrix ShareFile users and contacts.</p>
</div>
<div class="paragraph">
<p><strong>Groups</strong> - the Citrix ShareFile groups.</p>
</div>
<div class="paragraph">
<p>The delivered workflows are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Ident_Citrix ShareFile_Realtime</strong> - the synchronization workflow that exports detected changes for account and group objects from Identity Store to the Citrix ShareFile cloud and then validates the processed changes in the Citrix ShareFile to the Identity Store.</p>
</li>
<li>
<p><strong>Validate_Citrix ShareFile_Realtime</strong> - the validation workflow that imports existing Citrix ShareFile users and groups with group assignments from the Citrix ShareFile cloud to the Identity Store.</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="_ch7_citrix_sharefile_prerequisites_and_limitations"><a class="anchor" href="#_ch7_citrix_sharefile_prerequisites_and_limitations"></a><a class="link" href="#_ch7_citrix_sharefile_prerequisites_and_limitations">7.2.3.1. Citrix ShareFile Prerequisites and Limitations</a></h5>
<div class="paragraph">
<p>Depending on the type of Citrix subscription, the maximum number of employees that can be managed by DirX Identity may be limited.</p>
</div>
<div class="paragraph">
<p>It is not possible to change a group&#8217;s name using the GUI in the DirX Identity Manager.</p>
</div>
<div class="paragraph">
<p>The delivered workflows do not configure password synchronization.</p>
</div>
<div class="paragraph">
<p>Because of a constraint in DirX Identity when handling membership for a user without an existing account in Citrix, the e-mail address is used to identify the user inside an SPML modify request. (The same condition applies to an add request.) If there is already an account for the user in Citrix, the Citrix id is used to identify the user inside an SPML modify request.</p>
</div>
<div class="paragraph">
<p>The Citrix ShareFile API does not allow you to create a user with the same e-mail address as an existing user. Such an attempt fails. The Citrix ShareFile connector returns the ID of the user with this e-mail address in the SPML response.</p>
</div>
<div class="paragraph">
<p>The Citrix ShareFile API does allow you to create a group with the same name as an existing group. However, the Citrix ShareFile connector does not forward such a request to Citrix and returns an error.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_connecting_to_citrix_sharefile"><a class="anchor" href="#_ch7_connecting_to_citrix_sharefile"></a><a class="link" href="#_ch7_connecting_to_citrix_sharefile">7.2.3.2. Connecting to Citrix ShareFile</a></h5>
<div class="paragraph">
<p>To configure the connection to Citrix ShareFile:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Specify the name of the Citrix ShareFile server.</p>
</li>
<li>
<p>Set up the bind credentials of the connected directory representing Citrix ShareFile. Use a ShareFile account with sufficient rights.</p>
</li>
<li>
<p>Specify the HTTP proxy in the bind profile if necessary.</p>
</li>
<li>
<p>Check the provisioning settings used by the connected Citrix ShareFile system. Specify them according to real values for your provisioned Citrix ShareFile target system.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_configuring_the_citrix_sharefile_target_system"><a class="anchor" href="#_ch7_configuring_the_citrix_sharefile_target_system"></a><a class="link" href="#_ch7_configuring_the_citrix_sharefile_target_system">7.2.3.3. Configuring the Citrix ShareFile Target System</a></h5>
<div class="paragraph">
<p>The Citrix ShareFile target system requires the following layout:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Accounts</strong> - all accounts are located in a subfolder <strong>Accounts</strong>.</p>
</li>
<li>
<p><strong>Groups</strong> - all groups are located in a subfolder <strong>Groups</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The attribute <strong>dxrPrimaryKey</strong> of accounts and groups contains the identifier of these objects in the connected system.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_citrix_sharefile_workflow_and_activities"><a class="anchor" href="#_ch7_citrix_sharefile_workflow_and_activities"></a><a class="link" href="#_ch7_citrix_sharefile_workflow_and_activities">7.2.3.4. Citrix ShareFile Workflow and Activities</a></h5>
<div class="paragraph">
<p>The Citrix ShareFile users and group (and membership) are synchronized via a pair of channels (one channel per direction). The membership in Identity is stored on accounts. See the default Citrix ShareFile workflow for details.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_citrix_sharefile_ports"><a class="anchor" href="#_ch7_citrix_sharefile_ports"></a><a class="link" href="#_ch7_citrix_sharefile_ports">7.2.3.5. Citrix ShareFile Ports</a></h5>
<div class="paragraph">
<p>This section describes the Citrix ShareFile ports.</p>
</div>
<div class="paragraph">
<p>TS Port</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>CF - Crypt Filter</strong><br>
A Citrix ShareFile filter is configured implicitly. It is used to send the decrypted password attribute <strong>userPassword</strong> to the Citrix ShareFile cloud.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch7_dirx_access_workflows"><a class="anchor" href="#_ch7_dirx_access_workflows"></a><a class="link" href="#_ch7_dirx_access_workflows">7.2.4. DirX Access Workflows</a></h4>
<div class="paragraph">
<p>There are two methods to connect DirX Access with DirX Identity:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>DirX Access can directly make use of the DirX Identity target system.</p>
</li>
<li>
<p>DirX Identity can provision DirX Access via standard LDAP workflows.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The first method is easy to set up and handle, is always up to date and avoids any synchronization effort.</p>
</div>
<div class="paragraph">
<p>The second method should be used if the combined load coming from DirX Access and DirX Identity is too high for the directory server.</p>
</div>
<div class="sect4">
<h5 id="_ch7_using_the_target_system"><a class="anchor" href="#_ch7_using_the_target_system"></a><a class="link" href="#_ch7_using_the_target_system">7.2.4.1. Using the Target System</a></h5>
<div class="paragraph">
<p>This variant assumes that DirX Access uses directly the DirX Identity target system. Perform these steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Set up a virtual target system in DirX Identity. State handling is not necessary for this type of target system.</p>
</li>
<li>
<p>Set up DirX Access to use the DirX Identity target system as user store. Read the corresponding DirX Access documentation.</p>
</li>
<li>
<p>Test the solution.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>All changes of accounts and group memberships in DirX Identity are immediately visible from DirX Access.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_using_ldap_connectivity"><a class="anchor" href="#_ch7_using_ldap_connectivity"></a><a class="link" href="#_ch7_using_ldap_connectivity">7.2.4.2. Using LDAP Connectivity</a></h5>
<div class="paragraph">
<p>In this model we assume two different directory server instances: one keeps the Identity Store, the other one acts as DirX Access repository.</p>
</div>
<div class="paragraph">
<p>To set up this solution, perform these steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Create a new target system of type LDAP in DirX Identity. The necessary synchronization and validation workflows will be automatically configured.</p>
</li>
<li>
<p>Adapt the mapping of the synchronization and validation workflows according to the requirements of DirX Access.</p>
</li>
<li>
<p>Test the solution.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In this case provisioning changes (account and group changes) are propagated with real-time workflows to DirX Access. The delay is typically only a few seconds.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch7_evidian_esso_workflow"><a class="anchor" href="#_ch7_evidian_esso_workflow"></a><a class="link" href="#_ch7_evidian_esso_workflow">7.2.5. Evidian ESSO Workflow</a></h4>
<div class="paragraph">
<p>The Evidian ESSO system is an Active Directory (ADS) or LDAP target system in which every account can be enabled for single sign-on (SSO) to intranet- and extranet-based applications.</p>
</div>
<div class="paragraph">
<p>A target system associated with the application to be accessed via SSO from user accounts in the ADS/LDAP ESSO target system is configured in the Evidian ESSO workflow. This configuration allows a user who is logged into the ADS/LDAP ESSO connected system with the corresponding ADS/LDAP account to access the application-specific connected system - for example, a Salesforce system - without additional login.</p>
</div>
<div class="paragraph">
<p>The Evidian ESSO workflow operates between an Identity Store and an ADS/LDAP ESSO connected system. The workflow uses the LDAP connector on the Identity Store side and the ESSO connector on the Evidian ESSO side. The connector communicates via the Evidian User Access Web Service (labeled <strong>ESSO Web API</strong> in the next figure). The following figure shows this deployment:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch7_targetWFs/image4.png" alt="Evidian ESSO Provisioning Workflow Architecture">
</div>
<div class="title">Figure 79. Evidian ESSO Provisioning Workflow Architecture</div>
</div>
<div class="paragraph">
<p>To provision the Evidian ESSO system, you create an Evidian ESSO connected directory and link it to the ADS/LDAP ESSO target system&#8217;s connected directory. The following figure illustrates the simplified data model in Connectivity/Provisioning:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch7_targetWFs/image5.png" alt="Evidian ESSO Provisioning Workflow Data Flow">
</div>
<div class="title">Figure 80. Evidian ESSO Provisioning Workflow Data Flow</div>
</div>
<div class="sect4">
<h5 id="_ch7_evidian_esso_workflow_prerequisites_and_limitations"><a class="anchor" href="#_ch7_evidian_esso_workflow_prerequisites_and_limitations"></a><a class="link" href="#_ch7_evidian_esso_workflow_prerequisites_and_limitations">7.2.5.1. Evidian ESSO Workflow Prerequisites and Limitations</a></h5>
<div class="paragraph">
<p>The Evidian ESSO workflow has the following prerequisites:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The Evidian User Access Web Service must be reachable.</p>
</li>
<li>
<p>The Evidian certificate authority (CA) must be added to the <strong>cacerts</strong> file used by the Java-based Server (IdS-J).</p>
</li>
<li>
<p>The Evidian ESSO system must be configured as an Active Directory target system. The accounts must be available (at least in the state IMPORTED) and linked to a user.</p>
</li>
<li>
<p>To perform ESSO provisioning for the ADS ESSO target system, a connected directory of type ESSO (shown as <strong>ESSO</strong> in the previous figure) must be configured and linked with the ADS ESSO connected directory (shown as <strong>ADS/LDAP ESSO</strong> in the previous figure).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The Evidian ESSO workflow assumes that a boolean flag <strong>dxrOptions(enablesso)</strong> is configured for the account. It&#8217;s up to you how to populate it. You can define a flag at the user that is mastered to the account or you can define rules that specify for which accounts ESSO should be enabled. Here is a target system instance-specific object description extension for the definition:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">...
&lt;!-- LDAP specific property pages --&gt;
&lt;propertysheet&gt;

  &lt;propertypage name="Esso"
      insertafter="AccountGeneral"
      class="siemens.dxr.manager.nodes.customizer.GenericPropertyPage"
      title="Esso Enabling"
      layout="dxrOptions(enableEsso)"
      helpcontext="mr_ts_group_tsspecific"/&gt;
  &lt;/propertysheet&gt;

&lt;!-- LDAP specific properties --&gt;
&lt;properties&gt;
  &lt;property name="dxrOptions(enableEsso)"
      type="java.lang.Boolean"
      label="Enable for SSO"
      readonly="false"
      multivalue="false"
  /&gt;
&lt;/properties&gt;
...</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_setting_up_the_evidian_esso_workflow"><a class="anchor" href="#_ch7_setting_up_the_evidian_esso_workflow"></a><a class="link" href="#_ch7_setting_up_the_evidian_esso_workflow">7.2.5.2. Setting up the Evidian ESSO Workflow</a></h5>
<div class="paragraph">
<p>To set up the Evidian ESSO workflow:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Create the ADS or LDAP target system for the Evidian ESSO system.</p>
</li>
<li>
<p>Run the validation workflow to get the account data.</p>
</li>
<li>
<p>Link the accounts to the users.</p>
</li>
<li>
<p>Introduce the "enable SSO" flag into the target system associated with the application; for example, the Salesforce TS.</p>
</li>
<li>
<p>Create the Evidian ESSO connected directory and then link it to the ADS ESSO target system that you created in the first step.</p>
</li>
<li>
<p>Create the Evidian ESSO workflow and then link to the target system associated with the application.</p>
</li>
<li>
<p>Add the Evidian certificate authority (CA) to <strong>cacerts</strong>.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_connecting_to_evidian_esso"><a class="anchor" href="#_ch7_connecting_to_evidian_esso"></a><a class="link" href="#_ch7_connecting_to_evidian_esso">7.2.5.3. Connecting to Evidian ESSO</a></h5>
<div class="paragraph">
<p>In the Provisioning tab of the ESSO connected directory configuration object, specify the URL to the Evidian Web Service. In the Bind Profiles tab, specify a user and a password.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_evidian_esso_workflow_and_activities"><a class="anchor" href="#_ch7_evidian_esso_workflow_and_activities"></a><a class="link" href="#_ch7_evidian_esso_workflow_and_activities">7.2.5.4. Evidian ESSO Workflow and Activities</a></h5>
<div class="paragraph">
<p>The following figure shows the Evidian ESSO workflow&#8217;s join activity objects at the Identity Store and connected system sides as well as the related ports and channels and their relationships.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch7_targetWFs/image6.png" alt="Evidian ESSO Provisioning Workflow Join Activity" width="Channels and Objects">
</div>
<div class="title">Figure 81. Evidian ESSO Provisioning Workflow Join Activity, Channels and Objects</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_esso_workflow"><a class="anchor" href="#_ch7_esso_workflow"></a><a class="link" href="#_ch7_esso_workflow">7.2.5.5. ESSO Workflow</a></h5>
<div class="paragraph">
<p>In <strong>General</strong> &#8594; <strong>Associated</strong> <strong>TS</strong> for the Evidian ESSO workflow configuration object, specify the target system that corresponds to the application you want to access via Evidian ESSO. The <strong>Is</strong> <strong>applicable for</strong> section for the workflow must match the <strong>Match</strong> properties defined in the associated target system. The workflow uses the SynchOneWay controller.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_evidian_esso_workflow_ports"><a class="anchor" href="#_ch7_evidian_esso_workflow_ports"></a><a class="link" href="#_ch7_evidian_esso_workflow_ports">7.2.5.6. Evidian ESSO Workflow Ports</a></h5>
<div class="paragraph">
<p>This section provides information about the Evidian ESSO Provisioning workflow ports.</p>
</div>
<div class="paragraph">
<p>TS Port</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>CF - Crypt Filter</strong><br>
The standard crypt filter for password decryption.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_evidian_esso_workflow_channels"><a class="anchor" href="#_ch7_evidian_esso_workflow_channels"></a><a class="link" href="#_ch7_evidian_esso_workflow_channels">7.2.5.7. Evidian ESSO Workflow Channels</a></h5>
<div class="paragraph">
<p>This section provides information about Evidian ESSO channels. Only accounts are supported. Since a SynchOneWay controller is used, the channel on the Identity side is only relevant for reading the necessary attributes.</p>
</div>
<div class="sect5">
<h6 id="_ch7_common_aspects"><a class="anchor" href="#_ch7_common_aspects"></a><a class="link" href="#_ch7_common_aspects">7.2.5.7.1. Common Aspects</a></h6>
<div class="paragraph">
<p>Direction: Identity Store &#8594; ESSO</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ID is calculated using the environment variables <strong>essouser</strong> and <strong>essoapplication</strong>. The environment variable <strong>essoapplication</strong> is configured at the account channel in the Specific Attributes tab and is always <strong>DirXIdentity</strong>.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_user_hook"><a class="anchor" href="#_ch7_user_hook"></a><a class="link" href="#_ch7_user_hook">7.2.5.7.2. User Hook</a></h6>
<div class="paragraph">
<p>com.siemens.dxm.join.userhook.esso.UserHookAccountsTo</p>
</div>
<div class="paragraph">
<p>Implements the "Process Source Entry" procedure. It reads the user link of the source entry and tries to find the corresponding account in the ADS/LDAP ESSO target system. It provides the DN (in the connected system) of this account and the State attributes in the following environment properties: <strong>essouser</strong>, <strong>essouserstate</strong>, <strong>essousercsstate</strong>.</p>
</div>
<div class="paragraph">
<p>If the account cannot be found, it returns false and the entry will not be processed (you can&#8217;t manage Evidian ESSO accounts without an Active Directory account).</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_exportjoin"><a class="anchor" href="#_ch7_exportjoin"></a><a class="link" href="#_ch7_exportjoin">7.2.5.7.3. Export/Join</a></h6>
<div class="paragraph">
<p>A simple expression is used:</p>
</div>
<div class="exampleblock">
<div class="content">
${env.essouser} + ",application=" + ${env.essoapplication} + ",role=DirXIdentity"
</div>
</div>
<div class="paragraph">
<p>The user DN part of the identifier is taken from the environment property <strong>essouser</strong> which is populated by the processSourceEntry user hook. The application part is taken from the <strong>essoapplication</strong> environment property. The join expression is just a dummy as the connecter does not support filters. The whole Join criteria is given by the base DN, which identifies exactly one account in the ADS/LDAP ESSO connected system.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_id_mapping"><a class="anchor" href="#_ch7_id_mapping"></a><a class="link" href="#_ch7_id_mapping">7.2.5.7.4. ID Mapping</a></h6>
<div class="paragraph">
<p>ID mapping is a Java source mapping. It corresponds to the base object of the export (if no joined entry is found):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">String adsUserDN = (String) env.get("essouser");
String application = (String) env.get("essoapplication");
targetIdStr = adsUserDN + ",application="+application+",role=DirXIdentity";</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_post_mapping"><a class="anchor" href="#_ch7_post_mapping"></a><a class="link" href="#_ch7_post_mapping">7.2.5.7.5. Post Mapping</a></h6>
<div class="paragraph">
<p>Post mapping is a Java source mapping. The following attributes control the outcome:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The State attributes of the corresponding ADS/LDAP ESSO account (from environment)</p>
</li>
<li>
<p>The dxrState of the source entry (the account in the associated target system)</p>
</li>
<li>
<p>The flag that specifies whether ESSO should be enabled in the default <strong>dxrOption(enableesso)</strong> attribute of the source entry (the account in the associated target system)</p>
</li>
<li>
<p>The joined entry (whether it is available)</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_application"><a class="anchor" href="#_ch7_application"></a><a class="link" href="#_ch7_application">7.2.5.7.6. Application</a></h6>
<div class="paragraph">
<p>The application is defined as a Specific Attribute at the channel configuration object.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_customizing_the_evidian_esso_workflow"><a class="anchor" href="#_ch7_customizing_the_evidian_esso_workflow"></a><a class="link" href="#_ch7_customizing_the_evidian_esso_workflow">7.2.5.8. Customizing the Evidian ESSO Workflow</a></h5>
<div class="paragraph">
<p>This section describes how to customize the Evidian ESSO Provisioning workflow.</p>
</div>
<div class="sect5">
<h6 id="_ch7_using_a_different_enable_sso_flag"><a class="anchor" href="#_ch7_using_a_different_enable_sso_flag"></a><a class="link" href="#_ch7_using_a_different_enable_sso_flag">7.2.5.8.1. Using a Different Enable-SSO Flag</a></h6>
<div class="paragraph">
<p>If you want to use another attribute or another mechanism to define whether an account should be enabled for SSO:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Edit the postmapping to get the flag</p>
</li>
<li>
<p>Adapt the object description to manage this flag (optional)</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_exporting_the_search_base_on_the_identity_side"><a class="anchor" href="#_ch7_exporting_the_search_base_on_the_identity_side"></a><a class="link" href="#_ch7_exporting_the_search_base_on_the_identity_side">7.2.5.8.2. Exporting the Search Base on the Identity Side</a></h6>
<div class="paragraph">
<p>By default, <strong>"cn=Accounts,"${env.assocts}"* is used as the search base. If your associated target system holds accounts and groups in the same folder, you need to change this to: *"cn=Accounts and Groups,"${env.assocts}"</strong>.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch7_google_apps_workflows"><a class="anchor" href="#_ch7_google_apps_workflows"></a><a class="link" href="#_ch7_google_apps_workflows">7.2.6. Google Apps Workflows</a></h4>
<div class="paragraph">
<p>The Google Apps Provisioning workflows operate between a target system of type LDAP in the Identity Store and the corresponding connected Google Apps endpoint.</p>
</div>
<div class="paragraph">
<p>The workflows use the Google Apps connector for provisioning. This connector communicates with the Google Apps endpoint across the HTTP protocol using a REST API provided by Google, called Admin Directory API.</p>
</div>
<div class="paragraph">
<p>The connector uses Google OAuth service for authentication and authorization purposes.</p>
</div>
<div class="paragraph">
<p>The workflows handle the following objects:</p>
</div>
<div class="paragraph">
<p><strong>Users</strong> - the Google Apps users.</p>
</div>
<div class="paragraph">
<p><strong>Groups</strong> - the Google Apps groups.</p>
</div>
<div class="paragraph">
<p>The delivered workflows are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Ident_GoogleApps_Realtime</strong> - the synchronization workflow that exports detected changes for account and group objects from the Identity Store to the GoogleApps server and then validates the processed changes in Google Apps to the Identity Store. The workflow also generates a password if the object is created.</p>
</li>
<li>
<p><strong>Validate_GoogleApps_Realtime</strong> - the validation workflow that imports existing Google Apps users and groups along with group assignments from Google Apps to the Identity Store.</p>
</li>
<li>
<p><strong>SetPassword in Google Apps</strong> - the workflow that sets the password for the user object in GoogleApps.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following figure illustrates the Google Apps Provisioning workflow architecture.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch7_targetWFs/image7.png" alt="Google Apps Workflow Architecture">
</div>
<div class="title">Figure 82. Google Apps Workflow Architecture</div>
</div>
<div class="sect4">
<h5 id="_ch7_google_apps_workflow_prerequisites_and_limitations"><a class="anchor" href="#_ch7_google_apps_workflow_prerequisites_and_limitations"></a><a class="link" href="#_ch7_google_apps_workflow_prerequisites_and_limitations">7.2.6.1. Google Apps Workflow Prerequisites and Limitations</a></h5>
<div class="paragraph">
<p>The Google Apps connector acts as a remote application to the Google Apps system. As a result, you need to create a Google Admin Account and then link it to a Google Service Account in order to be able to access the API using the OAuth 2.0. (For details, see <strong><a href="https://developers.google.com/accounts/docs/OAuth2Login" class="bare">https://developers.google.com/accounts/docs/OAuth2Login</a></strong>.)</p>
</div>
<div class="paragraph">
<p>To obtain Google Admin Directory API credentials:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Log in to the Google Developers Console with your admin user credentials at <strong><a href="https://console.developers.google.com" class="bare">https://console.developers.google.com</a></strong>.</p>
</li>
<li>
<p>Create a new project. You need only provide a name; for example, <strong>DirX-Interop</strong>.</p>
</li>
<li>
<p>In the <strong>Projects</strong> window, navigate to <strong>APIs &amp; auth</strong> &#8594; <strong>APIs</strong>.</p>
</li>
<li>
<p>Search for the <strong>Admin</strong> <strong>SDK</strong> <strong>API</strong> and enable it for this user.</p>
</li>
<li>
<p>Navigate to <strong>APIs</strong> <strong>&amp;</strong> <strong>auth</strong> &#8594; <strong>Credentials</strong> and then create a new Service Account:</p>
</li>
<li>
<p>In the <strong>OAuth</strong> section, click <strong>Create new Client ID</strong>.</p>
</li>
<li>
<p>From the pop-up window, select the <strong>Service</strong> account and then click <strong>Create</strong> <strong>Client</strong> <strong>ID</strong>.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Your Client ID, Service Account Email and Private P12 Key have been generated (Please download your generated key as a P12 file. You will need it when setting up the Google Apps connected directory in DirX Identity).
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To use the Google Admin Directory API:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Log in to the Google Admin Console with your admin user credentials at <strong><a href="https://admin.google.com" class="bare">https://admin.google.com</a></strong>.</p>
</li>
<li>
<p>Navigate to <strong>Security</strong> &#8594; <strong>Advanced</strong> <strong>settings</strong> &#8594; <strong>Manage</strong> <strong>OAuth</strong> <strong>Client</strong> <strong>access</strong>.</p>
</li>
<li>
<p>In <strong>Client</strong> <strong>Name</strong>, enter the client ID generated by Google in the Developers Console.</p>
</li>
<li>
<p>In <strong>One or more API Scopes</strong>, enter the Google API scope URLs, separated by commas (we only need to be able to modify users and groups: <strong><a href="https://www.googleapis.com/auth/admin.directory.group" class="bare">https://www.googleapis.com/auth/admin.directory.group</a>, <a href="https://www.googleapis.com/auth/admin.directory.user" class="bare">https://www.googleapis.com/auth/admin.directory.user</a></strong>).</p>
</li>
<li>
<p>Click <strong>Authorize</strong> and then check to see that your changes appear in the list below. Note that when you make these changes, it takes Google a little time to apply them on its side.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Now you are ready to use the Google Admin Directory API.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_connecting_to_google_apps"><a class="anchor" href="#_ch7_connecting_to_google_apps"></a><a class="link" href="#_ch7_connecting_to_google_apps">7.2.6.2. Connecting to Google Apps</a></h5>
<div class="paragraph">
<p>To configure the connection to Google Apps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Set up the bind credentials of the connected directory that represents the Google Apps system. Use the correct credentials (with sufficient rights). These are the credentials used for administration of the Google Apps domain. The User must be a valid Google Apps user name or e-mail address.</p>
</li>
<li>
<p>Set up the following items in your Google Apps connected directory (in the Google API tab):</p>
</li>
<li>
<p>Private Key - use the P12 file generated by Google for your account.</p>
</li>
<li>
<p>Service Account Email - use the one generated by the Google developer console.</p>
</li>
<li>
<p>Application Name - you can use anything you like.</p>
</li>
<li>
<p>Domain Name - must contain the name of your company domain. (If the domain is not configured (default) it is deduced from the bind profile user id)</p>
</li>
<li>
<p>If necessary, specify the HTTP proxy server in the HTTP/HTTPS Proxy Server tab.</p>
</li>
<li>
<p>Check the provisioning settings used by the connected Google Apps system and set them to the values required by your provisioned Google Apps target system.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To run the Google Apps workflows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Assign the resource family <strong>GoogleApps</strong> in the IdS-J server.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_configuring_the_google_apps_target_system"><a class="anchor" href="#_ch7_configuring_the_google_apps_target_system"></a><a class="link" href="#_ch7_configuring_the_google_apps_target_system">7.2.6.3. Configuring the Google Apps Target System</a></h5>
<div class="paragraph">
<p>The Google Apps target system requires the following layout:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Accounts</strong> - all accounts (Google Apps users) are located in a subfolder <strong>Accounts</strong>.</p>
</li>
<li>
<p><strong>Groups</strong> - all groups are located in a subfolder <strong>Groups</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <strong>dxrPrimaryKey</strong> attribute of accounts and groups contains the identifier of these objects in the connected system. This attribute is generated only by Google.</p>
</div>
<div class="paragraph">
<p>The group membership is stored at the account object and references the <strong>dxrPrimaryKey</strong> attribute of group objects.</p>
</div>
<div class="paragraph">
<p>Configure the <strong>Domain</strong> property at the target system at the Options tab. This value is used as a suffix for Google Apps <strong>User</strong> <strong>Email</strong> and <strong>Group</strong> <strong>Email</strong>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_google_apps_workflow_and_activities"><a class="anchor" href="#_ch7_google_apps_workflow_and_activities"></a><a class="link" href="#_ch7_google_apps_workflow_and_activities">7.2.6.4. Google Apps Workflow and Activities</a></h5>
<div class="paragraph">
<p>The following figure shows the layout of the channels that are used by the Google Apps workflow join activity.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch7_targetWFs/image8.png" alt="Google Apps Workflow Channels and Objects">
</div>
<div class="title">Figure 83. Google Apps Workflow Channels and Objects</div>
</div>
<div class="paragraph">
<p>The Google Apps users and groups (and memberships) are synchronized via a pair of channels (one channel per direction). The membership in the Identity Store is stored in accounts. See the default Google Apps workflow for details</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_google_apps_ports"><a class="anchor" href="#_ch7_google_apps_ports"></a><a class="link" href="#_ch7_google_apps_ports">7.2.6.5. Google Apps Ports</a></h5>
<div class="paragraph">
<p>This section describes the Google Apps ports.</p>
</div>
<div class="paragraph">
<p>TS Port</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>CF - Crypt Filter</strong><br>
A Google Apps filter is configured implicitly. It is used to send the decrypted password attribute <strong>userPassword</strong> to the Google Apps endpoint.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_google_apps_account_channel_mapping"><a class="anchor" href="#_ch7_google_apps_account_channel_mapping"></a><a class="link" href="#_ch7_google_apps_account_channel_mapping">7.2.6.6. Google Apps Account-Channel Mapping</a></h5>
<div class="paragraph">
<p>In the account channel mapping, many LDAP attribute are mapped to/from Google Apps attributes. The following attributes receive special handling:</p>
</div>
<div class="paragraph">
<p>Direction: Identity Store &#8594; Google Apps</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ID - dxrPrimaryKey</p>
</li>
<li>
<p>Join - $\{source.dxrPrimaryKey}</p>
</li>
<li>
<p>Password - remember that the accountâs password is inherited from the user object in Identity Store when you assign a group to a user (and the account is then created implicitly). If no password is present at the user, the accountâs password is initially set to the default password. Check to make sure that the passwords comply with the password policies in effect for the Google Apps system. (By default, Google needs a password with a minimum length of eight (8) characters).</p>
</li>
<li>
<p>userName - this attribute doesnât need mapping because Google automatically generates the user name by concatenating the givenName and familyName</p>
</li>
<li>
<p>givenName - this attribute is set to "N/A" if the user doesnât provide a givenName.</p>
</li>
<li>
<p>orgUnitPath - the root (<strong>/</strong>) is always mapped to this attribute because the connector doesnât support the full functionality of the Google Apps organizational units.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Direction: Google Apps &#8594; Identity Store</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ID - $\{joinedEntry.id} or "cn="${source.userName}","+${env.role_ts_account_base}</p>
</li>
<li>
<p>Join - ${target.dxrPrimaryKey} or ${target.id}.</p>
</li>
<li>
<p>givenName - ${joinedEntry.givenName} or ${source.givenName} because the Google Apps system may register the changes after the validate workflow is finished.</p>
</li>
<li>
<p>sn - ${joinedEntry.sn} or ${source.familyName} because the Google Apps system may register the changes after the validate workflow is finished.</p>
</li>
<li>
<p>dxrName - ${joinedEntry.dxrName} or ${source.userName} because the Google Apps system may register the changes after the validate workflow is finished.</p>
</li>
<li>
<p>c, l, postalCode, postalAddress, postOfficeBox, st, street - these attributes are all mapped from Google&#8217;s multi-valued <strong>addresses</strong> attribute only for the address flagged as <strong>primary</strong>.</p>
</li>
<li>
<p>secretary - Google permits multiple secretaries. Only the first entry is mapped to the Identity Store.</p>
</li>
<li>
<p>employeeNumber - mapped from Google&#8217;s multi-valued <strong>externalIds</strong> attribute only for the <strong>externalId</strong> of type <strong>organization</strong>.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_google_apps_group_channel_mapping"><a class="anchor" href="#_ch7_google_apps_group_channel_mapping"></a><a class="link" href="#_ch7_google_apps_group_channel_mapping">7.2.6.7. Google Apps Group-Channel Mapping</a></h5>
<div class="paragraph">
<p>Mappings are defined for the Google Apps attributes <strong>Name</strong>, <strong>Description</strong> and <strong>Email</strong>.</p>
</div>
<div class="paragraph">
<p>Direction: Identity Store &#8594; GoogleApps</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ID - dxrPrimaryKey</p>
</li>
<li>
<p>Join - ${source.dxrPrimaryKey}</p>
</li>
<li>
<p>Post-Mapping - if the <strong>dxrState</strong> attribute in the Identity Store is DELETED, the operation (as part of the mapped entry) is set to DELETE.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Direction: GoogleApps &#8594; Identity Store</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ID - ${joinedEntry.id} or "cn="${source.groupName}","+ env.role_ts_group_base}</p>
</li>
<li>
<p>Join - ${target.dxrPrimaryKey} or ${target.id}.</p>
</li>
<li>
<p>dxrTSState - the attribute used to detect the current state of the group in Google Apps. It is set to ENABLED for existing entries and to DELETED for non-existing entries.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_google_apps_member_channel_mapping"><a class="anchor" href="#_ch7_google_apps_member_channel_mapping"></a><a class="link" href="#_ch7_google_apps_member_channel_mapping">7.2.6.8. Google Apps Member-Channel Mapping</a></h5>
<div class="paragraph">
<p>The member-channel configuration holds the mapping of the group members.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_google_apps_setpassword_channel_mapping"><a class="anchor" href="#_ch7_google_apps_setpassword_channel_mapping"></a><a class="link" href="#_ch7_google_apps_setpassword_channel_mapping">7.2.6.9. Google Apps SetPassword-Channel Mapping</a></h5>
<div class="paragraph">
<p>A password channel updates the Google Apps account passwords.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch7_imprivata_workflows"><a class="anchor" href="#_ch7_imprivata_workflows"></a><a class="link" href="#_ch7_imprivata_workflows">7.2.7. Imprivata Workflows</a></h4>
<div class="paragraph">
<p>The Imprivata OneSign Provisioning workflows are used to synchronize data between a target system of type SPMLv1 in the Identity Store and the corresponding connected Imprivata OneSign system. The Imprivata OneSign is provisioned via the SPMLv1 messages sent to an enabled Provisioning System Adaptor in the Imprivata OneSign appliance.</p>
</div>
<div class="paragraph">
<p>The workflows handle the following Imprivata OneSign objects:</p>
</div>
<div class="paragraph">
<p><strong>Subscriber</strong> - the subscriber represents the physical user. It holds the demographical data and can be used for accessing Imprivata OneSign.</p>
</div>
<div class="paragraph">
<p><strong>Account</strong> - each user can have one or more application accounts to log into an application managed via Imprivata OneSign. It stores the application credentials.</p>
</div>
<div class="paragraph">
<p>The delivered workflows are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Ident_Imprivata_Realtime</strong> - the synchronization one-way workflow that exports detected changes for a subscriber object from Identity to the Imprivata OneSign and updates the state of the affected entry in Identity.</p>
</li>
<li>
<p><strong>SetPassword in Imprivata</strong> - the workflow that sets the password for the subscriber object in Imprivata OneSign.</p>
</li>
<li>
<p><strong>Ident_ImprivataExtranetPortal_Realtime</strong> - the synchronization one-way workflow that exports detected changes of application credentials for an application account object from Identity to Imprivata OneSign. The workflow does not update the state of the account entry in the Identity target system. This workflow is a sample that works by default from the Extranet Portal target system in the My-Company sample domain.</p>
</li>
<li>
<p><strong>SetPassword in ImprivataExtranetPortal</strong> - the workflow that sets the password for the application account object in Imprivata OneSign. This workflow is a sample that works by default from the Extranet Portal target system in the My-Company sample domain.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The subscriber object is directly mapped to the single account object of the corresponding Imprivata target system in the Provisioning configuration. The application account object is mapped to a real account of a target system in DirX Identity, which is configured in Imprivata OneSign as an application for single sign-on (SSO). The following figure illustrates this object mapping.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch7_targetWFs/image9.png" alt="Imprivata Object Mapping">
</div>
<div class="title">Figure 84. Imprivata Object Mapping</div>
</div>
<div class="paragraph">
<p>As shown in the figure:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The Imprivata OneSign Domain is mapped to the DirX Identity target system</p>
</li>
<li>
<p>The Imprivata OneSign Subscriber is mapped to the DirX Identity account in the Imprivata target system</p>
</li>
<li>
<p>The Imprivata OneSign Application is mapped to any DirX Identity target system that allows setting passwords</p>
</li>
<li>
<p>The Imprivata OneSign Account is mapped to the DirX Identity account of any target system that permits passwords to be set</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>At each event, the Imprivata application target systems real-time provisioning triggers two different workflows. One workflow synchronizes the entries for the real application (for example, actualizes an account in an LDAP connected directory) and the other workflow synchronizes the credentials of the user for the LDAP application configured in Imprivata OneSign for SSO. Both workflows handle the events with the same topic. The following figure illustrates these workflows.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch7_targetWFs/image10.png" alt="Imprivata Workflows">
</div>
<div class="title">Figure 85. Imprivata Workflows</div>
</div>
<div class="paragraph">
<p>The subscriber and account objects in an Imprivata OneSign target system and in a target system managed via Imprivata OneSign must be created, modified and deleted in the same time. It is necessary to build a privilege structure that supports the concurrent handling of the Imprivata OneSign subscriber and account objects (use permissions that are linked to the corresponding groups to accomplish this task).</p>
</div>
<div class="sect4">
<h5 id="_ch7_imprivata_workflow_prerequisites_and_limitations"><a class="anchor" href="#_ch7_imprivata_workflow_prerequisites_and_limitations"></a><a class="link" href="#_ch7_imprivata_workflow_prerequisites_and_limitations">7.2.7.1. Imprivata Workflow Prerequisites and Limitations</a></h5>
<div class="paragraph">
<p>The Imprivata Provisioning workflows support:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Imprivata OneSign 4.1 SP1 or newer.</p>
</li>
<li>
<p>One-to-one relationship between a subscriber object and an application account object in an application. More accounts for a subscriber in an application are not supported.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The Imprivata Provisioning workflows do not support:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Disable operation for subscriber objects. Only the delete operation is supported.</p>
</li>
<li>
<p>Reconciliation of the subscriber or account objects due to search operation limitations of the Imprivata OneSign Provisioning System Adaptor.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_connecting_to_imprivata"><a class="anchor" href="#_ch7_connecting_to_imprivata"></a><a class="link" href="#_ch7_connecting_to_imprivata">7.2.7.2. Connecting to Imprivata</a></h5>
<div class="paragraph">
<p>To configure the connection to Imprivata:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Specify the <strong>IP Address</strong> of the Imprivata OneSign host. Imprivata OneSign is typically configured to accept SPMLv1 requests on the pre-configured secure port 443 and forces the use of the secured transport layer (HTTPS). Use the corresponding Imprivata service object which is the part of the connected directory that represents Imprivata OneSign.</p>
</li>
<li>
<p><strong>URL Path</strong> and <strong>Socket Timeout</strong> can be configured at the target system port of the appropriate workflow object. The <strong>URL Path</strong> of the Imprivata OneSign SPMLv1 provisioning service is pre-configured to the default value <strong>sso/provision/spmlrouter</strong>, Do not change this setting. Use <strong>Socket Timeout</strong> to increase the timeout value (in seconds) if necessary.</p>
</li>
<li>
<p>The Imprivata OneSign provisioning service does not use the bind credentials of the connected directory. Use the pre-configured values.</p>
</li>
<li>
<p>The HTTPS protocol requires the Imprivata OneSign certificate used for the secured connection to be trusted by the Java Runtime Environment for DirX Identity which is located in <em>dxi_java_home</em>. Perform trust store administration with Java <strong>keytool</strong> and import the Imprivata OneSign certificate. (See the chapter "Using OneSign Provisioning Features" in the Imprivata OneSign documentation for more details.)</p>
</li>
<li>
<p>Imprivata OneSign workflows use a specially implemented SPMLv1 based connector. Each SPMLv1 request sent to Imprivata OneSign must be identified by a <strong>External System Name</strong> which is part of the target system port of the appropriate workflow object. It is also pre-configured in the mapping for the channels that synchronize subscriber and account objects. This name is equivalent to the name of the configured Provisioning System Adaptor in the Imprivata OneSign appliance. Set these values in channel mappings and in the connector port according to the values configured in the Imprivata OneSign system.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_configuring_the_imprivata_target_system"><a class="anchor" href="#_ch7_configuring_the_imprivata_target_system"></a><a class="link" href="#_ch7_configuring_the_imprivata_target_system">7.2.7.3. Configuring the Imprivata Target System</a></h5>
<div class="paragraph">
<p>The Imprivata target system requires the following layout:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Accounts</strong> - one account object exists in the Identity target system for each Imprivata OneSign subscriber object in the connected system. All accounts are located in the subfolder Accounts.</p>
</li>
<li>
<p><strong>Groups</strong> - Imprivata OneSign does not use any type of group. Use a pre-configured "virtual" group for the creation of the Imprivata OneSign subscribers.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <strong>dxrPrimaryKey</strong> attribute has a special meaning: it stores the generated Imprivata ID for subscriber objects. The <strong>dxrName</strong> attribute is a single copy of the <strong>employeeNumber</strong> attribute by default and is used as the username in Imprivata OneSign.</p>
</div>
<div class="paragraph">
<p>An application target system managed via Imprivata OneSign requires the following layout:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Accounts</strong> - one account object exists in Identity for every Imprivata OneSign account object in the connected system. All accounts can be located in an Accounts subfolder.</p>
</li>
<li>
<p><strong>Groups</strong> - Imprivata OneSign does not require any type of group from the application target system. To assign accounts, use existing groups of the managed application.</p>
</li>
<li>
<p><strong>Accounts and groups</strong> - an application can also work with the single common subtree containing both accounts and groups.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <strong>dxmGUID</strong> attribute has a special meaning for Imprivata OneSign application accounts: it stores the generated Imprivata ID for account objects. The <strong>uid</strong> attribute is a single copy of the <strong>employeeNumber</strong> attribute by default. It must be generated in the same way as the <strong>dxrName</strong> attribute for the subscriber objects since it is used to identify the corresponding subscriber for the account object. The <strong>dxrName</strong> attribute for the application account objects is mapped to the application username. To keep the mapping from subscriber to account consistent, you may need to update the object descriptions for the target system accounts that are used as accounts for the Imprivata OneSign application (typically, you must define an additional configuration of the <strong>uid</strong> attribute).</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_imprivata_workflow_and_activities"><a class="anchor" href="#_ch7_imprivata_workflow_and_activities"></a><a class="link" href="#_ch7_imprivata_workflow_and_activities">7.2.7.4. Imprivata Workflow and Activities</a></h5>
<div class="paragraph">
<p>The following figures show the layout of the channels that are used by the join activity.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch7_targetWFs/image11.png" alt="Imprivata Workflow Channels for Imprivata OneSign Subscriber Objects">
</div>
<div class="title">Figure 86. Imprivata Workflow Channels for Imprivata OneSign Subscriber Objects</div>
</div>
<div class="paragraph">
<p>As this figure shows, the Imprivata OneSign subscriber objects are synchronized via a pair of channels. The group channels are only present to handle incoming events for groups. Such events are ignored.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch7_targetWFs/image12.png" alt="Imprivata Workflow Channels for Imprivata OneSign Account Objects">
</div>
<div class="title">Figure 87. Imprivata Workflow Channels for Imprivata OneSign Account Objects</div>
</div>
<div class="paragraph">
<p>As this figure shows, the Imprivata OneSign account objects are also synchronized via a pair of channels. The group channels are only present to handle incoming events for groups and are also ignored.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_imprivata_ports"><a class="anchor" href="#_ch7_imprivata_ports"></a><a class="link" href="#_ch7_imprivata_ports">7.2.7.5. Imprivata Ports</a></h5>
<div class="paragraph">
<p>This section provides information about the Imprivata workflow ports.</p>
</div>
<div class="paragraph">
<p>TS Port</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Crypt Filter</strong><br>
An Imprivata Filter is configured implicitly. It is used to send the <strong>password</strong> and <strong>applicationPassword</strong> subscriber and account application password attributes in the SOAP request decrypted to Imprivata OneSign via SPMLv1. This filter is used only for the password synchronization workflow. The initial password is pre-configured (see the mapping for the channel <strong>account</strong> on the Identity side for both workflows).</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_imprivata_channels"><a class="anchor" href="#_ch7_imprivata_channels"></a><a class="link" href="#_ch7_imprivata_channels">7.2.7.6. Imprivata Channels</a></h5>
<div class="paragraph">
<p>This section provides information about Imprivata workflow channels.</p>
</div>
<div class="sect5">
<h6 id="_ch7_common_aspects_2"><a class="anchor" href="#_ch7_common_aspects_2"></a><a class="link" href="#_ch7_common_aspects_2">7.2.7.6.1. Common Aspects</a></h6>
<div class="paragraph">
<p>Direction: Identity Store &#8594; Imprivata OneSign</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>userDisabled</strong> - the attribute used for disabling of the subscriber object in Imprivata. The value is derived from <strong>dxrState</strong> attribute of the corresponding account object in DirX Identity. The subscriber cannot be disabled in the default configuration, but it can be deleted.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Direction: Imprivata &#8594; Identity Store</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The workflow only uses the one-way synchronization controller, so updates can only be made via a user hook.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_subscriber"><a class="anchor" href="#_ch7_subscriber"></a><a class="link" href="#_ch7_subscriber">7.2.7.6.2. Subscriber</a></h6>
<div class="paragraph">
<p>Direction: Identity Store &#8594; Imprivata OneSign</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ID: <strong>dxrPrimaryKey</strong></p>
</li>
<li>
<p>Join: <strong>${target.externalSystemName}</strong>, <strong>${target.externalDomainName}</strong> and <strong>${target.username}</strong></p>
</li>
<li>
<p>Username: <strong>dxrName</strong></p>
</li>
<li>
<p>User hook stores the subscriber ID generated by Imprivata OneSign to the <strong>dxrPrimaryKey</strong> attribute. It also updates the state of the entry returned by the Imprivata OneSign.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_account"><a class="anchor" href="#_ch7_account"></a><a class="link" href="#_ch7_account">7.2.7.6.3. Account</a></h6>
<div class="paragraph">
<p>Direction: Identity Store &#8594; Imprivata OneSign</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ID: <strong>dxmGUID</strong></p>
</li>
<li>
<p>Join: <strong>${target.externalSystemName}</strong>, <strong>${target.externalDomainName}</strong>, <strong>${target.externalApplicationName}</strong> and <strong>${target.username}</strong></p>
</li>
<li>
<p>Username: <strong>uid</strong></p>
</li>
<li>
<p>Application username: <strong>dxrName</strong></p>
</li>
<li>
<p>User hook stores the account ID generated by Imprivata OneSign to the <strong>dxmGUID</strong> attribute.</p>
</li>
<li>
<p>PostMapping script changes the type of the request to delete if necessary.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_group"><a class="anchor" href="#_ch7_group"></a><a class="link" href="#_ch7_group">7.2.7.6.4. Group</a></h6>
<div class="paragraph">
<p>Direction: Identity Store &#8594; Imprivata OneSign</p>
</div>
<div class="ulist">
<ul>
<li>
<p>User hook ignores all incoming event to update the group objects to Imprivata OneSign.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_password_channel_2"><a class="anchor" href="#_ch7_password_channel_2"></a><a class="link" href="#_ch7_password_channel_2">7.2.7.6.5. Password Channel</a></h6>
<div class="paragraph">
<p>A password channel updates the subscriber and account passwords.</p>
</div>
<div class="paragraph">
<p>A password channel can also be configured backwards from the connected system to the Identity Store to be able to update some attributes in Identity after a password change or reset has taken place in the connected system. The join engine then synchronizes the attributes specified in the corresponding password channel mapping to the Identity Store as usual after the account with its password-relevant attributes is updated in the connected system.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch7_jdbc_workflow"><a class="anchor" href="#_ch7_jdbc_workflow"></a><a class="link" href="#_ch7_jdbc_workflow">7.2.8. JDBC Workflow</a></h4>
<div class="paragraph">
<p>The JDBC Provisioning workflow synchronizes data between a JDBC target system within the Identity Store and a relational database. The following figure shows the deployment.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch7_targetWFs/image13.png" alt="JDBC Provisioning Workflow Architecture">
</div>
<div class="title">Figure 88. JDBC Provisioning Workflow Architecture</div>
</div>
<div class="paragraph">
<p>The workflow uses the LDAP connector on the Identity Store side and the JDBC connector on the database side. The connector communicates with JDBC drivers.</p>
</div>
<div class="paragraph">
<p>The default JDBC workflow is set up for three application-related database tables that hold accounts, groups and memberships. The membership table keeps the relationship between the accounts and the groups. Handling of other or more tables is a customization task.</p>
</div>
<div class="sect4">
<h5 id="_ch7_jdbc_workflow_prerequisites_and_limitations"><a class="anchor" href="#_ch7_jdbc_workflow_prerequisites_and_limitations"></a><a class="link" href="#_ch7_jdbc_workflow_prerequisites_and_limitations">7.2.8.1. JDBC Workflow Prerequisites and Limitations</a></h5>
<div class="paragraph">
<p>You must install the driver jar files that correspond to the JDBC drivers you intend to use. For each IdS-J Server installation, place the jar files in the server&#8217;s <strong>confdb\common\lib</strong> directory to enable the IdS-J Server to use the drivers.</p>
</div>
<div class="paragraph">
<p>The default for new JDBC target systems is now that memberships are held at the account objects, which enhances performance for the real-time workflows. Because the Tcl-based workflows assume memberships at group objects, you cannot use the Tcl-based JDBC provisioning workflows in parallel with the JDBC real-time workflows for the same target system instance.</p>
</div>
<div class="paragraph">
<p>The JDBC connector runs in lite mode as much as possible, which means that database meta information is read from the database and therefore must not be explicitly configured.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_connecting_to_jdbc"><a class="anchor" href="#_ch7_connecting_to_jdbc"></a><a class="link" href="#_ch7_connecting_to_jdbc">7.2.8.2. Connecting to JDBC</a></h5>
<div class="paragraph">
<p>To configure the connection to JDBC:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Select the type in the Configuration Page of the JDBC Connected Directory and the corresponding Driver Type. Check the driverâs documentation to determine the URL that is required to connect.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_configuring_the_jdbc_target_system"><a class="anchor" href="#_ch7_configuring_the_jdbc_target_system"></a><a class="link" href="#_ch7_configuring_the_jdbc_target_system">7.2.8.3. Configuring the JDBC Target System</a></h5>
<div class="paragraph">
<p>Memberships are held at the account objects.</p>
</div>
<div class="paragraph">
<p>The default workflow configuration assumes that every provisioned table has an auto-generated primary key. This key cannot be calculated in DirX Identity. It is generated by the database. This key is used as dxrPrimarykey.</p>
</div>
<div class="sect5">
<h6 id="_ch7_attribute_correlation"><a class="anchor" href="#_ch7_attribute_correlation"></a><a class="link" href="#_ch7_attribute_correlation">7.2.8.3.1. Attribute Correlation</a></h6>
<div class="paragraph">
<p>Attributes in the DirX Identity target system belong to the corresponding attributes in the JDBC target system.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 32%;">
<col style="width: 30%;">
<col style="width: 38%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>DirX Identity - Group</strong></th>
<th class="tableblock halign-left valign-top"><strong>JDBC - Group Table</strong></th>
<th class="tableblock halign-left valign-top"><strong>Remark</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cn</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">dxrGroupName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unique name in DirX Identity</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dxrPrimaryKey, dxrName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ID (DB key)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identifiers</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 44%;">
<col style="width: 40%;">
<col style="width: 16%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>DirX Identity - Group</strong></th>
<th class="tableblock halign-left valign-top"><strong>JDBC - Memberships Table</strong></th>
<th class="tableblock halign-left valign-top"><strong>Remark</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dxrPrimaryKey, dxrName of group</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GroupID: DB key of group</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identifiers</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DxrPrimaryKey, dxrName of referenced account</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">AccountID: DB key of account</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identifiers</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 32%;">
<col style="width: 32%;">
<col style="width: 36%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>DirX Identity - Account</strong></th>
<th class="tableblock halign-left valign-top"><strong>JDBC - Accounts Table</strong></th>
<th class="tableblock halign-left valign-top"><strong>Remark</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cn</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DxrAccountName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unique name in DirX Identity</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dxrPrimaryKey, dxrName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ID (DB key)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identifiers</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_jdbc_workflow_and_activities"><a class="anchor" href="#_ch7_jdbc_workflow_and_activities"></a><a class="link" href="#_ch7_jdbc_workflow_and_activities">7.2.8.4. JDBC Workflow and Activities</a></h5>
<div class="paragraph">
<p>The following figure shows the JDBC workflow&#8217;s join activity objects at the Identity Store and connected system sides as well as the related ports and channels and their relationships.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch7_targetWFs/image14.png" alt="JDBC Provisioning Workflow Join Activity" width="Channels and Objects">
</div>
<div class="title">Figure 89. JDBC Provisioning Workflow Join Activity, Channels and Objects</div>
</div>
<div class="paragraph">
<p>As shown in the figure:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The "accounts" channel points to the "member" channel because the accounts keep the memberships.</p>
</li>
<li>
<p>The primary channel construct defines the memberships in the database.</p>
</li>
<li>
<p>The password synchronization workflow uses the password channel.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_jdbc_workflow_ports"><a class="anchor" href="#_ch7_jdbc_workflow_ports"></a><a class="link" href="#_ch7_jdbc_workflow_ports">7.2.8.5. JDBC Workflow Ports</a></h5>
<div class="paragraph">
<p>This section provides information about the JDBC workflow ports.</p>
</div>
<div class="paragraph">
<p>TS Port</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>CF - Crypt Filter</strong><br>
The standard crypt filter for password decryption.</p>
</li>
<li>
<p><strong>JF - JDBC Filter</strong><br>
A JDBC Filter is configured. It is used to transform multi-value membership attributes in Identity to multiple records in the JDBC membership table. As the Filter is a general Filter for handling transformation of multi-value attributes to multiple records, its configuration is independent of the workflows environment.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Configuration:</p>
</div>
<div class="paragraph">
<p>Request:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Member Attribute</strong> - the attribute that holds the target of the membership.<br>
Default: GroupID (because the Accounts table references the Groups table).</p>
</li>
<li>
<p><strong>Member Table</strong> - the table that holds memberships.<br>
Default: Memberships.</p>
</li>
<li>
<p><strong>Member Source Attribute</strong> - the attribute that holds the source of a membership.<br>
Default: AccountID as Accounts reference groups.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Search Response:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Match Type</strong> - the attribute used for matching records corresponding to the same identity object. Here it is accountID, as all memberships belonging to this account have the same accountID.</p>
</li>
<li>
<p><strong>Multivalue Attributes</strong> - the attribute that should be accumulated.<br>
Default: GroupID as all GroupIDs should be stored at the corresponding account.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_jdbc_workflow_channels"><a class="anchor" href="#_ch7_jdbc_workflow_channels"></a><a class="link" href="#_ch7_jdbc_workflow_channels">7.2.8.6. JDBC Workflow Channels</a></h5>
<div class="paragraph">
<p>This section provides information about JDBC workflow channels.</p>
</div>
<div class="sect5">
<h6 id="_ch7_common_aspects_3"><a class="anchor" href="#_ch7_common_aspects_3"></a><a class="link" href="#_ch7_common_aspects_3">7.2.8.6.1. Common Aspects</a></h6>
<div class="paragraph">
<p>Direction: Identity Store &#8594; JDBC</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ID is calculated via <strong>calculateIdInJdbc</strong>. For details, see the Java documentation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Direction: JDBC &#8594; Identity Store</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ID is calculated via <strong>CommonProcsJDBC.calculateIdInIdentity</strong>. It assumes that the specific attributes "accountnameatt" and "groupnameatt" (at the JDBC connected directory) contains the attribute names holding the (unique) account name and (unique) group name attributes.</p>
</li>
<li>
<p><strong>dxrName</strong> is taken from the database ID column.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_membership"><a class="anchor" href="#_ch7_membership"></a><a class="link" href="#_ch7_membership">7.2.8.6.2. Membership</a></h6>
<div class="paragraph">
<p>Direction: Identity Store &#8594; JDBC (TS Account-Group-Membership)</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ID: <strong>"accountId="$\{source.dxrPrimaryKey}",Table=Memberships"</strong></p>
</li>
<li>
<p>Primary Channel account <strong>Join: Memberships.AccountID = ID</strong></p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_setpassword"><a class="anchor" href="#_ch7_setpassword"></a><a class="link" href="#_ch7_setpassword">7.2.8.6.3. SetPassword</a></h6>
<div class="ulist">
<ul>
<li>
<p>Maps the <strong>dxmPassword</strong> to the password column in your account table.</p>
</li>
<li>
<p>A password channel can also be configured backwards from the connected system to Identity to be able to update some attributes in Identity after a password change or reset has taken place in the connected system. The join engine then as usual synchronizes the attributes specified in the corresponding password channel mapping to Identity after the account with its password-relevant attributes has been updated in the connected system.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_customizing_the_jdbc_workflows"><a class="anchor" href="#_ch7_customizing_the_jdbc_workflows"></a><a class="link" href="#_ch7_customizing_the_jdbc_workflows">7.2.8.7. Customizing the JDBC Workflows</a></h5>
<div class="paragraph">
<p>You can customize the JDBC workflows in two ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Adapt the database scheme in relationship to a different table layout</p>
</li>
<li>
<p>Call stored procedures</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="_ch7_adapting_the_database_scheme"><a class="anchor" href="#_ch7_adapting_the_database_scheme"></a><a class="link" href="#_ch7_adapting_the_database_scheme">7.2.8.7.1. Adapting the Database Scheme</a></h6>
<div class="paragraph">
<p>In most cases, your database table(s) will differ from the assumed default tables.</p>
</div>
<div class="paragraph">
<p>Table Names</p>
</div>
<div class="paragraph">
<p>In every mapping where the syntax Tablename.ColumnName is used, change the table name</p>
</div>
<div class="paragraph">
<p>IDMapping &#8594; JDBC:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Change <strong>calculateIdInJdbc</strong><br></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">targetId = CommonProcsJdbc.calculateIdInJdbc(
        sourceEntry,
        joinedEntry,
        env,
        entry_type,
        "Groups",
        "groups-id");</code></pre>
</div>
</div>
</li>
<li>
<p>If your Group Table is named GRP, change to:<br></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">targetId = CommonProcsJdbc.calculateIdInJdbc(
        sourceEntry,
        joinedEntry,
        env,
        entry_type,
        "GRP",
        "GRP-id");</code></pre>
</div>
</div>
</li>
<li>
<p>Change the Export Search base.</p>
</li>
<li>
<p>At the JDBC CD, set the SpecificAttribute membertable to your membertable.</p>
</li>
<li>
<p>At the JDBC filter, adjust the member table.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Column Names</p>
</div>
<div class="paragraph">
<p>You can change the column names directly in every mapping line. If you want to select attribute names from a list, you must edit the JDBC CD attribute configuration.</p>
</div>
<div class="paragraph">
<p>If column names of the columns holding the unique identity attribute (by default, dxrGroupName, dxrAccountName) differs, adjust this in JDBC CD SpecificAttribute accountnameatt / groupnameatt</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If an ID attribute changes:</p>
</li>
<li>
<p>All mappings containing ID</p>
</li>
<li>
<p>Channels &#8594; Id: dxrName/dxrPrimaryKey/dxrPrimaryKeyOld: Javamapping sourceAttrName = "ID";</p>
</li>
<li>
<p>Account-group-membership channel: join condition Primary</p>
</li>
<li>
<p>If accountID/groupID changes in membership table:</p>
</li>
<li>
<p>JDBC filter configuration</p>
</li>
<li>
<p>Adjust Specific attribute memberatt/ membersourceatt at JDBC connected directory</p>
</li>
<li>
<p>ID Mapping &#8594; JDBC account-group-membership</p>
</li>
<li>
<p>Primary Channel join secondary account-group-membership</p>
</li>
<li>
<p>Join in account-group-membership channel</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Primary Key is not an Auto Key</p>
</div>
<div class="paragraph">
<p>This is not possible in pure lite mode. Define instead the primary keys (in TS port):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;jdbc-connection always-follow-references="false"&gt;
    &lt;abbreviation name="account-id"&gt;Accounts.ID&lt;/abbreviation&gt;
    &lt;abbreviation name="group-id"&gt;Groups.ID&lt;/abbreviation&gt;
    &lt;abbreviation name="membership-id"&gt;Memberships.ID&lt;/abbreviation&gt;
    &lt;tables-and-views&gt;
        &lt;table primary-keys="account-id"&gt;
            &lt;name&gt;Accounts&lt;/name&gt;
        &lt;/table&gt;
        &lt;table primary-keys="group-id"&gt;
            &lt;name&gt;Groups&lt;/name&gt;
        &lt;/table&gt;
        &lt;table primary-keys="membership-id"&gt;
            &lt;name&gt;Memberships&lt;/name&gt;
        &lt;/table&gt;
    &lt;/tables-and-views&gt;
&lt;/jdbc-connection&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here a separate ID column in the membership table is assumed. Itâs also possible account-id and group-id defines the key. In this case the definition of the membership table and the corresponding abbreviation is not needed.</p>
</div>
<div class="paragraph">
<p>Use the defined abbreviation for id column in ID mapping</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">targetId = CommonProcsJdbc.calculateIdInJdbc(
        sourceEntry,
        joinedEntry,
        env,
        entry_type,
        "Accounts",
        "account-id",false);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Use CommonProcsJdbc.calculateIdInJdbc with argument autogeneratedkey=false.</p>
</div>
<div class="paragraph">
<p>Use the defined abbreviation in members channel as the primary value in Primary Channel join condition.</p>
</div>
<div class="paragraph">
<p>Use the defined abbreviation in join condition</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">&lt;join&gt;
    &lt;searchBasetype="urn:oasis:names:tc:SPML:1:0#DN"&gt;
        &lt;spml:id&gt;"accountid="+${source.dxrPrimaryKey}+",Table=Accounts"&lt;/spml:id&gt;
    &lt;/searchBase&gt;
&lt;/join&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Use the defined abbreviations in Primarykey(old) and DxrName Java mapping at Identity side.</p>
</div>
<div class="paragraph">
<p>Change the object description to generate a unique key for dxrPrimaryKey.</p>
</div>
<div class="paragraph">
<p>Use a Column to specify the Account State</p>
</div>
<div class="paragraph">
<p>To configure a column representing the account state in your account table insert a new line at the JDBC connected directory propertypage <strong>Specific Attributes</strong>. As name enter <strong>accountstateatt</strong>. Fill in the column name as value. The default <strong>dxrTSState</strong> Mapping for the account uses this column to set the <strong>dxrTSState</strong> if the configured column exists. Only the values <strong>ENABLED</strong> and <strong>DELETED</strong> are allowed. If your column contains other values, you must map your values to these allowed values. To do this edit the dxrTSState mapping at the account channel.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_calling_stored_procedures"><a class="anchor" href="#_ch7_calling_stored_procedures"></a><a class="link" href="#_ch7_calling_stored_procedures">7.2.8.7.2. Calling Stored Procedures</a></h6>
<div class="paragraph">
<p>Under the default JDBC TS port, you will find an example for a stored procedure definition.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!-- a procedure with 2 in params returning an int --&gt;
&lt;function name="changePassword"&gt;
    &lt;return&gt;
        &lt;range exact="0" category="OK"/&gt;
    &lt;/return&gt;
    &lt;argument name="ID" in-out="IN" dataType="INTEGER" /&gt;
    &lt;argument name="pw" in-out="IN" dataType="VARCHAR" /&gt;
&lt;/function&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The sample represents a SQL server stored procedure returning 0 on success. It takes two parameters: the ID that identifies the record and the password that should be set.</p>
</div>
<div class="paragraph">
<p>To call this stored procedure, an extended request is necessary. This request may be called in the postmapping or in a user hook. Building the extended request in the postmapping means that it is called after a normal request.</p>
</div>
<div class="paragraph">
<p>Call via postmapping:</p>
</div>
<div class="paragraph">
<p>In the default setPassword channel, you will find an example (in comments):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">logger.debug("SP postmapping called");
HashMap&lt;String,DsmlAttr&gt; sourceAttrs = source.getAttrs();
if (sourceAttrs == null)
    return mappedEntry;

// the Stored Procedure +
String theSP = "changePassword";

ExtendedRequest extReq = new ExtendedRequest();
mappedEntry.addExtendedRequest(extReq); // append the SP call as extended request
extReq.setRequestID("SPCall");
OperationIdentifier opId = new OperationIdentifier();
opId.setOperationID(theSP); // name of SP +
opId.setOperationIDType(OperationIdentifierOperationIDTypeType.GENERICSTRING);
extReq.setOperationIdentifier(opId);
ProviderIdentifier provId = new ProviderIdentifier();
provId.setProviderID("SP"); // SP for Stored procedure
provId.setProviderIDType(ProviderIdentifierProviderIDTypeType.URN);
extReq.setProviderIdentifier(provId);

// assume two parameter, the ID the password pw +
// first ID from source ??later also from mappedEntry +
// only the first element of attArr is computed by the connector +
Attributes[] attArr = new Attributes[1];
DsmlAttr pkey =sourceAttrs.get("dxrprimarykey");
DsmlAttr id = new DsmlAttr();
id.setName("ID");
id.addDsmlValue(pkey.getDsmlValue(0));
Attributes atts = new Attributes();
atts.addAttr(id);
logger.debug("SP argument ID: "+pkey.getDsmlValue(0).toString());

// second Password from mapped pw attr
DsmlModification[] mod = mappedEntry.getModification("pw");
if (mod.length &gt; 0) {
    // take first
    DsmlAttr pw = new DsmlAttr();
    pw.setName("pw");
    pw.addDsmlValue(mod[0].getDsmlValue(0));
    atts.addAttr(pw);
    logger.debug("SP argument pw: "+pw.getDsmlValue(0).toString());
}
attArr[0] = atts;
extReq.setAttributes(attArr);
// only extended Request to be processed
mappedEntry.setRequestType(Request.Type.NONE);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here the first argument ID is taken from the source attribute dxrprimarykey.</p>
</div>
<div class="paragraph">
<p>The second argument is taken from the mapped entry. This example shows that you can do some complicated mapping and take the result as an argument. Keep in mind that for mapped attributes, modifications will be generated. If you do not want the password to be set twice (by generated modification an by stored procedure) you can use the attribute flag <strong>Readonly</strong> to prevent it. In this sample, the <strong>RequestType</strong> is set to <strong>NONE</strong> at the end, which means that only the stored procedure is called and other generated modifications are ignored. Normally you do not intend to do this, so all generated modifications are made (for example, the description has changed) and afterwards the stored procedure is called to set the password column.</p>
</div>
<div class="paragraph">
<p>In the <strong>com.siemens.dxm.join.userhook.jdbc.UserHookAccountsTo</strong> user hook, you will find an example of how to call a stored procedure in a user hook.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">/**
* Call an SP via extended request
*
* Can also be done in postMapping or another user hook
* @see com.siemens.dxm.join.api.IUserHookExt#preUpdate(siemens.dxm.connector.DxmRequestor, siemens.dxm.connector.DxmRequestor, siemens.dxm.connector.spml.Identifier, java.util.HashMap, com.siemens.dxm.join.map.MappedEntry, siemens.dxm.connector.spml.Identifier, java.util.HashMap)
*/
public boolean preUpdate(DxmRequestor srcConn, DxmRequestor tgtConn, Identifier sourceId, HashMap&lt;String,DsmlAttr&gt; sourceAttrs, MappedEntry mappedEntry, Identifier joinedId, HashMap&lt;String,DsmlAttr&gt; joinedAttrs) {

// the Stored Procedure
String theSP = "changePassword";

ExtendedRequest extReq = new ExtendedRequest();
extReq.setRequestID("SPCall4SetPassword");
OperationIdentifier opId = new OperationIdentifier();
opId.setOperationID(theSP); // name of SP
opId.setOperationIDType(OperationIdentifierOperationIDTypeType.GENERICSTRING);
extReq.setOperationIdentifier(opId);
ProviderIdentifier provId = new ProviderIdentifier();
provId.setProviderID("SP"); // SP for Stored procedure
provId.setProviderIDType(ProviderIdentifierProviderIDTypeType.URN);
extReq.setProviderIdentifier(provId);

// we have two parameters, the ID and the password pw
// first take ID from source attributes
// only the first att is computed by the connector
Attributes[] attArr = new Attributes[1];
DsmlAttr pkey =sourceAttrs.get("dxrprimarykey");
DsmlAttr id = new DsmlAttr();
id.setName("ID");
id.addDsmlValue(pkey.getDsmlValue(0));
Attributes atts = new Attributes();
atts.addAttr(id);

logger.debug("SP argument ID: " + pkey.getDsmlValue(0).toString());

// second parameter Password from mapped pw attribute
DsmlModification[] mod = mappedEntry.getModification("pw");
if (mod.length &gt; 0) {
    // take first
    DsmlAttr pw = new DsmlAttr();
    pw.setName("pw");
    pw.addDsmlValue(mod[0].getDsmlValue(0));
    atts.addAttr(pw);

    logger.debug("SP argument pw: "+pw.getDsmlValue(0).toString());
}
attArr[0] = atts; // IN and IN_OUT parameters
extReq.setAttributes(attArr);

if (tgtConn instanceof DxmConnectorExtended) {
    // call extended Connector
    DxmConnectorExtended theConnector = (DxmConnectorExtended)tgtConn;
    try {
        ExtendedResponse rsp = theConnector.extendedRequest(extReq);
    } catch (DxmConnectorException e) {
        logger.error("SP Call failed: ",e);
    }
}
// process extended request only
// ignore other modifications to avoid a 2nd modification of the mapped pw
mappedEntry.setRequestType(Request.Type.NONE);

return true;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>What&#8217;s the difference?</p>
</div>
<div class="paragraph">
<p>In a user hook, you must call the connectorâs extendedRequest method explicitly. In postmapping, you just build the extendedRequest and add it to the mapped entry:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">mappedEntry.addExtendedRequest(extReq); // append th SP call as extended request</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>General Notes:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Always set "SP" as providerId</p>
</li>
<li>
<p>Attributes Array always has size 1. Every argument is an element of this one and is the only array element.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Function or Procedure?</p>
</div>
<div class="paragraph">
<p>The definition of a stored procedure may depend on the database system. For the JDBC connector definition, a function is defined if it returns a value. If no value is returned, it is a procedure.</p>
</div>
<div class="paragraph">
<p>Here is a Microsoft SQL Server 2005 stored procedure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">ALTER PROCEDURE [dbo].[changePassword]
    -- parameters for the stored procedure
    @userId int,
    @pw varchar(50)</code></pre>
</div>
</div>
<div class="paragraph">
<p>This stored procedure returns an int, which means you must configure this procedure as a function:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;function name="changePassword"&gt;
    &lt;return&gt;
        &lt;range exact="0"/&gt;
    &lt;/return&gt;
    &lt;argument name="ID" in-out="IN" dataType="INTEGER" /&gt;
    &lt;argument name="pw" in-out="IN" dataType="VARCHAR" /&gt;
&lt;/function&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In Oracle, a stored procedure does not return a value, which means you must configure a procedure. But for a procedure, you must specify the "return" argument because the connector needs an indicator for the outcome of the procedure. Therefore, you cannot use a procedure with the same arguments in Oracle. You must wrap the procedure to get an "out" argument for return:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;procedure name="changePw"&gt;
    &lt;return name="dummy"&gt;
        &lt;range exact="0"/&gt;
    &lt;/return&gt;
    &lt;argument name="ID" in-out="IN" dataType="INTEGER" /&gt;
    &lt;argument name="pw" in-out="IN" dataType="VARCHAR" /&gt;
    &lt;argument name="dummy" in-out="OUT" dataType="INTEGER" /&gt;
&lt;/procedure&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch7_ldap_workflows"><a class="anchor" href="#_ch7_ldap_workflows"></a><a class="link" href="#_ch7_ldap_workflows">7.2.9. LDAP Workflows</a></h4>
<div class="paragraph">
<p>The LDAP Provisioning workflows operate between a target system of type "LDAP" in the Identity Store and the corresponding connected LDAP Directory system.</p>
</div>
<div class="paragraph">
<p>The LDAP connector used in the workflows communicates with the LDAP server across the native LDAP protocol, as shown in the following figure.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch7_targetWFs/image15.png" alt="LDAP Workflow Architecture">
</div>
<div class="title">Figure 90. LDAP Workflow Architecture</div>
</div>
<div class="paragraph">
<p>The workflows allow you to synchronize Identity account and group objects with LDAP Directory users and group objects.</p>
</div>
<div class="sect4">
<h5 id="_ch7_ldap_workflow_prerequisites_and_limitations"><a class="anchor" href="#_ch7_ldap_workflow_prerequisites_and_limitations"></a><a class="link" href="#_ch7_ldap_workflow_prerequisites_and_limitations">7.2.9.1. LDAP Workflow Prerequisites and Limitations</a></h5>
<div class="paragraph">
<p>The LDAP workflows currently have no prerequisites or limitations.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_configuring_the_connection_to_ldap"><a class="anchor" href="#_ch7_configuring_the_connection_to_ldap"></a><a class="link" href="#_ch7_configuring_the_connection_to_ldap">7.2.9.2. Configuring the Connection to LDAP</a></h5>
<div class="paragraph">
<p>This section provides information about LDAP target system configuration.</p>
</div>
<div class="paragraph">
<p>Connection to the target system:</p>
</div>
<div class="paragraph">
<p>Specify the IP address, the data port, and the secure port at the LDAP service object (LDAP CD &#8594; Service). The IP address may contain the server name - fully-qualified or not - or a TCP/IP address.</p>
</div>
<div class="paragraph">
<p>In the Bind Profile (LDAP CD &#8594; Bind Profile), specify a user in DN format.</p>
</div>
<div class="paragraph">
<p>For SSL/TLS, fill the following fields:</p>
</div>
<div class="paragraph">
<p><strong>SSL Connection</strong> - check it for SSL connections, whether server or client authentication.</p>
</div>
<div class="paragraph">
<p><strong>Client Authentication</strong> - check if if you want to use client-side SSL.</p>
</div>
<div class="paragraph">
<p><strong>Path to Key Store File</strong> - the file name of the file-based keystore containing the certificate/private key pair and the relevant CA certificates for this client certificate.</p>
</div>
<div class="paragraph">
<p><strong>Key Store Password</strong> - the password for accessing the key store.</p>
</div>
<div class="paragraph">
<p><strong>Key Store Alias</strong> - the alias name of the keystore entry (optional).</p>
</div>
<div class="paragraph">
<p><strong>Path to Trust Store File</strong> - the file name of the file-based truststore containing the LDAP server CA certificate.</p>
</div>
<div class="paragraph">
<p><strong>Trust Store Password</strong> - the password for accessing the truststore.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_configuring_the_ldap_target_system"><a class="anchor" href="#_ch7_configuring_the_ldap_target_system"></a><a class="link" href="#_ch7_configuring_the_ldap_target_system">7.2.9.3. Configuring the LDAP Target System</a></h5>
<div class="paragraph">
<p>Pay attention to the following attributes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The attribute <strong>dxrPrimaryKey</strong> of accounts and groups contains the object&#8217;s target system DN. It is also used as the member attribute of groups. On account creation, it is generated by the <strong>tsaccount.xml</strong> object description using the connected directory-specific attributes <strong>account base</strong> and <strong>group base</strong>.</p>
</li>
<li>
<p>The attribute <strong>dxrName</strong> of accounts and groups contain the <strong>dxrPrimaryKey</strong> value. It is used for joining in Identity direction.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_ldap_workflow_and_activities"><a class="anchor" href="#_ch7_ldap_workflow_and_activities"></a><a class="link" href="#_ch7_ldap_workflow_and_activities">7.2.9.4. LDAP Workflow and Activities</a></h5>
<div class="paragraph">
<p>The following figure shows the layout of the channels that are used by the join activity.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch7_targetWFs/image16.png" alt="LDAP Workflow Channels">
</div>
<div class="title">Figure 91. LDAP Workflow Channels</div>
</div>
<div class="paragraph">
<p>As the figure shows, there is a pair of channels between accounts, groups and members on each side. The members are linked to the groups on both sides.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_ldap_workflow_ports"><a class="anchor" href="#_ch7_ldap_workflow_ports"></a><a class="link" href="#_ch7_ldap_workflow_ports">7.2.9.5. LDAP Workflow Ports</a></h5>
<div class="paragraph">
<p>This section describes LDAP workflow ports.</p>
</div>
<div class="paragraph">
<p>TS Port</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>CF - Crypt Filter</strong><br>
The configured Crypt Filter is used to send the password attribute userPassword decrypted to the LDAP server.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_ldap_workflow_channels"><a class="anchor" href="#_ch7_ldap_workflow_channels"></a><a class="link" href="#_ch7_ldap_workflow_channels">7.2.9.6. LDAP Workflow Channels</a></h5>
<div class="paragraph">
<p>This section provides information about LDAP workflow channels.</p>
</div>
<div class="sect5">
<h6 id="_ch7_account_and_group_channels_in_both_directions"><a class="anchor" href="#_ch7_account_and_group_channels_in_both_directions"></a><a class="link" href="#_ch7_account_and_group_channels_in_both_directions">7.2.9.6.1. Account and Group Channels in both Directions</a></h6>
<div class="paragraph">
<p>Master attributes:</p>
</div>
<div class="paragraph">
<p>Most attributes (except, for example, the dxrTSState attribute) are mastered by DirX Identity. Consequently, these attributes have the <strong>OnAddOnly</strong> flag in the mapping direction to Identity. This is particularly true for the Identifier, which is also mastered by DirX Identity in the default real-time synchronization workflow. In the target system direction, it is calculated by DirX Identity in the dxrPrimaryKey attribute and results in moving the object in the target system if dxrPrimaryKey changed. In the DirX Identity direction, the Identifier is calculated only on an add operation, otherwise the joined object&#8217;s Identifier is taken.</p>
</div>
<div class="paragraph">
<p>Moving account objects:</p>
</div>
<div class="paragraph">
<p>The default LDAP real-time synchronization workflow can perform a rename/move of accounts in the LDAP target system. It operates in the following way:</p>
</div>
<div class="paragraph">
<p>If the <strong>dxrPrimaryKey</strong> attribute of the account is changed in DirX Identity (as a result of a user resolution and new calculation of the account attributes, which can have <strong>dependsOn</strong> or <strong>masteredBy</strong> settings in the account&#8217;s object description), the workflow performs the following actions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It takes this as the new DN in LDAP.</p>
</li>
<li>
<p>It tries to find (join) the account with the configured join attributes (trying one after the other).</p>
</li>
<li>
<p>One of the join attributes is the employeeNumber, which shouldn&#8217;t change on user resolution in Identity.</p>
</li>
<li>
<p>When it finds the account in LDAP, it takes this DN is as the old DN and renames/removes the account from this old DN to the new DN.</p>
</li>
<li>
<p>On the way back, it puts the actual LDAP DN into the dxrPrimaryKey and dxrPrimaryKeyOld attributes in DirX Identity.</p>
</li>
<li>
<p>The dxrPrimaryKeyOld (as described above) is not taken for sync to TS but for other purposes.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Changing the account state holding the attribute employeeType:</p>
</div>
<div class="paragraph">
<p>If you want to use another attribute for holding the account state than <strong>employeeType</strong> you must do the following mapping adaptions in the account channel:</p>
</div>
<div class="paragraph">
<p>Direction Identity &#8594; Connected System</p>
</div>
<div class="paragraph">
<p>Just change the java mapping line with <strong>employeeType</strong> on the right side by exchanging <strong>employeeType</strong> with another attribute name. The content of the Java coding on the left side has not to be changed because it references now the term <strong>tgtAttrname</strong> instead of hard coded <strong>employeeType</strong>. The Java class name is just changed to the new attribute name if the mapping is saved.</p>
</div>
<div class="paragraph">
<p>Direction Connected System &#8594; Identity</p>
</div>
<div class="paragraph">
<p>Adapt the Java mapping to the target attribute <strong>dxrTSState</strong> and exchange <strong>employeeType</strong> in the line<br>
<code><strong>CommonProcsLdap.setAccountStateAttr("employeeType");</strong></code><br>
by the new attribute name.</p>
</div>
<div class="paragraph">
<p>PostMapping:</p>
</div>
<div class="paragraph">
<p>A postMapping exists only for the group channel in the target system direction. It is used for changing the request type to <strong>DELETE</strong> if the dxrState attribute in Identity contains the value <strong>DELETED</strong>, which results in deleting the object in the target system.</p>
</div>
<div class="paragraph">
<p>For accounts deletion of objects in the target system is handled in the Java mapping to the account state holding attribute, which is by default <strong>employeeType</strong>.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_password_channel_3"><a class="anchor" href="#_ch7_password_channel_3"></a><a class="link" href="#_ch7_password_channel_3">7.2.9.6.2. Password Channel</a></h6>
<div class="paragraph">
<p>The target system&#8217;s password attribute <strong>userPassword</strong> is updated with the current password of the account in DirX Identity and the pwdReset attribute, which determines whether or not the password must be changed on the next login by the user, is set depending on the source attribute <strong>dxmPasswordExpired</strong>. This attribute was previously set by the User or Account Password Event Manager workflow listening for requests from Identity Web Center or Password Listener.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_case_sensitive_rename"><a class="anchor" href="#_ch7_case_sensitive_rename"></a><a class="link" href="#_ch7_case_sensitive_rename">7.2.9.6.3. Case-Sensitive Rename</a></h6>
<div class="paragraph">
<p>If you want to enable case-sensitive renames like ou=RedFlag &#8594; ou=Redflag, you need to set the operational attribute <strong>caseExactRDNComparison</strong> to <strong>true</strong> in the generated request. Use the Op. Mapping tab of your channel get this into the workflow:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;mappingDefinition&gt;
    &lt;operationalAttrMapping mappingType="constant" name="caseExactRDNComparison"&gt;
        &lt;value&gt;true&lt;/value&gt;
    &lt;/operationalAttrMapping&gt;
&lt;/mappingDefinition&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_ldap_delta_workflows"><a class="anchor" href="#_ch7_ldap_delta_workflows"></a><a class="link" href="#_ch7_ldap_delta_workflows">7.2.9.7. LDAP Delta Workflows</a></h5>
<div class="paragraph">
<p>For a general explanation of the delta workflows, see the sections under "Java-based Workflow Architecture" in "Understanding the Default Application Workflows" in this guide.</p>
</div>
<div class="paragraph">
<p>The default LDAP delta workflow <strong>LDAP_Ident_Realtime_Delta</strong> (as the workflow name already implies) synchronizes deltas from an LDAP connected system to the Identity Store both for accounts and groups. You can verify this function by looking at the <strong>deltaSyncOneWay2Identity</strong> controller used by the workflow. The delta definitions given in the Delta tab for the LDAP connected directory&#8217;s channels apply (Connectivity Configuration Data &#8594; Connected Directories &#8594; Target Scheduled &#8594; LDAP &#8594; Channels).</p>
</div>
<div class="paragraph">
<p>Delta synchronization for the LDAP connected directories is based on time stamps: specifically, the LDAP attributes <strong>createTimeStamp</strong> and <strong>modifyTimeStamp</strong>. In the Delta tab, <strong>Delta</strong> <strong>Type</strong> is set to <strong>SearchAttributes</strong> and the two LDAP attributes are listed, and in <strong>Sort</strong> <strong>Type</strong>, the value <strong>String</strong> is selected.</p>
</div>
<div class="paragraph">
<p>When searching for deltas, the (configured) export search filter is extended and entries whose <strong>createTimeStamp</strong> or <strong>modifyTimeStamp</strong> attributes are set to a value that is more recent than (or equal to) the time stamp of the previous workflow run will be searched. For the first run, the (configured) export filter is not changed because there is no time stamp available for comparison.</p>
</div>
<div class="paragraph">
<p>When evaluating the search result, the most recent time stamp is retained as delta information and is stored in the Identity domain for each channel. This time stamp is subsequently used when the workflow is next activated (either in the DirX Identity Manager or by schedule).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The Delta tab of the corresponding channels (that is, the Identity Store channels) hold delta definitions, too. These definitions apply if you have defined a delta workflow for synchronization from the Identity Store to the LDAP connected system.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch7_ibm_notes_workflows"><a class="anchor" href="#_ch7_ibm_notes_workflows"></a><a class="link" href="#_ch7_ibm_notes_workflows">7.2.10. IBM Notes Workflows</a></h4>
<div class="paragraph">
<p>The IBM Notes (formerly Lotus Notes) Provisioning workflow synchronizes data between an IBM Notes target system within the Identity Store and an IBM Domino server. The following figure shows the deployment.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch7_targetWFs/image17.png" alt="IBM Notes Workflows Architecture">
</div>
<div class="title">Figure 92. IBM Notes Workflows Architecture</div>
</div>
<div class="paragraph">
<p>The join engine running in the Java-based Server needs to send and retrieve data from a Domino server. The Notes API that is used for accessing the Notes address book is a C/C interface. Therefore, the Notes Provisioning workflow provides an SPML/SOAP connector that enables the join engine to exchange SPML requests and responses with the C-based Server. The SPML/SOAP-service running in the C-based Server exchanges the SPML requests and responses with the Notes connector, which finally interacts with the Domino server using the Notes C/C-API.</p>
</div>
<div class="paragraph">
<p>The Notes Provisioning workflow allows you to synchronize accounts and groups with Notes users and groups in the Notes address book.</p>
</div>
<div class="sect4">
<h5 id="_ch7_notes_workflow_prerequisites_and_limitations"><a class="anchor" href="#_ch7_notes_workflow_prerequisites_and_limitations"></a><a class="link" href="#_ch7_notes_workflow_prerequisites_and_limitations">7.2.10.1. Notes Workflow Prerequisites and Limitations</a></h5>
<div class="paragraph">
<p>The Notes Provisioning workflow has the following prerequisites and limitations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The workflow requires the version of Notes C/C++-API V 7.0.2 or newer.</p>
</li>
<li>
<p>Before you can use the workflow, you must extend the DirX Identity Store schema with Notes target system-specific attributes and object classes so that the workflows can store Notes-specific information in the Identity Store. For instructions, see the section "Extending the Schema for the Target System Workflows".</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_configuring_the_notes_workflow"><a class="anchor" href="#_ch7_configuring_the_notes_workflow"></a><a class="link" href="#_ch7_configuring_the_notes_workflow">7.2.10.2. Configuring the Notes Workflow</a></h5>
<div class="paragraph">
<p>Configuring a Notes Provisioning workflow consists of the following steps:</p>
</div>
<div class="paragraph">
<p>Configuring the Notes Connector (running in the C++-based Server)</p>
</div>
<div class="paragraph">
<p>In Identity Manager, log in to Connectivity, go to the <strong>Expert</strong> <strong>View</strong>, and set the <strong>Is Active</strong> flag in</p>
</div>
<div class="paragraph">
<p><strong>Connectivity Configuration Data</strong> &#8594; <strong>Configuration</strong> &#8594; <strong>DirX Identity Servers</strong> &#8594; <strong>C Servers</strong> &#8594; <em>server_name</em> &#8594; <em>Notes_Connector_name</em></p>
</div>
<div class="paragraph">
<p>Verify the attributes of the C++-based Server (in <strong>ConSvr SOAP Listener</strong> and <strong>ConSvr SOAP Receiver</strong> tab) in</p>
</div>
<div class="paragraph">
<p><strong>Connectivity Configuration Data</strong> &#8594; <strong>Configuration</strong> &#8594; <strong>DirX Identity Servers</strong> &#8594; <strong>C Servers</strong> &#8594; <em>server_name</em></p>
</div>
<div class="paragraph">
<p>Configuring the Notes Service</p>
</div>
<div class="paragraph">
<p>Assign the Notes server name in the following (Notes-specific) format:</p>
</div>
<div class="paragraph">
<p><strong>CN=</strong><em>server_name</em><strong>/O=</strong><em>org_name</em><strong>[/&#8230;&#8203;]</strong></p>
</div>
<div class="paragraph">
<p>Make sure that the attribute types in the server name (for example, CN, O, OU) are specified in uppercase letters.</p>
</div>
<div class="exampleblock">
<div class="title">Example 1. Notes server name format</div>
<div class="content">
<strong>CN=my-server/O=my-organization</strong>
</div>
</div>
<div class="paragraph">
<p>Configuring the Connected Directory</p>
</div>
<div class="paragraph">
<p>Assign the <strong>Addr(ess) Book</strong> field.</p>
</div>
<div class="paragraph">
<p>In the <strong>Provisioning</strong> tab, check the fields</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Account Base</strong> and <strong>Group Base</strong> in "in Identity" property page.</p>
</li>
<li>
<p><strong>user Base</strong> and <strong>Group Base</strong> in "in Target System" property page.</p>
</li>
<li>
<p><strong>Admin Request Database</strong>, <strong>Admin Request Author</strong>, <strong>Group Member Limit</strong> and <strong>Unique Org Unit Attr</strong> in "Notes specific" property page. For details see the section "Static Configuration" in the <em>DirX Identity Connectivity Reference</em>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Configuring the Bind Profiles</p>
</div>
<div class="paragraph">
<p>At least two bind profiles are required: one for the Notes administrator (Admin) and another one for registering, moving or renaming users (Certifier).</p>
</div>
<div class="paragraph">
<p>Others may be required when moving Notes users to different organizations or organizational units. (one per organization or organizational unit)</p>
</div>
<div class="paragraph">
<p>Note that the <strong>User</strong> field of the bind profile is used as the file name of the appropriate Notes ID file. Furthermore, make sure that the file name exactly matches the file in the Notes profile when used as âPathFileCertIdâ.</p>
</div>
<div class="paragraph">
<p>For details, see the section âStatic Configurationâ in the <em>DirX Identity Connectivity Reference</em>.</p>
</div>
<div class="paragraph">
<p>Configuring the Organizational Specific Profiles</p>
</div>
<div class="paragraph">
<p>For registration of users or moving users in the Notes address book, the Notes APIs need several attributes. For details, see the topic âNotes Connectorâ in the <em>DirX Identity Connectivity Reference</em>.</p>
</div>
<div class="paragraph">
<p>Profiles are used for storing Notes-relevant attributes per organizational unit in order to avoid storing each attribute in the account separately. The profiles are located in</p>
</div>
<div class="paragraph">
<p><em>domain_root</em> &#8594; <strong>TargetSystems</strong> &#8594; <em>Targetsystem_name</em> &#8594; <strong>configurations</strong> &#8594; <strong>profiles</strong></p>
</div>
<div class="paragraph">
<p>At least one default profile must exist. Itâs used when no organizational unit specific one is available.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_configuring_the_notes_target_system"><a class="anchor" href="#_ch7_configuring_the_notes_target_system"></a><a class="link" href="#_ch7_configuring_the_notes_target_system">7.2.10.3. Configuring the Notes Target System</a></h5>
<div class="paragraph">
<p>To support Notes groups and accounts in Identity Store, the service layer makes use of object descriptions and Java scripts that are located in</p>
</div>
<div class="paragraph">
<p><em>domain_root</em> &#8594; <strong>TargetSystems</strong> &#8594; <strong>Notes</strong> &#8594; <strong>ObjectDescriptions</strong></p>
</div>
<div class="paragraph">
<p><em>domain_root</em> &#8594; <strong>TargetSystems</strong> &#8594; <strong>Notes</strong> &#8594; <strong>JavaScripts</strong></p>
</div>
<div class="paragraph">
<p>The following object descriptions are provided:</p>
</div>
<div class="paragraph">
<p><strong>Group.xml</strong> - for creation of Notes groups in the Identity Store</p>
</div>
<div class="paragraph">
<p><strong>Profile.xml</strong> - for creation of profile objects (profiles) in the Identity Store</p>
</div>
<div class="paragraph">
<p><strong>TS.xml</strong> - for creation of a Notes target system in the Identity Store</p>
</div>
<div class="paragraph">
<p><strong>TSAccount.xml</strong> - for creation of Notes accounts in the Identity Store</p>
</div>
<div class="paragraph">
<p>The following Java scripts (called when processing the object descriptions) are also provided:</p>
</div>
<div class="paragraph">
<p><strong>mail.js</strong> - for creation of the mail attribute</p>
</div>
<div class="paragraph">
<p><strong>ProfileFromOU.js</strong> - for creation of the dxrProfileLink attribute</p>
</div>
<div class="paragraph">
<p><strong>UniqueNameForAccounts.js</strong> - for creation of the dxrPrimaryKey attribute for accounts (which represents the attribute FullName in Notes)</p>
</div>
<div class="paragraph">
<p><strong>UniqueNameForGroups.js</strong> - for creation of the dxrPrimaryKey attribute for groups (which represents the attribute ListName in Notes)</p>
</div>
<div class="paragraph">
<p>The following section describes these object descriptions in detail.</p>
</div>
<div class="paragraph">
<p>Object Descriptions</p>
</div>
<div class="paragraph">
<p>This section provides detailed information about object descriptions.</p>
</div>
<div class="paragraph">
<p>Group.xml</p>
</div>
<div class="paragraph">
<p>The object description is used for creation of a Notes group in the Identity Store.</p>
</div>
<div class="paragraph">
<p>Profile.xml</p>
</div>
<div class="paragraph">
<p>The Notes APIs need several attributes for registration of users or moving users in the Notes address book. For details, please refer to the section Notes Connectorâ in the <em>DirX Identity Connectivity Reference</em>.</p>
</div>
<div class="paragraph">
<p>Profiles are used for storing Notes-relevant attributes per organizational unit in order to avoid storing each attribute in the account separately. The profiles are located in</p>
</div>
<div class="paragraph">
<p><em>domain_root</em> &#8594; <strong>TargetSystems</strong> &#8594; <em>Targetsystem_name</em> &#8594; <strong>configurations</strong> &#8594; <strong>profiles</strong></p>
</div>
<div class="paragraph">
<p>At least one default profile must exist. It is used when no organizational unit specific one is available.</p>
</div>
<div class="paragraph">
<p>The available attributes from the Notes profile objects are:</p>
</div>
<div class="paragraph">
<p><strong>Control parameters:</strong><br>
CreateIdFile<br>
CreateMailDatabase<br>
CreateMailDBNow<br>
CreateNorthAmericanId<br>
SaveIdInAddressBook<br>
SaveIdInFile<br>
SaveInternetPassword<br>
DeleteMailFile</p>
</div>
<div class="paragraph">
<p>Other attributes:<br>
CertifierStructure (will be passed as TargetCertifier to the Notes Connector)<br>
ClientType<br>
DbQuotaSizeLimit<br>
DbQuotaWarningThreshold</p>
</div>
<div class="paragraph">
<p>DefaultMailServer (will normally be mapped to the attribute MailServer)</p>
</div>
<div class="paragraph">
<p>LocalAdmin<br>
MailACLManager<br>
MailForwardAddress<br>
MailOwnerAccess</p>
</div>
<div class="paragraph">
<p>MailServer<br>
MailSystem<br>
MailTemplate<br>
MinPasswordLength</p>
</div>
<div class="paragraph">
<p>OtherMailServers<br>
PathFileCertId<br>
PathFileCertLog<br>
PathUserId<br>
RegistrationServer<br>
Validity</p>
</div>
<div class="paragraph">
<p>TS.xml</p>
</div>
<div class="paragraph">
<p>The object description is used for creation of a Notes target system in the Identity Store.</p>
</div>
<div class="paragraph">
<p>TSAccount.xml</p>
</div>
<div class="paragraph">
<p>The object description is used for creation of a Notes account in the Identity Store. New accounts inherit many attributes from the user. (for example, description, ou, and so on). The following attributes are explicitly set by the object description and hold the following default values:</p>
</div>
<div class="paragraph">
<p><strong>dxmLNcreateInAddressBook=true<br>
dxmLNregisterUser=true<br>
dxmLNuserRegistered=false<br>
dxmLNuserInAddressBook=false</strong></p>
</div>
<div class="paragraph">
<p>There are a few attributes that depend on others:</p>
</div>
<div class="paragraph">
<p><strong>dxrProfilesLink</strong> depends on <strong>ou<br>
dxrPrimaryKey</strong> depends on <strong>dxrProfileLink<br>
dxmLNuniqueOrgUnit</strong> depends on <strong>dxrPrimaryKey<br>
mail</strong> depends on <strong>dxmLNshortName</strong></p>
</div>
<div class="paragraph">
<p>Keep in mind that <strong>dxrProfileLink</strong> is only set for new objects (see description of <strong>ProfileFromOU.js</strong>) and therefore all the other attributes are only created and never changed.</p>
</div>
<div class="paragraph">
<p>Java Scripts</p>
</div>
<div class="paragraph">
<p>This section provides detailed information about Java scripts.</p>
</div>
<div class="paragraph">
<p>Mail.js</p>
</div>
<div class="paragraph">
<p>In the object description <strong>TSAccount.xml</strong>, the Java script <strong>mail.js</strong> is called to generate the mail attribute of the account. The value is calculated whenever the attribute <strong>dxmLNshortName</strong> changes or is created for the first time.</p>
</div>
<div class="paragraph">
<p>The script checks whether the account object holds the attribute <strong>dxrProfileLink</strong>. If true, it uses the attribute <strong>dxrCreateObjDefaults(mail)</strong> of the profile. The value of that attribute is used as a suffix that is blindly appended to the calculated value of the mail address. If <strong>dxrCreateObjDefaults(mail)</strong> is not set or the attribute <strong>dxrProfileLink</strong> is not available, then no mail attribute value is returned.</p>
</div>
<div class="paragraph">
<p>If the mail suffix is available, the mail attribute is calculated in the following way:</p>
</div>
<div class="paragraph">
<p><em>value_of_<strong><em>givenName</em></strong>.value_of_<strong><em>sn</em></strong>.value_of_<strong><em>dxmLNshortName@</em></strong>mail_suffix</em></p>
</div>
<div class="paragraph">
<p>If one of the attributes <strong>givenName</strong>, <strong>sn</strong> (surname), <strong>dxmLNshortName</strong> is not set, the missing components (including the delimiter for the next component) are dropped.</p>
</div>
<div class="paragraph">
<p>The return value of the Java script is stored in the variable "mail".</p>
</div>
<div class="paragraph">
<p>ProfileFromOU.js</p>
</div>
<div class="paragraph">
<p>In the object description <strong>TSAccount.xml</strong>, the Java script <strong>ProfileFromOU.js</strong> is called to generate the <strong>dxrProfileLink</strong> attribute of the account. The value is returned in the variable <strong>dxrProfile</strong> and is set based on the value of the attribute <strong>ou</strong>. If a value of the organizational unit is present, the script tries to find the appropriate profile in the target system specific subtree</p>
</div>
<div class="paragraph">
<p><em>domain_root</em> &#8594; <strong>TargetSystems</strong> &#8594; <em>TargetSystem_name</em> &#8594; <strong>configuration</strong> &#8594; <strong>profiles</strong></p>
</div>
<div class="paragraph">
<p>by matching the <strong>ou</strong> value with the <strong>cn</strong> value of the profile.</p>
</div>
<div class="paragraph">
<p>If no profile for that organizational unit was found or if the <strong>ou</strong> attribute in the account is empty, the Java script tries to find the default profile. If there is no default profile, the return value <strong>dxrProfile</strong> of the Java script is "".</p>
</div>
<div class="paragraph">
<p>Note that the attribute <strong>dxrProfileLink</strong> is only calculated for new objects. If, for example, the <strong>ou</strong> changes in the user object, then the <strong>ou</strong> attribute in the account changes, too (by a master mechanism); nevertheless, the attribute <strong>dxrProfileLink</strong> is not updated (even if it depends on attribute <strong>ou</strong>). It is a workflow task (in the user hooks) to update the attribute <strong>dxrProfileLink</strong> after having renamed the user in the Notes address book.</p>
</div>
<div class="paragraph">
<p>UniqueNameForAccounts.js</p>
</div>
<div class="paragraph">
<p>In the object description <strong>TSAccount.xml</strong>, the Java script <strong>UniqueNameForAccounts.js</strong> is called to generate the <strong>dxrPrimaryKey</strong> attribute of the account. The value is returned in the variable <strong>UniqueNameAccount</strong>.</p>
</div>
<div class="paragraph">
<p>The attribute <strong>UniqueNameAccount</strong> must be unique and is generated the following way:</p>
</div>
<div class="paragraph">
<p><em><strong><em>CN=</em></strong>value_of_<strong><em>givenName</em></strong> value_of_<strong><em>initials</em></strong> value_of_<strong><em>sn/OU=</em></strong>value_of_<strong><em>uniqueOrgUnit/O=</em></strong>value_of_<strong><em>orgUnit</em></strong></em></p>
</div>
<div class="paragraph">
<p>Setup of CN is straightforward. Missing components are simply ignored and the delimiter moves to the next components. The other components require a more sophisticated approach.</p>
</div>
<div class="paragraph">
<p>For the components O and OU, the Java script reads the attributes</p>
</div>
<div class="paragraph">
<p><strong>dxrCreateObjDefaults(Unique)<br>
dxrOptions(TargetCertifier)</strong></p>
</div>
<div class="paragraph">
<p>of the relevant profile (that is defined in the attribute <strong>dxrProfileLink</strong>). The attribute <strong>dxrOptions(TargetCertifier)</strong> is used as value of the component <strong>O</strong>. The component <strong>OU</strong> is only set, if the attribute <strong>UniqueNameAccount</strong> is not yet unique. Therefore the Java script searches all accounts whose attribute <strong>dxrPrimaryKey</strong> matches the component <strong>CN</strong> and component <strong>OU</strong>. If no object with that name is found <strong>UniqueNameAccount</strong> is returned as</p>
</div>
<div class="paragraph">
<p><em><strong><em>CN=</em></strong>value_of_<strong><em>givenName</em></strong> value_of_<strong><em>initials</em></strong> value_of_<strong><em>sn/O=</em></strong>value_of_<strong><em>orgUnit</em></strong></em></p>
</div>
<div class="paragraph">
<p>If more than one object has been found, then the Java script function <strong>getUniqueOrgUnit</strong> analyzes the search results and returns the next available value for OU by using the base for OU (<strong>dxrCreateObjDefaults(Unique)</strong>) and appending a unique number.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
As opposed to <strong>UniqueNameForGroups.js</strong>, a unique account name is generated by the script itself. There is no need for the service layer to call the script several times to generate a unique value by a trial and error procedure.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>UniqueNameForGroups.js</p>
</div>
<div class="paragraph">
<p>In the object description <strong>Group.xml</strong>, the Java script <strong>UniqueNameForGroups.js</strong> is called to generate the <strong>dxrPrimaryKey</strong> attribute of the group. The value is returned in the variable <strong>ListName</strong>.</p>
</div>
<div class="paragraph">
<p>The Java script uses the attribute cn of the group as the <strong>ListName</strong> and generates a unique name by simply appending an integer value. The service layer provides the current value of that integer value in the variable <strong>$UniqueOrgUnit</strong>. The service layer tries to create the group with that name; if not unique, it will call the Java script again with an incremented value of <strong>$UniqueOrgUnit</strong>. If the Java script reaches the limit 100, it returns the string <strong>JavaScript.Error</strong>, which causes the service layer to stop creation of the group (because no unique list name could be generated).</p>
</div>
<div class="paragraph">
<p>UniqueShortName.js</p>
</div>
<div class="paragraph">
<p>In the object description <strong>TSAccount.xml</strong>, the Java script <strong>UniqueShortNames.js</strong> is called to generate the <strong>dxmLNshortName</strong> attribute of the account. The value is returned in the variable <strong>ShortName</strong>.</p>
</div>
<div class="paragraph">
<p>The Java script sets up the value as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>first letter of <strong>givenName</strong></p>
</li>
<li>
<p>first letter of sn</p>
</li>
<li>
<p>employeeNumber</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The Java script checks whether that value is unique by calling the Java script function <strong>searchAccountName</strong>, which searches all accounts whose <strong>dxmLNshortName</strong> attribute matches that value (initial substring matching). If the attribute value is not unique, the Java script calls the function <strong>getUniqueCounter</strong>, which calculates the next available number to make the basic value unique. <strong>getUniqueCounter</strong> analyzes the search result (returned by <strong>searchAccountName</strong>) and returns the next available unique number. This unique number is appended to the basic value.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
As opposed to <strong>UniqueNameForGroups.js</strong>, a unique short name is generated by the script itself. There is no need for the service layer to call the script several times to generate a unique value by a trial and error procedure.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_notes_workflow_and_activities"><a class="anchor" href="#_ch7_notes_workflow_and_activities"></a><a class="link" href="#_ch7_notes_workflow_and_activities">7.2.10.4. Notes Workflow and Activities</a></h5>
<div class="paragraph">
<p>The following figure shows the layout of the channels that are used by the join activity.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch7_targetWFs/image17.png" alt="Notes Workflow Channels and Objects">
</div>
<div class="title">Figure 93. Notes Workflow Channels and Objects</div>
</div>
<div class="paragraph">
<p>The workflows handle these Notes objects:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Person - a physical user in the Notes address book</p>
</li>
<li>
<p>Group - a group in the Notes address book</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>DirX Identity supports these Notes workflows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Ident_Notes_Realtime</strong> - this workflow is a Java-based synchronization workflow. It can run either scheduled or event-based. Event-based means that it is triggered by an account or group change in DirX Identity. Each modification of an account or a group, for example, adding an attribute to an account, adding a new group, adding/removing a member to or from a group or changing the group owner starts a workflow that propagates this change to Notes.<br>
Once the change is applied, it is propagated back to the account or group object in the DirX Identity target system, for example to adjust the group&#8217;s state or other data.</p>
</li>
<li>
<p><strong>Restore_Notes_Ident</strong> - this workflow is a scheduled validation workflow running from the Identity Store to the Notes address book. It imports persons and groups in the Notes address book using the associated Identity target systems accounts and groups. It</p>
</li>
<li>
<p>creates new persons and groups in the Notes address book</p>
</li>
<li>
<p>modifies existing persons and groups (for example, modifies the groupâs members and other attributes according to the current group state)</p>
</li>
<li>
<p>deletes persons and groups in the Notes address book</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This workflow is used to perform an initial load of the Notes address book and to keep the Notes address book in sync if changes are done in Identity target system (for example, accounts or groups are added or deleted).</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>SetPassword_in_Notes</strong> - this workflow is a Java-based synchronization workflow that synchronizes the attribute dxmPassword of a target system account with the attribute HTTPPassword of a person in the Notes address book.</p>
</li>
<li>
<p><strong>Validate_Notes_Ident</strong> - this workflow is a scheduled validation workflow. It imports persons and groups from the Notes address book to the associated Identity target systems and</p>
</li>
<li>
<p>creates new accounts and groups in the Identity Store</p>
</li>
<li>
<p>modifies existing accounts and groups (for example, modifies the groupâs members and other attributes according to the current group state)</p>
</li>
<li>
<p>deletes accounts and groups in the Identity Store</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This workflow is used to perform an initial load of the Identity Notes target systems and to keep the Identity target systems in sync if changes are done in Notes (for example, persons or groups are added or deleted).</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_notes_workflow_ports"><a class="anchor" href="#_ch7_notes_workflow_ports"></a><a class="link" href="#_ch7_notes_workflow_ports">7.2.10.5. Notes Workflow Ports</a></h5>
<div class="paragraph">
<p>This section describes Notes workflow ports.</p>
</div>
<div class="paragraph">
<p>TS Port</p>
</div>
<div class="paragraph">
<p>The <strong>ts</strong> port references the Notes connected directory and its channels. The channels contain the mapping definitions for the import of persons/groups to the Notes address book and the join definitions. The export parameters are also defined (for exporting persons and groups from the Notes address book).</p>
</div>
<div class="paragraph">
<p>The following filters are defined:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>CF - Crypt Filter</strong><br>
Standard crypt filter for password decryption.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>IdentityDomain Port</p>
</div>
<div class="paragraph">
<p>The <strong>IdentityDomain</strong> port references the Notes channels (Channel Parent) of the Identity connected directory. The channels contain the mapping definitions for the import of accounts and groups from the Notes address book and the join definition for Identity. The export parameters are also defined (for exporting persons and groups from the Notes address book).</p>
</div>
<div class="paragraph">
<p>There is no filter defined in the <strong>IdentityDomain</strong> port.</p>
</div>
<div class="paragraph">
<p>Note that the validation workflow and the sync workflow use the same connected directory and channel configuration. Only the controller class is changed in the join activity.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_notes_workflow_channels"><a class="anchor" href="#_ch7_notes_workflow_channels"></a><a class="link" href="#_ch7_notes_workflow_channels">7.2.10.6. Notes Workflow Channels</a></h5>
<div class="paragraph">
<p>This section provides information about Notes workflow channels.</p>
</div>
<div class="sect5">
<h6 id="_ch7_direction_identity_store_ibm_notes"><a class="anchor" href="#_ch7_direction_identity_store_ibm_notes"></a><a class="link" href="#_ch7_direction_identity_store_ibm_notes">7.2.10.6.1. Direction: Identity Store &#8594; IBM Notes</a></h6>
<div class="paragraph">
<p>This section describes the mapping and user hook details of the direction Identity Store to IBM Notes. Complex post-mappings and user hooks are required because the Notes target system handles some of the update requests asynchronously (using the <strong>adminP</strong> process) and problems arise if the previous request has not been successfully processed when the next request arrives. Therefore the Notes real-time workflows use an internal attribute <strong>dxrPendingRequest</strong> that indicates whether or not a request can be sent to the Notes system without resulting in an error. For details, please refer to the following sections.</p>
</div>
<div class="paragraph">
<p>For a complete list and explanation of Notes-specific attributes, see the attribute section of the Notes connector description in the <em>DirX Identity Connectivity Reference</em>.</p>
</div>
<div class="paragraph">
<p>Post-Mapping for Groups</p>
</div>
<div class="paragraph">
<p>If the attribute <strong>dxrState</strong> in Identity Store is "DELETED", the operation (as part of the mapped entry) is set to DELETE.</p>
</div>
<div class="paragraph">
<p>Post-Mapping for Accounts</p>
</div>
<div class="paragraph">
<p>If the attribute dxrState in Identity Store is âDELETEDâ, the operation (as part of the mapped entry) is set to DELETE and the value of the attribute DeleteMailFile is set to <strong>0</strong>.</p>
</div>
<div class="paragraph">
<p>For Modify Requests, the following steps apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For each modify request to the Notes connector, a check is performed whether there is a pending request available (these pending requests are stored in the attribute <strong>dxrPendingRequest</strong>).<br>
<br>
Presence of a pending request results in a check of the <strong>FullName</strong> of Notes against the attribute <strong>dxrPrimaryKey</strong> in the Identity Store. If the attributes are still the same, a trace entry (a warning) is written indicating that the current request will not be propagated (the <strong>Request-Type</strong> in the mapped entry is set to NONE).<br></p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If the attribute values differ, then later on, the attribute <strong>dxrPendingRequest</strong> will be removed by the user hook <strong>preUpdate</strong>, because the user hook knows the connector for updating the attribute whereas the post-mapping procedure doesn&#8217;t.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Next, the current request is analyzed. A check is made as to whether the request would result in both a <strong>Rename</strong> and a <strong>MoveInHierarchy</strong> operation.<br></p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The Rename operation is detected by comparing the attributes <strong>LastName</strong>, <strong>FirstName</strong>, <strong>MiddleInitial</strong> and <strong>UniqueOrgUnit</strong> (identified by the <strong>UniqueOrgUnitAttrType</strong> attribute) of Notes against <strong>sn</strong>, <strong>givenName</strong>, <strong>initials</strong> and <strong>dxmLNuniqueOrgUnit</strong> in the Identity Store. If one of the values is different, a <strong>Rename</strong> operation is propagated. A <strong>MoveInHierarchy</strong> operation is detected by the existence of the attribute <strong>PathFileTargetCertId</strong> in the attribute list.)
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If both a <strong>Rename</strong> and <strong>MoveInHierarchy</strong> operation are detected, then the parameters for the <strong>MoveInHierarchy</strong> operation are dropped and a logging entry (a warning) is written. The <strong>MoveInHierachy</strong> operation (<strong>PathFileTargetCertId</strong>) will be propagated the next time the account is synchronized again to Notes.</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>AC - com.siemens.dxm.join.userhook.notes.UserHookAccountsTo (user hooks for accounts)</p>
</div>
<div class="paragraph">
<p>The following user hooks are used:</p>
</div>
<div class="paragraph">
<p>User hook <strong>preUpdate</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>This user hook checks whether the attribute <strong>dxrPendingRequest</strong> (set by an earlier request) could be reset. This is indicated by a change of the <strong>FullName</strong> which means that the request has been processed by Notes. If the <strong>FullName</strong> of Notes is different from the attribute <strong>dxrPrimaryKey</strong> in the Identity Store, then the attribute <strong>dxrPendingRequest</strong> is deleted.</p>
</li>
<li>
<p>The user hook must provide additional attributes that are kept in the Notes profile object in the Identity Store. For this reason, the profile identified by the value of the attribute <strong>ou</strong> is selected. If no such profile exists or the value of <strong>ou</strong> is empty, then the default profile is selected.<br>
<br>
The source attribute list is extended by a set of attributes from the profile object. For details, see the section "Notes Dynamic Configuration" in the <em>DirX Identity Connectivity Reference</em>.</p>
</li>
<li>
<p>Next, the user hook checks whether the account has been moved to another organizational unit in the Identity Store. This is indicated by a change of the <strong>ou</strong> attribute, whereas the attribute <strong>dxrProfileLink</strong> was not changed. If the entry was moved, then a potentially new Notes profile object needs to be assigned in the attribute <strong>dxrProfileLink</strong>.<br>
<br>
The user hook <strong>preUpdate</strong> determines which profile applies and stores the name of the new profile in the member variable <strong>newProfileName</strong> of the user hook. Later on, the user hook <strong>postUpdate</strong> will update that profile name in the Identity Store.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Assignment of a new profile updates these attributes:*<br>
PathFileTargetCertId* (derived from the attribute <strong>PathFileCertId</strong> of the new profile)<br>
<strong>TargetCertifier</strong><br>
<strong>Validity</strong></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If no profile is available for the new <strong>ou</strong> and the old value of <strong>dxrProfileLink</strong> was mapped to the default profile, then propagation of <strong>MoveInHierachy</strong> to Notes is not possible as no new information for <strong>PathFileTargetCertId</strong> and <strong>TargetCertifier</strong> is available.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If the attribute <strong>dxrProfileLink</strong> is not set (for example, because the account was created in an earlier DirX Identity version that did not support this attribute) then the user hook <strong>preUpdate</strong> evaluates a profile name using the value of <strong>ou</strong>.</p>
</div>
<div class="paragraph">
<p>User hook <strong>postUpdate</strong></p>
</div>
<div class="paragraph">
<p>After a successful update in Notes this user hook checks whether the attribute <strong>dxrPendingRequest</strong> needs to be set. The existence of the attribute <strong>dxrPendingRequest</strong> guarantees that no other critical update operation (rename or move) on the same objects is initialized while the previous one is still running.</p>
</div>
<div class="paragraph">
<p>The check comprises these tests:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the attribute <strong>dxmLNregisterUser</strong> is set to true, the user is registered in the Notes server and normally the <strong>FullName</strong> is generated. If the <strong>FullName</strong> is not available in the SPML-Response of the update request, then a pending request is generated.</p>
</li>
<li>
<p>The attributes <strong>LastName</strong>, <strong>FirstName</strong>, <strong>MiddleInitial</strong> and <strong>UniqueOrgUnit</strong> (stored in the attribute defined by <strong>uniqueOrgUnitAttrType</strong>) of Notes are checked against the attributes <strong>sn</strong>, <strong>givenName</strong>, <strong>initials</strong> and <strong>dxmLNuniqueOrgUnit</strong> of the Identity Store. If there is a difference in one of these attributes and the <strong>FullName</strong> of Notes is still the same as <strong>dxrPrimaryKey</strong> in Identity Store, the attribute <strong>dxrPendingRequest</strong> is set.</p>
</li>
<li>
<p>If the attribute <strong>PathFileTargetCertId</strong> is present in the attribute list, then a <strong>MoveInHierarchy</strong> operation needs to be executed by Notes. This is an indication to set the attribute <strong>dxrPendingRequest</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The format of the attribute <strong>dxrPendingRequest</strong> is:</p>
</div>
<div class="paragraph">
<p><code>date=<em>date</em>;PendingOperation=<em>operation</em>;PathFileCertId=<em>value</em>;PathFileTargetCertId=<em>value</em>;FullName=<em>value</em></code></p>
</div>
<div class="paragraph">
<p>Furthermore, if a requested move operation was successful, then the attribute <strong>dxrProfileLink</strong> is set to the value of the previously evaluated <strong>newProfileName</strong> (see the preUpdate user hook).</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_direction_ibm_notes_identity_store"><a class="anchor" href="#_ch7_direction_ibm_notes_identity_store"></a><a class="link" href="#_ch7_direction_ibm_notes_identity_store">7.2.10.6.2. Direction: IBM Notes &#8594; Identity Store</a></h6>
<div class="paragraph">
<p>This section describes the user hook details of the direction Identity Store to IBM Notes.</p>
</div>
<div class="paragraph">
<p>For a complete list and explanation of Notes-specific attributes that are kept in the Identity Store, see the attribute section of the Notes connector description in the <em>DirX Identity Connectivity Reference</em>.</p>
</div>
<div class="paragraph">
<p>AI - com.siemens.dxm.join.userhook.notes.UserHookAccountsFrom (user hooks for accounts)</p>
</div>
<div class="paragraph">
<p>The following user hooks are used:</p>
</div>
<div class="paragraph">
<p>User hook <strong>postUpdate</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>The user hook checks after a successful update in Identity Store, whether the attribute <strong>dxrPendingRequest</strong> could be deleted. If the request contained an update of the attribute <strong>dxrPrimaryKey</strong>, then the attribute <strong>dxrPendingRequest</strong> has to be read first. The reason is, that it could have been set in the <strong>postUpdate</strong> user hook of Identity Store to Notes synchronization. Therefore, it is not available in the attribute list of the Identity Store on the way back due to the fact that the Identity Store is normally not read again. If <strong>dxrPendingRequest</strong> exists it will be deleted.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_password_channel_4"><a class="anchor" href="#_ch7_password_channel_4"></a><a class="link" href="#_ch7_password_channel_4">7.2.10.6.3. Password Channel</a></h6>
<div class="paragraph">
<p>A password channel updates the account passwords.</p>
</div>
<div class="paragraph">
<p>A password channel can also be configured backwards from the connected system to Identity to be able to update some attributes in Identity after a password change or reset has taken place in the connected system. The join engine then as usual synchronizes the attributes specified in the corresponding password channel mapping to Identity after the account with its password-relevant attributes was updated in the connected system.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch7_medico_workflows"><a class="anchor" href="#_ch7_medico_workflows"></a><a class="link" href="#_ch7_medico_workflows">7.2.11. Medico Workflows</a></h4>
<div class="paragraph">
<p>The Medico Provisioning workflows operate between a target system of type <strong>Medico</strong> in the Identity Store and the corresponding connected Medico system.</p>
</div>
<div class="paragraph">
<p>Because Medico provides an SPML/SOAP service, the workflows use the SPML connector (SpmlV1SoapConnector2TS) for provisioning. This connector communicates with the Medico SPML server. The following figure illustrates the Medico Provisioning workflow architecture.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch7_targetWFs/image18.png" alt="Medico Provisioning Workflow Architecture">
</div>
<div class="title">Figure 94. Medico Provisioning Workflow Architecture</div>
</div>
<div class="paragraph">
<p>The workflows handle the following Medico objects:</p>
</div>
<div class="paragraph">
<p><strong>Person</strong> - the physical user. The Person object holds the demographic data and is not used for login.</p>
</div>
<div class="paragraph">
<p><strong>LoginID</strong> (or User ID) - the user login account ID. Each user can have one or more accounts to log into a Medico application. Different accounts are needed for different access rights. Access rights are expressed in terms of roles, profiles and groups. There are special accounts (âSonderbenutzerâ / âSonderrolleâ) with high access rights that are reserved for emergency situations.</p>
</div>
<div class="paragraph">
<p><strong>Role</strong> - the role associated with the LoginID. A role is composed of a set of entry points that regulate the applications and menu entries that are allowed for and presented to a LoginID.</p>
</div>
<div class="paragraph">
<p><strong>Profile</strong> - the profile associated with the LoginID. The profile contains information used mainly to determine the stations (beds) for which physicians are responsible.</p>
</div>
<div class="paragraph">
<p><strong>Group</strong> - the group associated with the LoginID. The group exists for historical reasons, but it can be used to specify general access rights, for example, printer access. A LoginID must have exactly one group associated with it.</p>
</div>
<div class="paragraph">
<p>The following figure illustrates the relationships between Medico and DirX Identity objects.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch7_targetWFs/image19.png" alt="Relationships between Medico and DirX Identity Objects">
</div>
<div class="title">Figure 95. Relationships between Medico and DirX Identity Objects</div>
</div>
<div class="paragraph">
<p>As shown in the figure, a Person and LoginID object on the Medico side are created from the Account entry on the Identity side.</p>
</div>
<div class="paragraph">
<p>Groups within the Medico target system in DirX Identity have a type attribute. The corresponding object on the Medico side (Role, Profile, Group) is mapped according to this type attribute.</p>
</div>
<div class="paragraph">
<p>The memberships between a LoginID and a Role or Profile are described as member attributes of a Role or Profile. Membership changes result in an add or delete member attribute at the Identity side.</p>
</div>
<div class="paragraph">
<p>The membership between a LoginID and a Group is described in the groupid attribute of the LoginID.</p>
</div>
<div class="sect4">
<h5 id="_ch7_medico_workflow_prerequisites_and_limitations"><a class="anchor" href="#_ch7_medico_workflow_prerequisites_and_limitations"></a><a class="link" href="#_ch7_medico_workflow_prerequisites_and_limitations">7.2.11.1. Medico Workflow Prerequisites and Limitations</a></h5>
<div class="paragraph">
<p>The Medico workflow requires medico//s Release 16 or higher.</p>
</div>
<div class="paragraph">
<p>The Medico SPML server supports a subset of the SPML V1 request; in particular, the server does not support search requests without filter specifications. As a result, you must be careful when changing the configuration. For detailed information on the Medico SPML server, see the Medico documentation. This limitation also means that the real-time password workflow SetPassword currently does not work. Please use the "setPassword in Medico" workflow instead.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_configuring_the_medico_workflow"><a class="anchor" href="#_ch7_configuring_the_medico_workflow"></a><a class="link" href="#_ch7_configuring_the_medico_workflow">7.2.11.2. Configuring the Medico Workflow</a></h5>
<div class="paragraph">
<p>To configure the connection to Medico:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Specify the IP address and the data port at the Medico service object (Medico CD &#8594; Service).</p>
</li>
<li>
<p>Configure the socket timeout at the workflow&#8217;s TS port. You may increase the timeout value (in seconds) for long SPML requests to the Medico SPML server (for example, searches with a large result set).</p>
</li>
<li>
<p>Do not change the URL path.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_configuring_the_medico_target_system"><a class="anchor" href="#_ch7_configuring_the_medico_target_system"></a><a class="link" href="#_ch7_configuring_the_medico_target_system">7.2.11.3. Configuring the Medico Target System</a></h5>
<div class="paragraph">
<p>The Medico target system requires the following layout:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Accounts</strong> - for each Medico LoginID, one account with <strong>dxrType=login</strong> is created in DirX Identity. The Medico target system in the Identity Store does not contain any Person objects. All accounts are located in a subfolder <strong>logins</strong>.</p>
</li>
<li>
<p><strong>Groups</strong> - the Medico role, profile and group objects are represented as groups in the subfolders <strong>Medico Roles</strong>, <strong>Medico Profiles</strong> and <strong>Medico Groups</strong>. The attribute <strong>dxrType</strong> is used to identify the type.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The Medico-specific JavaScript superior.js is used to distribute the objects to the different folders.</p>
</div>
<div class="paragraph">
<p>The following Medico-specific JavaScripts calculate the attributes <strong>dxrName</strong> and <strong>dxrPrimaryKey</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>calcDxrNameAcc.js</p>
</li>
<li>
<p>calcDxrNameGroup.js</p>
</li>
<li>
<p>calcPrimaryKeyAcc.js</p>
</li>
<li>
<p>calcPrimaryKeyGroup.js</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The attribute <strong>dxrPrimaryKey</strong> contains the SPML ID in the target system:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>loginid=dxrName/employeeNumber,type=login</p>
</li>
<li>
<p>groupid=dxrName,type=group</p>
</li>
<li>
<p>profileid=dxrName,type=profile</p>
</li>
<li>
<p>roleid=dxrName,type=role</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The attribute <strong>dxrName</strong> contains the employeeNumber for accounts and the cn for groups.</p>
</div>
<div class="paragraph">
<p>Mastered attributes for accounts include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>dxrProfession</p>
</li>
<li>
<p>gender</p>
</li>
<li>
<p>dayOfBirth</p>
</li>
<li>
<p>mail</p>
</li>
<li>
<p>street</p>
</li>
<li>
<p>postalCode</p>
</li>
<li>
<p>l</p>
</li>
<li>
<p>c</p>
</li>
<li>
<p>telephoneNumber</p>
</li>
<li>
<p>title</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_medico_workflow_and_activities"><a class="anchor" href="#_ch7_medico_workflow_and_activities"></a><a class="link" href="#_ch7_medico_workflow_and_activities">7.2.11.4. Medico Workflow and Activities</a></h5>
<div class="paragraph">
<p>The following figure shows the layout of the channels that are used by the Medico workflow&#8217;s join activity.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch7_targetWFs/image20.png" alt="Medico Provisioning Workflow Channels and Objects">
</div>
<div class="title">Figure 96. Medico Provisioning Workflow Channels and Objects</div>
</div>
<div class="paragraph">
<p>A pair of channels (one channel per direction) exists for every Medico object (Role, Profile, Group, LoginID, Person). There are no member channels. Memberships are modeled as the member attribute.</p>
</div>
<div class="paragraph">
<p>The following construction is used for the logins and persons channels:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Identity side - the <strong>logins</strong> channel is the primary channel of the persons channel. Person data is merged with the login channel that represents the account. DirX Identity does not model a Person object.</p>
</li>
<li>
<p>Medico side - the <strong>person</strong>s channel references the Medico Person object. Demographic data is passed in this channel.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_medico_workflow_ports"><a class="anchor" href="#_ch7_medico_workflow_ports"></a><a class="link" href="#_ch7_medico_workflow_ports">7.2.11.5. Medico Workflow Ports</a></h5>
<div class="paragraph">
<p>This section describes the Medico workflow ports.</p>
</div>
<div class="paragraph">
<p>TS Port</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>CR -</strong> <strong>Crypt Filter</strong><br>
The standard crypt filter for password decryption.</p>
</li>
<li>
<p><strong>MF - Medico Crypt Filter</strong><br>
A MedicoCrypt filter is implicitly configured. It is used to send the Medico password attribute <strong>pawo</strong> in the SOAP request decrypted to the Medico SPML server. This filter is used only for the initial password when a new login is added.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_medico_workflow_channels"><a class="anchor" href="#_ch7_medico_workflow_channels"></a><a class="link" href="#_ch7_medico_workflow_channels">7.2.11.6. Medico Workflow Channels</a></h5>
<div class="paragraph">
<p>This section provides information about Medico workflow channels.</p>
</div>
<div class="sect5">
<h6 id="_ch7_common_aspects_4"><a class="anchor" href="#_ch7_common_aspects_4"></a><a class="link" href="#_ch7_common_aspects_4">7.2.11.6.1. Common Aspects</a></h6>
<div class="paragraph">
<p>Direction: Identity Store &#8594; Medico</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>mapAttrMaxLength</strong> - Medico attributes have a maximum length, and requests with attribute values exceeding this limit will fail. As a result, this mapping function truncates the value.</p>
</li>
<li>
<p><strong>mapAttrDefaultMaxLength</strong> - for convenience, an additional mapping function is defined which sets a given default value if there is no source attribute value. The function also truncates the value to the defined maximum length.</p>
</li>
<li>
<p><strong>mapValidFromAttr</strong> - in the Medico system, objects are never deleted. Each object has a <strong>validFrom</strong> and <strong>validTo</strong> attribute. The conversion is handled within this mapping function.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Direction: Medico &#8594; Identity Store</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>CommonProcsMedico.calculateIdInIdentity</strong> - calculates the Id.</p>
</li>
<li>
<p><strong>dxrType</strong> is set according to the type of the channel handles (login, profile, &#8230;&#8203;).</p>
</li>
<li>
<p><strong>dxrPrimarykey</strong> is set to the value of the source ID.</p>
</li>
<li>
<p><strong>dxrName</strong> is taken from the Medico id attribute (loginid, profileid, &#8230;&#8203;).</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_person"><a class="anchor" href="#_ch7_person"></a><a class="link" href="#_ch7_person">7.2.11.6.2. Person</a></h6>
<div class="paragraph">
<p>Direction: Identity Store &#8594; Medico</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ID: <strong>"pnr="$\{source.employeeNumber}",type=person</strong></p>
</li>
<li>
<p>Join: <strong>pnr= $\{source.employeeNumber}</strong></p>
</li>
<li>
<p>A Medico person has two additional name attributes:*<br>
Namechr* surname, givenName<strong><br>
Namechrnorm</strong> Namchr umlauts are expanded and converted to lowercase<br>
For details see the JavaDoc of <strong>mapNameChr</strong> and <strong>mapNameChrNorm</strong></p>
</li>
<li>
<p>Medico supports only one e-mail address per person. In DirX Identity, e-mail is defined as a multi-valued attribute. If there is no e-mail attribute value stored in Medico, the first value is taken from the DirX Identity e-mail attribute. If the value in Medico matches one of the DirX Identity values, nothing is changed. If not, the first value is taken.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Direction: Medico &#8594; Identity Store</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Primary Channel login - join to primary via employeeNumber.</p>
</li>
<li>
<p>Postmapping - prevents creating a Person object. Action is set to <strong>NONE</strong> if the action was set to <strong>add</strong>.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_login"><a class="anchor" href="#_ch7_login"></a><a class="link" href="#_ch7_login">7.2.11.6.3. Login</a></h6>
<div class="paragraph">
<p>Direction: Identity Store &#8594; Medico</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ID: the <strong>dxrPrimaryKey</strong> is used as the identifying attribute.</p>
</li>
<li>
<p>Join: the join is performed with the ID.</p>
</li>
<li>
<p>loginid: the <strong>dxrName</strong> value is used as the loginid.</p>
</li>
<li>
<p>For new logins, a constant groupid <strong>DIRXOHNE</strong> is set (groupid is a mandatory attribute).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>LC - com.siemens.dxm.join.userhook.medico.UserHookAccountsTo</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>preUpdate - creates a person if necessary</p>
</li>
<li>
<p>postUpdate - if login was renamed, the old login is disabled</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Direction: Medico&#8594; Identity Store</p>
</div>
<div class="paragraph">
<p><strong>LI - com.siemens.dxm.join.userhook.medico.UserHookAccountsFrom</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>preUpdate: merge the person attribute to account. In the current workflow version, it should work without this user hook (primary channel construct). If you have an older version of this workflow, you need this user hook.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_password_channel_5"><a class="anchor" href="#_ch7_password_channel_5"></a><a class="link" href="#_ch7_password_channel_5">7.2.11.6.4. Password Channel</a></h6>
<div class="paragraph">
<p>A password channel updates the login passwords.</p>
</div>
<div class="paragraph">
<p>A Password Channel can also be configured backwards from the Connected System to Identity to be able to update some attributes in Identity after a password change or reset has taken place in the Connected System. The join engine then as usual synchronizes the attributes specified in the corresponding Password Channel Mapping to Identity after the account with its password relevant attributes was updated in the Connected System.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch7_office_365_workflows"><a class="anchor" href="#_ch7_office_365_workflows"></a><a class="link" href="#_ch7_office_365_workflows">7.2.12. Office 365 Workflows</a></h4>
<div class="paragraph">
<p>The Office 365 Provisioning workflows operate between a target system of type <strong>Office 365</strong> in the Identity Store and the corresponding connected Office 365 endpoint.</p>
</div>
<div class="paragraph">
<p>The workflows use the Office 365 connector (Office365Connector) for provisioning. This connector communicates with the Office 365 endpoint using RESTful API with JSON requests.</p>
</div>
<div class="paragraph">
<p>The connector uses Office 365 OAuth server for authentication and authorization.</p>
</div>
<div class="paragraph">
<p>The Office 365 workflows handle the following Office 365 objects:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Account -</strong> the common Office 365 (Windows Azure) accounts.</p>
</li>
<li>
<p><strong>Group</strong> - the common Office 365 (Windows Azure) security groups.</p>
</li>
<li>
<p><strong>Role</strong> - the predefined Office 365 (Windows Azure) administrative roles.</p>
</li>
<li>
<p><strong>Service</strong> <strong>Plan</strong> - the access to the predefined Office 365 applications bound to a single Office 365 license (subscribed sku).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The delivered workflows include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Validate_Office365_Realtime -</strong> the validation workflow that imports existing Office 365 accounts, security groups, roles and service plans together with assignment from Office 365 server to the Identity Store.</p>
</li>
<li>
<p><strong>Ident_Office365_Realtime -</strong> the synchronization workflow that exports detected changes for account and group objects including assignments from Identity Store to the Office 365 endpoint in the first step. The second step is to validate the processed changes in Office 365 endpoint to the Identity Store.</p>
</li>
<li>
<p><strong>SetPassword in Office365</strong> - the SetPassword workflow that sets the password for the user object in Office 365.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following figure illustrates the Office 365 Provisioning workflow architecture.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch7_targetWFs/image21.png" alt="Office 365 Provisioning Workflow Architecture">
</div>
<div class="title">Figure 97. Office 365 Provisioning Workflow Architecture</div>
</div>
<div class="sect4">
<h5 id="_ch7_office_365_workflow_prerequisites_and_limitations"><a class="anchor" href="#_ch7_office_365_workflow_prerequisites_and_limitations"></a><a class="link" href="#_ch7_office_365_workflow_prerequisites_and_limitations">7.2.12.1. Office 365 Workflow Prerequisites and Limitations</a></h5>
<div class="paragraph">
<p>The Office 365 Provisioning workflows support only those object and attributes supported by the Office 365 connector. The workflows can handle only one valid Office 365 license (subscribed sku).</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_connecting_to_office_365"><a class="anchor" href="#_ch7_connecting_to_office_365"></a><a class="link" href="#_ch7_connecting_to_office_365">7.2.12.2. Connecting to Office 365</a></h5>
<div class="paragraph">
<p>Verify that services are correctly configured at the Office 365 connected directory. The Office 365 Service referenced by the connected directory should contain the default value <strong>graph.microsoft.com</strong> with SSL enabled. The referenced Office 365 OAuth Service should contain the full URL <strong><a href="https://login.microsoftonline.com/*" class="bare">https://login.microsoftonline.com/*</a><em>tenantID</em></strong>/oauth2/token*. Verify that both Graph API (<strong><a href="https://graph.microsoft.com" class="bare">https://graph.microsoft.com</a></strong>) and the OAuth service (<strong><a href="https://login.microsoftonline.com" class="bare">https://login.microsoftonline.com</a></strong>/<em>tenantID</em>/<strong>oauth2/token</strong>) are accessible from the host where the Office 365 workflows will run.</p>
</div>
<div class="paragraph">
<p>Office 365 connected directory and provisioning workflows support the central HTTP proxy server configuration. See the section "HTTP Proxy Server Configuration" for details.</p>
</div>
<div class="paragraph">
<p>DirX Identity must be registered as a valid principal service for your existing Office 365 tenant domain. Use Windows PowerShell commands to create a principal service. You can also use an existing script CreateServicePrincipal.ps1 which can be freely downloaded from Internet. As a result of the configuration, you will obtain an application principal ID and a symmetric key used for authentication to the OAuth service.</p>
</div>
<div class="paragraph">
<p>Configure the tab Graph API and enter your Office 365 <strong>Tenant</strong> and <strong>Application ID</strong>. Enter the generated client key in the <strong>Application Secret</strong> field.</p>
</div>
<div class="paragraph">
<p>Make sure that the registered principal service representing DirX Identity has sufficient rights. For basic user synchronization and group assignment, the Office 365 role <strong>User</strong> <strong>Account</strong> <strong>Administrator</strong> is sufficient. The assignment of the Office 365 roles requires assignment of the <strong>Company</strong> <strong>Administrator</strong> role. Use Microsoft PowerShell to administer the rights of the principal service.</p>
</div>
<div class="paragraph">
<p>Note that the default validity for the Application Secret is one year. The Office 365 OAuth service will refuse incoming requests that use an expired key. Renew the Application Secret also in Microsoft PowerShell when necessary.</p>
</div>
<div class="paragraph">
<p>Check the <strong>Provisioning</strong> settings used by the connected directory and then set them to the real values for your provisioned target system.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_configuring_the_office_365_target_system"><a class="anchor" href="#_ch7_configuring_the_office_365_target_system"></a><a class="link" href="#_ch7_configuring_the_office_365_target_system">7.2.12.3. Configuring the Office 365 Target System</a></h5>
<div class="paragraph">
<p>The Office 365 target system requires the following layout:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Accounts</strong> â all Office 365 accounts are located in a subfolder <strong>Accounts</strong>.</p>
</li>
<li>
<p><strong>Groups</strong>/<strong>Security</strong> <strong>Groups</strong> â all Office 365 groups are located in a subfolder <strong>Security</strong> <strong>Groups</strong>.</p>
</li>
<li>
<p><strong>Groups</strong>/<strong>Roles</strong> â all Office 365 roles are located in a subfolder <strong>Roles</strong>.</p>
</li>
<li>
<p><strong>Groups</strong>/<strong>Service</strong> <strong>Plans</strong> â all Office 365 service plans that belong to a single valid Office 365 license (subscribed sku) are located in a subfolder <strong>Service</strong> <strong>Plans</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <strong>dxrPrimaryKey</strong> attribute of accounts, groups, roles and service plans contains the unique ID generated by the Office 365 endpoint.</p>
</div>
<div class="paragraph">
<p>The <strong>dxrLicense</strong> attribute is automatically populated if any active service plan assignment exists. Itâs deleted when the last service plan is unassigned from a user. It uses the obligation mechanism (see service plan objects) and the target system-specific JavaScript AccountSkuId.js.</p>
</div>
<div class="paragraph">
<p>The group membership (security groups, roles and service plans) is stored at the account object and references the <strong>dxrPrimaryKey</strong> attribute of group objects.</p>
</div>
<div class="paragraph">
<p>Configure the <strong>Tenant</strong> <strong>Domain</strong> property at the target system at the Options tab. This value is used as a suffix for the Office 365 User Principal Name (dxmADsUserPrincipalName).</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_office_365_workflow_and_activities"><a class="anchor" href="#_ch7_office_365_workflow_and_activities"></a><a class="link" href="#_ch7_office_365_workflow_and_activities">7.2.12.4. Office 365 Workflow and Activities</a></h5>
<div class="paragraph">
<p>The following figure shows the layout of the channels that are used by the join activity.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch7_targetWFs/image22.png" alt="Office 365 Provisioning Workflow Channels and Objects">
</div>
<div class="title">Figure 98. Office 365 Provisioning Workflow Channels and Objects</div>
</div>
<div class="paragraph">
<p>The Office 365 objects and membership are synchronized via a pair of channels (one channel per direction).</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_office_365_workflow_ports"><a class="anchor" href="#_ch7_office_365_workflow_ports"></a><a class="link" href="#_ch7_office_365_workflow_ports">7.2.12.5. Office 365 Workflow Ports</a></h5>
<div class="paragraph">
<p>This section describes the Office 365 workflow ports.</p>
</div>
<div class="paragraph">
<p>TS Port</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>CF - Crypt Filter</strong><br>
An Office 365 filter is configured implicitly. It is used to send the decrypted password attribute <strong>password</strong> to the Office 365 endpoint.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_office_365_workflow_channels"><a class="anchor" href="#_ch7_office_365_workflow_channels"></a><a class="link" href="#_ch7_office_365_workflow_channels">7.2.12.6. Office 365 Workflow Channels</a></h5>
<div class="paragraph">
<p>This section provides information about Office 365 workflow channels.</p>
</div>
<div class="sect5">
<h6 id="_ch7_accounts"><a class="anchor" href="#_ch7_accounts"></a><a class="link" href="#_ch7_accounts">7.2.12.6.1. Accounts</a></h6>
<div class="paragraph">
<p>Direction: Identity Store &#8594; Office 365:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ID: <strong>dxrPrimaryKey</strong></p>
</li>
<li>
<p>Join: <strong>${source.dxrPrimaryKey}</strong></p>
</li>
<li>
<p><strong>accountEnabled</strong> - the attribute used to disable the account object in Office 365. The correct value is derived from the <strong>dxrState</strong> attribute of the corresponding account object in the Identity Store.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>AC</strong> - <strong>com.siemens.dxm.join.map.office365.accounts.to.UserHookSyncServicePlansAndSkuId</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>preUpdate</strong> - removes the mapped values for the attributes skuId and disabledPlans with values for joined entry in order to prevent the synchronization of these attributes.</p>
</li>
<li>
<p><strong>postUpdate</strong> â checks whether a synchronization of the <strong>skuId</strong> and <strong>disabledPlans</strong> attributes is necessary. It actualizes the list of disabled service plans according to the current list of assigned service plans in Office 365. It also removes an unused license (sku) for an Office 365 account.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Direction: Office 365 &#8594; Identity Store</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ID: <strong>${joinedEntry.id}</strong> or <strong>"cn="${source.displayName}","+${env.role_ts_account_base}</strong></p>
</li>
<li>
<p>Join: <strong>${source.dxrPrimaryKey}</strong> or <strong>${target.id}</strong>.</p>
</li>
<li>
<p><strong>dxrTSState</strong> - the attribute used to detect the current state of the account in Office 365. The correct value is derived from the <strong>accountEnabled</strong> attribute of the corresponding account object in Office 365. It is set to DELETED when no account entry is found.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>AI</strong> - <strong>com.siemens.dxm.join.map.office365.accounts.from.UserHookGetServicePlans</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>prolog</strong> - creates a list of available service plans for a valid Office 365 license. It makes them available for other mapping classes.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_groups"><a class="anchor" href="#_ch7_groups"></a><a class="link" href="#_ch7_groups">7.2.12.6.2. Groups</a></h6>
<div class="paragraph">
<p>Direction: Identity Store &#8594; Office 365</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ID: <strong>dxrPrimaryKey</strong></p>
</li>
<li>
<p>Join: <strong>${source.dxrPrimaryKey}</strong></p>
</li>
<li>
<p>Post-Mapping - if the <strong>dxrState</strong> attribute in the Identity Store is DELETED, the operation (as part of the mapped entry) is set to DELETE.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Direction: Office 365 &#8594; Identity Store</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ID: <strong>${joinedEntry.id}</strong> or <strong>"cn="${source.displayName}",cn=security groups,"+${env.role_ts_group_base}</strong></p>
</li>
<li>
<p>Join: <strong>${source.dxrPrimaryKey}</strong> or <strong>${target.id}</strong>.</p>
</li>
<li>
<p><strong>dxrTSState</strong> - the attribute used for detection of the real state of the group in Office 365. It is set to ENABLED for existing entries; for non-existing entries, it is set to DELETED.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_roles"><a class="anchor" href="#_ch7_roles"></a><a class="link" href="#_ch7_roles">7.2.12.6.3. Roles</a></h6>
<div class="paragraph">
<p>Direction: Identity Store &#8594; Office 365</p>
</div>
<div class="paragraph">
<p><strong>RC</strong> - <strong>com.siemens.dxm.join.map.office365.roles.to.UserHookRolesTo</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>processSourceEntry</strong> - prevents synchronization of role objects to Office 365 since roles are read-only.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Direction: Office 365 &#8594; Identity Store</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ID: <strong>${joinedEntry.id}</strong> or <strong>"cn="${source.displayName}",cn=roles,"+${env.role_ts_group_base}</strong></p>
</li>
<li>
<p>Join: <strong>${source.dxrPrimaryKey}</strong> or <strong>${target.id}</strong>.</p>
</li>
<li>
<p><strong>dxrTSState</strong> - the correct value is derived from the <strong>roleDisabled</strong> attribute of the corresponding role object in Office 365. It is set to DELETED when no role entry is found.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_service_plans"><a class="anchor" href="#_ch7_service_plans"></a><a class="link" href="#_ch7_service_plans">7.2.12.6.4. Service Plans</a></h6>
<div class="paragraph">
<p>Direction: Identity Store &#8594; Office 365</p>
</div>
<div class="paragraph">
<p><strong>SC</strong> - <strong>om.siemens.dxm.join.map.office365.plans.to.UserHookServicePlansTo</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>processSourceEntry</strong> â this user hook prevents synchronization of service plan objects to Office 365 since service plan are read-only parts of an existing Office 365 license.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Direction: Office 365 &#8594; Identity Store</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ID: <strong>${joinedEntry.id}</strong> or <strong>"cn="${source.servicePlanName}",cn=service plans,"+${env.role_ts_group_base}</strong></p>
</li>
<li>
<p>Join: <strong>${source.dxrPrimaryKey}</strong> or <strong>${target.id}</strong>.</p>
</li>
<li>
<p><strong>dxrTSState</strong> - the attribute used for detection of real state of the service plan in Office 365. It is set to ENABLED for existing entries, for non-existing entries it is set to DELETED.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_password_channel_6"><a class="anchor" href="#_ch7_password_channel_6"></a><a class="link" href="#_ch7_password_channel_6">7.2.12.6.5. Password Channel</a></h6>
<div class="paragraph">
<p>A password channel updates the Office 365 account passwords.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_member_channel"><a class="anchor" href="#_ch7_member_channel"></a><a class="link" href="#_ch7_member_channel">7.2.12.6.6. Member Channel</a></h6>
<div class="paragraph">
<p>The member channel configuration holds the mapping of the group members.</p>
</div>
<div class="paragraph">
<p>Direction: Identity Store &#8594; Office 365</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The mapping of the <strong>memberOf</strong> attribute is handled in a special Java mapping function. It separates membership for service plans and sends the result to Office 365. The Office 365 connector can handle both role and group memberships. The service plans and license assignments are handled in the AC user hook (user channel user hook).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Direction: Office 365 &#8594; Identity Store</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The mapping of the member state <strong>dxrGroupMember</strong> attributes is standard for all attributes. The information about assigned groups, roles and service plans in Office 365 is joined.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch7_openicf_windows_local_accounts_workflows"><a class="anchor" href="#_ch7_openicf_windows_local_accounts_workflows"></a><a class="link" href="#_ch7_openicf_windows_local_accounts_workflows">7.2.13. OpenICF Windows Local Accounts Workflows</a></h4>
<div class="paragraph">
<p>The OpenICF Windows Local Accounts Provisioning workflows operate between a target system of type <strong>OpenICF</strong> in the Identity Store and the corresponding OpenICF .Net connector server, which is configured for communication with a Windows Local Accounts and Groups database using the OpenICF connector bundle <strong>WindowsLocalAccounts.Connector.dll</strong>.</p>
</div>
<div class="paragraph">
<p>The <strong>WindowsLocalAccounts.Connector.dll</strong> bundle represents the OpenICF Windows Local Accounts connector, which is described in the <em>DirX</em> <em>Identity Connectivity Reference</em> in the section "OpenICF Windows Local Accounts Connector".</p>
</div>
<div class="paragraph">
<p>The following figure illustrates the OpenICF Windows Local Accounts deployment.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch7_targetWFs/image23.png" alt="OpenICF Windows Local Accounts Deployment">
</div>
<div class="title">Figure 99. OpenICF Windows Local Accounts Deployment</div>
</div>
<div class="paragraph">
<p>As shown in the figure, the Java-based UNIX-OpenICF connector sends a request to an OpenICF .Net connector server which runs on a Windows platform. The OpenICF connector server passes the request to the Windows Local Accounts connector bundle. The bundle then establishes a connection to the specified Windows host and performs the operations on the host&#8217;s local Security Account Manager (SAM) database. It is possible to provision several Windows hosts using a single OpenICF .Net connector server.</p>
</div>
<div class="paragraph">
<p>For a more detailed description about deployment scenarios, see the <em>DirX Identity Connectivity Reference</em> &#8594; "OpenICF Windows Local Accounts Connector".</p>
</div>
<div class="paragraph">
<p>For a detailed description of the DirX Identity Java-based UNIX-OpenICF connector, see the <em>DirX Identity Connectivity Reference</em> &#8594; "UNIX-OpenICF Connector".</p>
</div>
<div class="paragraph">
<p>The following figure illustrates the OpenICF Windows Local Accounts Provisioning workflow architecture.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch7_targetWFs/image24.png" alt="OpenICF Windows Local Accounts Provisioning Workflow Architecture">
</div>
<div class="title">Figure 100. OpenICF Windows Local Accounts Provisioning Workflow Architecture</div>
</div>
<div class="paragraph">
<p>The workflows handle the following Windows local system objects:</p>
</div>
<div class="paragraph">
<p><strong>Account</strong> (synonymously also named User) - the Windows local system accounts.</p>
</div>
<div class="paragraph">
<p><strong>Group</strong> - the Windows local system groups.</p>
</div>
<div class="paragraph">
<p>The delivered workflows are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Ident_WinLA-OICF_Realtime</strong> - the synchronization workflow that exports detected changes for account and group objects from the Identity Store to the Windows system and then validates the processed changes in the Windows system to the Identity Store.</p>
</li>
<li>
<p><strong>SetPassword in WinLA-OICF</strong> - the workflow that sets the password for the account in the Windows system.</p>
</li>
<li>
<p><strong>Validate_WinLA-OICF_Realtime</strong> - the validation workflow that imports existing Windows accounts and groups including group assignments from the Windows system to the Identity Store.</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="_ch7_openicf_windows_local_accounts_workflow_prerequisites_and_limitations"><a class="anchor" href="#_ch7_openicf_windows_local_accounts_workflow_prerequisites_and_limitations"></a><a class="link" href="#_ch7_openicf_windows_local_accounts_workflow_prerequisites_and_limitations">7.2.13.1. OpenICF Windows Local Accounts Workflow Prerequisites and Limitations</a></h5>
<div class="paragraph">
<p>All prerequisites and limitations refer to the connector and are therefore described in the <em>DirX Identity Connectivity Reference</em> "OpenICF Windows Local Accounts Connector" section.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_connecting_to_the_windows_local_accounts_system"><a class="anchor" href="#_ch7_connecting_to_the_windows_local_accounts_system"></a><a class="link" href="#_ch7_connecting_to_the_windows_local_accounts_system">7.2.13.2. Connecting to the Windows Local Accounts System</a></h5>
<div class="paragraph">
<p>Before you configure the workflows, install and configure the OpenICF .Net Connector Server as described in the <em>DirX Identity Connectivity Reference</em> &#8594; OpenICF Windows Local Accounts Connector.</p>
</div>
<div class="paragraph">
<p>Then configure the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>From the WinLA-OpenICF connected directory that represents the Windows Local Accounts system to be provisioned, go to the OpenICF Connector Server tab and from there to the connected directory that represents the OpenICF Server (<strong>Generic</strong> connected directory type) and specify the IP address or the host name and the data port of the OpenICF Server service object. Adapt the bind profile for the OpenICF Server: set the password that is configured as a shared secret with the OpenICF connector server and enable SSL if it is enabled on the OpenICF server side. Using SSL may require additional configuration steps. See the section "UNIX-OpenICF Connector" in the <em>DirX Identity Connectivity Reference</em> for details.</p>
</li>
<li>
<p>On the WinLA-OpenICF connected directory, specify the IP address or the host name of the targeted Windows system at the WinLA-OpenICF service object. No port number is required here. Then set the bind profile properly. Because the OpenICF .Net Connector Server is started under credentials with appropriate access rights for managing the target Windows systems, no user name must be specified. A user name beginning with "dummy" would have the same effect because it is not used for building a connection to the target Windows system. The password is ignored in these cases.</p>
</li>
<li>
<p>Specify the <strong>Response</strong> <strong>Timeout</strong> property on the OpenICF Connector Server tab of the WinLA-OpenICF Connected Directory. The default value is <strong>30</strong> and should be sufficient.</p>
</li>
<li>
<p>Check the settings related to the OpenICF connector bundle at the TS port object tab OpenICF Connector Bundle, which usually must not be changed. The properties to define are <strong>Bundle</strong> <strong>Name</strong> (default: <strong>WindowsLocalAccounts.Connector</strong>), <strong>Bundle</strong> <strong>Version</strong> (default: <strong>1.4.0.0</strong>) and <strong>Class</strong> <strong>Name</strong> (the default is <strong>Org.IdentityConnectors.WindowsLocalAccounts.WindowsLocalAccountsConnector</strong>).</p>
</li>
<li>
<p>Assign the resource family <strong>OpenICF</strong> in the IdS-J server.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_configuring_the_openicf_windows_local_accounts_target_system"><a class="anchor" href="#_ch7_configuring_the_openicf_windows_local_accounts_target_system"></a><a class="link" href="#_ch7_configuring_the_openicf_windows_local_accounts_target_system">7.2.13.3. Configuring the OpenICF Windows Local Accounts Target System</a></h5>
<div class="paragraph">
<p>The target system requires the following layout:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Accounts - all Windows accounts are located in a subfolder Accounts.</p>
</li>
<li>
<p>Groups - all Windows groups are located in a subfolder Groups.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The attributes dxrName and dxrPrimaryKey of accounts contain the name (SamAccountName) of these objects in the connected Windows system.</p>
</div>
<div class="paragraph">
<p>The standard JavaScript dxrNameForAccounts.js generates the attribute dxrName for the Windows account.</p>
</div>
<div class="paragraph">
<p>The attributes dxrName and dxrPrimaryKey of groups contain the name (SamAccountName) of these objects in the connected Windows system.</p>
</div>
<div class="paragraph">
<p>The account object also stores the group membership and references the dxrPrimaryKey attribute of the group objects.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_openicf_windows_local_accounts_workflow_and_activities"><a class="anchor" href="#_ch7_openicf_windows_local_accounts_workflow_and_activities"></a><a class="link" href="#_ch7_openicf_windows_local_accounts_workflow_and_activities">7.2.13.4. OpenICF Windows Local Accounts Workflow and Activities</a></h5>
<div class="paragraph">
<p>The following figure shows the layout of the channels that are used by the OpenICF Windows Local Accounts workflow&#8217;s join activity:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch7_targetWFs/image25.png" alt="OpenICF Windows Local Accounts Provisioning Workflow Channels">
</div>
<div class="title">Figure 101. OpenICF Windows Local Accounts Provisioning Workflow Channels</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_openicf_windows_local_accounts_workflow_ports"><a class="anchor" href="#_ch7_openicf_windows_local_accounts_workflow_ports"></a><a class="link" href="#_ch7_openicf_windows_local_accounts_workflow_ports">7.2.13.5. OpenICF Windows Local Accounts Workflow Ports</a></h5>
<div class="paragraph">
<p>This section describes the ports of the workflows.</p>
</div>
<div class="paragraph">
<p>TS Port</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>CF - Crypt Filter</strong><br>
This filter is configured implicitly. It is used to send the decrypted password attribute <strong><em>PASSWORD</em></strong> to the OpenICF connector server.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_openicf_windows_local_accounts_workflow_channels"><a class="anchor" href="#_ch7_openicf_windows_local_accounts_workflow_channels"></a><a class="link" href="#_ch7_openicf_windows_local_accounts_workflow_channels">7.2.13.6. OpenICF Windows Local Accounts Workflow Channels</a></h5>
<div class="paragraph">
<p>This section provides information about the OpenICF Windows Local Accounts workflow channels.</p>
</div>
<div class="sect5">
<h6 id="_ch7_accounts_2"><a class="anchor" href="#_ch7_accounts_2"></a><a class="link" href="#_ch7_accounts_2">7.2.13.6.1. Accounts</a></h6>
<div class="paragraph">
<p>Direction: Identity Store &#8594; WinLA -OpenICF</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Direct mapping <strong>dxrPrimaryKey</strong> &#8594; ID - where <strong>dxrPrimaryKey</strong> is built by the common JavaScript dxrNameForAccounts, producing a unique account name in the Identity target system.</p>
</li>
<li>
<p>Java Source mapping &#8594; <strong><em>ENABLE</em></strong> - the attribute is used for enabling or disabling the account in the Windows system. The value is derived from the dxrState attribute of the corresponding account object in DirX Identity.</p>
</li>
<li>
<p>Direct mapping dxmPassword &#8594; <strong><em>PASSWORD</em></strong> - which is used only on an add request.</p>
</li>
<li>
<p>Join - ${source.dxrPrimaryKey}</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Direction: WinLA -OpenICF &#8594; Identity Store</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Join via the <strong>dxrName</strong> attribute that is mapped in the same way as the dxrPrimaryKey attribute from $\{source.id}.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_groups_2"><a class="anchor" href="#_ch7_groups_2"></a><a class="link" href="#_ch7_groups_2">7.2.13.6.2. Groups</a></h6>
<div class="paragraph">
<p>Direction: Identity Store &#8594; WinLA -OpenICF</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Direct mapping dxrPrimaryKey &#8594; IDâ where dxrPrimaryKey is taken from the cn of the group in the Identity target system.</p>
</li>
<li>
<p>Join - ${source.dxrPrimaryKey}</p>
</li>
<li>
<p>PostMapping script - changes the type of the request to delete if dxrState=DELETED.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Direction: WinLA -OpenICF &#8594; Identity Store</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Join via the <strong>dxrName</strong> attribute that is mapped in the same way as the <strong>dxrPrimaryKey</strong> attribute from ${source.id}.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_members"><a class="anchor" href="#_ch7_members"></a><a class="link" href="#_ch7_members">7.2.13.6.3. Members</a></h6>
<div class="paragraph">
<p>Direction: Identity Store &#8594; WinLA-OpenICF</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Java common class mapping Members &#8594; <strong><em>GROUPS</em></strong>.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_setpassword_2"><a class="anchor" href="#_ch7_setpassword_2"></a><a class="link" href="#_ch7_setpassword_2">7.2.13.6.4. setPassword</a></h6>
<div class="paragraph">
<p>Direction: Identity Store &#8594; WinLA-OpenICF</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Direct mapping <strong>dxmPassword</strong> &#8594; <strong><em>PASSWORD</em></strong></p>
</li>
<li>
<p>Direct mapping <strong>dxmPasswordExpired</strong> &#8594; <strong><em>PASSWORD_EXPIRED</em></strong></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch7_racf_workflows"><a class="anchor" href="#_ch7_racf_workflows"></a><a class="link" href="#_ch7_racf_workflows">7.2.14. RACF Workflows</a></h4>
<div class="paragraph">
<p>The RACF Provisioning workflows operate between a target system of type <strong>RACF</strong> in the Identity Store and the corresponding connected RACF system.</p>
</div>
<div class="paragraph">
<p>The RACF connector used in the workflows communicates with the LDAP server across the native LDAP protocol, as shown in the following figure:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch7_targetWFs/image26.png" alt="RACF Workflow Architecture">
</div>
<div class="title">Figure 102. RACF Workflow Architecture</div>
</div>
<div class="paragraph">
<p>The delivered workflows include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Ident_RACF_Realtime</strong> - the synchronization workflow that exports detected changes for account and group objects from Identity Store to the RACF end system and then validates the processed changes in RACF to the Identity Store. The workflow also generates a password if the object is created. When this workflow is triggered by a schedule or started directly in DirX Identity Manager, it also synchronizes the Users and Groups subtrees.</p>
</li>
<li>
<p><strong>SetPassword_in_RACF</strong> - the SetPassword workflow that synchronizes the userâs password to RACF when a password change in the Identity Store is detected.</p>
</li>
<li>
<p><strong>Validate_RACF_Realtime</strong> - the validation workflow that imports existing RACF accounts and RACF groups from RACF to the Identity Store.</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="_ch7_prerequisites_and_limitations"><a class="anchor" href="#_ch7_prerequisites_and_limitations"></a><a class="link" href="#_ch7_prerequisites_and_limitations">7.2.14.1. Prerequisites and Limitations</a></h5>
<div class="paragraph">
<p>The RACF workflows have the following prerequisites and limitations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The RACF connector does not support nested group assignments. They cannot be read or written.</p>
</li>
<li>
<p>The workflow and the connector do not handle the RACF group member limit for groups that are not default groups.</p>
</li>
<li>
<p>Group memberships in the DirX Identity target system must be stored at the account.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_configuring_the_racf_target_system"><a class="anchor" href="#_ch7_configuring_the_racf_target_system"></a><a class="link" href="#_ch7_configuring_the_racf_target_system">7.2.14.2. Configuring the RACF Target System</a></h5>
<div class="paragraph">
<p>Group memberships must be stored at the accounts, so <strong>Reference Group from Account</strong> must be checked.</p>
</div>
<div class="paragraph">
<p>Each RACF user must have a RACF default group. When a RACF user is to be created, the channel user hook of the Provisioning workflow calculates the default group to be used. It selects from a list of default groups that are configured in the target system using the Options tab &#8594; <strong>Default Groups</strong>. Make sure to fill in this list with enough groups to hold all the RACF users and make sure they already exist in RACF. Keep in mind that the maximum number of users per RACF group is limited to <strong>5900</strong>.</p>
</div>
<div class="paragraph">
<p>The Options tab of the target system also shows the field <strong>Last Used Default Group</strong>. It is managed by the workflow user hook and holds the last used default group. You do not need to fill in this field.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_configuring_the_connection_to_racf"><a class="anchor" href="#_ch7_configuring_the_connection_to_racf"></a><a class="link" href="#_ch7_configuring_the_connection_to_racf">7.2.14.3. Configuring the Connection to RACF</a></h5>
<div class="paragraph">
<p>As the RACF connector accesses the RACF system via LDAP, the properties for the LDAP service and bind profile apply.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_configuring_the_connected_directory"><a class="anchor" href="#_ch7_configuring_the_connected_directory"></a><a class="link" href="#_ch7_configuring_the_connected_directory">7.2.14.4. Configuring the Connected Directory</a></h5>
<div class="paragraph">
<p>As with the LDAP connected directory, it is important to configure the base nodes for users and groups within the DirX Identity target system folder and in the connected system. The corresponding fields can be set in the connected directoryâs Provisioning tab.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If the tab is not visible, perform <strong>Reload Object Descriptors</strong> from the context menu.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In addition, for a RACF system, you must configure the parent node for the connection objects (representing RACF user - group memberships) in the Specific Attributes tab.</p>
</div>
<div class="paragraph">
<p>Provisioning</p>
</div>
<div class="paragraph">
<p><strong>Account Base</strong> - the base node for the account tree in the DirX Identity target system.</p>
</div>
<div class="paragraph">
<p><strong>Group Base</strong> - the base node for the group tree in the DirX Identity target system.</p>
</div>
<div class="paragraph">
<p><strong>User Base</strong> - the base node for the accounts in the RACF connected system.</p>
</div>
<div class="paragraph">
<p><strong>Group Base</strong> - the base node for the groups in the RACF connected system.</p>
</div>
<div class="paragraph">
<p>Specific Attributes</p>
</div>
<div class="paragraph">
<p><strong>connect_base</strong> - the base node for the connect objects (user-group memberships) in the RACF connected system.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_racf_workflow_ports"><a class="anchor" href="#_ch7_racf_workflow_ports"></a><a class="link" href="#_ch7_racf_workflow_ports">7.2.14.5. RACF Workflow Ports</a></h5>
<div class="paragraph">
<p>This section describes RACF workflow ports.</p>
</div>
<div class="paragraph">
<p>TS Port</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>CF - Crypt Filter</strong><br>
The configured Crypt Filter decrypts the password attribute racfPassword before passing it to the RACF connector. The attribute name is configured in the Target System tab of the TS port.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_racf_workflow_channels"><a class="anchor" href="#_ch7_racf_workflow_channels"></a><a class="link" href="#_ch7_racf_workflow_channels">7.2.14.6. RACF Workflow Channels</a></h5>
<div class="paragraph">
<p>This section provides information about RACF workflow channels.</p>
</div>
<div class="sect5">
<h6 id="_ch7_accounts_channel"><a class="anchor" href="#_ch7_accounts_channel"></a><a class="link" href="#_ch7_accounts_channel">7.2.14.6.1. Accounts Channel</a></h6>
<div class="paragraph">
<p>The members channel must be referenced from the accounts channel. Note the following attributes:</p>
</div>
<div class="paragraph">
<p>racfid</p>
</div>
<div class="paragraph">
<p>The racfid is used as an identifier for users in RACF and is stored in the DirX Identity target system account in the attribute racfid.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The racfid cannot have more than 8 characters.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>racfDefaultGroup</p>
</div>
<div class="paragraph">
<p>The default group for a RACF user is calculated in the channel user hook and passed as an artificial attribute of the source entry. For details on configuring default groups, see the section âConfiguring the RACF Target Systemâ in this guide.</p>
</div>
<div class="paragraph">
<p>racfAttributes</p>
</div>
<div class="paragraph">
<p>The racfAttributes attribute triggers special processing in the RACF LDAP service and represents their result when reading. The following values related to activating / deactivating a RACF user are set by the connector. They are calculated in the mapping function configured for this attribute:</p>
</div>
<div class="paragraph">
<p>RESUME â set for unlocking a RACF user.</p>
</div>
<div class="paragraph">
<p>REVOKE â set for locking a RACF user. After successful processing, RACF sets the value REVOKED.</p>
</div>
<div class="paragraph">
<p>racfPassword</p>
</div>
<div class="paragraph">
<p>Make sure to set an initial password when the account is created in the DirX Identity target system and map it from dxmPassword to racfPassword.</p>
</div>
<div class="paragraph">
<p>When you observe the values PASSWORD or PROTECTED in the userâs racfAttributes in the RACF system, the typical reason is that the user has no password or an expired one. For more details on racfAttributes, see the IBM documentation, for example, <a href="https://www.ibm.com/docs/en/zos/2.5.0?topic=information-associating-ldap-attributes-racf-fields" class="bare">https://www.ibm.com/docs/en/zos/2.5.0?topic=information-associating-ldap-attributes-racf-fields</a>.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_groups_channel"><a class="anchor" href="#_ch7_groups_channel"></a><a class="link" href="#_ch7_groups_channel">7.2.14.6.2. Groups Channel</a></h6>
<div class="paragraph">
<p>Note that the attributes <strong>racfSuperiorGroup</strong>, <strong>racfOwner</strong>, and <strong>racfSubGroupName</strong> are only read from the RACF system.</p>
</div>
<div class="paragraph">
<p>The <strong>racfid</strong> is used as identifier for groups in RACF and is stored in the DirX Identity target system group in the attribute racfid. Note that the racfid cannot have more than 8 characters.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_members_channel"><a class="anchor" href="#_ch7_members_channel"></a><a class="link" href="#_ch7_members_channel">7.2.14.6.3. Members Channel</a></h6>
<div class="paragraph">
<p>The members channel must be referenced from the accounts channel.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The attribute <strong>dxrPrimaryKey</strong> must be mapped to the identifier.
</td>
</tr>
</table>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_setpassword_channel"><a class="anchor" href="#_ch7_setpassword_channel"></a><a class="link" href="#_ch7_setpassword_channel">7.2.14.6.4. SetPassword Channel</a></h6>
<div class="paragraph">
<p>Password change operation</p>
</div>
<div class="paragraph">
<p>The old password must be part of the password change request because RACF does not allow resetting a password. After the password is set, the connector performs an extra bind operation with the RACF user and the old password to set the new password. The two passwords are delivered in one string, separated by a slash character, for example, <strong>oldpassword/newpassword</strong>.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch7_salesforce_workflows"><a class="anchor" href="#_ch7_salesforce_workflows"></a><a class="link" href="#_ch7_salesforce_workflows">7.2.15. Salesforce Workflows</a></h4>
<div class="paragraph">
<p>The Salesforce Provisioning workflows operate between a target system of type Salesforce in the Identity Store and the corresponding connected Salesforce system. The Salesforce connector uses the REST API, which provides a powerful, convenient and simple Web services API for interacting with the Salesforce system.</p>
</div>
<div class="paragraph">
<p>The Salesforce workflows handle the following Salesforce tables (note: in this section, <strong>SF</strong> indicates Salesforce objects and <strong>DXI</strong> indicates DirX Identity objects):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>SF</strong> <strong>Account</strong> - the Salesforce accounts. This table represents an individual account, which is an organization or person involved with a business (such as customers, competitors, and partners) and holds a ContactID, which is the ID of the user who currently owns the account.</p>
</li>
<li>
<p><strong>SF</strong> <strong>Contact</strong> - the Salesforce contacts. This table represents a contact, which is a person associated with an account. It holds the following important attributes:</p>
</li>
<li>
<p><strong>ContactID</strong> - the ID of the account thatâs the parent of this contact.</p>
</li>
<li>
<p><strong>OwnerID</strong> - the ID of the owner of the account associated with this contact.</p>
</li>
<li>
<p><strong>SF</strong> <strong>PermissionSet</strong> - the Salesforce permission sets. This table represents a set of permissions used to grant more access to one or more users without changing their profiles or reassigning profiles. (The Permission Set object is available in the SalesForce API version 22.0 and newer.)</p>
</li>
<li>
<p><strong>SF</strong> <strong>Profile</strong> - the Salesforce profiles. This table represents a profile, which defines a set of permissions to perform different operations, such as querying, adding, updating, or deleting information. It holds a <strong>UserLicenseId</strong>, which is the ID of the <strong>UserLicense</strong> associated with this profile.</p>
</li>
<li>
<p><strong>SF</strong> <strong>User</strong> - the Salesforce users in an organization. This table holds the following important attributes:</p>
</li>
<li>
<p><strong>AccountID</strong> - the ID of the account associated with a customer portal user. This field is null for Salesforce users.</p>
</li>
<li>
<p><strong>ContactID</strong> - the ID of the contact associated with this account. This field is null for Salesforce users.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The Salesforce workflows synchronize a Salesforce user (with its profile/user license information and optionally one or more permission sets) to a target system account in DirX Identity and store the SF Profile and SF PermissionSets as target system groups.</p>
</div>
<div class="paragraph">
<p>Salesforce also supports the concept of community users, which are external users with access to a Salesforce community. These users require holding information about SF Contacts and SF Accounts. A community user uses one of the following user licenses: Customer_Community, Customer_Community_Login, Partner_Community, Partner_Community_Login. Salesforce stores community users in the same user table as other users. The only difference is the use of a few ProfileIds that are attached to these community user licenses. As a result, community users appear in the DirX Identity account tree of the target system.</p>
</div>
<div class="paragraph">
<p>SF Accounts are mapped to DXI Organizations. They should reside in the subfolder <strong>Business Objects/SalesforceAccounts</strong> to distinguish them from other organizations.</p>
</div>
<div class="paragraph">
<p>SF Contacts are mapped to DXI users. These users are assumed to be associated with organizations such as customers. Storing SF Contacts in the DirX Identity user tree makes them available to user relations and to delegated user management. Thus they can also be provisioned to other target systems. This design supports a global view compared to having everything in a target system. SF Contacts should reside in the subfolder <strong>Users/SalesforceContacts</strong> to distinguish them from internal users.</p>
</div>
<div class="paragraph">
<p>The following figure illustrates how DirX Identity represents the Salesforce object model:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch7_targetWFs/image27.png" alt="DirX Identity - Salesforce Object Model">
</div>
<div class="title">Figure 103. DirX Identity - Salesforce Object Model</div>
</div>
<div class="paragraph">
<p>The figure shows the DirX Identity objects on the left and the Salesforce objects on the right. On the DirX Identity side:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The target system holds the DirX Identity accounts (which are SF users and SF (Community) users) and the DirX Identity groups (which are the SF Profiles and the SF Permission Sets).</p>
</li>
<li>
<p>Outside the target system are the DirX Identity business organizations for SF Accounts and the DirX Identity users (for SF Contacts).</p>
</li>
<li>
<p>The names enclosed in brackets (&lt; &gt;) represent DirX Identity objects. The names of objects that appear underneath the DirX Identity objects are the corresponding Salesforce objects.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>On the Salesforce side:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The SF users and the SF (Community) users are enclosed in a dashed-line box to indicate that "normal" users have no relationship to SF Account and SF Contacts whereas the SF (Community) users require the existence of an entry in the SF Account and in the SF Contact table.</p>
</li>
<li>
<p>The arrows represent the links between the tables.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The delivered Salesforce workflows include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Ident_Salesforce_Realtime</strong> - the synchronization workflow that exports detected changes for account and group objects from Identity Store to the Salesforce cloud and then validates the processed changes in Salesforce to the Identity Store. The workflow also generates a password if the object is created. When this workflow is triggered by a schedule or started directly in DirX Identity Manager, it also synchronizes the <strong>Users/SalesforceContacts</strong> and the <strong>Business Objects/SalesforceAccounts</strong> subtrees.</p>
</li>
<li>
<p><strong>Ident_Salesforce_SLSFAccounts_Realtime</strong> - the synchronization workflow that is triggered by an entry change event and exports detected changes for an object in the <strong>Business Objects/SalesforceAccounts</strong> subtree in Identity Store to the Salesforce cloud and then validates the processed changes in Salesforce to the Identity Store. Note that this workflow uses an entry change topic and therefore uses the following definition in the <strong>WhenApplicable</strong> section:</p>
<div class="ulist">
<ul>
<li>
<p>Topic Prefix: <strong>dxm.event.ebr</strong></p>
</li>
<li>
<p>Type: <strong>aSFOrganization</strong></p>
</li>
<li>
<p>Cluster; *</p>
</li>
<li>
<p>Domain: *</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>This definition implies that an event policy for the object description <strong>aSFOrganization</strong> and the LDAP object class <strong>dxmSLSFaccount</strong> needs to be active.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Ident_Salesforce_SLSFContacts_Realtime</strong> - the synchronization workflow that is triggered by an entry change event and exports detected changes for an object in the <strong>Users/SalesforceContacts</strong> subtree in Identity Store to the Salesforce cloud and then validates the processed changes in Salesforce to the Identity Store. Note that this workflow uses an entry change topic and therefore uses the following definition in the <strong>WhenApplicable</strong> section:</p>
<div class="ulist">
<ul>
<li>
<p>Topic Prefix: <strong>dxm.event.ebr</strong></p>
</li>
<li>
<p>Type: <strong>aSFContact</strong></p>
</li>
<li>
<p>Cluster; *</p>
</li>
<li>
<p>Domain: *</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>This definition implies that an event policy for the object description <strong>aSFContact</strong> and the LDAP object class <strong>dxmSLSFcontactt</strong> needs to be active.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Validate_Salesforce_Realtime</strong> - the validation workflow that imports existing SF Accounts, SF Contacts, SF PermissionSets and SF Profiles from the Salesforce cloud to the Identity Store.</p>
</li>
<li>
<p><strong>SetPassword in Salesforce</strong> - the SetPassword workflow that synchronizes the userâs password to Salesforce when a password change in the Identity Store is detected.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following figure illustrates the Salesforce Provisioning workflow architecture.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch7_targetWFs/image28.png" alt="Salesforce Provisioning Workflow Architecture">
</div>
<div class="title">Figure 104. Salesforce Provisioning Workflow Architecture</div>
</div>
<div class="paragraph">
<p>SF Profiles and SF PermissionSets are only administered in Salesforce directly. (One of the reasons for this is that SF PermissionSets are very complex objects with a huge variety of permission flags). As a result, you always need to start by running the <strong>Validate_Salesforce_Realtime</strong> workflow to make these objects available in the TS groups subtree.</p>
</div>
<div class="paragraph">
<p>Once these objects are available, you can fully administer the SF Accounts, SF Contacts and SF users directly in the Identity Store.</p>
</div>
<div class="paragraph">
<p>When creating new entries in DirX Identity, the (Salesforce) <strong>Id</strong> attribute of such an entry is not yet known; it is synchronized back from Salesforce to Identity and the object in Identity is renamed (because the <strong>Id</strong> is stored in the <strong>cn</strong> in Identity).</p>
</div>
<div class="paragraph">
<p>DirX Identity provisions both SF Profiles and SF Permission Sets as groups and stores them in the TS subtree <strong>groups &#8594; Profiles</strong> and <strong>groups &#8594; PermissionSets</strong>.</p>
</div>
<div class="paragraph">
<p>When you assign Salesforce groups to a user, you must assign exactly one group that is an SF Profile and optionally one or more SF PermissionSets.</p>
</div>
<div class="paragraph">
<p>SF Profiles and SF PermissionSets can be differentiated by the description attributes. SF Profiles are identified by the <strong>(PRF)</strong> prefix, for example:</p>
</div>
<div class="paragraph">
<p>(PRF): Chatter Free User; (UL): Chatter Free</p>
</div>
<div class="paragraph">
<p>Note that the substrings <strong>(UL)</strong> identify the underlying user license on which the SF Profile is based.</p>
</div>
<div class="paragraph">
<p>SF PermissionSets are identified by the <strong>(PERM)</strong> prefix; for example:<br></p>
</div>
<div class="exampleblock">
<div class="content">
(PERM): (PRF): Chatter Free User; (UL): Chatter Free<br>
(PERM): (PRF): -; (UL): -<br>
(PERM): (PRF): -; (UL): Salesforce
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The substring <strong>(PRF)</strong> identifies the SF Profile that is assigned to that SF PermissionSet. The <strong>(UL)</strong> prefix identifies the underlying user license on which the SF Profile is based.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>(PRF)</strong> and <strong>(UL)</strong> may be absent (represented by a hyphen (<strong>-</strong>), if the SF PermissionSet is not attached to an SF Profile. In this case, such permission sets can be used in addition to any SF profile.</p>
</div>
<div class="paragraph">
<p>Keep in mind that the SF Profile and the SF PermissionSet profile definitions must match. If they do not, they are in conflict and canât be assigned in parallel.</p>
</div>
<div class="sect4">
<h5 id="_ch7_salesforce_workflow_prerequisites_and_limitations"><a class="anchor" href="#_ch7_salesforce_workflow_prerequisites_and_limitations"></a><a class="link" href="#_ch7_salesforce_workflow_prerequisites_and_limitations">7.2.15.1. Salesforce Workflow Prerequisites and Limitations</a></h5>
<div class="paragraph">
<p>Before you can use the Salesforce workflows, you must perform the following tasks:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Create and register a Remote Access application in the Salesforce system, as described in "Registering the Remote Access Application".</p>
</li>
<li>
<p>Create the customer-specific attribute <strong>StatusInfo<em>c</strong> to manage the status of Salesforce user deletion, as described in "Creating the StatusInfo</em>c Attribute".</p>
</li>
<li>
<p>Extend the DirX Identity Store schema with Salesforce target system-specific attributes and object classes so that the workflows can store Salesforce-specific information in the Identity Store, as described in the section "Extending the Schema for the Target System Workflows".</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="_ch7_registering_the_remote_access_application"><a class="anchor" href="#_ch7_registering_the_remote_access_application"></a><a class="link" href="#_ch7_registering_the_remote_access_application">7.2.15.1.1. Registering the Remote Access Application</a></h6>
<div class="paragraph">
<p>The Salesforce connector acts as a remote application to the Salesforce system. As a result, you need to create a Remote Access application in the Salesforce system before you can use the Salesforce workflows. (For details, see <a href="https://developer.salesforce.com/page/Getting_Started_with_the_Force.com_REST_API" class="bare">https://developer.salesforce.com/page/Getting_Started_with_the_Force.com_REST_API</a>). To register the remote access application:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Log in to <strong>Salesforce.com</strong> with your (developer) account and then navigate to <strong>Setup</strong> &gt; <strong>Develop</strong> &gt; <strong>Remote</strong> <strong>Access</strong>.</p>
</li>
<li>
<p>In the <strong>Connected</strong> <strong>Apps</strong> section, click <strong>New</strong>. In the next dialog, enter the following items:</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Connected</strong> <strong>App</strong> <strong>Name</strong>; for example, <strong>DirXIdentityConnector</strong></p>
</div>
<div class="paragraph">
<p><strong>API</strong> <strong>Name</strong>; for example, <strong>DirXIdentityConnector</strong></p>
</div>
<div class="paragraph">
<p><strong>Contact</strong> <strong>Email</strong> - your e-mail address</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In <strong>API</strong> <strong>(Enable OAuth Settings)</strong>, select <strong>Enable</strong> <strong>OAuth</strong> <strong>Settings</strong>. Enter the following items:</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Callback</strong> <strong>URL</strong>; for example, <strong><a href="https://localhost:88123/REST-API/callback" class="bare">https://localhost:88123/REST-API/callback</a></strong></p>
</div>
<div class="paragraph">
<p><strong>Selected OAUth Scopes</strong> - select full access (<strong>full</strong>)</p>
</div>
<div class="ulist">
<ul>
<li>
<p>When you click <strong>Save</strong>, you will see the following items in the <strong>API (Enable OAuth Settings)</strong> section:</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Consumer</strong> <strong>Key</strong></p>
</div>
<div class="paragraph">
<p><strong>Consumer</strong> <strong>Secret</strong></p>
</div>
<div class="paragraph">
<p>Now your remote access application has been created. <strong>Consumer</strong> <strong>Key</strong> and <strong>Consumer</strong> <strong>Secret</strong> must be provided in the connected directory for Salesforce as described in "Configuring the Salesforce Workflows".</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_creating_the_statusinfo_c_attribute"><a class="anchor" href="#_ch7_creating_the_statusinfo_c_attribute"></a><a class="link" href="#_ch7_creating_the_statusinfo_c_attribute">7.2.15.1.2. Creating the StatusInfo__c Attribute</a></h6>
<div class="paragraph">
<p>Salesforce users canât be deleted. In the Salesforce system, each user has an IsActive attribute that is set to false if the user is deleted. Furthermore the workflow sets the customer specific attribute StatusInfo__c of the Salesforce user to DELETED. So there is another task before you can run the workflows. You have to create the customer specific attribute StatusInfo_c:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Log in to <strong>Salesforce.com</strong> with your (developer) account and then navigate to <strong>Setup</strong> &gt; <strong>Build</strong> &gt; <strong>Customize</strong> &gt; <strong>Users</strong> &gt; <strong>Fields</strong>.</p>
</li>
<li>
<p>In the section User Custom Fields, click <strong>New</strong>. In the Data Type section, select <strong>Text</strong> and then click <strong>Next</strong>.</p>
</li>
<li>
<p>In <strong>Step 2. Enter the details</strong>, enter the following fields:</p>
<div class="ulist">
<ul>
<li>
<p>Field Label: StatusInfo</p>
</li>
<li>
<p>Length: 16</p>
</li>
<li>
<p>Field Name: StatusInfo</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>and then click <strong>Next</strong>.</p>
</div>
</li>
<li>
<p>In <strong>Step 3. Establish field level security</strong>, select the <strong>Visible</strong> field and then click <strong>Next</strong>.</p>
</li>
<li>
<p>In <strong>Step 4. Add to page layouts</strong>, the <strong>Add</strong> field and <strong>User</strong> <strong>Layout</strong> should already be selected. If they are not selected, select them, and then click <strong>Save</strong>. You will see the User Custom Fields again and you will see the new attribute <strong>StatusInfo</strong> with its internal API name <strong>StatusInfo__c</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The internal name StatusInfo__c is used in the account-channel mapping and in the account-channel Export section as a filter. If you want to use another Salesforce attribute, you must change the account-channel mapping and the account-channel Export section.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_salesforce_workflow_limitations"><a class="anchor" href="#_ch7_salesforce_workflow_limitations"></a><a class="link" href="#_ch7_salesforce_workflow_limitations">7.2.15.1.3. Salesforce Workflow Limitations</a></h6>
<div class="paragraph">
<p>The following limitations apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Currently, only Salesforce users and profiles are synchronized.</p>
</li>
<li>
<p>A Salesforce user can only hold one value in the <strong>ProfileId</strong> attribute. Consequently, you can only assign one group (=Salesforce Profile) to a DirX Identity account.</p>
</li>
<li>
<p>Salesforce users can&#8217;t be deleted. In the Salesforce system, each user has an <strong>IsActive</strong> attribute that is set to <strong>false</strong> if the user is deleted. Furthermore the workflow sets the customer-specific attribute <strong>StatusInfo<em>c</strong> of the Salesforce user to DELETED, as described in "Creating the StatusInfo</em>c Attribute". When you remove a group from an Identity Store user, the account is normally disabled. At the account (which also received the state DISABLED), you normally no longer see the assigned group in the Member of tab.<br>
<br>
The Salesforce workflows have a different behavior concerning the deletion of groups. The <strong>ProfileId</strong> attribute (which represents the assigned group) can&#8217;t be deleted at the Salesforce user. Thus, when synchronizing back to the Identity Store, the <strong>ProfileId</strong> is still returned in the search result and so, when applying the mapping for the <strong>dxrGroupMemberDelete</strong> attribute, the value doesn&#8217;t change (will not be deleted). As a result, you will always see the group (<strong>ProfileId</strong>) with the state DELETE in the Member of tab of the account.</p>
</li>
<li>
<p>Salesforce profiles can&#8217;t be created/deleted using the Salesforce connector. As a result, you must run the <strong>Validate_Salesforce_Realtime</strong> workflow as the first action once you have set up your environment. When doing so, the Salesforce profiles are created as groups in the Identity Store. From now on, you can assign one of these groups to your Identity Store users.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_configuring_the_salesforce_workflows"><a class="anchor" href="#_ch7_configuring_the_salesforce_workflows"></a><a class="link" href="#_ch7_configuring_the_salesforce_workflows">7.2.15.2. Configuring the Salesforce Workflows</a></h5>
<div class="paragraph">
<p>To configure the connection to Salesforce:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Specify the <strong>IP</strong> <strong>Address</strong> in the Salesforce service object; for example, <strong>login.salesforce.com</strong>. Check the <strong>SSL</strong> flag. No <strong>Ports</strong> are required.</p>
</li>
<li>
<p>Set up the bind credentials of the connected directory that represents the Salesforce system. Use a Salesforce user with sufficient rights. Enter <strong>Name</strong>, <strong>Password</strong> and <strong>Security</strong> <strong>Token</strong> (which you normally receive as e-mail from Salesforce, if you registered for the first time or if you changed your password).</p>
</li>
<li>
<p>Set up the following items in your Salesforce connected directory (in the Salesforce tab):</p>
</li>
<li>
<p><strong>URL-Suffixes</strong>:</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For connecting to the Salesforce system using OAuth, enter:</p>
</div>
<div class="paragraph">
<p><strong>/services/oauth2/token</strong></p>
</div>
<div class="paragraph">
<p>For performing search and updates requests, enter the Salesforce API version you want to use. For example:</p>
</div>
<div class="paragraph">
<p><strong>/services/data/v30.0</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Consumer</strong> <strong>Key</strong> - enter the consumer key of your remote access application.</p>
</li>
<li>
<p><strong>Consumer</strong> <strong>Secret</strong> - enter the consumer secret of your remote access application.</p>
</li>
<li>
<p>Set up the following items in your Salesforce connected directory, if required (in the HTTP/HTTPS Proxy Server tab):</p>
</li>
<li>
<p>In <strong>Proxy</strong> <strong>Server</strong>, the link to the proxy server modeled as a connected directory object.</p>
</li>
<li>
<p>In <strong>Proxy</strong> <strong>Server</strong> <strong>Bind</strong> <strong>Profile</strong>, the link to the bind profile used by the proxy server.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To configure the Salesforce workflows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Install the schema extensions required by the Salesforce workflows as described in the section "Extending the Schema for the Target System Workflows", selecting the <strong>Salesforce</strong> extensions.</p>
</li>
<li>
<p>Assign the resource family <strong>Salesforce</strong> in the IdS-J server.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_configuring_the_salesforce_target_system"><a class="anchor" href="#_ch7_configuring_the_salesforce_target_system"></a><a class="link" href="#_ch7_configuring_the_salesforce_target_system">7.2.15.3. Configuring the Salesforce Target System</a></h5>
<div class="paragraph">
<p>The Salesforce target system requires the following layout:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Accounts - all accounts (Salesforce users) are located in a subfolder <strong>Accounts</strong>.</p>
</li>
<li>
<p>Groups - all groups (Salesforce profiles) are located in a subfolder <strong>Groups</strong>.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_salesforce_workflow_and_activities"><a class="anchor" href="#_ch7_salesforce_workflow_and_activities"></a><a class="link" href="#_ch7_salesforce_workflow_and_activities">7.2.15.4. Salesforce Workflow and Activities</a></h5>
<div class="paragraph">
<p>The Salesforce users and profiles are synchronized via a pair of channels (one channel per direction). The membership in Identity (Salesforce attribute ProfileId) is stored on accounts. See the default Salesforce workflow for details.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_salesforce_workflow_ports"><a class="anchor" href="#_ch7_salesforce_workflow_ports"></a><a class="link" href="#_ch7_salesforce_workflow_ports">7.2.15.5. Salesforce Workflow Ports</a></h5>
<div class="paragraph">
<p>This section describes the Salesforce workflow ports.</p>
</div>
<div class="paragraph">
<p>TS Port</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>CF -</strong> <strong>Crypt</strong> <strong>Filter</strong><br>
A Salesforce crypt filter is implicitly configured. It is used to send the decrypted password attribute Password to the Salesforce system.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_account_channel_mapping_for_sf_users"><a class="anchor" href="#_ch7_account_channel_mapping_for_sf_users"></a><a class="link" href="#_ch7_account_channel_mapping_for_sf_users">7.2.15.6. Account-Channel Mapping for SF Users</a></h5>
<div class="paragraph">
<p>In the Account channel mapping, many LDAP attributes are mapped one-to-one to Salesforce attributes. The following attributes receive special handling:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>EmailEncodingKey, LanguageLocaleKey, LocaleSidKey, TimeZoneKey - these mandatory attributes are generated via a Java Source mapping, but only for an ADD operation. The attributes are not stored in the Identity Store. In the Java Source mapping, either the LDAP attribute <strong>language</strong> or <strong>c</strong> is evaluated.</p>
</li>
<li>
<p>Password - remember that the accountâs password is inherited from the user object in Identity Store when you assign a group (=Salesforce profile) to a user (and then implicitly the account is created). If no password is present at the user, the accountâs password is initially set to <strong>dirxdirx1</strong>. Check to make sure that the passwords comply with the password policies in effect for the Salesforce system. If the default password <strong>dirxdirx1</strong> is not useful for your purposes, you need to change the object description for Salesforce (cn=TSAccount.xml,cn=Object Descriptions,cn=Salesforce,cn=TargetSystems,cn=Configuration,cn=&lt;domain&gt;).</p>
</li>
<li>
<p>Email - the <strong>Email</strong> attribute in the Salesforce system is a single-valued attribute; in the Identity Store, the corresponding LDAP <strong>mail</strong> attribute is a recurring attribute. As a result, the Java Source mapping operates as follows:</p>
</li>
<li>
<p>If the attribute is not yet set in the Salesforce system, the value of <strong>mail</strong> that fits best with the attribute <strong>dxrName</strong> is mapped to <strong>Email</strong>. (remember that the <strong>Username</strong> attribute in Salesforce is derived from <strong>dxrName</strong> in the Identity Store, and that <strong>Username</strong> and <strong>Email</strong> in the Salesforce system normally appear to be similar or are even the same.).If none of the values of <strong>mail</strong> matches with <strong>dxrName</strong>, the first value of <strong>mail</strong> is mapped to <strong>Email</strong>.</p>
</li>
<li>
<p>If the value of <strong>Email</strong> is already set in the Salesforce system, this value is retained "as is" if it is available in the <strong>mail</strong> attribute in the Identity Store.</p>
</li>
<li>
<p>If the value of <strong>Email</strong> in the Salesforce system is completely different from the values of <strong>mail</strong> in the Identity Store, the value is generated as if it was not yet set in the Salesforce system.</p>
</li>
<li>
<p>Phone - the <strong>Phone</strong> attribute in the Salesforce system is a single-valued attribute; in the Identity Store, the corresponding LDAP attruibute <strong>telephoneNumber</strong> is a recurring attribute. As a result, the Java Source mapping operates as follows:</p>
</li>
<li>
<p>If the attribute is not yet set in the Salesforce system, the first value of <strong>telephoneNumber</strong> is mapped to <strong>Phone</strong>.</p>
</li>
<li>
<p>If the value of Phone is already set in the Salesforce system, this value is retaiined "as is" if it is available in the <strong>telephoneNumber</strong> attribute in the Identity Store.</p>
</li>
<li>
<p>If the attribute value of <strong>Phone</strong> in the Salesforce system is completely different from the values of <strong>telephoneNumber</strong> in the Identity Store, the first value of <strong>telephoneNumber</strong> is mapped to <strong>Phone</strong>.</p>
</li>
<li>
<p>StatusInfo<em>c - the customer-specific attribute <strong>StatusInfo</em>c</strong> is set to DELETED if the corresponding <strong>dxrState</strong> attribute in the Identity Store is set to DISABLED or DELETED.</p>
</li>
<li>
<p>IsActive - the <strong>IsActive</strong> attribute is set to <strong>true</strong> if the corresponding dxrState attribute in the Identity Store is set to DISABLED or DELETED.</p>
</li>
<li>
<p>When a new account is created by assigning a Salesforce group to a user in Identity Store.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_group_channel_mapping_for_sf_permissionsets"><a class="anchor" href="#_ch7_group_channel_mapping_for_sf_permissionsets"></a><a class="link" href="#_ch7_group_channel_mapping_for_sf_permissionsets">7.2.15.7. Group-Channel Mapping for SF PermissionSets</a></h5>
<div class="paragraph">
<p>Mappings are defined for the Salesforce attributes <strong>Name</strong>, <strong>Description</strong>, <strong>LicenseId</strong> and <strong>ProfileId</strong>. However, because SF PermissionSets cannot be added, modified or deleted, you should avoid making changes to the groups in Identity Store. (Note that these mappings are only present to define the set of attributes that is read when synchronizing from Salesforce to Identity Store.) Make the changes in Salesforce and then run the <strong>Validate_Salesforce_Realtime</strong> workflow to update the groups in the Identity Store.</p>
</div>
<div class="paragraph">
<p>Many attributes are simply mapped one to one or comparable attribute names are mapped (for example, <strong>Name</strong> to <strong>cn</strong>).</p>
</div>
<div class="paragraph">
<p>The <strong>dxrPrimaryKey</strong> attribute of groups contains the identifier (the <strong>Id</strong> attribute in Salesforce) of the Salesforce profile objects. The <strong>dxrName</strong> attribute contains the Salesforce <strong>Name</strong> attribute.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_group_channel_mapping_for_sf_profiles"><a class="anchor" href="#_ch7_group_channel_mapping_for_sf_profiles"></a><a class="link" href="#_ch7_group_channel_mapping_for_sf_profiles">7.2.15.8. Group-Channel Mapping for SF Profiles</a></h5>
<div class="paragraph">
<p>Mappings are defined for the Salesforce attributes <strong>Name</strong>, <strong>Description</strong>, <strong>UserLicenseId</strong> and <strong>UserType</strong>. However, because Salesforce profiles cannot be added, modified or deleted, you should avoid making changes to the groups in Identity Store. (Note that these mappings are only present to define the set of attributes that is read when synchronizing from Salesforce to Identity Store.) Make the changes in Salesforce and then run the <strong>Validate_Salesforce_Realtime</strong> workflow to update the groups in the Identity Store.</p>
</div>
<div class="paragraph">
<p>Many attributes are simply mapped one to one or comparable attribute names are mapped (for example, <strong>Name</strong> to <strong>cn</strong>).</p>
</div>
<div class="paragraph">
<p>The <strong>dxrPrimaryKey</strong> attribute of groups contains the identifier (the <strong>Id</strong> attribute in Salesforce) of the Salesforce profile objects. The <strong>dxrName</strong> attribute contains the Salesforce <strong>Name</strong> attribute.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_channel_mapping_for_sf_accounts"><a class="anchor" href="#_ch7_channel_mapping_for_sf_accounts"></a><a class="link" href="#_ch7_channel_mapping_for_sf_accounts">7.2.15.9. Channel Mapping for SF Accounts</a></h5>
<div class="paragraph">
<p>Mappings are defined for the Salesforce attributes <strong>Name</strong>, <strong>Description</strong>, <strong>LicenseId</strong> and <strong>ProfileId</strong>. However, because SF PermissionSets cannot be added, modified or deleted, you should avoid making changes to the groups in Identity Store. (Note that these mappings are only present to define the set of attributes that is read when synchronizing from Salesforce to Identity Store.) Make the changes in Salesforce and then run the <strong>Validate_Salesforce_Realtime</strong> workflow to update the groups in the Identity Store.</p>
</div>
<div class="paragraph">
<p>Many attributes are simply mapped one to one or comparable attribute names are mapped (for example, <strong>Name</strong> to <strong>cn</strong>).</p>
</div>
<div class="paragraph">
<p>The <strong>dxrPrimaryKey</strong> attribute of SF Accounts contains the identifier (the <strong>Id</strong> attribute in Salesforce) of the SF Accounts objects. The <strong>dxrName</strong> attribute contains the Salesforce <strong>Name</strong> attribute.</p>
</div>
<div class="paragraph">
<p>When creating an SF Account in Identity Store, take the following steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Set the attribute âProvision To Salesforceâ; if it is not set, the SF Account is not synchronized to Salesforce.</p>
</li>
<li>
<p>Assign an âOwnerâ in the âOwner Informationâ section; note that the âOwner Idâ is automatically set when assigning the âOwnerâ.</p>
</li>
<li>
<p>Set additional attributes.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that the BO organization in Identity Store that you just created is renamed by the workflow and the <strong>cn</strong> then holds the <strong>id</strong> attribute of the new SF Account in Salesforce.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_channel_mapping_for_sf_contacts"><a class="anchor" href="#_ch7_channel_mapping_for_sf_contacts"></a><a class="link" href="#_ch7_channel_mapping_for_sf_contacts">7.2.15.10. Channel Mapping for SF Contacts</a></h5>
<div class="paragraph">
<p>Many attributes are simply mapped one to one or comparable attribute names are mapped (for example, <strong>dxmSLSFwebSite</strong> to <strong>cn</strong>).</p>
</div>
<div class="paragraph">
<p>The <strong>dxrPrimaryKey</strong> attribute contains the identifier (the <strong>Id</strong> attribute in Salesforce) of the SF Contact objects. The <strong>dxrName</strong> attribute contains the <strong>Salesforce</strong> <strong>Name</strong> attribute.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_member_channel_mapping_for_sf_users"><a class="anchor" href="#_ch7_member_channel_mapping_for_sf_users"></a><a class="link" href="#_ch7_member_channel_mapping_for_sf_users">7.2.15.11. Member-Channel Mapping for SF Users</a></h5>
<div class="paragraph">
<p>The member channel mapping for <strong>PermissionSetId</strong> (which contains both the Ids for the SF Profile and the SF PermissionSets) sets the attribute <strong>ProfileId</strong> in Salesforce when assigning groups to a user in Identity Store. It also creates/updates/removes the internal Salesforce Permission Set assignment.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_setpassword_channel_mapping_for_sf_users"><a class="anchor" href="#_ch7_setpassword_channel_mapping_for_sf_users"></a><a class="link" href="#_ch7_setpassword_channel_mapping_for_sf_users">7.2.15.12. SetPassword-Channel Mapping for SF Users</a></h5>
<div class="paragraph">
<p>Password changes in the Identity Store (in the LDAP attribute <strong>dxmPassword</strong>) are transferred as a modification of the pseudo-attribute <strong>Password</strong>. An additional modification request is also sent to the Salesforce system to reset the userâs password.</p>
</div>
<div class="paragraph">
<p>When you subsequently log in to Salesforce, the system asks you to enter a security question with its answer. On this Web page, you need to enter the new password (and the security question/answer); but you donât need to change the password again.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_account_channel_mapping_for_identity_store_accounts"><a class="anchor" href="#_ch7_account_channel_mapping_for_identity_store_accounts"></a><a class="link" href="#_ch7_account_channel_mapping_for_identity_store_accounts">7.2.15.13. Account-Channel Mapping for Identity Store Accounts</a></h5>
<div class="paragraph">
<p>Many attributes are simply mapped one-to-one or comparable attribute names are mapped (for example, <strong>CompanyName</strong> to <strong>o</strong>).</p>
</div>
<div class="paragraph">
<p>The <strong>dxrPrimaryKey</strong> attribute of accounts contains the identifier (the <strong>Id</strong> attribute in Salesforce) of the Salesforce user object. The attribute <strong>dxrName</strong> contains the Salesforce <strong>Username</strong>.</p>
</div>
<div class="paragraph">
<p>Remember, too, that for most of the attributes, the <strong>onAddOnly</strong> flag is set in the mapping because the assumption is that the Identity Store holds the master data and thus the Identity Store will never be overwritten with updates from Salesforce.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_group_channel_mapping_for_identity_store_profiles"><a class="anchor" href="#_ch7_group_channel_mapping_for_identity_store_profiles"></a><a class="link" href="#_ch7_group_channel_mapping_for_identity_store_profiles">7.2.15.14. Group-Channel Mapping for Identity Store Profiles</a></h5>
<div class="paragraph">
<p>Many attributes are simply mapped one-to-one or comparable attribute names are mapped (for example, <strong>UserLicenseId</strong> to <strong>dxmSLSFuserLicenseId</strong>).</p>
</div>
<div class="paragraph">
<p>The <strong>dxrPrimaryKey</strong> attribute of accounts contains the identifier (the <strong>Id</strong> attribute in Salesforce) of the SF Profile object. The attribute <strong>dxrName</strong> contains the Salesforce <strong>Name</strong>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_group_channel_mapping_for_identity_store_permissionsets"><a class="anchor" href="#_ch7_group_channel_mapping_for_identity_store_permissionsets"></a><a class="link" href="#_ch7_group_channel_mapping_for_identity_store_permissionsets">7.2.15.15. Group-Channel Mapping for Identity Store PermissionSets</a></h5>
<div class="paragraph">
<p>Many attributes are simply mapped one-to-one or comparable attribute names are mapped (for example, <strong>LicenseId</strong> to <strong>dxmSLSFuserLicenseId</strong>).</p>
</div>
<div class="paragraph">
<p>The <strong>dxrPrimaryKey</strong> attribute of accounts contains the identifier (the <strong>Id</strong> attribute in Salesforce) of the SF PermissionSet object. The attribute <strong>dxrName</strong> contains the Salesforce <strong>Name</strong>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_channel_mapping_for_identity_store_organizations_sf_accounts"><a class="anchor" href="#_ch7_channel_mapping_for_identity_store_organizations_sf_accounts"></a><a class="link" href="#_ch7_channel_mapping_for_identity_store_organizations_sf_accounts">7.2.15.16. Channel Mapping for Identity Store Organizations (SF Accounts)</a></h5>
<div class="paragraph">
<p>Many attributes are simply mapped one-to-one or comparable attribute names are mapped (for example, <strong>Fax</strong> to <strong>facsimileTelephoneNumber</strong>). Note that the schema maps the Salesforce attributes to attributes in the Identity Store using the same name and the prefix <strong>dxmSLSF</strong>; for example, <strong>Site</strong> is mapped to <strong>dxmSLSFsite</strong>.</p>
</div>
<div class="paragraph">
<p>The <strong>dxrPrimaryKey</strong> attribute contains the identifier (the <strong>Id</strong> attribute in Salesforce) of the SF Account object. The attribute <strong>dxrName</strong> contains the Salesforce <strong>Name</strong>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_channel_mapping_for_identity_store_users_sf_contacts"><a class="anchor" href="#_ch7_channel_mapping_for_identity_store_users_sf_contacts"></a><a class="link" href="#_ch7_channel_mapping_for_identity_store_users_sf_contacts">7.2.15.17. Channel Mapping for Identity Store Users (SF Contacts)</a></h5>
<div class="paragraph">
<p>Many attributes are simply mapped one-to-one or comparable attribute names are mapped (for example, <strong>MobilePhone</strong> to <strong>mobile</strong>). Note that the schema maps the Salesforce attributes to attributes in the Identity Store using the same name and the prefix <strong>dxmSLSF</strong>; for example, <strong>OtherPhone</strong> is mapped to <strong>dxmSLSFotherPhone</strong>.</p>
</div>
<div class="paragraph">
<p>The <strong>dxrPrimaryKey</strong> attribute contains the identifier (the <strong>Id</strong> attribute in Salesforce) of the SF Contact object. The attribute <strong>dxrName</strong> contains the Salesforce <strong>Name</strong>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch7_sap_ecc_r3_um_workflows"><a class="anchor" href="#_ch7_sap_ecc_r3_um_workflows"></a><a class="link" href="#_ch7_sap_ecc_r3_um_workflows">7.2.16. SAP ECC (R/3) UM Workflows</a></h4>
<div class="paragraph">
<p>The SAP ECC (formerly R/3) UM Provisioning workflows synchronize data between a target system of type SAPR3UM in the Identity Store and the corresponding connected SAP ECC system. In the following sections, R/3 is synonymous with ECC.</p>
</div>
<div class="paragraph">
<p>The SAP R/3 UM connector used in the workflows communicates with the SAP R/3 system across the SAP Java connector JCo.</p>
</div>
<div class="paragraph">
<p>The following figure illustrates the SAP R/3 UM workflow architecture.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch7_targetWFs/image29.png" alt="SAP R/3 UM Workflow Architecture">
</div>
<div class="title">Figure 105. SAP R/3 UM Workflow Architecture</div>
</div>
<div class="paragraph">
<p>The validation, synchronization and password workflows allow you to synchronize DirX Identity account and group objects with SAP R/3 user, role and profile objects.</p>
</div>
<div class="sect4">
<h5 id="_ch7_sap_r3_um_workflow_prerequisites_and_limitations"><a class="anchor" href="#_ch7_sap_r3_um_workflow_prerequisites_and_limitations"></a><a class="link" href="#_ch7_sap_r3_um_workflow_prerequisites_and_limitations">7.2.16.1. SAP R/3 UM Workflow Prerequisites and Limitations</a></h5>
<div class="paragraph">
<p>The SAP R/3 UM workflows have the following prerequisites and limitations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The SAP Java Connector JCo must be installed on the machine where the SAP R/3 UM connector runs. It can be downloaded free of charge from the SAP Web pages.</p>
</li>
<li>
<p>Roles and profiles are not allowed to be created in SAP R/3 by the underlying SAP BAPI interfaces, so the synchronization workflows can only modify user-SAP role or user-SAP profile assignments.</p>
</li>
<li>
<p>Before you can use the workflows, you must extend the DirX Identity Store schema with SAP R/3 UM target system-specific attributes and object classes so that the workflows can store SAP R/3 UM-specific information in the Identity Store. For instructions, see the section "Extending the Schema for the Target System Workflows".</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_configuring_the_sap_r3_um_target_system"><a class="anchor" href="#_ch7_configuring_the_sap_r3_um_target_system"></a><a class="link" href="#_ch7_configuring_the_sap_r3_um_target_system">7.2.16.2. Configuring the SAP R/3 UM Target System</a></h5>
<div class="paragraph">
<p>This section provides information about SAP R/3 UM target system configuration.</p>
</div>
<div class="paragraph">
<p>Connectivity View</p>
</div>
<div class="paragraph">
<p>Configure the SAPR3UM connected directory with the connected directory configuration wizard from the Global View target real-time scenario. You are guided through the steps. The main configuration tasks are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Specify the IP address or host name of the SAP R/3 UM service object (SAP application server).</p>
</li>
<li>
<p>Specify username and password in the bind profile.</p>
</li>
<li>
<p>Specify account and group base of the target system in provisioning.</p>
</li>
<li>
<p>Specify the values on the parameters page, mainly client Id, system number and whether you work with a CUA enabled system or not.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Provisioning View</p>
</div>
<div class="paragraph">
<p>When creating the account, the attribute <strong>dxrName</strong> is created with a target system-wide unique value. You can see this in the <strong>tsaccount.xml</strong> object description. Also the attribute <strong>sapUsername</strong> is filled with this value. <strong>sapUsername</strong> is used for generating the identifier passed to the SAP R/3 connector when synchronizing the account to the SAP R/3 connected system. In the DirX Identity direction, the <strong>dxrName</strong> attribute is used for joining.</p>
</div>
<div class="paragraph">
<p>In the SAP R/3 UM target system, the members are referenced from the account objects. The reference attribute is the <strong>cn</strong> attribute of the groups. Also in the connected SAP R/3 system the memberships are held by the accounts.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_sap_r3_um_workflow_and_activities"><a class="anchor" href="#_ch7_sap_r3_um_workflow_and_activities"></a><a class="link" href="#_ch7_sap_r3_um_workflow_and_activities">7.2.16.3. SAP R/3 UM Workflow and Activities</a></h5>
<div class="paragraph">
<p>The following figure shows the layout of the channels that are used by the join activity.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch7_targetWFs/image30.png" alt="SAP R/3 UM Workflow Channels and Objects">
</div>
<div class="title">Figure 106. SAP R/3 UM Workflow Channels and Objects</div>
</div>
<div class="paragraph">
<p>As the figure shows, there is a pair of channels between accounts, groups and members on each side. The members are linked to the accounts on both sides, so there is no cross channel relationship.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_sap_r3_um_workflow_ports"><a class="anchor" href="#_ch7_sap_r3_um_workflow_ports"></a><a class="link" href="#_ch7_sap_r3_um_workflow_ports">7.2.16.4. SAP R/3 UM Workflow Ports</a></h5>
<div class="paragraph">
<p>This section describes SAP R/3 UM workflow ports.</p>
</div>
<div class="paragraph">
<p>TS Port</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>CF - Crypt Filter</strong><br>
The configured crypt filter is used to send the password attribute PASSWORD.BAPIPWD decrypted to the SAP R/3 system.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_sap_r3_um_workflow_channels"><a class="anchor" href="#_ch7_sap_r3_um_workflow_channels"></a><a class="link" href="#_ch7_sap_r3_um_workflow_channels">7.2.16.5. SAP R/3 UM Workflow Channels</a></h5>
<div class="paragraph">
<p>This section provides information about SAP R/3 UM workflow channels.</p>
</div>
<div class="sect5">
<h6 id="_ch7_common_aspects_5"><a class="anchor" href="#_ch7_common_aspects_5"></a><a class="link" href="#_ch7_common_aspects_5">7.2.16.5.1. Common Aspects</a></h6>
<div class="paragraph">
<p>Master attributes</p>
</div>
<div class="paragraph">
<p>Almost all attributes except a few special ones like dxrTSState are mastered by DirX Identity. Consequently, in the mapping direction to DirX Identity, these attributes have set the <strong>OnAddOnly</strong> flag and in the target system direction this flag is not set.</p>
</div>
<div class="paragraph">
<p>However, some attributes cannot be changed for single users through the mapping. Those attributes, for example ADDRESS.STREET, are linked to an extra table for a certain group of users, where they are set by the SAP R/3 administrator.</p>
</div>
<div class="paragraph">
<p>CUA- or non CUA system</p>
</div>
<div class="paragraph">
<p>The workflow does not need to be adapted depending on whether or not the connected system is a CUA (Central User Administration) system. The workflow mappings and post-mappings handle the difference transparently.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_accounts_3"><a class="anchor" href="#_ch7_accounts_3"></a><a class="link" href="#_ch7_accounts_3">7.2.16.5.2. Accounts</a></h6>
<div class="paragraph">
<p>Direction: Identity &#8594; Connected System</p>
</div>
<div class="paragraph">
<p>The attribute <strong>dxrTSState</strong> is a pseudo attribute of the SAP R/3 connector. That is it is not passed to the SAP R/3 system as an attribute, but is interpreted by the connector, which performs the corresponding actions depending on the values <strong>ENABLED</strong>, <strong>DISABLED</strong> or <strong>DELETED</strong>.</p>
</div>
<div class="paragraph">
<p>Direction: Connected System &#8594; Identity</p>
</div>
<div class="paragraph">
<p>The attributes <strong>ISLOCKED.LOCAL_LOCK</strong> and <strong>ISLOCKED.GLOB_LOCK</strong>, which are set depending on whether a CUA or non-CUA system is connected, are read from the SAP R/3 connected system and converted by the <strong>dxrTSState</strong> Java mapping to the corresponding states in DirX Identity.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_groups_3"><a class="anchor" href="#_ch7_groups_3"></a><a class="link" href="#_ch7_groups_3">7.2.16.5.3. Groups</a></h6>
<div class="paragraph">
<p>Direction: Identity &#8594; Connected System</p>
</div>
<div class="paragraph">
<p>The group mapping only results in modifications to the corresponding role in SAP R/3 because roles and profiles are not allowed to be created in SAP R/3 via an interface. Add operations are rejected by the SAP R/3 connector.</p>
</div>
<div class="paragraph">
<p>Direction: Connected System &#8594; Identity</p>
</div>
<div class="paragraph">
<p>The mapping, the export filters and the join filters of the group channels are configured to synchronize SAP R/3 roles - not profiles - to Identity groups.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_memberships"><a class="anchor" href="#_ch7_memberships"></a><a class="link" href="#_ch7_memberships">7.2.16.5.4. Memberships</a></h6>
<div class="paragraph">
<p>In both systems, DirX Identity and SAP R/3, accounts hold the memberships. Therefore, no cross-channel relationship is required.</p>
</div>
<div class="paragraph">
<p>Direction: Identity &#8594; Connected System</p>
</div>
<div class="paragraph">
<p>Post-Mapping</p>
</div>
<div class="paragraph">
<p>If a non-CUA system is connected, the target attribute <strong>ACTIVITYGROUPS.AGR_NAME</strong> must be mapped. If a CUA system is connected, the attribute <strong>dxrRole.NAME</strong> must be set. This action is handled in the Java PostMapping, which must have access to both attributes.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_password_channel_7"><a class="anchor" href="#_ch7_password_channel_7"></a><a class="link" href="#_ch7_password_channel_7">7.2.16.5.5. Password Channel</a></h6>
<div class="paragraph">
<p>The target systems password attribute <strong>PASSWORD.BAPIPWD</strong> is updated with the current password of the account in DirX Identity contained in the attribute <strong>dxmPassword</strong>. The <strong>dxrPwdReset</strong> attribute of the SAP R/3 connector, which determines whether the user must change the password on the next login, is set depending on the source attribute <strong>dxmPasswordExpired</strong>. This attribute was set beforehand by the Password Event Manager workflow listening for requests of Web Center or Password Listener.</p>
</div>
<div class="paragraph">
<p>A Password Channel can also be configured backwards from the Connected System to Identity to be able to update some attributes in Identity after a password change or reset has taken place in the Connected System. The join engine then as usual synchronizes the attributes specified in the corresponding Password Channel Mapping to Identity after the account with its password relevant attributes was updated in the Connected System.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_customizing_the_sap_r3_um_workflows"><a class="anchor" href="#_ch7_customizing_the_sap_r3_um_workflows"></a><a class="link" href="#_ch7_customizing_the_sap_r3_um_workflows">7.2.16.6. Customizing the SAP R/3 UM Workflows</a></h5>
<div class="paragraph">
<p>The workflows can be customized to synchronize SAP R/3 profiles instead of SAP R/3 roles. To make this customization:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Set up a corresponding object structure on the Identity side.</p>
</li>
<li>
<p>Specify the prefix "PROFILE:" instead of "ROLE:" in the workflows export filter and identifier mapping of the group channel.</p>
</li>
<li>
<p>Specify the corresponding member attributes in the membership mapping.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch7_service_management_workflows"><a class="anchor" href="#_ch7_service_management_workflows"></a><a class="link" href="#_ch7_service_management_workflows">7.2.17. Service Management Workflows</a></h4>
<div class="paragraph">
<p>The Service Management Provisioning workflows operate between a target system of type <strong>RequestWorkflow</strong> in the Identity Store and the external offline system. Instead of direct provisioning, the Java-based workflows start a corresponding request workflow instance for each provisioning action via the DirX Identity Request Workflow Services. This model assumes that there is an acting administrator who receives tasks via request workflow approval activities. He performs manual provisioning and then approves the task.</p>
</div>
<div class="paragraph">
<p>For more information about manual provisioning, read the corresponding section in the <em>DirX Identity Use Case Document</em> "DXI Service Management".</p>
</div>
<div class="paragraph">
<p>The workflows handle these common objects:</p>
</div>
<div class="paragraph">
<p><strong>Account</strong> - the account represents a common account in a target system. It represents any account-like object in the real (offline) system.</p>
</div>
<div class="paragraph">
<p><strong>Group</strong> - the group represents a common group in a target system. It represents any group-like object in the real (offline) system.</p>
</div>
<div class="paragraph">
<p>The delivered workflows are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Ident_SvcMgmt_Realtime</strong> - the synchronization one-way workflow that exports detected changes for account or group objects from DirX Identity to the Workflow Service, which creates the appropriate request workflow instances.</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="_ch7_service_management_workflow_prerequisites_and_limitations"><a class="anchor" href="#_ch7_service_management_workflow_prerequisites_and_limitations"></a><a class="link" href="#_ch7_service_management_workflow_prerequisites_and_limitations">7.2.17.1. Service Management Workflow Prerequisites and Limitations</a></h5>
<div class="paragraph">
<p>The Connectivity workflow does not update the entries in the external offline system directly. It only invokes a special request workflow that contains tasks for a human administrator. This means that there is no direct provisioning to the offline system.</p>
</div>
<div class="paragraph">
<p>In this scenario, password management does not make sense because the administrator would see all user passwords.</p>
</div>
<div class="paragraph">
<p>The scenario does not comprise initial load or validation workflows. Such workflows must be built as project-specific solutions; for example, via files.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_configuring_service_management_workflows"><a class="anchor" href="#_ch7_configuring_service_management_workflows"></a><a class="link" href="#_ch7_configuring_service_management_workflows">7.2.17.2. Configuring Service Management Workflows</a></h5>
<div class="paragraph">
<p>To configure the Service Management workflows, use the connected directory and workflow wizards.</p>
</div>
<div class="paragraph">
<p>Connected Directory Wizard</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Open the connected directory wizard and open the <strong>Service</strong> object.</p>
</li>
<li>
<p>Specify the <strong>IP Address</strong> of the host where the DirX Identity Request Workflow Service runs. This is the Java-based Server that is configured for the domain.<br>
DirX Identity is typically configured to accept SOAP requests for request workflow management on the pre-configured unsecured port 40000 (and on the secured port 40443).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Workflow Wizard</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Open the workflow wizard.</p>
</li>
<li>
<p>Click the <strong>Join Activity General Info</strong> tab. Here you can configure the timing parameters for the join activity.</p>
</li>
<li>
<p>Click the <strong>Request Workflows Settings</strong> tab. Here you can configure the <strong>URL Path</strong> and <strong>Socket Timeout</strong> at the target system port of the appropriate workflow object.</p>
</li>
<li>
<p>The <strong>URL Path</strong> of the Workflow Service is pre-configured to the default value <strong>workflowService/services/WorkflowService</strong>. Do not change this setting.</p>
</li>
<li>
<p>Set the timeout value (in seconds) in <strong>Socket Timeout</strong> if necessary.</p>
</li>
<li>
<p>Enter LDAP name of the provisioning domain into the optional <strong>Domain</strong> property. It enables the Java-based Server to identify if the request is for the correct domain.</p>
</li>
<li>
<p><strong>Primary Workflow DN</strong> is the valid DN of the active request workflow definition, which will be used for handling the generated requests. The primary workflow will always be invoked for account objects if configured. It will also be used for group objects if the <strong>Secondary Workflow DN</strong> is not set. Secondary workflow can be configured only for handling the group objects. The secondary workflow configuration is valid only if the primary workflow is also configured. If both primary and secondary workflow configurations are not set, the Workflow Service will try to find a suitable request workflow definition according to its <strong>When Applicable</strong> settings. It is recommended to configure at least a primary workflow. Remember that using a single request workflow definition requires an implementation that can handle two different object types.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_configuring_the_service_management_target_system"><a class="anchor" href="#_ch7_configuring_the_service_management_target_system"></a><a class="link" href="#_ch7_configuring_the_service_management_target_system">7.2.17.3. Configuring the Service Management Target System</a></h5>
<div class="paragraph">
<p>A service management target system requires the following layout:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Accounts</strong> - in the DirX Identity target system, a corresponding account object exists for every account in the external offline system. All accounts are located in the subfolder <strong>Accounts</strong>.</p>
</li>
<li>
<p><strong>Groups</strong> - in the DirX Identity target system, a corresponding group object exists for every group in the external offline system. All groups are located in the subfolder <strong>Groups</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The attribute <strong>dxrPrimaryKey</strong> has a special meaning. It stores the identification of the account or group object in the offline system. It is also a description that should be well-understood by an administrator performing the manual operation in the offline system. The slight modification of the object descriptions for account and group objects in the Provisioning configuration may be necessary in order to satisfy this goal.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_service_management_workflows_and_activities"><a class="anchor" href="#_ch7_service_management_workflows_and_activities"></a><a class="link" href="#_ch7_service_management_workflows_and_activities">7.2.17.4. Service Management Workflows and Activities</a></h5>
<div class="paragraph">
<p>The following figure shows the layout of the channels that are used by the join activity:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch7_targetWFs/image31.png" alt="Service Management Channels and Object Types">
</div>
<div class="title">Figure 107. Service Management Channels and Object Types</div>
</div>
<div class="paragraph">
<p>The service management account and group objects are synchronized via a pair of channels. Both channels use the same user hook implementation.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_service_management_workflow_ports"><a class="anchor" href="#_ch7_service_management_workflow_ports"></a><a class="link" href="#_ch7_service_management_workflow_ports">7.2.17.5. Service Management Workflow Ports</a></h5>
<div class="paragraph">
<p>This section describes the Service Management ports.</p>
</div>
<div class="paragraph">
<p>TS Port</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Crypt Filter</strong><br>
a service management filter is configured implicitly. It is pre-configured for custom usage only.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_service_management_workflow_channels"><a class="anchor" href="#_ch7_service_management_workflow_channels"></a><a class="link" href="#_ch7_service_management_workflow_channels">7.2.17.6. Service Management Workflow Channels</a></h5>
<div class="paragraph">
<p>This section provides information about Service Management Workflow channels.</p>
</div>
<div class="sect5">
<h6 id="_ch7_common_aspects_6"><a class="anchor" href="#_ch7_common_aspects_6"></a><a class="link" href="#_ch7_common_aspects_6">7.2.17.6.1. Common Aspects</a></h6>
<div class="paragraph">
<p>Direction: Identity Store &#8594; Service Management</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The workflow uses a special channel user hook implementation. The workflow gets the original SPMLv1 event along with tracked attribute changes initiated by the saved change of an account or a group object. Add or delete events are directly transformed to add or delete types of the mapped SPMLv1 request. A modify event can be transformed to a delete type if the tracked event modifications contain the change of the dxrState attribute with the added value "<strong>DELETED</strong>". Add and modify events always contain a list of changed attributes.<br>
<br>
These event attributes are taken and compared with the list of mapped attributes (channel configuration). The result contains the intersection of the attribute names contained in the event and in the mapped entry. If such an intersection is empty, no request is propagated. The generated request always contains the attribute values taken from the corresponding mapped attribute. Attribute values contained in the event are ignored.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Direction: Service Management &#8594; Identity Store</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The workflow uses the one-way synchronization controller. Therefore no direct updates are possible.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_account_2"><a class="anchor" href="#_ch7_account_2"></a><a class="link" href="#_ch7_account_2">7.2.17.6.2. Account</a></h6>
<div class="paragraph">
<p>Direction: Identity Store &#8594; Service Management</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ID: <strong>${source.id}</strong></p>
</li>
<li>
<p>Join: is not applicable since the connector always returns an empty result.</p>
</li>
<li>
<p>State attribute: <strong>dxrState</strong></p>
</li>
<li>
<p>The user hook handles the events along with the mapped entries; see "Common Aspects".</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_group_2"><a class="anchor" href="#_ch7_group_2"></a><a class="link" href="#_ch7_group_2">7.2.17.6.3. Group</a></h6>
<div class="paragraph">
<p>Direction: Identity Store &#8594; Service Management</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ID: <strong>${source.id}</strong></p>
</li>
<li>
<p>Join: is not applicable since the connector always returns an empty result.</p>
</li>
<li>
<p>State attribute: <strong>dxrState</strong></p>
</li>
<li>
<p>The user hook handles the events along with the mapped entries; see "Common Aspects".</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch7_sharepoint_workflows"><a class="anchor" href="#_ch7_sharepoint_workflows"></a><a class="link" href="#_ch7_sharepoint_workflows">7.2.18. SharePoint Workflows</a></h4>
<div class="paragraph">
<p>The SharePoint Provisioning workflows provision groups and group memberships between a target system of type <strong>SharePoint</strong> in the Identity Store and the corresponding connected SharePoint system. Supported SharePoint systems are SharePoint Server 2007, SharePoint Server 2010, SharePoint Server 2013 and SharePoint Server 2016.</p>
</div>
<div class="paragraph">
<p>Microsoft introduced the claims-based identity model in SharePoint Server 2013. A claim is a piece of identity information, like name, email address, group membership or type of the identity. This model includes that SharePoint group memberships are kept in the form <em>claims-based identity prefixdomain_name\user_name</em>. For instructions on how to configure the SharePoint workflows and the SharePoint target system to correctly provision group memberships, see the sections "Configuring the SharePoint Target System" and "SharePoint Workflow Channels".</p>
</div>
<div class="paragraph">
<p>Because SharePoint uses the accounts from the Active Directory, a corresponding ADS workflow must be configured.</p>
</div>
<div class="paragraph">
<p>The SharePoint workflow&#8217;s join activity uses the LDAP connector to connect to the Identity Store and the SharePoint connector to connect to the SharePoint server.</p>
</div>
<div class="paragraph">
<p>Two default workflows are provided for DirX Identity SharePoint synchronization:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Ident_SharePoint_Realtime_Clustered</strong> - performs synchronization to SharePoint.</p>
</li>
<li>
<p><strong>Validate_SharePoint_Ident_Clustered</strong> - helps to validate the SharePoint connected system with the related DirX Identity target system.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following figure illustrates the SharePoint Provisioning workflow architecture.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch7_targetWFs/image32.png" alt="SharePoint Provisioning Workflow Architecture">
</div>
<div class="title">Figure 108. SharePoint Provisioning Workflow Architecture</div>
</div>
<div class="paragraph">
<p>Data Structures</p>
</div>
<div class="paragraph">
<p>SharePoint is organized into sites. Each site has its own set of groups with a different set of access rights (called roles in SharePoint). SharePoint uses the Windows account names to identify users. Adding an account to a SharePoint group will grant the user the access rights that are attached to the group.</p>
</div>
<div class="paragraph">
<p>Each SharePoint site has its own bind credentials that are related to a bind account.</p>
</div>
<div class="paragraph">
<p>DirX Identity&#8217;s target system cluster feature is used to map this structure to DirX Identity. Each SharePoint site has its counterpart in a DirX Identity target system that is part of a common SharePoint cluster. The advantages of this approach are that only one workflow needs to be configured for use by all the clustered target systems and that clusters support a bind account mechanism. Each target system references one bind account that holds the credentials for the target system connection. This mechanism fits perfectly with the requirement of different bind credentials per site.</p>
</div>
<div class="paragraph">
<p>Since SharePoint uses the Windows Active Directory accounts, account objects are not held in the SharePoint target systems. Each SharePoint target system references the associated Active Directory target systems by a peer target system link.</p>
</div>
<div class="paragraph">
<p>In a group of an Identity SharePoint target system, the members are DN links to the user objects. Special SharePoint user hooks are added to the SharePoint workflows that transform user DNs to account names and vice-versa by evaluating the accounts in the linked peer target system related to the user by the <strong>dxrUserLink</strong> attribute.</p>
</div>
<div class="sect4">
<h5 id="_ch7_sharepoint_workflow_prerequisites_and_limitations"><a class="anchor" href="#_ch7_sharepoint_workflow_prerequisites_and_limitations"></a><a class="link" href="#_ch7_sharepoint_workflow_prerequisites_and_limitations">7.2.18.1. SharePoint Workflow Prerequisites and Limitations</a></h5>
<div class="paragraph">
<p>The SharePoint workflows have the following prerequisites and limitations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Before you can use the workflows, you must extend the DirX Identity Store schema with SharePoint target system-specific attributes and object classes so that the workflows can store SharePoint-specific information in the Identity Store. For instructions, see the section "Extending the Schema for the Target System Workflows".</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_configuring_the_sharepoint_clusters_workflows_and_connection"><a class="anchor" href="#_ch7_configuring_the_sharepoint_clusters_workflows_and_connection"></a><a class="link" href="#_ch7_configuring_the_sharepoint_clusters_workflows_and_connection">7.2.18.2. Configuring the SharePoint Clusters, Workflows and Connection</a></h5>
<div class="paragraph">
<p>Configuring the SharePoint workflows consists of the following steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Setting up SharePoint clustered target systems</p>
</li>
<li>
<p>Setting up the SharePoint workflows</p>
</li>
<li>
<p>Setting up a SharePoint SSL connection</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="_ch7_creating_clustered_sharepoint_target_systems"><a class="anchor" href="#_ch7_creating_clustered_sharepoint_target_systems"></a><a class="link" href="#_ch7_creating_clustered_sharepoint_target_systems">7.2.18.2.1. Creating Clustered SharePoint Target Systems</a></h6>
<div class="paragraph">
<p>To set up a SharePoint cluster in the Identity Manager:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Select the <strong>Provisioning</strong> &#8594; <strong>Target System</strong> view.</p>
</li>
<li>
<p>Select <strong>New</strong> &#8594; <strong>Cluster Container</strong> at the top-level node and create a cluster container. For example, name it <strong>SharePoint</strong>.</p>
</li>
<li>
<p>Select this container, and then select <strong>New Cluster</strong> to create a cluster for your SharePoint server. For example, name it <strong>SharePointServer1</strong>. It shall contain all SharePoint sites as target systems.</p>
</li>
<li>
<p>Select the cluster object, and then select <strong>New Target System</strong> for each site. This action starts the Target System wizard. Note that the wizard does not create Java-based workflows because only one workflow is necessary for a SharePoint cluster (it handles all contained sites). To set up the synchronization and validation workflows, perform the procedure described in "Configuring SharePoint Workflows".</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The result is a structure like this:</p>
</div>
<div class="exampleblock">
<div class="content">
<strong>SharePoint</strong><br>
<strong>SharePointServer1</strong><br>
Site1<br>
Site2<br>
&#8230;&#8203;<br>
<strong>SharePointServer2</strong><br>
Site1<br>
&#8230;&#8203;
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
All target systems use a common configuration tree with common object descriptions. Thus, after you create the first target system, move the configuration container from the target system one level up. Now it is a child of the cluster and lies in parallel with the target system. If you add the next target system to the cluster, the configuration container is automatically omitted.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following configuration steps must be performed at each SharePoint target system:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In the <strong>General</strong> tab, add the links to the related peer target systems. These are the target systems containing the related active directory accounts.</p>
</li>
<li>
<p>In the <strong>Server Connection</strong> tab, enter the URL of the related SharePoint site.</p>
</li>
<li>
<p>In the <strong>Server Connection</strong> tab, edit the bind account. Click <strong>Edit</strong> and enter the bind credentials for the SharePoint site: <em>domain</em>**<em>loginname</em> (for example, *domain1\admin*) and password.</p>
</li>
<li>
<p>Save bind account and target system.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_configuring_sharepoint_workflows"><a class="anchor" href="#_ch7_configuring_sharepoint_workflows"></a><a class="link" href="#_ch7_configuring_sharepoint_workflows">7.2.18.2.2. Configuring SharePoint Workflows</a></h6>
<div class="paragraph">
<p>If you don&#8217;t want to use the Target System wizard to create the SharePoint workflows, you can also:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use the Identity Manager to copy the workflow to your scenario (<strong>Connectivity &#8594; Global View</strong>).</p>
</li>
<li>
<p>Select the copied workflow from the context menu of the workflow line, and then select <strong>Configure</strong>.</p>
</li>
<li>
<p>Check that the <strong>Is applicable for</strong> parameters section is set correctly (for the synchronization workflow only; leave the parameters empty for the validation workflow):</p>
</li>
<li>
<p><strong>Type</strong> - must be set to <strong>SharePoint</strong>.</p>
</li>
<li>
<p><strong>Cluster</strong> - should be set to the <strong>Cluster</strong> field value of the target system objects in your corresponding cluster (<strong>Advanced</strong> tab, Match properties).</p>
</li>
<li>
<p><strong>Domain</strong> - set this field to '*'. This action defines that this workflow runs for all target systems in your target system cluster, which means it runs for all sites in your SharePoint server.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_configuring_sharepoint_ssl_connections"><a class="anchor" href="#_ch7_configuring_sharepoint_ssl_connections"></a><a class="link" href="#_ch7_configuring_sharepoint_ssl_connections">7.2.18.2.3. Configuring SharePoint SSL Connections</a></h6>
<div class="paragraph">
<p>To create an SSL connection to SharePoint:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Create a trust store (a keystore containing the certificate of the trusted root certification authority).</p>
</li>
<li>
<p>Configure SSL in DirX Identity.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Creating the Trust Store</p>
</div>
<div class="paragraph">
<p>The trust store is a Java keystore that is created using the keytool supplied with the Java Runtime Environment. The certificate is obtained by exporting it from the Internet Explorer&#8217;s key store of trusted root certification authorities.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Export the certificate as DER encoded binary X.509 (.CER) to file, for example, <strong>SharePointCa.cer</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To create a Java keystore containing this file, call the Java keytool with the following arguments:</p>
</div>
<div class="paragraph">
<p><strong>keytool -import -alias</strong> <em>alias</em> <strong>-storepass</strong> <em>password</em> <strong>-keystore</strong> <em>keystore_filename</em> <strong>-file</strong> <em>certificate_filename</em></p>
</div>
<div class="paragraph">
<p><em>alias</em> can be randomly chosen, and it must be unique if multiple certificates are stored in the keystore.</p>
</div>
<div class="paragraph">
<p><em>password</em> is the keystore password. It must be entered later on as the trustStorePassword in the DirX Identity target system configuration.</p>
</div>
<div class="paragraph">
<p><em>keystore_filename</em> is the keystore file name. It should have the extension .jks</p>
</div>
<div class="paragraph">
<p><em>certificate_filename</em> denotes the file containing the certificate, with the extension .cer</p>
</div>
<div class="paragraph">
<p>keytool asks if this certificate is trusted. You must answer "Yes" if you want to use this certificate.</p>
</div>
<div class="paragraph">
<p>Here is a sample call:</p>
</div>
<div class="exampleblock">
<div class="content">
<code>keytool -import -alias sharepoint -storepass changeme -keystore SharePointCaCerts.jks -file SharePointCa.cer</code>
</div>
</div>
<div class="paragraph">
<p>This call creates a keystore file <strong>SharePointCaCerts.jks</strong> containing the certificate exported in the first step. It is called a trust store since it contains certificates of trusted authorities.</p>
</div>
<div class="paragraph">
<p>Configuring SSL in DirX Identity</p>
</div>
<div class="paragraph">
<p>Select the DirX Identity target system and choose the <strong>Server Connection</strong> tab. Set the following parameters to set up SSL:</p>
</div>
<div class="paragraph">
<p><strong>Site URL</strong> - set the site URL beginning with <strong>https</strong> and using the secure port (by default, <strong>443</strong>). A sample structure of the URL is<br></p>
</div>
<div class="exampleblock">
<div class="content">
<code><strong>https://</strong><em>server</em><strong>:</strong><em>port</em><strong>/sites/</strong><em>site</em></code>
</div>
</div>
<div class="paragraph">
<p><strong>Path to Trust Store File</strong> - set the fully-qualified path name of the trust store file created in the preceding step.</p>
</div>
<div class="paragraph">
<p><strong>Trust Store Password</strong> - set the trust store password. Note that the password should be scrambled or RSA-encrypted.</p>
</div>
<div class="paragraph">
<p>You must then restart the Java-based Server to apply the changes.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_configuring_the_sharepoint_target_system"><a class="anchor" href="#_ch7_configuring_the_sharepoint_target_system"></a><a class="link" href="#_ch7_configuring_the_sharepoint_target_system">7.2.18.3. Configuring the SharePoint Target System</a></h5>
<div class="paragraph">
<p>Users are not created in SharePoint but are taken from a peer target system. Note that the SharePoint user hook supports multiple peer target system links. If you set multiple links, all accounts a user has in the related target systems are enabled for the SharePoint site.</p>
</div>
<div class="paragraph">
<p>The next sections describe the settings of the target system in more detail.</p>
</div>
<div class="paragraph">
<p>Advanced Settings</p>
</div>
<div class="paragraph">
<p>The match properties Type, Cluster and Domain are part of the event topic that is sent when a group is changed. They are used to select the appropriate workflow and to identify the target system in the workflow:</p>
</div>
<div class="paragraph">
<p><strong>Type</strong> - must contain the fixed value SharePoint (do not change!).</p>
</div>
<div class="paragraph">
<p><strong>Cluster</strong> - should contain the name of your SharePoint server (can be a symbolic name).</p>
</div>
<div class="paragraph">
<p><strong>Domain</strong> - should contain the SharePoint site name.</p>
</div>
<div class="paragraph">
<p>The assignment properties should not be changed. You must check <strong>Enable Realtime Provisioning</strong> to start an event-based workflow for a group change. <strong>Disable Password Sync</strong> should be set because the accounts reside in the Active Directory domain.</p>
</div>
<div class="paragraph">
<p>Server Configuration</p>
</div>
<div class="paragraph">
<p>This tab allows setting the URL. It contains the host address and the port.<br></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Normally SharePoint is accessed via port 80. In case of SSL, port 443 is used.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The reference to the bind account is entered here, holding the bind credentials for the related site. Note that the accountâs dxrName attribute must contain <em>domain</em>*\account;* for example, <strong>domain1\admin</strong>. The password must be stored in the bind accountâs dxmPassword attribute. To achieve this, you must change the <strong>userPassword</strong> attribute of the bind account in the Data View.</p>
</div>
<div class="paragraph">
<p>Connector Configuration</p>
</div>
<div class="paragraph">
<p>You can configure the following values for an optional proxy server:</p>
</div>
<div class="paragraph">
<p><strong>Host</strong> - host name of the proxy server (optional).</p>
</div>
<div class="paragraph">
<p><strong>Port</strong> - port of the proxy server (optional).</p>
</div>
<div class="paragraph">
<p><strong>User</strong> - user for proxy server authentication (optional).</p>
</div>
<div class="paragraph">
<p><strong>Password</strong> - password for proxy server authentication (optional).</p>
</div>
<div class="paragraph">
<p>You can configure the following values for the connector:</p>
</div>
<div class="paragraph">
<p><strong>User Name Prefix</strong> - is used in sites whose members follow the syntax <em>prefixaccount_name</em>.<br>
For example the prefix <strong>ptdssomember:</strong> is used for sites with member syntax <strong>ptdssomember:*<em>account_name</em>. Note that you must configure an empty *domainnameattribute</strong> at the connected directory of those sites.</p>
</div>
<div class="paragraph">
<p><strong>Search Groups from Site Collection</strong> - a Boolean flag indicating that the groups must be searched from the site collection rather than from the specified (sub)site.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If the subsite on your SharePoint server was created with inheriting the site collection (parent site) permissions, the groups created in this subsite are part of the site collection and are only contained in the search result for the subsite if this flag is set. If the subsite to be provisioned was created with unique permissions, this flag must not be set (default) if only the subsite&#8217;s groups are to be provisioned and not all site collection groups including those of subsites with inherited permissions, too.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Debugging trace file:</p>
</div>
<div class="paragraph">
<p><strong>Trace File</strong> - a path and filename for the request. This file is useful in debugging mode to inspect the SPML requests towards the connector and the corresponding responses. Once the workflows become productive, delete or rename the option to prevent writing to the trace file.</p>
</div>
<div class="paragraph">
<p>Environment Properties</p>
</div>
<div class="paragraph">
<p>You can configure the following values:</p>
</div>
<div class="paragraph">
<p><strong>Domain\Userloginname</strong> - a valid default user login name for a new group.. A user name in SharePoint versions before SharePoint Server 2013 is presented in the form <em>domain</em>**<em>account</em>. From SharePoint Server 2013 on, a user name is presented in the form of a claims-based identity type prefix (for a Windows claims identity type, the prefix is *i:0#.w|*) followed by <em>domain</em>*\*<em>account</em>. If this default_userloginname is set, it is used as the defaultUserLoginName when a new group is created in SharePoint. If it is left empty, the group&#8217;s default userloginname is populated from the user provided with the bind account.</p>
</div>
<div class="paragraph">
<p><strong>Default Owner &#8594; Owner</strong> - the default owner, if a group&#8217;s owner attribute on the DirX Identity side is not populated. The SharePoint attribute <strong>ownerIdentifier</strong> is mandatory for creating a group in SharePoint. The owner type, whose default value can be set in the environment property <strong>default_owner_type</strong>, must be either User or Group. If the owner type is User, the value for the default owner must be a valid username in the syntax <em>domain</em>**<em>account</em> or <em>claims_based_prefixdomain</em>*\*<em>account</em> depending on the SharePoint Server version as described in Domain\Userloginname. If the owner type is Group, the default owner must be the name of a group in the same SharePoint site..</p>
</div>
<div class="paragraph">
<p><strong>Default Owner &#8594; Owner Type</strong> - the default owner type. Allowed values are User and Group.</p>
</div>
<div class="paragraph">
<p><strong>Base DN</strong> (mandatory) - the base DN for groups in the current target system. This DN is used as a parent folder for the groups imported from the validation workflow. It is automatically set during save of the target system to the value *cn=Groups,*<em>dn of target system</em>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_sharepoint_workflow_and_activities"><a class="anchor" href="#_ch7_sharepoint_workflow_and_activities"></a><a class="link" href="#_ch7_sharepoint_workflow_and_activities">7.2.18.4. SharePoint Workflow and Activities</a></h5>
<div class="paragraph">
<p>The following figure shows the layout of the channels that are used by the SharePoint workflow&#8217;s join activity.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch7_targetWFs/image33.png" alt="SharePoint Provisioning Workflow Channels and Objects">
</div>
<div class="title">Figure 109. SharePoint Provisioning Workflow Channels and Objects</div>
</div>
<div class="paragraph">
<p>DirX Identity supports these SharePoint workflows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Ident_SharePoint_Realtime_Clustered</strong> - this workflow is a Java-based synchronization workflow. It can run either scheduled or event-based. Event-based means it is triggered by a group change in DirX Identity. Each modification of a group - for example, adding a new group, adding/removing a member to a group or changing the group owner - starts a workflow that propagates this change to SharePoint.<br>
Once the change is applied, it is propagated back to the group object in the DirX Identity target system, for example, to adjust the groupâs state or other data.</p>
</li>
<li>
<p><strong>Validate_SharePoint_Ident_Clustered</strong> - this workflow is a scheduled validation workflow. It imports groups from SharePoint sites to the associated DirX Identity target systems and modifies the groupâs members and other attributes according to the current group state.<br>
This workflow is used to perform an initial load of the DirX Identity SharePoint target systems and to keep the DirX Identity target systems in sync if changes are made in SharePoint (for example, groups are added or deleted).</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_sharepoint_workflow_ports"><a class="anchor" href="#_ch7_sharepoint_workflow_ports"></a><a class="link" href="#_ch7_sharepoint_workflow_ports">7.2.18.5. SharePoint Workflow Ports</a></h5>
<div class="paragraph">
<p>This section describes the SharePoint workflow ports.</p>
</div>
<div class="paragraph">
<p>TS Port</p>
</div>
<div class="paragraph">
<p>The TS port references the SharePoint connected directory and its channels. The channels contain the mapping definitions for export of groups to SharePoint and the join definition for SharePoint.</p>
</div>
<div class="paragraph">
<p>IdentityDomain Port</p>
</div>
<div class="paragraph">
<p>The IdentityDomain port references the SharePoint channels (Channel Parent) of the DirX Identity connected directory. The channels contain the mapping definitions for import of groups from SharePoint and the join definition for DirX Identity.</p>
</div>
<div class="paragraph">
<p>Note that the SharePoint validation workflow and the synchronization workflow use the same connected directory and channel configuration. Only the controller class is changed in the join activity.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_sharepoint_workflow_channels"><a class="anchor" href="#_ch7_sharepoint_workflow_channels"></a><a class="link" href="#_ch7_sharepoint_workflow_channels">7.2.18.6. SharePoint Workflow Channels</a></h5>
<div class="paragraph">
<p>This section provides information about SharePoint workflow channels.</p>
</div>
<div class="sect5">
<h6 id="_ch7_aspects_common_to_all_channels_and_synchronization_directions"><a class="anchor" href="#_ch7_aspects_common_to_all_channels_and_synchronization_directions"></a><a class="link" href="#_ch7_aspects_common_to_all_channels_and_synchronization_directions">7.2.18.6.1. Aspects Common to All Channels and Synchronization Directions</a></h6>
<div class="paragraph">
<p>At the SharePoint connected directory, the directory type LDAP is used since the required configuration parameters are almost the same. The clustered workflows ignore the SharePoint target system service and the bind profiles. These parameters are read from the target systems/bind profiles in the Provisioning domain.</p>
</div>
<div class="paragraph">
<p>The <strong>Identity</strong> &#8594; <strong>Group</strong> <strong>Base</strong> property must not be set at the connected directory because it is different for each target system. In a clustered workflow, this value is overwritten by the target system-specific configuration attribute <strong>Group</strong> <strong>Folder</strong> &#8594; <strong>Base</strong> <strong>DN</strong> in the Environment Properties tab (attribute <strong>role_ts_group_base</strong>) in the Provisioning domain. The <strong>Target</strong> <strong>System</strong> &#8594; <strong>Group</strong> <strong>Base</strong> property of the connected directory must be set even though it is ignored when exporting the groups from the SharePoint server since all groups per site are flat.</p>
</div>
<div class="paragraph">
<p>Some specific attributes of the Connected Directory are important for the workflows:</p>
</div>
<div class="paragraph">
<p><strong>accountnameattribute</strong> (mandatory) - the name of the LDAP attribute holding the Windows account name in the peer target systemâs account objects.</p>
</div>
<div class="paragraph">
<p><strong>delete_group_enabled</strong> - a boolean flag. If set to true, deleting a group in DirX Identity results in a physical deletion of the group in the connected SharePoint site. If set to false, groups are not deleted in SharePoint.</p>
</div>
<div class="paragraph">
<p><strong>debug_to_screen</strong> - a boolean flag. If set to true, extra debug information is written to stdout. This attribute must be set to false in a production environment.</p>
</div>
<div class="paragraph">
<p><strong>domainnameattribute</strong> - the name of the LDAP attribute holding the Windows domain name in the peer target systemâs account objects. If no value is specified, the domain of the bind account is added to the account name. In SharePoint Server versions prior to SharePoint Server 2013, the user name is composed of <em>domain</em>**<em>account</em>. In SharePoint Server 2013 and higher, the user name is composed of a claims-based identity type prefix (for a Windows claims identity type, the prefix is <strong>i:0#.w</strong>|) followed by <em>domain</em>**<em>account</em>. This means that the domain attribute (the default attribute name holding the domain name is dxmAdsDomain) of an account in the peer target system must consist of this claims-based prefix plus the domain name; for example, *i:0#.w|domain1*.</p>
</div>
<div class="paragraph">
<p>In SharePoint sites that use the member syntax <em>prefixaccount</em> (for example, *ptdssomember:*<em>account</em>) the domainnameattribute must be left blank. This leads to the following behavior:</p>
</div>
<div class="paragraph">
<p>In the sync direction (Identity to SharePoint) the members are created without the domain prefix in the join engine. The SharePoint connector then adds the prefix to the account name.</p>
</div>
<div class="paragraph">
<p>In the validation direction (SharePoint to Identity), the connector strips off the configured prefix from the members. In the join engine, the corresponding accounts then are searched without domain name, only with the filter *cn=*<em>account</em>.</p>
</div>
<div class="paragraph">
<p>If you use both sites with and without user name prefix, it may be necessary that you must configure two SharePoint clusters: one for the use with user name prefix (and empty domainnameattribute), and one for the use for members with syntax <em>domain</em>*\*<em>account</em> (with domainnameattribute configured).</p>
</div>
<div class="paragraph">
<p><strong>filterblocksize</strong> - the maximum number of account names in one search filter. The account name-to-user mapping is performed via LDAP searches in DirX Identity. This attribute adjusts the maximum number of account names that are combined in one search filter.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_groups_4"><a class="anchor" href="#_ch7_groups_4"></a><a class="link" href="#_ch7_groups_4">7.2.18.6.2. Groups</a></h6>
<div class="paragraph">
<p>Direction: Identity Store &#8594; SharePoint</p>
</div>
<div class="paragraph">
<p>GC - com.siemens.dxm.join.userhook.sharepoint.UserHookGroupsTo</p>
</div>
<div class="paragraph">
<p>This user hook performs the following mapping functions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The group member DNs are converted to the target account names by searching the accounts in the peer target system according to their <strong>dxrUserLink</strong>s. The references <strong>member DN</strong> to <em>domainname</em>_account name_ are extracted from the accounts.</p>
</li>
<li>
<p>If the owner DN points to a user, it is converted to <em>domainname</em>_account_ by the same mechanism. If it is a group, the group name is extracted.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Export Section</p>
</div>
<div class="ulist">
<ul>
<li>
<p>This section contains the search filter to export all SharePoint groups of one site. In the future, other object types (beside groups) may be handled, so an object class Group is introduced here.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Mapping Section</p>
</div>
<div class="paragraph">
<p>The DirX Identity to SharePoint mapping is:</p>
</div>
<div class="paragraph">
<p><strong>Identifier</strong> - the identifier is created in a Java mapping function. It contains the groupâs cn.</p>
</div>
<div class="paragraph">
<p><strong>objectClass</strong> - set to the fixed value "Group"</p>
</div>
<div class="paragraph">
<p><strong>groupNam</strong>e - the cn of the group.</p>
</div>
<div class="paragraph">
<p><strong>ownerIdentifier</strong> - a Java source mapping that performs the following mapping:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If a value for <strong>owner</strong> is present in the source entry, this valued is returned in the map result.</p>
</li>
<li>
<p>Otherwise, the value for <strong>default_owner_type</strong> is read from the environment and returned in the map result.</p>
</li>
<li>
<p>If none of the above is present, the ownerIdentifier is not deleted for a modify group operation; the old value is kept instead. For an add operation, the group creation will fail, because the ownerIdentifier attribute in SharePoint is mandatory.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>ownerType</strong> - a Java source mapping that performs the following mapping:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If a value for <strong>owner</strong> is present in the source entry, this value is returned in the map result.</p>
</li>
<li>
<p>Otherwise, the value for <strong>default_owner_identifier</strong> is read from the environment and returned in the map result.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>role</strong> - in the sample workflow, dxrHistoryRemoved holds the SharePoint role names. It is directly mapped to the sharePoint role attribute. You must choose your own attribute here if you intend to provision role names.</p>
</div>
<div class="paragraph">
<p><strong>description</strong> - direct mapping to the same attribute.</p>
</div>
<div class="paragraph">
<p><strong>defaultUserLoginName</strong> - a Java source mapping that performs the following mapping:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If a value for <strong>owner</strong> is present in the source entry and the owner is a user, this value is returned in the result.</p>
</li>
<li>
<p>Otherwise, the value for <strong>default_userloginname</strong> is read from the environment and returned in the result.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Operational Mapping Section</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The remote members of the group are mapped to the operational attribute "localMember". This mechanism preserves local members so that they are not deleted in SharePoint.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Join Section</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The join filter matches the groupâs cn in DirX Identity against its SharePoint group name.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Direction: SharePoint &#8594; Identity Store</p>
</div>
<div class="paragraph">
<p>GI - com.siemens.dxm.join.userhook.sharepoint.UserHookGroupsFrom</p>
</div>
<div class="paragraph">
<p>This user hook performs the following mapping functions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The target account names are converted to user DNs. Through the <strong>domainnameattribute</strong> and the <strong>accountnameattribute</strong> in the connected directory configuration, the account is searched in the peer target system. If found, the dxrUserLink attribute if populated holds the related user DN. If no DN is found for an account name, the member is mapped to "remotemember".</p>
</li>
<li>
<p>The owner identifier is converted to a user or a group DN. If no DN is found, the owner is mapped to "remoteowner".</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Export Section</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The export section defines the search filter to export all groups of a SharePoint target system. As the search base <strong>role_ts_group_base</strong> is used, it is defined in the DirX Identity target system configuration (<strong>Base DN</strong> in the <strong>Environment Properties</strong> tab).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Mapping Section</p>
</div>
<div class="paragraph">
<p>The SharePoint to DirX Identity mapping is:</p>
</div>
<div class="paragraph">
<p><strong>Identifier</strong> - the identifier is created in a Java mapping function. If a joinedId already exists, this value is used. In a validation workflow, the groupâs DN is built from the SharePoint groupName and the <strong>role_ts_group_base</strong> configured at the corresponding DirX Identity target system.</p>
</div>
<div class="paragraph">
<p><strong>objectClass</strong> - defines the object classes required for a target system group.</p>
</div>
<div class="paragraph">
<p><strong>description</strong> - direct mapping from the description in SharePoint.</p>
</div>
<div class="paragraph">
<p><strong>ownerType</strong> - the type of the SharePoint owner is mapped to <strong>dxrDefaultGroupType</strong> in the sample. You may need to change this mapping if you use <strong>dxrDefaultGroupType</strong> for other purposes.</p>
</div>
<div class="paragraph">
<p><strong>owner</strong> - the owner is mapped from the <strong>ownerIdentifier</strong>. Note that the user hook runs prior to the mapping and thus the <strong>ownerIdentifier</strong> is already a DN here.</p>
</div>
<div class="paragraph">
<p><strong>cn</strong> - the groupâs common name is filled with the SharePoint groupName.</p>
</div>
<div class="paragraph">
<p><strong>dxrHistoryRemoved</strong> - this attribute is used to hold the SharePoint role names in the sample workflow. You should change this to another attribute if you intend to provision the roles.</p>
</div>
<div class="paragraph">
<p><strong>dxrState</strong>, <strong>dxrTSState</strong>, <strong>dxrTSLocal</strong> and <strong>dxrToDo</strong> - the standard mapping as, for example, in the LDAP-to-LDAP workflows is used here, too.</p>
</div>
<div class="paragraph">
<p>Join Section</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The group is joined in DirX Identity by its DN created in the mapping section.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_member_channel_2"><a class="anchor" href="#_ch7_member_channel_2"></a><a class="link" href="#_ch7_member_channel_2">7.2.18.6.3. Member Channel</a></h6>
<div class="paragraph">
<p>The member channel configuration holds the mapping of the group members.</p>
</div>
<div class="paragraph">
<p>Direction: Identity Store &#8594; SharePoint</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The mapping of the member attribute is handled in a special Java mapping function. It was copied from the LDAP-to-LDAP workflow.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Direction: SharePoint &#8594; Identity Store</p>
</div>
<div class="paragraph">
<p>Mapping Section</p>
</div>
<div class="paragraph">
<p>The DirX Identity to SharePoint mapping is:</p>
</div>
<div class="paragraph">
<p><strong>dxrGroupMember</strong> attributes - the mapping of the member state attributes is standard for most attributes. Only <strong>dxrGroupMemberRemote</strong> and <strong>uniqueMember</strong> are mapped with special Java functions.</p>
</div>
<div class="paragraph">
<p><strong>dxrGroupMemberRemote</strong> - before the mapping, <strong>remotemember</strong> contains all SharePoint user names that cannot be mapped to a DirX Identity user. This situation occurs if the Windows account is not managed in a peer target system. The Java mapping function maps <strong>remotemember</strong> to <strong>dxrGroupMemberRemote</strong>. If no <strong>remotemember</strong> exists, <strong>dxrGroupMemberRemote</strong> is deleted.</p>
</div>
<div class="paragraph">
<p><strong>uniqueMember</strong> - in a target system without accounts but with states, <strong>uniqueMember</strong> must contain all users referencing the group. Once the user is removed from all group members, it is also removed from uniqueMember.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch7_unify_office_workflows"><a class="anchor" href="#_ch7_unify_office_workflows"></a><a class="link" href="#_ch7_unify_office_workflows">7.2.19. Unify Office Workflows</a></h4>
<div class="paragraph">
<p>The Unify Office Provisioning workflows operate between a target system of type Unify Office in the Identity Store and the corresponding connected Unify Office endpoint.</p>
</div>
<div class="paragraph">
<p>The workflows use the Unify Office connector (UnifyOfficeConnector) for provisioning. This connector communicates with the Unify Office (RingCentral) endpoint using RESTful API with JSON requests.</p>
</div>
<div class="paragraph">
<p>The connector uses the Unify Office (RingCentral) OAuth server for authentication and authorization.</p>
</div>
<div class="paragraph">
<p>The Unify Office workflows handle the following Unify Office objects:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Account</strong> - the common Unify Office (RingCentral) user (SCIMv2 conformant, translates to RingCentral extension object).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The delivered workflows include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Validate_UnifyOffice_Realtime</strong> - the validation workflow that imports existing Unify Office users from Unify Office (RingCentral) server to the Identity Store.</p>
</li>
<li>
<p><strong>Ident_UnifyOffice_Realtime</strong> - the synchronization workflow that exports detected changes for account from Identity Store to the Unify Office (RingCentral) endpoint and then validates the processed changes in Unify Office (RingCentral) endpoint to the Identity Store.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following figure illustrates the Unify Office (RingCentral) Provisioning workflow architecture.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch7_targetWFs/image34.png" alt="Unify Office Provisioning Workflow Architecture">
</div>
<div class="title">Figure 110. Unify Office Provisioning Workflow Architecture</div>
</div>
<div class="sect4">
<h5 id="_ch7_prerequisites_and_limitations_2"><a class="anchor" href="#_ch7_prerequisites_and_limitations_2"></a><a class="link" href="#_ch7_prerequisites_and_limitations_2">7.2.19.1. Prerequisites and Limitations</a></h5>
<div class="paragraph">
<p>The Unify Office Provisioning workflows only offer channels for the SCIM objects and attributes provided by the appropriate RingCentral API endpoint. The Unify Office Connector supports other objects as well, but since these are specific for voice telephony they are out of scope.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_connecting_to_unify_office"><a class="anchor" href="#_ch7_connecting_to_unify_office"></a><a class="link" href="#_ch7_connecting_to_unify_office">7.2.19.2. Connecting to Unify Office</a></h5>
<div class="paragraph">
<p>Verify that services are correctly configured at the Unify Office connected directory. The Unify Office Service referenced by the connected directory should contain the default value <strong>platform.devtest.ringcentral.com</strong> with SSL enabled. This platform connects to the sandbox account; for production, it must be changed to <strong>platform.ringcentral.com</strong>.</p>
</div>
<div class="paragraph">
<p>The Unify Office connected directory and Provisioning workflows support the central HTTP proxy server configuration. See the section âHTTP Proxy Server Configurationâ for details.</p>
</div>
<div class="paragraph">
<p>DirX Identity must be registered as a valid principal service for your existing Unify Office tenant (account). Use the Unify Office (RingCentral) developer portal <a href="https://developers.ringcentral.com/" class="bare">https://developers.ringcentral.com/</a> to create your app and generate your client ID and client secret.</p>
</div>
<div class="paragraph">
<p>Configure the bind profile for the Admin User when you plan to use the Resource Owner Password Flow and configure the bind profile for client authentication with the generated client ID and <strong>Client</strong> <strong>Secret</strong> field from your generated app.</p>
</div>
<div class="paragraph">
<p>Check the Provisioning settings used by the connected directory and then set them to the real values for your provisioned target system.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_configuring_the_unify_office_target_system"><a class="anchor" href="#_ch7_configuring_the_unify_office_target_system"></a><a class="link" href="#_ch7_configuring_the_unify_office_target_system">7.2.19.3. Configuring the Unify Office Target System</a></h5>
<div class="paragraph">
<p>The Unify Office target system requires the following layout:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Accounts</strong> - all Unify Office accounts are located in a subfolder <strong>Accounts</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <strong>dxrPrimaryKey</strong> attribute of accounts contains the unique ID generated by the Unify Office (RingCentral) endpoint.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_workflow_and_activities"><a class="anchor" href="#_ch7_workflow_and_activities"></a><a class="link" href="#_ch7_workflow_and_activities">7.2.19.4. Workflow and Activities</a></h5>
<div class="paragraph">
<p>The following figure shows the layout of the channels that are used by the join activity:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch7_targetWFs/image35.png" alt="Unify Office Provisioning Workflow Channels and Objects">
</div>
<div class="title">Figure 111. Unify Office Provisioning Workflow Channels and Objects</div>
</div>
<div class="paragraph">
<p>The Unify Office objects are synchronized via a pair of channels (one channel per direction).</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_workflow_ports"><a class="anchor" href="#_ch7_workflow_ports"></a><a class="link" href="#_ch7_workflow_ports">7.2.19.5. Workflow Ports</a></h5>
<div class="paragraph">
<p>This section describes the Unify Office workflow ports.</p>
</div>
<div class="paragraph">
<p>TS Port</p>
</div>
<div class="ulist">
<ul>
<li>
<p>CF - Crypt Filter<br>
A connector filter is configured implicitly. It is used to send decrypted passwords to the Unify Office endpoint.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_workflow_channels"><a class="anchor" href="#_ch7_workflow_channels"></a><a class="link" href="#_ch7_workflow_channels">7.2.19.6. Workflow Channels</a></h5>
<div class="paragraph">
<p>This section provides information about Unify Office workflow channels.</p>
</div>
<div class="sect5">
<h6 id="_ch7_accounts_4"><a class="anchor" href="#_ch7_accounts_4"></a><a class="link" href="#_ch7_accounts_4">7.2.19.6.1. Accounts</a></h6>
<div class="paragraph">
<p>Direction: Identity Store &#8594; Unify Office:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ID: <strong>dxrPrimaryKey</strong></p>
</li>
<li>
<p>Join: <strong>${source.dxrPrimaryKey}</strong> or <strong>userName=${target.userName}</strong></p>
</li>
<li>
<p><strong>accountEnabled</strong> - the attribute used to disable the account object in Unify Office. The correct value is derived from the <strong>dxrState</strong> attribute of the corresponding account object in the Identity Store.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Direction: Unify Office &#8594; Identity Store</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ID: <strong>"cn="${source.userName}","+${env.role_ts_account_base}</strong> or <strong>${joinedEntry.id}</strong></p>
</li>
<li>
<p>Join: <strong>${target.dxrPrimaryKey}</strong> or <strong>${target.dxrName}</strong> or <strong>${target.id}</strong>.</p>
</li>
<li>
<p><strong>dxrTSState</strong> - the attribute used to detect the current state of the account in Unify Office. The correct value is derived from the <strong>accountEnabled</strong> attribute of the corresponding account object in Unify Office. It is set to DELETED when no account entry is found.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch7_unix_openicf_workflows"><a class="anchor" href="#_ch7_unix_openicf_workflows"></a><a class="link" href="#_ch7_unix_openicf_workflows">7.2.20. UNIX-OpenICF Workflows</a></h4>
<div class="paragraph">
<p>The UNIX-OpenICF Provisioning workflows operate between a target system of type OpenICF in the Identity Store and the corresponding connected OpenICF connector server which is configured for communication with a UNIX (Linux) system using the OpenICF connector bundle <strong>org.forgerock.openicf.connectors.solaris-connector</strong> (UNIX connector).</p>
</div>
<div class="paragraph">
<p>The following figure illustrates the OpenICF connector server architecture.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch7_targetWFs/image36.png" alt="UNIX-OpenICF Connector Server Architecture">
</div>
<div class="title">Figure 112. UNIX-OpenICF Connector Server Architecture</div>
</div>
<div class="paragraph">
<p>As shown in the figure, the Java OpenICF connector sends a request to an OpenICF connector server which runs on a supported platform. Note that single an OpenICF server may support more connector bundles at the same time. The OpenICF server passes the request to the UNIX connector bundle. The bundle then establishes a SSH or telnet connection to a configured UNIX host and executes the necessary scripts. It is possible to provision more UNIX hosts using the single OpenICF connector server.</p>
</div>
<div class="paragraph">
<p>The workflows use the specially preconfigured DirX Identity OpenICF connector for UNIX provisioning (OpenIcfConnector2Unix). This connector communicates with the OpenICF connector server using the special OpenICF protocol. See the section "OpenICF Connector" in the <em>DirX Identity Connectivity Reference</em> for more details. The following figure illustrates the UNIX-OpenICF Provisioning workflow architecture.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch7_targetWFs/image37.png" alt="UNIX-OpenICF Provisioning Workflow Architecture">
</div>
<div class="title">Figure 113. UNIX-OpenICF Provisioning Workflow Architecture</div>
</div>
<div class="paragraph">
<p>The workflows handle the following UNIX objects:</p>
</div>
<div class="paragraph">
<p><strong>Account</strong> - the common UNIX accounts.</p>
</div>
<div class="paragraph">
<p><strong>Group</strong> - the common UNIX groups.</p>
</div>
<div class="paragraph">
<p>The delivered workflows are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Ident_UNIX-OICF_Realtime</strong> - the synchronization workflow that exports detected changes for account and group objects from Identity Store to the UNIX system and then validates the processed changes in the UNIX system to the Identity Store.</p>
</li>
<li>
<p><strong>SetPassword in UNIX-OICF</strong> - the workflow that sets the password for the account in the UNIX system.</p>
</li>
<li>
<p><strong>Validate_UNIX-OICF_Realtime</strong> - the validation workflow that imports existing UNIX accounts and groups with group assignments from the UNIX system to the Identity Store.</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="_ch7_unix_openicf_prerequisites_and_limitations"><a class="anchor" href="#_ch7_unix_openicf_prerequisites_and_limitations"></a><a class="link" href="#_ch7_unix_openicf_prerequisites_and_limitations">7.2.20.1. UNIX-OpenICF Prerequisites and Limitations</a></h5>
<div class="paragraph">
<p>The UNIX-OpenICF workflows have the following prerequisites and limitations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The delivered workflows require a properly deployed OpenICF connector server with a supported version of <strong>org.forgerock.openicf.connectors.solaris-connector</strong> (UNIX connector). DirX Identity delivers an enhanced version of this bundle based on version 1.1.1.0-SNAPSHOT.</p>
</li>
<li>
<p>Some SUSE Enterprise Server distributions may not be able to completely remove secondary group assignments for a user. The OpenICF UNIX connector uses the common UNIX command <strong>usermod</strong> <strong>-G ""</strong> <em>account_name</em>. This command might not work correctly on SUSE distributions. In this case, deprecated secondary group assignments will remain unassigned.</p>
</li>
<li>
<p>Before you can use the workflows, you must extend the DirX Identity Store schema with UNIX-OpenICF target system-specific attributes and object classes so that the workflows can store UNIX-OpenICF-specific information in the Identity Store. For instructions, see the section "Extending the Schema for the Target System Workflows". When performing the procedures described in this section, select the extensions for PAM-UNIX and UNIX.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_connecting_to_the_unix_system"><a class="anchor" href="#_ch7_connecting_to_the_unix_system"></a><a class="link" href="#_ch7_connecting_to_the_unix_system">7.2.20.2. Connecting to the UNIX System</a></h5>
<div class="paragraph">
<p>Building the connection to the UNIX system consists of two steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Installing and configuring the Java-based OpenICF connector server</p>
</li>
<li>
<p>Configuring the connection to the OpenICF connector server</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="_ch7_setting_up_the_java_based_openicf_connector_server"><a class="anchor" href="#_ch7_setting_up_the_java_based_openicf_connector_server"></a><a class="link" href="#_ch7_setting_up_the_java_based_openicf_connector_server">7.2.20.2.1. Setting up the Java-based OpenICF Connector Server</a></h6>
<div class="paragraph">
<p>This section provides information on how to set up the Java-based OpenICF connector server.</p>
</div>
<div class="paragraph">
<p>OpenICF Server</p>
</div>
<div class="paragraph">
<p>Download a stable installation package for the Java OpenICF connector server on <strong><a href="http://www.forgerock.org/openicf-archive.html" class="bare">http://www.forgerock.org/openicf-archive.html</a></strong>. We recommend the version OpenICF Java 1.1.1.0 for compatibility reasons. Follow the installation instructions on <strong><a href="http://openicf.forgerock.org/connector-framework-internal/connector_server.html" class="bare">http://openicf.forgerock.org/connector-framework-internal/connector_server.html</a></strong>. Configure the OpenICF server port, shared secret and create host certificates if you intend to use SSL.</p>
</div>
<div class="paragraph">
<p>OpenICF UNIX Connector Bundle</p>
</div>
<div class="paragraph">
<p>Deploy the delivered improved version of the UNIX connector bundle to your OpenICF connector server installation directory. After you have installed the feature for OpenICF connectivity, you can find the UNIX connector in the folder <em>install_path</em>/<strong>connectors/OpenICF/bundles/java</strong> (the file name is in the form <strong>solaris-connector-<strong></strong>.jar*). Copy the file to the <em>openicf_install_path</em>*/bundles* directory. If there is an older version of the file <strong>solaris-connector-</strong></strong>.jar* in this folder, delete it. The configuration of the connector bundle does not require any special steps.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_configuring_the_connection_to_the_openicf_connector_server"><a class="anchor" href="#_ch7_configuring_the_connection_to_the_openicf_connector_server"></a><a class="link" href="#_ch7_configuring_the_connection_to_the_openicf_connector_server">7.2.20.2.2. Configuring the Connection to the OpenICF Connector Server</a></h6>
<div class="paragraph">
<p>To configure the connection to a UNIX system using an OpenICF connector server:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Specify the IP address or the host name and the data port of the OpenICF connector server with the deployed UnixConnector bundle. Adapt the bind profile for the OpenICF server - set the password that is configured as a shared secret with the OpenICF connector server and enable SSL if it is enabled on the OpenICF server side. Using SSL may require additional configuration steps. See the section "OpenICF Connector" in the <em>DirX Identity Connectivity Reference</em> for more details. All of these properties can be configured using the connected directory (Generic connected directory type) that represents the OpenICF server. It is referenced from the connected directory that represents the UNIX system (the OpenICF Server and OpenICF Server Bind Profile property on the OpenICF Connector Server tab).</p>
</li>
<li>
<p>Specify the IP address or the host name of the UNIX system at the UNIX-OpenICF service object and then set the bind profile properly. UNIX-OpenICF connected directory represents a real UNIX system that will be provisioned by our workflows. Use the correct port numbers that are configured on the UNIX host for the desired type of communication (SSH or telnet). Use credentials with sufficient access rights (UNIX account and group management).</p>
</li>
<li>
<p>Specify the <strong>Response</strong> <strong>Timeout</strong> property on the <strong>OpenICF</strong> <strong>Connector</strong> <strong>Server</strong> tab of the UNIX-OpenICF connected directory. Set the value that is sufficient for the selected bundle type (UnixConnector). The default value is <strong>30</strong>.</p>
</li>
<li>
<p>Check the settings related to the OpenICF connector bundle at the TS port of the workflow object (<strong>OpenICF</strong> <strong>Connector</strong> <strong>Bundle</strong> tab). The <strong>Bundle</strong> <strong>Specification</strong> area allows you to define the <strong>Bundle</strong> <strong>Name</strong> (the default is <strong>org.forgerock.openicf.connectors.solaris-connector</strong>), <strong>Bundle</strong> <strong>Version</strong> (the default is <strong>1.1.1.0-SNAPSHOT</strong>) and <strong>Class</strong> <strong>Name</strong> property (the default is <strong>org.identityconnectors.solaris.UNIXConnector</strong>). Only use values that are valid for a connector bundle deployed on the OpenICF connector server. Override default values if necessary. The <strong>Bundle</strong> <strong>Settings</strong> area lets you choose the <strong>Unix</strong> <strong>Mode</strong> (use <strong>linux</strong> for Linux flavors), <strong>Connection</strong> <strong>Type</strong> (use <strong>ssh</strong> or <strong>telnet</strong>) and set the <strong>Shell</strong> <strong>Prompt</strong> (use the string character that is displayed at the beginning of the UNIX command prompt for the connected user. The hash tag (<strong>#</strong>) sign is typically used for the root account.)</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_configuring_the_unix_openicf_target_system"><a class="anchor" href="#_ch7_configuring_the_unix_openicf_target_system"></a><a class="link" href="#_ch7_configuring_the_unix_openicf_target_system">7.2.20.3. Configuring the UNIX-OpenICF Target System</a></h5>
<div class="paragraph">
<p>The UNIX-OpenICF target system requires the following layout:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Accounts</strong> - all UNIX accounts are located in a subfolder Accounts.</p>
</li>
<li>
<p><strong>Groups</strong> - all UNIX groups are located in a subfolder Groups.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The attributes <strong>uid</strong>, <strong>dxrName</strong> and <strong>dxrPrimaryKey</strong> of accounts contain the name (<strong>uid</strong>) of these objects in the connected UNIX system.</p>
</div>
<div class="paragraph">
<p>The standard <strong>JavaScript dxrNameForAccounts.js</strong> generates the attribute <strong>uid</strong> for the UNIX account.</p>
</div>
<div class="paragraph">
<p>The attributes <strong>dxrName</strong> and <strong>dxrPrimaryKey</strong> of groups contain the name <strong>(gid)</strong> of these objects in the connected UNIX system.</p>
</div>
<div class="paragraph">
<p>The attribute <strong>dxmUnixPrimaryGroup</strong> for the UNIX account (refers to the primary UNIX group of the account) is by default automatically chosen as one of the currently assigned UNIX groups. It uses the obligation mechanism (see group objects) and the UNIX-OpenICF specific <strong>JavaScript AccountPrimaryGroup.js</strong>. The JavaScript updates the <strong>dxmUnixPrimaryGroup</strong> when necessary. You can change the primary group manually at the account object.</p>
</div>
<div class="paragraph">
<p>The account object also stores the group membership and references the <strong>dxrPrimaryKey</strong> attribute of the group objects.</p>
</div>
<div class="paragraph">
<p>The workflows support disabling of the accounts. In this case, a special primary group needs to be assigned for a disabled account since the primary group membership is mandatory for UNIX systems. You can configure the name of the group that will be used solely for disabled accounts. See the <strong>UNIX-OpenICF</strong> tab of the target system instance and the property <strong>Group</strong> for disabled accounts. Create a real group in the connected UNIX system with no access rights with the corresponding name (<strong>gid</strong>).</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_unix_openicf_workflow_and_activities"><a class="anchor" href="#_ch7_unix_openicf_workflow_and_activities"></a><a class="link" href="#_ch7_unix_openicf_workflow_and_activities">7.2.20.4. UNIX-OpenICF Workflow and Activities</a></h5>
<div class="paragraph">
<p>The following figure shows the layout of the channels that are used by the UNIX-OpenICF workflow&#8217;s join activity:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/ch7_targetWFs/image38.png" alt="UNIX-OpenICF Provisioning Workflow Channels and Objects">
</div>
<div class="title">Figure 114. UNIX-OpenICF Provisioning Workflow Channels and Objects</div>
</div>
<div class="paragraph">
<p>The UNIX objects account and group (and membership) are synchronized via a pair of channels (one channel per direction).</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_unix_openicf_workflow_ports"><a class="anchor" href="#_ch7_unix_openicf_workflow_ports"></a><a class="link" href="#_ch7_unix_openicf_workflow_ports">7.2.20.5. UNIX-OpenICF Workflow Ports</a></h5>
<div class="paragraph">
<p>This section describes the UNIX-OpenICF workflow ports.</p>
</div>
<div class="paragraph">
<p>TS Port</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>CF - Crypt Filter</strong><br>
A UNIX-OpenICF filter is implicitly configured. It is used to send the decrypted password attribute <strong><em>PASSWORD</em></strong> to the OpenICF connector server.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_unix_openicf_workflow_channels"><a class="anchor" href="#_ch7_unix_openicf_workflow_channels"></a><a class="link" href="#_ch7_unix_openicf_workflow_channels">7.2.20.6. UNIX-OpenICF Workflow Channels</a></h5>
<div class="paragraph">
<p>This section provides information about UNIX-OpenICF workflow channels.</p>
</div>
<div class="sect5">
<h6 id="_ch7_common_aspects_7"><a class="anchor" href="#_ch7_common_aspects_7"></a><a class="link" href="#_ch7_common_aspects_7">7.2.20.6.1. Common Aspects</a></h6>
<div class="paragraph">
<p>Direction: Identity Store &#8594; UNIX-OpenICF</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><em>ENABLE</em></strong> - the attribute used for disabling the account in UNIX. The value is derived from dxrState attribute of the corresponding account object in DirX Identity.</p>
</li>
<li>
<p><strong>secondary_group</strong> - the attribute for secondary UNIX group membership detects changes of primary group assignment and adds the deprecated primary membership to secondary UNIX groups if necessary. It also removes primary groups from the list of secondary (supplementary) groups.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_accounts_5"><a class="anchor" href="#_ch7_accounts_5"></a><a class="link" href="#_ch7_accounts_5">7.2.20.6.2. Accounts</a></h6>
<div class="paragraph">
<p>Direction: Identity Store &#8594; UNIX-OpenICF</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ID: <strong>dxrPrimaryKey</strong></p>
</li>
<li>
<p>Join: <strong>${source.dxrPrimaryKey}</strong> or <strong>${source.uidNumber}</strong></p>
</li>
<li>
<p>The <strong><em>GROUPS</em></strong> attribute holds the name of the primary group.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Direction: UNIX-OpenICF &#8594; Identity Store</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Join via the <strong>dxrName</strong> attribute that is mapped identically as the <strong>uid</strong> and <strong>dxrPrimaryKey</strong> attribute.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_groups_5"><a class="anchor" href="#_ch7_groups_5"></a><a class="link" href="#_ch7_groups_5">7.2.20.6.3. Groups</a></h6>
<div class="paragraph">
<p>Direction: Identity Store &#8594; UNIX-OpenICF</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ID: <strong>dxrPrimaryKey</strong></p>
</li>
<li>
<p>Join: <strong>${source.dxrPrimaryKey}</strong> or <strong>{source.gidNumber}</strong></p>
</li>
<li>
<p>PostMapping script changes the type of the request to delete if necessary.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Direction: UNIX-OpenICF &#8594; Identity Store</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Join via the <strong>dxrName</strong> attribute that is mapped identically as the <strong>dxrPrimaryKey</strong> attribute.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_understanding_tcl_based_target_system_workflows"><a class="anchor" href="#_understanding_tcl_based_target_system_workflows"></a><a class="link" href="#_understanding_tcl_based_target_system_workflows">7.3. Understanding the Tcl-based Target System Workflows</a></h3>
<div class="paragraph">
<p>The topics in this section provide configuration information about the Tcl-based target system (Provisioning) workflows, including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The types of Provisioning workflows that exist for each target system</p>
</li>
<li>
<p>Object identification and group-to-account referencing</p>
</li>
<li>
<p>A summary of target system reference, join, and primary key attributes</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For a description of the script structure used by the target system workflows, see "Understanding the Default Application Workflow Technology" &gt; "Understanding Tcl-based Workflows" &gt; "Tcl-based Connectivity Architecture" &gt; "Provisioning Workflow Script Structure".</p>
</div>
<div class="paragraph">
<p>This section provides details about the Tcl-based default target system workflows, including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>HiPath workflow (Siemens) - describes details about the HDMS / HiPath 4000 Manager workflow<br>
Note that the Siemens HiPath synchronization workflow does not work from a DirX Identity target system - it works from the user tree of the Identity Store. See the HiPath workflow section for more information.</p>
</li>
<li>
<p>ODBC workflow - describes details about the ODBC workflow</p>
</li>
<li>
<p>RACF workflow (IBM) - describes details about the RACF workflow</p>
</li>
<li>
<p>SiPass workflow (Siemens) - describes details about the SiPass workflows</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_ch7_target_system_workflow_types"><a class="anchor" href="#_ch7_target_system_workflow_types"></a><a class="link" href="#_ch7_target_system_workflow_types">7.3.1. Target System Workflow Types</a></h4>
<div class="paragraph">
<p>Each target system has a validation and a synchronization provisioning workflow.</p>
</div>
<div class="paragraph">
<p>You can run the validation workflow in one of two modes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>InitialLoad</strong> - exports all of the accounts and groups and the relationships between them from the target system and imports them into the relevant target system subtree in the Identity Store. It performs a full export of the target system and an import to DirX Identity in replace mode. This is the default mode.</p>
</li>
<li>
<p><strong>Validation</strong> - detects deviations between the state known in DirX Identity and in the target system, for example about created or deleted accounts and groups or their relationships in the target system. It writes messages about the deviations it finds into the "to do" fields of the affected target system objects in the Identity Store. It does a full export of the target system and an import to DirX Identity in replace mode.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Initial load and validation modes use the same jobs and are almost identical. The only difference between them is the specific attribute mode of the workflow object, which is set to <strong>InitialLoad</strong> for the initial load workflow. The Provisioning common script checks this flag and writes the dxrToDo fields for a validation workflow run.</p>
</div>
<div class="paragraph">
<p>The synchronization workflow exports all relevant changes from the DirX Identity accounts and groups subtree, imports them into the target system and acknowledges the changes back to the Identity Store. It does a delta export in both directions and imports the data to DirX Identity in merge mode.</p>
</div>
<div class="paragraph">
<p>Both synchronization and validation workflows update the dxrTSState attribute and the group member attributes of the affected target system objects in the DirX Identity store with the state of the object in the target system.</p>
</div>
</div>
<div class="sect3">
<h4 id="_ch7_object_identification_and_group_to_account_references"><a class="anchor" href="#_ch7_object_identification_and_group_to_account_references"></a><a class="link" href="#_ch7_object_identification_and_group_to_account_references">7.3.2. Object Identification and Group-to-Account References</a></h4>
<div class="paragraph">
<p>The Provisioning workflows for the default Connectivity scenario operate on both "hierarchical and "non-hierarchical" target systems. In a hierarchical target system, entries (typically, accounts and groups) are ordered hierarchically in trees; LDAP and ADS are examples of hierarchical target systems. A non-hierarchical target system has a "flat" ordering of entries; Windows is an example of a non-hierarchical target system. This section provides referencing and joining information about the hierarchical and non-hierarchical target system workflows provided with the default scenario.</p>
</div>
<div class="sect4">
<h5 id="_ch7_workflows_for_the_hierarchical_target_systems"><a class="anchor" href="#_ch7_workflows_for_the_hierarchical_target_systems"></a><a class="link" href="#_ch7_workflows_for_the_hierarchical_target_systems">7.3.2.1. Workflows for the Hierarchical Target Systems</a></h5>
<div class="paragraph">
<p>This section provides general, referencing, and joining information for the ADS, Exchange, SAP EP UM, and LDAP hierarchical target system workflows.</p>
</div>
<div class="sect5">
<h6 id="_ch7_general_information_2"><a class="anchor" href="#_ch7_general_information_2"></a><a class="link" href="#_ch7_general_information_2">7.3.2.1.1. General Information</a></h6>
<div class="paragraph">
<p>The hierarchical workflows for the ADS, Exchange, SAP EP UM and LDAP target systems map the hierarchical tree structure of the target system to the DirX Identity target system accounts and groups subtree. They use the DirX Identity attribute dxrPrimaryKey for account and group objects to hold the target system DN of the object.</p>
</div>
<div class="paragraph">
<p>At the end of the initial load and validation workflows, the AccountRootInTs and GroupRootInTs parameters of the target system object in DirX Identity Provisioning are set to the values specified in DirX Identity Connectivity in the target system connected directory in the provisioning step. They define the account and group root distinguished name (DN) in the target system and are used in DirX Identity to create the dxrPrimaryKey attribute of an account or group object that is created in DirX Identity.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_referencing_information"><a class="anchor" href="#_ch7_referencing_information"></a><a class="link" href="#_ch7_referencing_information">7.3.2.1.2. Referencing Information</a></h6>
<div class="paragraph">
<p>The workflows for the target systems ADS, Exchange, LDAP and SAP EP UM use the dxrPrimaryKey attribute as the reference attribute from a group to an account. Because it holds the DN of the object in the target system, the DirX Identity group member attributes can be mapped directly to the target system member attribute and vice-versa.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_joining_information"><a class="anchor" href="#_ch7_joining_information"></a><a class="link" href="#_ch7_joining_information">7.3.2.1.3. Joining Information</a></h6>
<div class="paragraph">
<p>The Exchange and SAP EP UM workflows use the dxrPrimaryKey attribute for joining (identifying) a target system object with an object in the Identity Store.</p>
</div>
<div class="paragraph">
<p>The LDAP workflows use the employeeNumber attribute and the ADS workflows use the sAMAccountName attribute for joining. This usage has the advantage that objects that have been moved in the LDAP or ADS directory are identified in the Identity Store and can be moved there if the flag Rename Allowed is set in the import properties of <strong>metacp</strong>.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_workflows_for_the_non_hierarchical_target_systems"><a class="anchor" href="#_ch7_workflows_for_the_non_hierarchical_target_systems"></a><a class="link" href="#_ch7_workflows_for_the_non_hierarchical_target_systems">7.3.2.2. Workflows for the Non-Hierarchical Target Systems</a></h5>
<div class="paragraph">
<p>This section provides information about referencing and joining for the Windows NT and ODBC non-hierarchical workflows.</p>
</div>
<div class="sect5">
<h6 id="_ch7_referencing_and_joining"><a class="anchor" href="#_ch7_referencing_and_joining"></a><a class="link" href="#_ch7_referencing_and_joining">7.3.2.2.1. Referencing and Joining</a></h6>
<div class="paragraph">
<p>The NT and ODBC non-hierarchical workflows use the cn attribute as the reference attribute from groups to accounts. The ODBC workflows supply an ODBC unique identifier in the dxrPrimaryKey attribute and use it for joining in subsequent workflows. The Windows NT workflows do not use the dxrPrimaryKey attribute; instead, they use cn, which holds the Windows NT account name, for joining.</p>
</div>
<div class="paragraph">
<p>In the non-hierarchical workflows RACF and SAP R3 UM, the accounts contain the group member lists so that the groups are referenced from the accounts. This flag is set in the target system advanced page. The reference attribute of the RACF target system is the racfid of a group, and the reference attribute of the SAP R3 UM target system is the cn of a group. Neither of these target system workflows use the dxrPrimaryKey attribute. The RACF workflow uses the racfid for joining and the SAP R3 UM workflow uses sapUsername.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch7_target_system_reference_and_join_summary"><a class="anchor" href="#_ch7_target_system_reference_and_join_summary"></a><a class="link" href="#_ch7_target_system_reference_and_join_summary">7.3.3. Target System Reference and Join Summary</a></h4>
<div class="paragraph">
<p>The following table provides the reference attribute, reference direction, join attribute and dxrPrimaryKey for all of the target systems supported by DirX Identity.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16%;">
<col style="width: 19%;">
<col style="width: 19%;">
<col style="width: 24%;">
<col style="width: 22%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"></th>
<th class="tableblock halign-left valign-top"><strong>Reference Attribute</strong></th>
<th class="tableblock halign-left valign-top"><strong>Reference Direction</strong></th>
<th class="tableblock halign-left valign-top"><strong>Join Attribute</strong></th>
<th class="tableblock halign-left valign-top"><strong>dxrPrimaryKey</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>ADS</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">dxrPrimaryKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Group - Group</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">sAMAccountName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DN of TS object</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>LDAP</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">dxrPrimaryKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Group - Group</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">employeeNumber</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DN of TS object</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>LDAPXXL</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">dxrPrimaryKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Account - Group</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">employeeNumber</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DN of TS object</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>ODBC</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cn</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Group - Group</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">dxrPrimaryKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ODBC unique identifier</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>JDBC</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cn</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Group - Group</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">dxrPrimaryKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JDBC unique identifier</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Notes</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cn</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Group - Group</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cn (=LNfullName)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">not used</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>RACF</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">racfid</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Account - Account</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">racfid</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">not used</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>SAPR3UM</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cn</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Account - Account</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">sapUsername</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">not used</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>SAPEPUM</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">uid</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Group - Group</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">dxrPrimaryKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DN of TS object</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The reference direction indicates how the group memberships are stored in DirX Identity and in the target system. For example "Group - Group" indicates:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Identity Store: the memberships are stored in attributes that point from the groups to the accounts.</p>
</li>
<li>
<p>Target system database: the memberships are stored in attributes that point from the groups to the accounts.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The group-side storage does not work for very large numbers of group members. In a company with 500,000 employees, all might be in the group "Standard Employee" which resides in 500,000 attribute values in one group attribute. Target systems (for example, LDAP directories) cannot handle groups of any size.</p>
</div>
<div class="paragraph">
<p>If the memberships are stored on the account side, the limit is less critical because the number of groups of which a user can be a member will not be more than 10,000. This number can be handled by any LDAP server.</p>
</div>
</div>
<div class="sect3">
<h4 id="_ch7_hipath_workflow"><a class="anchor" href="#_ch7_hipath_workflow"></a><a class="link" href="#_ch7_hipath_workflow">7.3.4. HiPath Workflow</a></h4>
<div class="paragraph">
<p>The HiPath Workflow <strong>Ident_HiPath</strong> handles bi-directional synchronization between a Siemens Hicom Domain Management System (HiPath 4000) and the Identity Store (user area, not target system area!). The workflow communicates with the HiPath database using the Hicom XIE import/export interface.</p>
</div>
<div class="paragraph">
<p>The following HiPath systems are supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>HDMS 3.1</p>
</li>
<li>
<p>HDMS 3.6</p>
</li>
<li>
<p>HDMS-US 5.2</p>
</li>
<li>
<p>HiPath 4000 Manager V1.0</p>
</li>
<li>
<p>HiPath 4000 Manager V3.1</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The basic assumptions and prerequisites for the HiPath workflow are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>MetaStore is entry master for the HiPath database.</p>
</li>
<li>
<p>The HiPath database is attribute master for telephoneNumber and facsimileTelephoneNumber (hardcoded).</p>
</li>
<li>
<p>The person entry in the LDAP directory must contain the attribute <strong>dxmOprOriginator</strong>. In the DirX Identity default scenario this is guaranteed via the objectClass <strong>dxrUser</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The workflow performs the following steps in sequence:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Activity Meta2HiPath_HiPath</p>
</li>
<li>
<p>Activity HiPath2Meta_HiPath</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="_ch7_prerequisites_and_limitations_3"><a class="anchor" href="#_ch7_prerequisites_and_limitations_3"></a><a class="link" href="#_ch7_prerequisites_and_limitations_3">7.3.4.1. Prerequisites and Limitations</a></h5>
<div class="paragraph">
<p>Before you can use the HiPath workflow, you must extend the DirX Identity Store schema with HDMS target system-specific attributes and object classes so that the workflow can store HDMS-specific information in the Identity Store. For instructions, see the section "Extending the Schema for the Target System Workflows".</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_configuring_the_ident_hipath_workflow"><a class="anchor" href="#_ch7_configuring_the_ident_hipath_workflow"></a><a class="link" href="#_ch7_configuring_the_ident_hipath_workflow">7.3.4.2. Configuring the Ident_HiPath Workflow</a></h5>
<div class="paragraph">
<p>The default scenario HiPath workflow is:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Ident_HiPath</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To complete the configuration for this workflow, you must set up the environment and then adapt some values in the Connectivity configuration.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Set and test the environment as described in the "Environment Setup" topic in "Default Application Reference".</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Use the configuration wizard in the Identity Manager Global View as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Go to the <strong>Default</strong> scenario and double-click the connected directory icon <strong>HiPath</strong>.</p>
</li>
<li>
<p>In the wizard window, click the icon to the right of the <strong>Service</strong> field.</p>
</li>
<li>
<p>Set the <strong>Server Name</strong> and <strong>IP Address</strong> fields.</p>
</li>
<li>
<p>Click <strong>OK</strong>.</p>
</li>
<li>
<p>Click <strong>Hicom DMS Parameters</strong>.</p>
</li>
<li>
<p>Select the <strong>HiPath</strong> <strong>Version</strong> and set the correct <strong>Remote Mode</strong> parameters (see the context- sensitive help in the <em>DirX Identity Connectivity Administration Guide</em>).</p>
</li>
<li>
<p>Click <strong>OK</strong>, and then click <strong>Finish</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Next, set the parameters of the workflow as follows, but only if you selected HDMS 5.2 as the version:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Right-click the workflow line between the connected directory icons <strong>Identity</strong> <strong>Store</strong> and <strong>HiPath</strong>.</p>
</li>
<li>
<p>In the pop-up menu, select the workflow <strong>Ident_HiPath</strong> and then click <strong>Configure</strong>.</p>
</li>
<li>
<p>Click <strong>Ident2HiPath</strong> <strong>Attribute Mapping</strong>, then:</p>
</li>
<li>
<p>Change the output attribute <strong>text3</strong> (this one is not supported by the US version) to another unused attribute, for example <strong>info3</strong>.</p>
</li>
<li>
<p>Change the output attribute <strong>longname</strong> (this one is not supported by the US version) to another unused attribute, for example <strong>room</strong>.</p>
</li>
<li>
<p>Click <strong>HiPath2Ident</strong> <strong>Attribute Mapping</strong>, then:</p>
</li>
<li>
<p>Change the input attribute <strong>text3</strong> (this one is not supported by the US version) to another unused attribute, for example <strong>info3</strong> (use the same one you selected for <strong>Ident2HiPath</strong> <strong>Attribute Mapping</strong>).</p>
</li>
<li>
<p>Click <strong>Finish</strong> to close the wizard and save your changes.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Now the workflow should run.</p>
</div>
<div class="paragraph">
<p>The workflow transfers some information back to the Identity Store (for example, the telephoneNumber and facsimileTelephoneNumber). This workflow does not create or delete any entries (it assumes that the Identity Store is the master for entries).</p>
</div>
<div class="paragraph">
<p>For details, see the next sections.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_activity_ident2hipath_hipath_meta_directory_export"><a class="anchor" href="#_ch7_activity_ident2hipath_hipath_meta_directory_export"></a><a class="link" href="#_ch7_activity_ident2hipath_hipath_meta_directory_export">7.3.4.3. Activity Ident2HiPath_HiPath (meta directory export)</a></h5>
<div class="paragraph">
<p>This section describes the operation and the prerequisites of the Ident2HiPath_HiPath activity.</p>
</div>
<div class="sect5">
<h6 id="_ch7_general_features_and_prerequisites"><a class="anchor" href="#_ch7_general_features_and_prerequisites"></a><a class="link" href="#_ch7_general_features_and_prerequisites">7.3.4.3.1. General Features and Prerequisites</a></h6>
<div class="ulist">
<ul>
<li>
<p>Delta operation at the LDAP side.</p>
</li>
<li>
<p>Filter: Status = ENABLED or TBDEL.</p>
</li>
<li>
<p>Updates HiPath in merge mode (ADD operations are converted to INSERT operations in HiPath, MODIFY operations are converted to UPDATE operations in HiPath and DELETE operations are converted to DELETE operations in HiPath).</p>
</li>
<li>
<p>The workflow handles referential integrity for HDMS 3.X: If the Workflow detects that entries in HDMS tables COMPIMP, ORGIMP, BUILDIMP, LOCIMP are required before creating a Person in HDMS, it will create these entries implicitly.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The basic assumptions and prerequisites for this activity are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The attributes <strong>dxrState</strong>, <strong>dxmOprOriginator</strong> and <strong>createTimeStamp</strong> should be selected at the source side. If you intend to use an attribute other than dxrState as the status attribute, you need to customize the export post mapping and the export search filter.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_basic_operation"><a class="anchor" href="#_ch7_basic_operation"></a><a class="link" href="#_ch7_basic_operation">7.3.4.3.2. Basic Operation</a></h6>
<div class="paragraph">
<p>This activity performs a full or delta export of meta directory entries into a CSV file, which it then imports into an HiPath database. It has the following phases:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Initialization</strong> - This phase reads the relevant directory data and the complete HiPath database into a data file. This phase also creates a <strong>metacp</strong> index list handle that represents the database sorted by DMSIDs and a handle that represents the database sorted by join criteria (for example, employee Number) which is created in full mode only.</p>
</li>
<li>
<p><strong>Comparison</strong> - This phase compares the directory and HiPath and derives the required HiPath update actions, including creation of the related HiPath update request file.</p>
</li>
<li>
<p><strong>Update</strong> - This phase updates the HiPath database using the request file created in the comparison phase.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In <strong>full mode</strong>, export works as follows: it selects entries from the Identity Store (filter dxmOprStatus = ENABLED or TBDEL) and transfers them to the HiPath directory. For each entry in the directory search result, it considers the following cases:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Directory entry has related HiPath entries. In this case, perform these steps for each related DMSID:</p>
</li>
<li>
<p>Find related HiPath entry by DMSID.</p>
</li>
<li>
<p>If there is no match, this is considered as an inconsistency to be resolved by the administrator. The entry will be documented in the trace file as missing in HiPath.</p>
</li>
<li>
<p>If there is one match, update the related HiPath entry if directory entry is in state ENABLED (in particular, trace HiPath entry as up-to-date if no changes have been detected), and delete the related HiPath entry if the directory entry is in state TBDEL</p>
</li>
<li>
<p>Directory entry does not have related HiPath entries. Try to find the related HiPath-entry via best-guess-match and distinguish the following cases:</p>
</li>
<li>
<p>No HiPath-entry matches. If the Directory entry is in state TBDEL, nothing is to be done for that entry. Otherwise INSERT entry into HiPath.</p>
</li>
<li>
<p>More than one HiPath-entry matches. This ambiguity will be documented in the trace file.</p>
</li>
<li>
<p>Exactly one HiPath-entry matches. Consider the following subcases:</p>
</li>
<li>
<p>Directory entry is in state ENABLED. If the match is unique also in the directory. perform an UPDATE operation for updating the related HiPath-entry where the attributes to be synchronized are taken from the directory. The directory entry will also be updated with the related DMS-Identifier (if not yet present in the directory entry).</p>
</li>
<li>
<p>Directory entry is in state TBDEL If the match is unique also in the directory, then DELETE the related entry in HiPath.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In <strong>delta mode,</strong> there is a slight difference: for directory entries without related HiPath entries:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The creationTimestamp of the Directory entry is evaluated (no best-guess-match).</p>
</li>
<li>
<p>Entries with a creationTimestamp that is more recent than export-last-update-time will lead to an INSERT in HiPath.</p>
</li>
<li>
<p>Entries with a creationTimestamp that is less recent than export-last-update-time are assumed to have related HiPath entries from previous synchronization cycles. Therefore, such an entry (old creationTimestamp and no related HiPath entry) will be discarded and documented in the trace file.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_control_of_the_remote_hipath_system"><a class="anchor" href="#_ch7_control_of_the_remote_hipath_system"></a><a class="link" href="#_ch7_control_of_the_remote_hipath_system">7.3.4.3.3. Control of the Remote HiPath System</a></h6>
<div class="paragraph">
<p>The HDMSAgent uses a remote copy command in order to transfer files to the remote host, and a remote shell command to execute the HDMS request on the remote host:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The related remote copy command is <strong>rcp</strong> (remote copy) if the value of the <strong>remote_secure_interaction</strong> parameter is <strong>FALSE</strong>, and the command <strong>scp</strong> (secure shell), if the parameter value is <strong>TRUE</strong>.</p>
</li>
<li>
<p>The related remote shell command is <strong>rsh</strong> (remote shell) if the value of the <strong>remote_secure_interaction</strong> parameter is <strong>FALSE</strong>, and the command <strong>ssh</strong> (secure shell), if the parameter value is <strong>TRUE</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The meta controller script controls the remote HiPath system as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Creation of a request file, for example, x.req.</p>
</li>
<li>
<p>Copy request file to remote host, using the remote copy command.</p>
</li>
<li>
<p>Invoke the script <strong>remote_hdms</strong> on remote host, using said remote shell command.</p>
</li>
<li>
<p>The script <strong>remote_hdms</strong> calls <strong>dmsiepro</strong>c with request file (for example, x.req), the response file (for example, x.rsp) contains the result of each request specified in request file.</p>
</li>
<li>
<p>Copy response file from remote host using the remote copy command.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>To make this work correctly, you must set up the environment. See the section "Setting Up the HiPath Environment" for details.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_activity_hipath2ident_hipath_meta_directory_import"><a class="anchor" href="#_ch7_activity_hipath2ident_hipath_meta_directory_import"></a><a class="link" href="#_ch7_activity_hipath2ident_hipath_meta_directory_import">7.3.4.4. Activity HiPath2Ident_HiPath (meta directory import)</a></h5>
<div class="paragraph">
<p>This section describes the operation and the prerequisites of the HiPath2Ident_HiPath activity.</p>
</div>
<div class="sect5">
<h6 id="_ch7_general_features_and_prerequisites_2"><a class="anchor" href="#_ch7_general_features_and_prerequisites_2"></a><a class="link" href="#_ch7_general_features_and_prerequisites_2">7.3.4.4.1. General Features and Prerequisites</a></h6>
<div class="ulist">
<ul>
<li>
<p>Updates Directory in merge mode.</p>
</li>
<li>
<p>Performs MODIFY operations only.</p>
</li>
<li>
<p>A DELETEd HiPath-Entry is propagated as Directory MODIFY operation (it removes those attribute values which are correlated with the HiPath-Entry).</p>
</li>
<li>
<p>A INSERTed/UPDATEd HiPath-Entry is propagated as Directory MODIFY operation (it updates those Attribute values which are correlated with the HiPath-Entry).</p>
</li>
<li>
<p>It links multiple HiPath entries to one Directory Entry.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The basic assumptions and prerequisites for this activity are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The attributes objectClass, dxmOprOriginator and all attributes necessary for the join operation must be selected at the target side.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_basic_operation_2"><a class="anchor" href="#_ch7_basic_operation_2"></a><a class="link" href="#_ch7_basic_operation_2">7.3.4.4.2. Basic Operation</a></h6>
<div class="paragraph">
<p>This step performs a full or delta export of HiPath Person (PERS) entries into a CSV file, which it then imports into a meta directory database. The performed steps are:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Getting updated/deleted PERS-table entries from HiPath. In delta-mode, an appropriate SQL-like filter regarding creation/modification time is passed to HiPath.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>Connecting to the directory.</p>
</li>
<li>
<p>For each record in the result obtained in step 1, try to find the related Directory entry first by a join operation with employeeNumber, then with DMS-Identifier in the dxmOprOriginator attribute.</p>
<div class="ulist">
<ul>
<li>
<p>If the number of matches is different from one, document this fact in trace file.</p>
</li>
<li>
<p>If the match is unique, perform a MODIFY operation as follows:</p>
</li>
<li>
<p>For a deleted HiPath entry, remove the corresponding phone and fax numbers from the directory entry.</p>
</li>
<li>
<p>For an inserted/updated HiPath entry, update the corresponding phone and fax numbers from the directory entry.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Notes:</p>
</div>
<div class="paragraph">
<p>The parameter <strong>Multi Master Attribute List</strong> (from HiPath2Ident Entry Handling) specifies the list of attributes being subject to the special handling in import as described in this section above. The default setting defines the special handling (including maintenance of attribute dxmOprOriginator) to be applied for attributes telephoneNumber and facsimileTelephoneNumber only.</p>
</div>
<div class="paragraph">
<p>The parameter <strong>Keep Unmastered Attributes</strong> (from HiPath2Ident Entry Handling, default âTRUEâ) controls whether or not unmastered (for example, manually entered attribute values) will be preserved.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_multiple_entry_handling"><a class="anchor" href="#_ch7_multiple_entry_handling"></a><a class="link" href="#_ch7_multiple_entry_handling">7.3.4.5. Multiple Entry Handling</a></h5>
<div class="paragraph">
<p>The agent can handle LDAP directory entries and HiPath PERS table entries. Each LDAP directory entry that corresponds one-to-one with a HiPath entry will be extended by the objectClass value <strong>dxrUser</strong>.</p>
</div>
<div class="paragraph">
<p>This concept is a general concept for multi mastering of attribute values. Currently it is only implemented for the HiPath workflow. The method should be used sparingly because it decreases performance when used with a high number of entries.</p>
</div>
<div class="paragraph">
<p>The relevant attributes of this objectClass for the HiPath workflow are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>dxrState</strong> (status) - Only Directory Entries with status ENABLED and TBDEL are subject to synchronization into HiPath.</p>
</li>
<li>
<p><strong>dxmOprOriginator</strong> - A multivalued attribute in the form âvalue x of attribute y originates from entry of target system systemâ. The purpose of this attribute is storage of attribute mastership information. The attribute structure is:</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>master</em><mark><em>key</em></mark><em>attribute_name</em>#<em>attribute_value</em></p>
</div>
<div class="paragraph">
<p>with</p>
</div>
<div class="paragraph">
<p><em>master</em> - Name of the master system. The <strong>Master Name</strong> operational attribute of the connected directory is taken to define this value.</p>
</div>
<div class="paragraph">
<p><em>key</em> - unique identifier for an entry in related target system (for the HiPath workflow the DMSID is used)</p>
</div>
<div class="paragraph">
<p><em>attribute_name</em> - the mastered LDAP attribute name (for example telephoneNumber)</p>
</div>
<div class="paragraph">
<p><em>attribute_value</em> - the mastered LDAP attribute value (for example +49 89 722 12345)</p>
</div>
<div class="paragraph">
<p>Sample Attribute values are:</p>
</div>
<div class="paragraph">
<p>HDMS#12345#telephoneNumber#+49 89 123 12345<br>
HDMS#23456#facsimileTelephoneNumber#+49 89 987 65432<br>
HDMS#34567##</p>
</div>
<div class="paragraph">
<p>The first line represents the assertion âAttribute value #+49 89 123 12345 of attribute telephoneNumber originates from entry with DMSID=12345 of the master system with Master Name HDMS".</p>
</div>
<div class="paragraph">
<p>The last line represents just a link to a HiPath entry.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_setting_up_the_hipath_environment"><a class="anchor" href="#_ch7_setting_up_the_hipath_environment"></a><a class="link" href="#_ch7_setting_up_the_hipath_environment">7.3.4.6. Setting up the HiPath Environment</a></h5>
<div class="paragraph">
<p>This section provides instructions on how to set up the HiPath environment and then test it.</p>
</div>
<div class="paragraph">
<p>To set up the environment:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Copy (using ftp, for example) the <strong>remote_hdms</strong> shell script from the <em>install_path<strong>\</strong></em>*agents\HDMS* to the subdirectory specified in the <strong>remote_subdir</strong> parameter relative to the remote account specified by the <strong>remote_account</strong> parameter.</p>
</li>
<li>
<p>Edit the copied <strong>remote_hdms</strong> script to ensure that:</p>
</li>
<li>
<p>The DMS_DIR variable setting specified in the script matches the full pathname of the HDMS XIE import/export program on the remote HiPath installation.</p>
</li>
<li>
<p>The DATA_DIR variable setting specified in the script matches the setting in the <strong>remote_subdir</strong> parameter.</p>
</li>
<li>
<p>Ensure that the account that runs HDMSAgent on the local system has the rights to run <strong>rcp</strong> and <strong>rsh</strong> (or <strong>scp</strong> and <strong>ssh</strong>, respectively) to access the remote system.</p>
</li>
<li>
<p>Enable the HiPath environment for remote operation, depending on the <strong>remote_secure_interaction</strong> parameter. Enable the HiPath environment for <strong>rsh</strong> and <strong>rcp</strong> (see the section "Enable HiPath Environment for rsh and rcp"), if the parameter value is <strong>FALSE</strong>. Enable the HiPath environment for <strong>ssh</strong> and <strong>scp</strong> (see the section "Enable HiPath environment for ssh and scp"), if the parameter value is <strong>TRUE</strong>.</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="_ch7_user_creation_directives_for_hipath_4000_manager_v3_1"><a class="anchor" href="#_ch7_user_creation_directives_for_hipath_4000_manager_v3_1"></a><a class="link" href="#_ch7_user_creation_directives_for_hipath_4000_manager_v3_1">7.3.4.6.1. User Creation Directives for HiPath 4000 Manager V3.1</a></h6>
<div class="paragraph">
<p>Connectivity to a HiPath system requires a UNIX account that has read and write access over the HiPath XIE interface. UNIX accounts created with HiPath 4000 Manager V3.1 do not have these access rights. To create an account with the required access rights:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Log in as user <strong>engr</strong>. This is the root user of the HiPath 4000 system.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="8">
<li>
<p>Run the UNIX command <strong>useradd</strong> to create the account <strong>hdmsuser</strong>.</p>
</li>
<li>
<p>In the <strong>dmsie</strong> subdirectory of your HiPath installation, copy the file <strong>root</strong> and rename it to <strong>hdmsuser</strong>.</p>
</li>
<li>
<p>If you want to grant read and write access only for the <strong>PERSDAT</strong> table, delete all lines that are different from <strong>PERSDAT</strong> from the <strong>hdmsuser</strong> file.</p>
</li>
<li>
<p>Allow read access for all users to the file <strong>hdmsuser</strong>.</p>
</li>
<li>
<p>Add a line:*<br>
hdmsuser*<br>
to the <strong>.users</strong> file in the <strong>dmsie</strong> subdirectory of your HiPath installation.<br>
If the <strong>.users</strong> file does not exist, create this file with owner <strong>root</strong>, group <strong>sys</strong>, and access rights <strong>644</strong>.</p>
</li>
<li>
<p>Run the following <strong>procadmin</strong> commands:*<br>
<br>
procadmin -t -g XIEAPI<br>
procadmin -s -g XIEAPI<br>
procadmin -l -g XIEAPI*<br>
<br>
See your HiPath system documentation for details about the <strong>procadmin</strong> command.</p>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_enable_hipath_environment_for_rsh_and_rcp"><a class="anchor" href="#_ch7_enable_hipath_environment_for_rsh_and_rcp"></a><a class="link" href="#_ch7_enable_hipath_environment_for_rsh_and_rcp">7.3.4.6.2. Enable HiPath Environment for rsh and rcp</a></h6>
<div class="paragraph">
<p>Suppose that HDMSAgent runs on system <strong>host1</strong> from the account <strong>metauser</strong> and host1 has the network address <strong>ip1</strong>. Suppose you want to configure HDMSAgent for interaction with HDMS V3.1 on <strong>host2</strong>, network address <strong>ip2</strong>.</p>
</div>
<div class="paragraph">
<p>First, perform the following steps on <strong>host2</strong>:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create the account <strong>hdmsuser</strong> as described in the section "User creation directives for HiPath 4000 Manager V3.1" above. With XIE, grant full access rights to this account to manage the related tables PERS, COMPIMP, LOCIMP, BUILDIMP, ORGIMP. If you use another user account, be aware of the correct access rights.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="14">
<li>
<p>Log in as <strong>hdmsuser</strong>.</p>
</li>
<li>
<p>Edit the <strong>.rhosts</strong> file in the <strong>hdmsuser</strong> home directory to grant <strong>metauser</strong> on host1 <strong>rsh</strong>, <strong>rcp</strong> and <strong>ftp</strong> access (by creating an entry <strong>ip1</strong> <strong>metauser</strong> in the <strong>.rhosts</strong> file). Be sure that the spelling of the <strong>metauser</strong> account is correct (this field is case-sensitive).</p>
</li>
<li>
<p>Create the subdirectories <strong>req</strong> and <strong>bin</strong>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>For the actions required on host1, always use the correct (case-sensitive) account name in the login dialog (in our example, <strong>metauser</strong> instead of <strong>Metauser</strong>).</p>
</div>
<div class="paragraph">
<p>We recommend that you test your setup by running <strong>rcp</strong>, <strong>rsh</strong>, and <strong>remote_hdms</strong> by hand, as shown in the following example:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>On host1, remote copy (<strong>rcp</strong>) a file on the remote host into the <strong>req</strong> subdirectory of hdmsuser&#8217;s home directory:<br>
rcp xxx hdmsuser@&lt;ip2&gt;:req (if host1 is a UNIX host)<br>
rcp xxx &lt;ip2&gt;.hdmsuser:req (if host1 is Windows NT host)</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="17">
<li>
<p>On host1, remote copy (<strong>rcp</strong>) a file from host2 that exists in the <strong>req</strong> subdirectory of <strong>hdmsuser</strong>'s home directory but that does not exist in your current working directory:<br>
rcp hdmsuser@&lt;host2&gt;:req/xxx . (if host1 is a UNIX host)<br>
rcp hdmsuser@&lt;host2&gt;:req/xxx . (if host1 is a Windows NT host)</p>
</li>
<li>
<p>On host1, run a remote execution (<strong>rsh</strong>) of a simple command. For example:<br>
rsh ip2 -l hdmsuser ls -l req</p>
</li>
<li>
<p>On host2:</p>
<div class="ulist">
<ul>
<li>
<p>Log in as <strong>hdmsuser</strong> and create an HiPath request file $HOME/req/xxx.req with the following contents and no leading white spaces:<br>
# HDMS Call: xxx.req<br>
1;SELECT * FROM COMPIMP<br>
#@*<br>
<br>
Note*: For HDMS-US 5.2, HiPath 4000 Manager V1.0 and V3.0, the COMIMP table does not exist. Please use any other valid table (e.g. PERSDAT) instead of COMPIMP.</p>
</li>
<li>
<p>Change directory to the <strong>hdmsuser</strong> home directory.</p>
</li>
<li>
<p>On the command line, type <strong>bin/remote_hdms</strong> xxx.<strong>req</strong>.</p>
</li>
<li>
<p>On the command line, type <strong>echo$?</strong> to check the exit code. On success, the exit code is 0 and the file $HOME/req/xxx.rsp should exist with content that indicates successful execution of the request, such as:<br>
# HDMS Call: xxx.req; 2000-03-22 14:00:13.00<br>
#1;1<br>
38500|DE|PQR||||<br>
#@<br>
<br>
or (if the HDMS database is empty):<br>
# HDMS Call: xxx.req; 2000-03-22 14:00:13.00<br>
#1;0<br>
#@</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Define a user account, say <em>some_user_account</em>, that is to run HiPath Workflow. We recommend the DirX Identity installation account for this purpose wherever possible. Deviation from this recommendation will imply some extra work when configuring the workflow. Ensure that <em>some_user_account</em> has the permissions to call the HDMS XIE import/export program and has the permissions to manage the related tables using the XIE program, namely</p>
</div>
<div class="ulist">
<ul>
<li>
<p>PERS, COMPIMP, LOCIMP, BUILDIMP, ORGIMP for HDMS 3.X</p>
</li>
<li>
<p>PERSDAT for HDMS-US 5.2, HiPath 4000 Manager V1.0 and V3.0</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can also test your setup by running the HiPath Workflow in trial mode.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_hipath_environment_setup_for_ssh_and_scp"><a class="anchor" href="#_ch7_hipath_environment_setup_for_ssh_and_scp"></a><a class="link" href="#_ch7_hipath_environment_setup_for_ssh_and_scp">7.3.4.6.3. HiPath Environment Setup for ssh and scp</a></h6>
<div class="paragraph">
<p>For example, suppose that HDMSAgent runs on system <strong>host1</strong> from the account <strong>metauser</strong> and host1 has the network address <strong>ip1</strong>. Suppose you want to configure HDMSAgent for interaction with HDMS V3.1 on <strong>host2</strong>, network address <strong>ip2</strong>.</p>
</div>
<div class="paragraph">
<p>First, perform the following steps on <strong>host1</strong>:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Login as <strong>metauser</strong>.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="20">
<li>
<p>Create public/private key with the <strong>ssh-keygen</strong> command, as shown in the following sample dialog:<br>
<br>
$ cd<br>
$ ssh-keygen -t rsa<br>
<br>
Enter &lt;RETURN&gt; for all input requests and wait until the generation is finished.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Now, perform the following steps on <strong>host2</strong>:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create the account <strong>hdmsuser</strong> as described in section "User creation directives for HiPath 4000 Manager V3.0" above. With XIE, grant full access rights to this account to manage the related tables PERS, COMPIMP, LOCIMP, BUILDIMP, ORGIMP. If you use another user account, pay attention to the correct access rights.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="21">
<li>
<p>Log in as <strong>hdmsuser</strong>.</p>
</li>
<li>
<p>Transfer the public key (which you created for account <strong>metauser</strong> on host <strong>host1</strong>) to host2, for example <strong>scp metauser@host1:.ssh/id_rsa.pub ./metapublickey.txt</strong>. Be sure that the spelling of the metauser account is correct (this field is case sensitive).</p>
</li>
<li>
<p>Create the directory <strong>$HOME/.ssh</strong> if it does not yet exist.</p>
</li>
<li>
<p>Append the public key to the authorized keys file of the user <strong>hdmsuser</strong>, for example type <strong>cat $HOME/metapublickey.txt &gt;&gt; $HOME/.ssh/authorized_keys</strong>. Verify the permissions of the file <strong>authorized_keys</strong>. They should be 644.</p>
</li>
<li>
<p>Create the subdirectories <strong>req</strong> and <strong>bin</strong>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>For the actions required on host1, always use the correct (case-sensitive) account name in the login dialog (in our example, <strong>metauser</strong> instead of <strong>Metauser</strong>).</p>
</div>
<div class="paragraph">
<p>We recommend that you test your setup by running <strong>scp</strong>, <strong>ssh</strong>, and the <strong>remote_hdms</strong> by hand. It is essential that the commands <strong>scp</strong> and <strong>ssh</strong> execute without requesting a password. The commands can be tested as shown in the following example:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>On host1, remote copy (<strong>scp</strong>) a file on the remote host into the <strong>req</strong> subdirectory of <strong>hdmsuser</strong>'s home directory.<br>
scp xxx hdmsuser@&lt;ip2&gt;:req</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="26">
<li>
<p>On host1, remote copy (<strong>scp</strong>) a file from host2 that exists in the <strong>req</strong> subdirectory of <strong>hdmsuser</strong>'s home directory but that does not exist in your current working directory:<br>
scp hdmsuser@&lt;host2&gt;:req/xxx .</p>
</li>
<li>
<p>On host1, run a remote execution (<strong>ssh</strong>) of a simple command. For example:<br>
ssh hdmsuser@&lt;ip2&gt; ls -l req</p>
</li>
<li>
<p>On host2:</p>
<div class="ulist">
<ul>
<li>
<p>Log in as <strong>hdmsuser</strong> and create an HDMS request file $HOME/req/xxx.req with the following contents and no leading white spaces:<br>
# HDMS Call: xxx.req<br>
1;SELECT * FROM COMPIMP<br>
#@*<br>
<br>
Note*: For HDMS-US 5.2, HiPath 4000 Manager V1.0 and V3.0, the COMIMP table does not exist. Please use any other valid table (e.g. PERSDAT) instead of COMPIMP.</p>
</li>
<li>
<p>Change directory to the <strong>hdmsuser</strong> home directory.</p>
</li>
<li>
<p>On the command line, type <strong>bin/remote_hdms</strong> xxx<strong>.req</strong>.</p>
</li>
<li>
<p>On the command line, type e<strong>cho $?</strong> to check the exit code. On success, the exit code is 0 and the file $HOME/req/xxx.rsp should exist with content that indicates successful execution of the request, for example:<br>
# HDMS Call: xxx.req; 2000-03-22 14:00:13.00<br>
#1;1<br>
38500|DE|PQR||||<br>
#@<br>
<br>
or (if the HDMS database is empty):<br>
# HDMS Call: xxx.req; 2000-03-22 14:00:13.00<br>
#1;0<br>
#@</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Define a user account, say <em>some_user_account</em>, that is to run the HiPath workflow. We recommend the DirX Identity installation account for this purpose wherever possible; deviating from this recommendation will require some extra work when configuring the workflow. Ensure that <em>some_user_account</em> has the permissions to call the HDMS XIE import/export program and has the permissions to manage the related tables using the XIE program, namely</p>
</div>
<div class="ulist">
<ul>
<li>
<p>PERS, COMPIMP, LOCIMP, BUILDIMP, ORGIMP for HDMS 3.X</p>
</li>
<li>
<p>PERSDAT for HDMS-US 5.2, HiPath 4000 Manager V1.0 and V3.0</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can also test your setup by running the HiPath workflow in trial mode.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_export_traces"><a class="anchor" href="#_ch7_export_traces"></a><a class="link" href="#_ch7_export_traces">7.3.4.7. Export Traces</a></h5>
<div class="paragraph">
<p>The export trace file records the progress of the export task and statistical information about the operations being performed. This section describes the format of the generated information, which consists of these sections:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Meta directory entries</p>
</li>
<li>
<p>HiPath entries</p>
</li>
<li>
<p>Derived HiPath updates</p>
</li>
<li>
<p>Derived Directory updates</p>
</li>
<li>
<p>HiPath update statistics</p>
</li>
<li>
<p>DMS identifier update statistics</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="_ch7_meta_directory_entry_section"><a class="anchor" href="#_ch7_meta_directory_entry_section"></a><a class="link" href="#_ch7_meta_directory_entry_section">7.3.4.7.1. Meta Directory Entry Section</a></h6>
<div class="ulist">
<ul>
<li>
<p><strong>Directory entries:</strong> Number of meta directory entries to be synchronized into HiPath.</p>
</li>
<li>
<p><strong>Discarded:</strong> Number of "invalid" meta directory entries to be discarded. By default (that is, default definition of the export user hook uh::LoopExtraFilter), an entry will be discarded in delta mode if it does not have any related HiPath entry but is older than the "last export" time. In this case, HiPath Workflow assumes that a previous synchronization attempt of the entry into the HiPath database failed and discards the entry. The meta controller trace file contains notices about such entries.</p>
</li>
<li>
<p><strong>Missing in HiPath:</strong> Number of meta directory entries with DMS identifier that are not marked as to be deleted in HiPath, but do not exist in HiPath. The meta controller trace file contains notices about such entries.</p>
</li>
<li>
<p><strong>Deleted in Directory and HiPath:</strong> Number of meta directory entries with flag <strong>deleted in HiPath</strong> set to TRUE. The trace file will contain notices about such entries.</p>
</li>
<li>
<p><strong>To-Be-Deleted, missing in HiPath:</strong> Number of meta directory entries with a DMS identifier that are marked as to be deleted in HiPath, but do not exist in HiPath. The trace-file will contain notices about such entries.</p>
</li>
<li>
<p><strong>Ambiguous in Directory:</strong> Number of meta directory entries where the related HiPath entry has been found by best-guess match, but where multiple entries have the same related HiPath entry. The meta controller trace file will contain notices about such entries.</p>
</li>
<li>
<p><strong>Ambiguous in HiPath:</strong> Number of meta directory entries where the related HiPath entry cannot be determined uniquely by best-guess match. The meta controller trace file will contain notices about such entries.</p>
</li>
<li>
<p><strong>Up-to-date in HiPath:</strong> Number of meta directory entries where the related HiPath entry is already up-to-date with respect to the attributes to be synchronized.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p># Directory entries: 9<br>
# Discarded: 0<br>
# Missing in HDMS: 0<br>
# Deleted in Directory and HDMS : 0<br>
# To-Be-Deleted, missing in HDMS: 0<br>
# Ambiguous in Directory: 0<br>
# Ambiguous in HDMS: 0<br>
# Up-to-date in HDMS: 3</p>
</div>
</div>
</div>
<div class="paragraph">
<p>In this example, 9 meta directory entries have been detected to be synchronized into HiPath, 3 of them are already up-to-date.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_hipath_entry_section"><a class="anchor" href="#_ch7_hipath_entry_section"></a><a class="link" href="#_ch7_hipath_entry_section">7.3.4.7.2. HiPath Entry Section</a></h6>
<div class="paragraph">
<p>If HiPath workflow has loaded the PERS table and one or more of its dependent tables (COMPIMP, ORGIMP, LOCIMP, and BUILDIMP) were examined for referential integrity, this section shows the number of entries in each table.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p># HDMS PERS-table entries: 6<br>
# HDMS COMPIMP-table entries: 1<br>
# HDMS ORGIMP-table entries: 5<br>
# HDMS LOCIMP-table entries: 4<br>
# HDMS BUILDIMP-table entries: 4</p>
</div>
</div>
</div>
<div class="paragraph">
<p>If HiPath workflow does not need to load one or more of these tables (for example, if it detects only up-to-date entries) the section contains a message that the table has not been loaded. For example:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p># HDMS ORGIMP-table not loaded.</p>
</div>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_derived_hipath_updates_section"><a class="anchor" href="#_ch7_derived_hipath_updates_section"></a><a class="link" href="#_ch7_derived_hipath_updates_section">7.3.4.7.3. Derived HiPath Updates Section</a></h6>
<div class="paragraph">
<p>The derived HiPath Updates section shows the HiPath database update actions that the HiPath workflow export comparison phase has determined. A counter exists for each action to be performed in the HiPath database. For example:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p># HDMS-Update-Actions derived in Comparision phase<br>
# PERS-table INSERTs: 3<br>
# PERS-table UPDATEs: 1<br>
# PERS-table DELETEs: 2<br>
# COMPIMP-table INSERTS: 0<br>
# ORGIMP-table INSERTS: 2<br>
# LOCIMP-table INSERTS: 0<br>
# BUILDIMP-table INSERTS: 0</p>
</div>
</div>
</div>
<div class="paragraph">
<p>In this example, HiPath workflow requests INSERT of 3 PERS-table entries, UPDATE of 1 PERS-table entry, and DELETE of 2 PERS-TABLE entries. In addition, two organizations (ORGIMP table entries) will be created for support of referential integrity.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_hipath_update_statistics"><a class="anchor" href="#_ch7_hipath_update_statistics"></a><a class="link" href="#_ch7_hipath_update_statistics">7.3.4.7.4. HiPath Update Statistics</a></h6>
<div class="paragraph">
<p>This section shows a counter for each HiPath update action that HiPath workflow can perform and whether or not it succeeded or failed for this synchronization task. The INSERTs are not counted per-table.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p># HDMS update statistics:<br>
# Successful INSERTs: 4<br>
# Unsuccessful INSERTs: 1<br>
# Successful UPDATEs: 1<br>
# Unsuccessful UPDATEs: 0<br>
# Successful DELETEs: 2</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_customizing_the_hipath_workflow"><a class="anchor" href="#_ch7_customizing_the_hipath_workflow"></a><a class="link" href="#_ch7_customizing_the_hipath_workflow">7.3.4.8. Customizing the HiPath Workflow</a></h5>
<div class="paragraph">
<p>You can customize the HiPath workflow in many areas, but it requires Tcl know-how.</p>
</div>
<div class="sect5">
<h6 id="_ch7_job_authentication"><a class="anchor" href="#_ch7_job_authentication"></a><a class="link" href="#_ch7_job_authentication">7.3.4.8.1. Job Authentication</a></h6>
<div class="paragraph">
<p>You must make sure that the HiPath workflow uses the authentication that has been used when testing the remote copy and remote shell command in previous setup steps. Check the Authentication tab of both Jobs of the HiPath Workflow. There are 2 possibilities:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If your Identity IdS-C service already runs with the appropriate account (i.e. because in our example above), the authentication tab should not contain any data.</p>
</li>
<li>
<p>If your Identity IdS-C service runs as local system account (on Windows platforms) or another accounts being privileged to launch jobs with different user authentication, you must enter authentication information (i.e. User Name = metauser in our example above and password and domain as appropriate).</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_ident2hipath_target_selected_attributes_and_hipath2ident_source_selected_attributes"><a class="anchor" href="#_ch7_ident2hipath_target_selected_attributes_and_hipath2ident_source_selected_attributes"></a><a class="link" href="#_ch7_ident2hipath_target_selected_attributes_and_hipath2ident_source_selected_attributes">7.3.4.8.2. Ident2HiPath Target Selected Attributes and HiPath2Ident Source Selected Attributes</a></h6>
<div class="paragraph">
<p>The correct attribute set is chosen implicitly by the HiPath Workflow itself in dependency of the <strong>HDMS Version</strong> defined in the related HiPath connected directory. This approach is much more comfortable than selecting dozens of attributes one-by-one and putting them into the appropriate order. There is a drawback of this approach:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The Identity Manager will not be able to detect and visualize invalid HiPath attribute mapping rules and select boxes for HiPath join expression</p>
</li>
<li>
<p>The administrator must use the appropriate HiPath attribute abbreviations (when using attributes in customized TCL code) and HiPath attribute names (when using Identity Manager)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See section HiPath Tables for valid attribute abbreviations and names for your HDMS/HiPath version.</p>
</div>
<div class="paragraph">
<p>Note: If the HiPath workflow shall support a customer extended HiPath dataschema, you need to customize the <strong>file_attr_list</strong> variables:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Change the statement <strong>set src_conn_param(attr_list) "$file_attr_list_tpl($hdms_version)"</strong> for computation of variable file_attr_list in the script <strong>Import HDMS Var Tcl Script</strong> of the import task</p>
</li>
<li>
<p>Change the statement <strong>set tgt_conn_param(attr_list) "$file_attr_list_tpl($hdms_version)"</strong> for computation of variable file_attr_list in the script âExport HDMS Var Tcl Scriptâ of the Export Task</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_ident2hipath_attribute_mapping"><a class="anchor" href="#_ch7_ident2hipath_attribute_mapping"></a><a class="link" href="#_ch7_ident2hipath_attribute_mapping">7.3.4.8.3. Ident2HiPath Attribute Mapping</a></h6>
<div class="paragraph">
<p>The default attribute mapping is suitable for a synchronization where entries are joined by a unique identifier (e.g. dxmGUID) which is stored in an unused HiPath attribute (e.g. text3). Moreover, this mapping computes all attributes which are required for creation of person entries and - for HDMS 3.X - implicit creation of additional entries (in tables COMPIMP, ORGIMP, BUILDIMP, LOCIMP).</p>
</div>
<div class="paragraph">
<p>Please note that target attribute text3 is not appropriate for HDMS US 5.2. For this HDMS release, another attribute must be used (e.g. info3). Please note that target attribute longname is not suitable for HDMS-US 5.2. For this HDMS release, another attribute must be used (e.g. room)</p>
</div>
<div class="paragraph">
<p>In general, appropriate mappings must be defined for your attributes constituting your join criteria (HDMS Join expression and Joinback expression). The postmapping section updates the ChangeType based on the status attribute which is dxrState by default. If your status attribute is other than dxrState, then you must customize this section and to cross-check your customization with the source selected attributes and the export filter.</p>
</div>
<div class="paragraph">
<p>Please note some special mapping rules:</p>
</div>
<div class="paragraph">
<p><strong>Special meaning of empty value</strong> - An empty string value (ââ) for a HiPath attribute denotes, that the related attribute will be left unchanged when modifying a HiPath entry.</p>
</div>
<div class="paragraph">
<p><strong>Special meaning of blank value</strong> - If you intend to delete an attribute in HiPath in order to synchronize deletion of related attribute in the Directory, then your mapping must result into a blank value.<br>
Example: Suppose you intend to synchronize the ldap attribute description onto HiPath attribute text1. Then you need:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A mapping rule mapping description onto text1</p>
</li>
<li>
<p>A statement in the postmapping section like:<br>
<br>
if \{ $rh_dms(TEXT1) == } then \{<br>
set rh_dms(TEXT1) [llist â â ];# list containing non-empty string with a blank}</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_ident2hipath_export_properties"><a class="anchor" href="#_ch7_ident2hipath_export_properties"></a><a class="link" href="#_ch7_ident2hipath_export_properties">7.3.4.8.4. Ident2HiPath Export Properties</a></h6>
<div class="paragraph">
<p>The <strong>HDMS Join Expression</strong> / <strong>Joinback expression</strong> parameters define the best-guess-match policy that HiPath Workflow is to use to join meta directory and HiPath entries. Each Attribute in Joinback Expression must correspond one-to-one with an attribute in HiPath Join Expression. For example:</p>
</div>
<div class="paragraph">
<p>Joinback Expression: surname and givenname</p>
</div>
<div class="paragraph">
<p>HDMS Join Expression: name and christianname</p>
</div>
<div class="paragraph">
<p>In this example, HiPath workflow is to match meta directory entries with HiPath entries using a combination of surname and given name. The meta directory sn (surname) attribute maps to the HiPath attribute ânameâ and the meta directory gn (given name) attribute maps to the HiPath attribute âchristiannameâ. There must be related mapping rules.</p>
</div>
<div class="paragraph">
<p>These settings assume that each meta directory entry can be identified by a unique identifier which is stored in the attribute âtext3â of an HiPath entry. Please note that attribute text3 is not appropriate for HDMS US 5.2. For this HiPath release, another attribute must be used (e.g., info3).</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_hipath2ident_attribute_mapping"><a class="anchor" href="#_ch7_hipath2ident_attribute_mapping"></a><a class="link" href="#_ch7_hipath2ident_attribute_mapping">7.3.4.8.5. HiPath2Ident Attribute Mapping</a></h6>
<div class="paragraph">
<p>The <strong>postmapping</strong> computes a filter value to be used on the attribute dxmOprOriginator in the form:</p>
</div>
<div class="paragraph">
<p>&lt;master name&gt;#dmsidval#*</p>
</div>
<div class="paragraph">
<p>The dmsidval variable was computed in the mapping table.</p>
</div>
<div class="paragraph">
<p>This filter works on the dxmOprAttribute that contains values of the form:</p>
</div>
<div class="paragraph">
<p><em>mastername</em><mark><em>dmsidval</em></mark><em>attributename</em>#<em>attributevalue</em></p>
</div>
<div class="paragraph">
<p>The specific handling of this attribute is done in the workflow-specific user hook uh::LoopPostJoin.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_hipath_tables"><a class="anchor" href="#_ch7_hipath_tables"></a><a class="link" href="#_ch7_hipath_tables">7.3.4.9. HiPath Tables</a></h5>
<div class="paragraph">
<p>These tables define the relationship between the abbreviation names used in the DirX Identity workflows and the HDMS/HiPath name.</p>
</div>
<div class="paragraph">
<p>The first column contains the field number in the interface file, the second column the DirX Identity abbreviation name and the third the related HDMS/HiPath name.</p>
</div>
<div class="sect5">
<h6 id="_ch7_hdms_3_1_conversion_table"><a class="anchor" href="#_ch7_hdms_3_1_conversion_table"></a><a class="link" href="#_ch7_hdms_3_1_conversion_table">7.3.4.9.1. HDMS 3.1 Conversion Table</a></h6>
<div class="paragraph">
<p>See the Hicom DMS 3.1 SA4, Service Manual, Section "Import/Export interface API" for full details about XIE interface request/response format and the meaning of the attributes.</p>
</div>
<div class="paragraph">
<p>1 - CMD - identifier<br>
2 - C - country<br>
3 - O - company<br>
4 - ORG1 - org1<br>
5 - ORG2 - org2<br>
6 - ORG3 - org3<br>
7 - NAME - name<br>
8 - SRTNAME - sortname<br>
9 - CHN - christianname<br>
10 - TIT - title<br>
11 - SAL - salutation<br>
12 - LOC - location<br>
13 - BUILD - building<br>
14 - LNAME - longname<br>
15 - EXT - extension<br>
16 - SWITCH - switch<br>
17 - POS - position<br>
18 - TIENUM - tienum<br>
19 - EXTAREA - ext_areacode<br>
20 - EXTNET - ext_netcode<br>
21 - EXTEXT - ext_ext<br>
22 - FTN - faxnumber<br>
23 - OWNGROUP - owner_group<br>
24 - DIRTRACC - direct_trunc_acc<br>
25 - TEXT1 - text1<br>
26 - TEXT2 - text2<br>
27 - TEXT3 - text3</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_hdms_3_6_conversion_table"><a class="anchor" href="#_ch7_hdms_3_6_conversion_table"></a><a class="link" href="#_ch7_hdms_3_6_conversion_table">7.3.4.9.2. HDMS 3.6 Conversion Table</a></h6>
<div class="paragraph">
<p>See the Hicom DMS 3.6, Service Manual, Section "Import/Export interface API" for full details about XIE interface request/response format and the meaning of the attributes.</p>
</div>
<div class="paragraph">
<p>1 - CMD - Command<br>
2 - C - country<br>
3 - O - company<br>
4 - ORG1 - org1<br>
5 - ORG2 - org2<br>
6 - ORG3 - org3<br>
7 - NAME - name<br>
8 - SRTNAME - sortname<br>
9 - CHN - christianname<br>
10 - TIT - title<br>
11 - SAL - salutation<br>
12 - LOC - location<br>
13 - BUILD - building<br>
14 - LNAME - longname<br>
15 - EXT - extension<br>
16 - SWITCH - switch<br>
17 - POS - position<br>
18 - TIENUM - tienum<br>
19 - EXTAREA - ext_areacode<br>
20 - EXTNET - ext_netcode<br>
21 - EXTEXT - ext_ext<br>
22 - FTN - faxnumber<br>
23 - OWNGROUP - owner_group<br>
24 - DIRTRACC - direct_trunc_acc<br>
25 - TEXT1 - text1<br>
26 - TEXT2 - text2<br>
27 - TEXT3 - text3<br>
28 - TEXT4 - text4<br>
29 - IMPDATA - import_dat<br>
30 - ACCCTRL - access_control<br>
31 - MODDATE - modify_date<br>
32 - EQ - equipment<br>
33-52 - L1-L20 - l1-l20<br>
53 - LPREFIX - l_prefix<br>
54 - EXTCC - ext_cc<br>
55 - COSTCENTRE - costcentre<br>
56 - CHARGEID - charge_id<br>
57 - BANKCODE - bankcode<br>
58 - ACCNUM - accnum</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_hdms_5_2_conversion_table"><a class="anchor" href="#_ch7_hdms_5_2_conversion_table"></a><a class="link" href="#_ch7_hdms_5_2_conversion_table">7.3.4.9.3. HDMS 5.2 Conversion Table</a></h6>
<div class="paragraph">
<p>See the Hicom DMS-US 5.2, Service Manual, Section "Import/Export interface API" for full details about XIE interface request/response format and the meaning of the attributes.</p>
</div>
<div class="paragraph">
<p>1 - CMD - Command<br>
2 - SWITCH - switch<br>
3 - DOMAIN - domain<br>
4 - C - country<br>
5 - O - company<br>
6 - ORG1 - org1<br>
7 - ORG2 - org2<br>
8 - ORG3 - org3<br>
9 - NAME - name<br>
10 - SRTNAME - sortname<br>
11 - CHN - christianname<br>
12 - TIT - title<br>
13 - ADDR - address<br>
14 - LOC - location<br>
15 - BUILD - building<br>
16 - ROOM - room<br>
17 - STATION - station<br>
18 - POS - position<br>
19 - TIENUM - tienum<br>
20 - EXTAREA - ext_areacode<br>
21 - EXTNET - ext_netcode<br>
22 - EXTEXT - ext_ext<br>
23 - FTN - faxnumber<br>
24 - IMPDATA - import_dat<br>
25 - OWNGROUP - owner_group<br>
26 - MODDATE - modify_date<br>
27 - ACCCTRL - access_control<br>
28 - INFO1 - info1<br>
29 - INFO2 - info2<br>
30 - INFO3 - info3<br>
31 - INFO4 - info4<br>
32 - DIRTRACC - direct_trunc_acc<br>
33 - EQ - equipment<br>
34-53 - L1-L20 - l1-l20<br>
54 - LPREFIX - l_prefix<br>
55 - IDF - idf<br>
56 - IDFCABLEPAIR - Idf_cable_pair<br>
57-71 - INFO5-INFO19 - info5-info19</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_hipath_4000_manager_v1_0_conversion_table"><a class="anchor" href="#_ch7_hipath_4000_manager_v1_0_conversion_table"></a><a class="link" href="#_ch7_hipath_4000_manager_v1_0_conversion_table">7.3.4.9.4. HiPath 4000 Manager V1.0 Conversion Table</a></h6>
<div class="paragraph">
<p>See the HiPath Manager V1.0, Service Manual, Section "Import/Export interface API" for full details about XIE interface request/response format and the meaning, syntax, format and maximum length of the attributes.</p>
</div>
<div class="paragraph">
<p>1 - CMD - cmd<br>
2 - C - country<br>
3 - O - company<br>
4 - ORG1 - org1<br>
5 - ORG2 - org2<br>
6 - ORG3 - org3<br>
7 - ORG4 - org4<br>
8 - ORG5 - org5<br>
9 - ORG6 - org6<br>
10 - NAME - name<br>
11 - SRTNAME - srtname<br>
12 - CHN - christianname<br>
13 - TIT - title<br>
14 - SAL - salutation<br>
15 - LOC - location<br>
16 - BUILD - building<br>
17 - LNAME - longname<br>
18 - EXT - extension<br>
19 - SWITCH - switch<br>
20 - SEQNUM - seq_num<br>
21 - TIENUM - tienum<br>
22 - EXTAREA - ext_areacode<br>
23 - EXTNET - ext_netcode<br>
24 - EXTEXT - ext_ext<br>
25 - FTN - faxnumber<br>
26 - IMPDATA - import_dat<br>
27 - OWNGROUP - owner_group<br>
28 - MODDATE - modify_date<br>
29 - ACCCTRL - access_control<br>
30 - TEXT1 - text1<br>
31 - TEXT2 - text2<br>
32 - TEXT3 - text3<br>
33 - DIRTRACC - direct_trunc_acc<br>
34 - EQ - equipment<br>
35-54 - L1-L20 - l1-l20<br>
55 - LPREFIX - l_prefix<br>
56 - TEXT4 - text4<br>
57 - EXTCC - ext_cc<br>
58 - CHARGEID - chargeid<br>
59 - BASCHCLASS - basic_charge_class<br>
60 - BANKCODE - bankcode<br>
61 - ACCNUM - accnum<br>
62 - XPREXISTS - xpr_exists<br>
63 - XPRKEY - xpr_key<br>
64 - XPRPIN - xpr_pin<br>
65 - XPRSERVER - xpr_server<br>
66 - XPRVMSADMIN - xpr_vmsadmin<br>
67 - XPRBROADCAST - xpr_broadcast<br>
68 - XPRDCTSEND - xpr_dctsend<br>
69 - XPRDCTRCV - xpr_dctrcv<br>
70 - XPRPWD - xpr_password<br>
71 - XPRNAME - xpr_name<br>
72 - XPRFLAG1 - xpr_flag1<br>
73 - XPRFLAG2 - xpr_flag2<br>
74 - XPRCONNECT - xpr_connect<br>
75 - XPRQUOTA - xpr_quota<br>
76 - XPRRESERVE1 - xpr_reserve1<br>
77 - XPRRESERVE2 - xpr_reserve2<br>
78 - PERSNUM - persnum<br>
79 - DOMAIN - domain<br>
80 - IDF - idf<br>
81 - IDFCABLEPAIR - idf_cable_pair<br>
82-96 - INFO5-INFO19 - info5-info19<br>
97 â VSW â v_switch<br>
98 â HUSID â usid<br>
99 â UMUI â umuid<br>
100 â UMUS â um_user<br>
101 â UMM - um_marked<br>
102 â UMOP - um_operation_id</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_hipath_4000_manager_v3_1_conversion_table"><a class="anchor" href="#_ch7_hipath_4000_manager_v3_1_conversion_table"></a><a class="link" href="#_ch7_hipath_4000_manager_v3_1_conversion_table">7.3.4.9.5. HiPath 4000 Manager V3.1 Conversion Table</a></h6>
<div class="paragraph">
<p>See the HiPath 4000 Manager V3.1, section "Import/Export interface API" in the Service Documentation for details about the XIE interface request/response format and the meaning, syntax, format and maximum length of the attributes.</p>
</div>
<div class="paragraph">
<p>1 through 102 - See the section "HiPath 4000 Manager V1.0 Conversion Table" above<br>
103 - APEGRNO apg_group_no<br>
104 - XPRDELPW - xpr_delpwd<br>
105 - XPRDELPWTMP - xpr_delpwd_tmp</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch7_odbc_workflows"><a class="anchor" href="#_ch7_odbc_workflows"></a><a class="link" href="#_ch7_odbc_workflows">7.3.5. ODBC Workflows</a></h4>
<div class="paragraph">
<p>The DirX Identity ODBC workflows provision an ODBC target system. Two workflows are available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>ODBC2Ident_Validation</strong> - performs initial load or validation from an ODBC target system</p>
</li>
<li>
<p><strong>Ident_ODBC_Sync</strong> - synchronizes the DirX Identity target system and the real ODBC target system</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The workflows' implementation assumes the following table layout in the ODBC target system:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A table of groups, where each row represents one group</p>
</li>
<li>
<p>A table of accounts, where each row represents one account</p>
</li>
<li>
<p>A table of memberships where each row represents a membership of one account in one group</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The next sections provide conceptual and configuration information about the ODBC Provisioning workflows.</p>
</div>
<div class="sect4">
<h5 id="_ch7_prerequisites_and_limitations_4"><a class="anchor" href="#_ch7_prerequisites_and_limitations_4"></a><a class="link" href="#_ch7_prerequisites_and_limitations_4">7.3.5.1. Prerequisites and Limitations</a></h5>
<div class="paragraph">
<p>Before you can use the ODBC workflows, you must extend the DirX Identity Store schema with ODBC target system-specific attributes and object classes so that the workflows can store ODBC-specific information in the Identity Store. For instructions, see the section "Extending the Schema for the Target System Workflows".</p>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_odbc_workflow_concepts"><a class="anchor" href="#_ch7_odbc_workflow_concepts"></a><a class="link" href="#_ch7_odbc_workflow_concepts">7.3.5.2. ODBC Workflow Concepts</a></h5>
<div class="paragraph">
<p>This section explains the concepts of the workflow implementation.</p>
</div>
<div class="sect5">
<h6 id="_ch7_attribute_correlation_2"><a class="anchor" href="#_ch7_attribute_correlation_2"></a><a class="link" href="#_ch7_attribute_correlation_2">7.3.5.2.1. Attribute Correlation</a></h6>
<div class="paragraph">
<p>The ODBC Tcl-based workflow assumes the same database structure as the JDBC Java-based workflow. For details, see the section "Target System Configuration" in "JDBC Provisioning Workflows".</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_attribute_configuration"><a class="anchor" href="#_ch7_attribute_configuration"></a><a class="link" href="#_ch7_attribute_configuration">7.3.5.2.2. Attribute Configuration</a></h6>
<div class="paragraph">
<p>Note that the attribute configuration contains two additional pseudo-attributes <strong>addMember</strong> and <strong>delMember</strong> that do not exist in the database. These attributes are used to transform multiple joined database records to the DirX Identity multi-valued attributes dxrGroupMemberAdd and dxrGroupMemberDelete and vice-versa.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_identity_multi_valued_attribute_to_odbc_multi_record_transformation"><a class="anchor" href="#_ch7_identity_multi_valued_attribute_to_odbc_multi_record_transformation"></a><a class="link" href="#_ch7_identity_multi_valued_attribute_to_odbc_multi_record_transformation">7.3.5.2.3. Identity Multi-Valued Attribute to ODBC Multi-Record Transformation</a></h6>
<div class="paragraph">
<p>This section provides information about the transformation of DirX Identity multi-valued attributes to ODBC multi-records, from the ODBC-to-Identity direction and vice-versa.</p>
</div>
<div class="paragraph">
<p><strong>From ODBC to DirX Identity:</strong></p>
</div>
<div class="paragraph">
<p>The reading of group memberships in ODBC is performed by special join operations. For every membership, one result record is retrieved. In DirX Identity, each member is stored in a multi-valued attribute (dxrGroupMemberImported, dxrGroupMemberaAdd and dxrGroupMemberDelete).</p>
</div>
<div class="paragraph">
<p>A special profile script <strong>ODBC2Role</strong> is used for the transformation operation. The script assumes that the ODBC records are sorted by groups. As long as records of the same group are read, only the membership attributes are accumulated. At the end, or when reading a different group record, the accumulated record is written.</p>
</div>
<div class="paragraph">
<p>The following procedure accumulates members:</p>
</div>
<div class="paragraph">
<p>proc appendMV \{ source_data<br>
rec_data<br>
first} \{<br>
#<br>
# appends the members to the multi-valued attributes delmember/addmember<br>
# depending on the changetype<br>
#<br>
# Parameters:<br>
# src_data name of source handle (if 'src_dir_type' is 'File')<br>
# rec_data handle of currently read data record<br>
# first TRUE first record of group (use set else lappend)<br>
#<br>
# Return Values:</p>
</div>
<div class="paragraph">
<p>This default appendMV procedure works well for the synchronization workflow because it handles change types.</p>
</div>
<div class="paragraph">
<p>The <strong>ODBC profile script</strong> in the validation workflow requires a special appendMV procedure, which is defined in the user hook script of the <strong>ODBC2Ident_ValGroup_MetaCP</strong> job. Here the members are accumulated in the field <strong>AccountDxrName</strong> of the source record. The attribute that is used to determine records that belong to same group is hard-coded into <strong>GroupDxrName</strong>.</p>
</div>
<div class="paragraph">
<p><strong>From Identity to ODBC:</strong></p>
</div>
<div class="paragraph">
<p>DirX Identity uses the multi-valued attributes dxrGroupMemberAdd and dxrGroupMemberDelete to store memberships. For every member to be added, an ODBC add operation to the memberships tables is generated. For every member to be deleted, an ODBC delete operation to the memberships table is generated.</p>
</div>
<div class="paragraph">
<p>This procedure is part of the user hook script of the <strong>Role2ODBC_SyncGroupMembers_MetaCP</strong> job (LoopExtraFunction). For every member a <strong>rh_file_tgt</strong> handle is created. The data is mapped to it and the appropriate changetype is set. Afterwards it is written with write_record and then released. Because the DB keys are used for ODBC operation, the DB key for the account is read from the account&#8217;s dxrPrimary key Attribute, which results in one extra search per membership.</p>
</div>
<div class="paragraph">
<p>As all mapping is performed in the user hooks routine, the mapping routine itself is very small. In postJoinMapping, the action is set to "none", so no extra record is written for this dummy mapped record.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_odbc_validation_workflow"><a class="anchor" href="#_ch7_odbc_validation_workflow"></a><a class="link" href="#_ch7_odbc_validation_workflow">7.3.5.3. ODBC Validation Workflow</a></h5>
<div class="paragraph">
<p>The entries from the ODBC database are loaded into DirX Identity. The ODBC database is treated as the entry master. In validation mode, the workflow writes ToDo Messages to the DirX Identity objects that are not synchronized with the ODBC database.</p>
</div>
<div class="sect5">
<h6 id="_ch7_workflow_activities"><a class="anchor" href="#_ch7_workflow_activities"></a><a class="link" href="#_ch7_workflow_activities">7.3.5.3.1. Workflow Activities</a></h6>
<div class="paragraph">
<p>The validation workflow uses the following activities:</p>
</div>
<div class="paragraph">
<p><strong>ODBC2Ident_ODBCExport</strong> - exports groups with their memberships from the ODBC database.</p>
</div>
<div class="paragraph">
<p><strong>ODBC2Ident_ValGroup_metaCP</strong> - handles groups and memberships in DirX Identity.</p>
</div>
<div class="paragraph">
<p><strong>ODBC2Ident_ValAccount_ODBCExport</strong> - exports accounts from the ODBC database.</p>
</div>
<div class="paragraph">
<p><strong>ODBC2Ident_ValAccount_metaCP</strong> - handles accounts in DirX Identity.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_dirx_identity_groupsmemberships_handling"><a class="anchor" href="#_ch7_dirx_identity_groupsmemberships_handling"></a><a class="link" href="#_ch7_dirx_identity_groupsmemberships_handling">7.3.5.3.2. DirX Identity-Groups/Memberships Handling</a></h6>
<div class="paragraph">
<p>The following select statement exports groups and their members:</p>
</div>
<div class="paragraph">
<p>Keys=GroupDxrName,MembershipGroupID,MembershipAccountID</p>
</div>
<div class="paragraph">
<p>Select=AccountDxrName,GroupDxrName,MembershipAccountID,MembershipGroupID,GroupID</p>
</div>
<div class="paragraph">
<p>From=(Groups LEFT JOIN Memberships ON Memberships.GroupID=Groups.ID) LEFT JOIN Accounts ON Accounts.ID=Memberships.AccountID</p>
</div>
<div class="paragraph">
<p>Where=1=1 ORDER BY Groups.dxrGroupname</p>
</div>
<div class="paragraph">
<p>The statement generates one record into the export file for each membership. Groups without members are also exported (LEFT JOIN, one record for each empty group).</p>
</div>
<div class="paragraph">
<p>As described in the section "Identity Multi-Valued Attribute to ODBC Multi Record Transformation", all records for a specific group are accumulated to one record, where dxrAccountName contains all members as a multi-valued attribute. The ORDER BY clause is necessary for accumulation.</p>
</div>
<div class="paragraph">
<p>Every group is mapped to a group in the DirX Identity ODBC target system.</p>
</div>
<div class="paragraph">
<p>dxrGroupName &#8594; Name (cn) of Group<br>
GroupID &#8594; dxrPrimaryKey of group</p>
</div>
<div class="paragraph">
<p>Every dxrAccountName is seen as group member.</p>
</div>
<div class="paragraph">
<p><strong>DirX Identity Account Handling</strong></p>
</div>
<div class="paragraph">
<p>Accounts are selected from the ODBC database with the statement:</p>
</div>
<div class="paragraph">
<p>Select= AccountDesc,AccountDxrName,AccountID,AccountOdbcName</p>
</div>
<div class="paragraph">
<p>From=Accounts</p>
</div>
<div class="paragraph">
<p>One record is exported for each account.</p>
</div>
<div class="paragraph">
<p>The <strong>dxrAccountName</strong> attribute is used as the <strong>cn</strong> for the DirX Identity account. The database key maps to the <strong>dxrPrimaryKeyAttribute</strong>.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_odbc_synchronization_workflow"><a class="anchor" href="#_ch7_odbc_synchronization_workflow"></a><a class="link" href="#_ch7_odbc_synchronization_workflow">7.3.5.4. ODBC Synchronization Workflow</a></h5>
<div class="paragraph">
<p>First we&#8217;ll look at some ODBC-specific issues. Synchronization enforces changes of groups/accounts and memberships in the ODBC database and synchronizes back these changes to DirX Identity (set the appropriate status attributes, group membership states). Because we don&#8217;t want to violate the referential integrity in the ODBC database, the membership should be deleted first, and then the referenced object can be deleted. On the other hand, we need the DB keys to add a new membership. So for newly created accounts/groups, we need to synchronize back the DB key before inserting memberships.</p>
</div>
<div class="sect5">
<h6 id="_ch7_workflow_activities_2"><a class="anchor" href="#_ch7_workflow_activities_2"></a><a class="link" href="#_ch7_workflow_activities_2">7.3.5.4.1. Workflow Activities</a></h6>
<div class="paragraph">
<p>The ODBC synchronization workflow uses the following activities and workflows:</p>
</div>
<div class="paragraph">
<p><strong>Ident2ODBC_SyncAccount_MetaCP</strong> - an activity that exports Identity accounts with dxrTSState=NONE from the Identity Store. These are accounts that are to be inserted into the ODBC database.</p>
</div>
<div class="paragraph">
<p><strong>Ident2ODBC_ SyncAccount_ODBCImport</strong> - an activity that imports new accounts into the ODBC database.</p>
</div>
<div class="paragraph">
<p><strong>ODBC2Ident_SyncNewAccWF</strong> - a workflow that exports the delta accounts back to the Identity Store. In addition to the accounts created in the previous step, the workflow handles deleted or modified accounts (initiated by a previous workflow run or by changing the database).</p>
</div>
<div class="paragraph">
<p><strong>Ident2ODBC_SyncGroup_MetaCP</strong> - an activity that exports new DirX Identity groups (dxrTSState=NONE) from the Identity Store.</p>
</div>
<div class="paragraph">
<p><strong>IdentODBC_SyncGroup_ODBCImport</strong> - an activity that imports these new groups into the ODBC database</p>
</div>
<div class="paragraph">
<p><strong>ODBC2Ident_SyncNewGroupWF</strong> - a workflow that exports the delta groups back to the Identity Store. In addition to the groups created in the previous step, the workflow handles deleted or modified accounts (initiated by a previous workflow run or by changing the database). For example, a group in the Identity Store deleted by the last run of the synchronization workflow is produced as delta information and is then "deleted" in the Identity Store.</p>
</div>
<div class="paragraph">
<p><strong>Ident2ODBC_SyncGroupMembers_MetaCP</strong> - an activity that exports all GroupMembers that are either in status Add or Delete. For each member, one record with a changetype add or delete is exported.</p>
</div>
<div class="paragraph">
<p><strong>Ident2ODBC_SyncGroupMembers_ODBCImport</strong> - an activity that adds or deletes memberships in the Memberships table in the ODBC database.</p>
</div>
<div class="paragraph">
<p><strong>Ident2ODBC_SyncAccountDel</strong> - a workflow that exports accounts to be deleted from the Identity Store and deletes them in the ODBC database.</p>
</div>
<div class="paragraph">
<p><strong>Ident2ODBC_SyncGroupDel</strong> - a workflow that exports groups to be deleted from the Identity Store and deletes them in the ODBC database.</p>
</div>
<div class="paragraph">
<p><strong>ODBC2Ident_SyncGroup_ODBCExport</strong> - an activity that exports changed groups with their memberships from the ODBC database.</p>
</div>
<div class="paragraph">
<p><strong>ODBC2Ident_SyncGroup_MetaCP</strong> - an activity that imports the changed groups and the related membership changes. Only memberships are updated. Groups are not deleted here. The next synchronization or validation workflow will delete these groups if necessary.</p>
</div>
<div class="paragraph">
<p><strong>ODBC2Ident_SyncAcc_ODBCExport</strong> - an activity that exports changed accounts from the ODBC database.</p>
</div>
<div class="paragraph">
<p><strong>ODBC2Ident_SyncAcc_MetaCP</strong> - an activity that imports the changed account to the Identity Store.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_workflow_tasks_without_stored_procedures"><a class="anchor" href="#_ch7_workflow_tasks_without_stored_procedures"></a><a class="link" href="#_ch7_workflow_tasks_without_stored_procedures">7.3.5.4.2. Workflow Tasks without Stored Procedures</a></h6>
<div class="paragraph">
<p>The workflow consists of the following tasks:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Handling new accounts in DirX Identity - create in ODBC and synchronize back the dbKey to dxrPrimary key</p>
</li>
<li>
<p>Handling new groups in DirX Identity - create in ODBC and synchronize back the dbKey to dxrPrimary key</p>
</li>
<li>
<p>Handling new/deleted memberships in DirX Identity - the membership table in ODBC is updated</p>
</li>
<li>
<p>Handling accounts in state deleted in the Identity Store - accounts are deleted in ODBC</p>
</li>
<li>
<p>Handling groups deleted in identity store - groups are deleted in ODBC</p>
</li>
<li>
<p>Synchronizing back groups/memberships - only memberships are handled at the moment. Groups are not deleted in Role (use the validation workflow for this task)</p>
</li>
<li>
<p>Synchronize back accounts</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_workflow_tasks_with_stored_procedures"><a class="anchor" href="#_ch7_workflow_tasks_with_stored_procedures"></a><a class="link" href="#_ch7_workflow_tasks_with_stored_procedures">7.3.5.4.3. Workflow Tasks with Stored Procedures</a></h6>
<div class="paragraph">
<p>The ODBC workflow implementation delivered with DirX Identity assumes that all ODBC import tasks do not use stored procedures. Using stored procedures may simplify these tasks. Stored procedures can handle referential integrity - For adds to the membership table, only account/group name is necessary, because stored procedures may get the database keys through selects. So, we don&#8217;t need to synchronize back new objects before handling memberships. Instead, the stored procedure handles these issues.</p>
</div>
<div class="paragraph">
<p>Using a stored procedure, the remaining tasks are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Handling all changed accounts in the Identity Store - performs add or delete operations in the Accounts table (implicitly also some memberships might be deleted if a referenced account is deleted).</p>
</li>
<li>
<p>Handling all changed groups in the Identity Store - performs add or delete operations in the Accounts table (implicitly also some memberships might be deleted if a referenced group is deleted).</p>
</li>
<li>
<p>Handling all changed group memberships - performs add or delete operations in the Membership table.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note: One stored procedure can handle these tasks.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Synchronize back accounts.</p>
</li>
<li>
<p>Synchronize back groups/memberships.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_ch7_customizing_the_odbc_workflows"><a class="anchor" href="#_ch7_customizing_the_odbc_workflows"></a><a class="link" href="#_ch7_customizing_the_odbc_workflows">7.3.5.5. Customizing the ODBC Workflows</a></h5>
<div class="paragraph">
<p>This section describes how to change the workflows when other database structures exist.</p>
</div>
<div class="sect5">
<h6 id="_ch7_using_additional_attributes"><a class="anchor" href="#_ch7_using_additional_attributes"></a><a class="link" href="#_ch7_using_additional_attributes">7.3.5.5.1. Using Additional Attributes</a></h6>
<div class="paragraph">
<p>To change the ODBC synchronization workflow to use additional ODBC attributes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Specify your attributes in the attribute configuration</p>
</li>
<li>
<p>Add the mapping of your attributes as a user hook</p>
</li>
<li>
<p>Extend the selected attributes/mapping with your attributes.</p>
</li>
<li>
<p>Add the correct values to the ODBC export/import properties.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The next sections provide details.</p>
</div>
<div class="paragraph">
<p><strong>Attribute Configuration</strong></p>
</div>
<div class="paragraph">
<p>Specify the attributes of your database tables that are not included yet.</p>
</div>
<div class="paragraph">
<p>The following attributes should not be changed:</p>
</div>
<div class="paragraph">
<p>changetype<br>
DDN<br>
addMember<br>
delMember</p>
</div>
<div class="paragraph">
<p>The abbreviations of the following attributes (abbreviations) should not be changed. You can change the Name (table.column) and optionally the prefix:</p>
</div>
<div class="paragraph">
<p>AccountDxrName<br>
AccountID<br>
GroupDxrName<br>
GroupID<br>
MembershipAccountID<br>
MembershipGroupID<br>
MembershipID</p>
</div>
<div class="paragraph">
<p><strong>User Hook in Job Ident2ODBC_SyncGroupMembers_MetaCP</strong></p>
</div>
<div class="paragraph">
<p>In this job, the mapping is performed in the LoopExtraFunction user hook. See the corresponding section in the existing workflow:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-tcl hljs" data-lang="tcl"># mapping
set rh_file_tgt(changetype) "add"
set rh_file_tgt(AccountDxrName) $memb
set rh_file_tgt(MembershipGroupID) $src(dxrPrimaryKey)
set rh_file_tgt(GroupDxrName) $src(cn)</code></pre>
</div>
</div>
<div class="paragraph">
<p>and a similar section with changetype delete.</p>
</div>
<div class="paragraph">
<p>You can add the mapping of your additional attributes here.</p>
</div>
<div class="paragraph">
<p><strong>Selected Attributes / Mapping</strong></p>
</div>
<div class="paragraph">
<p>The existing workflow already contains the minimum set of attributes needed. So in most cases, you just need to extend it with your additional attributes.</p>
</div>
<div class="paragraph">
<p><strong>ODBC Export / Import Properties</strong></p>
</div>
<div class="paragraph">
<p>You will find these properties in the channels under the ODBC connected directory. You do not need to change fields where abbreviations are used. Enter the correct values for your database in the other fields.</p>
</div>
</div>
<div class="sect5">
<h6 id="_ch7_using_structurally_different_odbc_databases"><a class="anchor" href="#_ch7_using_structurally_different_odbc_databases"></a><a class="link" href="#_ch7_using_structurally_different_odbc_databases">7.3.5.5.2. Using Structurally Different ODBC Databases</a></h6>
<div class="paragraph">
<p>If your database schema differs from the expected three table structure, no general statements can be made. You can try to change the ODBC Selects so that they produce a similar result as with the given schema. On the other hand, if you have fewer tables, you may simplify the whole workflow by packing some activities into one..</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ch7_racf_workflows_2"><a class="anchor" href="#_ch7_racf_workflows_2"></a><a class="link" href="#_ch7_racf_workflows_2">7.3.6. RACF Workflows</a></h4>
<div class="paragraph">
<p>The DirX Identity RACF workflows provision a RACF target system. Two workflows are available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>RACF2Ident_Validation</strong> - performs initial load or validation from a RACF target system</p>
</li>
<li>
<p><strong>Ident_RACF_Sync</strong> - synchronizes between the Identity Store and a RACF target system</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The RACF workflows are based on the DirX Identity meta controller (<strong>metacp</strong>). They use the RACF LDAP interface via IBMâs SecureWay LDAP server. The workflows can support all object types and attribute types that are accessible via the RACF interface.</p>
</div>
<div class="paragraph">
<p>Before you can use the RACF workflows, you must extend the DirX Identity Store schema with RACF target system-specific attributes and object classes so that the workflows can store RACF-specific information in the Identity Store. For instructions, see the section "Extending the Schema for the Target System Workflows".</p>
</div>
<div class="paragraph">
<p>RACF contains a lot of subsystems that are not used at every customer site. DirX Identity only supports a basic set of subsystems. Others must be configured for a specific customer. The following subsystems are configured in the default applications:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>TSO (Time Sharing Option) - basic configuration of users, groups, and so on</p>
</li>
<li>
<p>WORKATTR (Work Attributes) - additional attributes</p>
</li>
<li>
<p>OMVS (Open Edition MVS) - UNIX system for MVS, only used for FTP transfer (for all users, not specific for each user)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following subsystems are not configured in the default applications:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>CICS (Customer Information Control System) - tele-processing monitor for online transaction systems</p>
</li>
<li>
<p>DCE (Distributed Computing Environment) - distributed application handling</p>
</li>
<li>
<p>NETVIEW (Network Automation) - network monitoring and automation</p>
</li>
<li>
<p>OVM (Open Edition VM) - UNIX system for VM</p>
</li>
<li>
<p>OPAPAM - MCS console</p>
</li>
<li>
<p>LANGUAGE - nationalization</p>
</li>
<li>
<p>DFP (SMS Routine = System Managed Storage) - file management, pool sharing, disk management, profile management, disk space management.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note: Due to capabilities that are missing from the RACF LDAP server, it is not possible to read or update the schema via LDAP with DirX Identity automatic schema retrieval.</p>
</div>
</div>
<div class="sect3">
<h4 id="_ch7_sipass_workflows"><a class="anchor" href="#_ch7_sipass_workflows"></a><a class="link" href="#_ch7_sipass_workflows">7.3.7. SiPass Workflows</a></h4>
<div class="paragraph">
<p>The DirX Identity SiPass workflows provision a SiPass target system. Two workflows are available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>SiPass2Ident_Validation</strong> - performs initial load or validation from a SiPass target system</p>
</li>
<li>
<p><strong>Ident_SiPass_Sync</strong> - synchronizes the DirX Identity target system and the SiPass target system</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following restrictions and hints apply to the SiPass standard workflows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The workflows' SiPass agent step runs only on Windows systems.</p>
</li>
<li>
<p>The SiPass agent must run on the machine where the SiPass server is installed. To achieve this you can setup a C++-based secondary server on this machine. We recommend to run the metacp jobs also on this machine to avoid file transfers.</p>
</li>
<li>
<p>The SiPass standard workflow only handles work group objects. It does not handle access groups.</p>
</li>
<li>
<p>Scrambled and encrypted bind passwords and data attributes are not supported. As a result, the "disable encryption" flag in the bind profile must be set.</p>
</li>
<li>
<p>SiPass workflows are pre-configured with <strong>Regional and Language Option</strong>s set in <strong>Regional</strong> <strong>Options</strong> to standard <strong>English</strong> <strong>(United States)</strong>. If SiPass is installed on a machine with other regional settings, you must adapt the format strings in SiPass agent jobs (see the <strong>Date</strong> <strong>Formats</strong> tab).</p>
</li>
<li>
<p>The SiPass attribute CardNumber is mandatory for each SiPass cardholder. The synchronization workflow is pre-configured to get this attribute from the attribute dxrName that stores the reference number. For a real provisioning application, the CardNumber attribute should be mapped to the dxrCardNumber attribute, which is empty by default. It is necessary to supply this attribute (for example, as a copy from the corresponding user).</p>
</li>
<li>
<p>The dxrName attribute is used as identifier at the SiPass side (CardNumber). Therefore it must be of type integer and it must be unique.</p>
</li>
<li>
<p>Groups must exist in the SiPass system. The agent cannot create groups due to a restriction of the SiPass interface.</p>
</li>
<li>
<p>During initial load a group is loaded that indicates accounts that are not members of another group. The group name is either &lt;none&gt; or &lt;keine&gt; depending on the language used.</p>
</li>
<li>
<p>Trying to load accounts with no group membership into SiPass causes an error. The dxrState attribute at the Identity Store stays in state 'None'.</p>
</li>
<li>
<p>SiPass can only assign exactly one group to an account. Build your role structure so that only one group is assigned to an account. DirX Identity does not check this restriction. If an account is assigned to more than one group, the import into SiPass fails.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_deprecated_features"><a class="anchor" href="#_deprecated_features"></a><a class="link" href="#_deprecated_features">Appendix A: Deprecated Features</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section contains features that still work but should not be used because better features are available.</p>
</div>
<div class="paragraph">
<p>Use the Java-based workflows instead of the Tcl-based workflows described in this chapter.</p>
</div>
<div class="paragraph">
<p>Note that the features described in this chapter are still supported but will not be enhanced.</p>
</div>
<div class="sect2">
<h3 id="_ads_provisioning_workflows"><a class="anchor" href="#_ads_provisioning_workflows"></a><a class="link" href="#_ads_provisioning_workflows">A.1. ADS Provisioning Workflows</a></h3>
<div class="paragraph">
<p>This section comprises all issues related to Active Directory and Exchange Provisioning workflows.</p>
</div>
<div class="sect3">
<h4 id="_apx_exchange_server_2007_provisioning_workflow"><a class="anchor" href="#_apx_exchange_server_2007_provisioning_workflow"></a><a class="link" href="#_apx_exchange_server_2007_provisioning_workflow">A.1.1. Exchange Server 2007 Provisioning Workflow</a></h4>
<div class="paragraph">
<p>Microsoft strongly recommends that you install Exchange Server 2007 on a 64-bit processor machine with a 64-bit operating system, even though it is possible to install it on a 32-bit processor machine. Also at least one domain controller that is the schema master must have Windows Server 2003 Service Pack 1 installed.</p>
</div>
<div class="paragraph">
<p>For further hardware and software requirements as well as the required steps to prepare Active Directory, the domains and the forest for Exchange 2007, refer to the Microsoft documentation.</p>
</div>
<div class="paragraph">
<p>To administer Exchange Server 2007 including the administration of mailbox-enabled users (if the mailbox Server role was installed) you can install the Exchange 2007 management tools, which consist of the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Exchange Management Console</p>
</li>
<li>
<p>Exchange Management Shell</p>
</li>
<li>
<p>Exchange Help File</p>
</li>
<li>
<p>Exchange Best Practices Analyzer Tool</p>
</li>
<li>
<p>Exchange Troubleshooting Assistant Tool</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Creating Mailbox-enabled Users:</strong></p>
</div>
<div class="paragraph">
<p>To create mailbox-enabled users with the Tcl-based provisioning workflows (C++-based AdsAgent) the following changes in the attribute mappings must be done:</p>
</div>
<div class="paragraph">
<p>The attribute âtextEncodedORAddressâ can be eliminated from the mapping because Exchange 2007 does not support the X400 provider anymore by default.</p>
</div>
<div class="paragraph">
<p>The attribute displayName has to be set to make the created mailbox enabled user work properly together with the Exchange 2007 GUI. For example map the LDAP cn attribute to the Exchange displayName attribute.</p>
</div>
<div class="paragraph">
<p>In addition to the known attributes that must be set on creation of a mailbox-enabled user the following ones can be set:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>msExchRecipientTypeDetails</p>
</li>
<li>
<p>msExchVersion</p>
</li>
<li>
<p>msExchRecipientDisplayType</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Setting these attributes prevents the created mailbox to be shown as <strong>Legacy Mailbox</strong> by the Exchange Management Console tool. By Exchange 2007 a <strong>Legacy Mailbox</strong> is regarded as a one that resides on an Exchange 2000/2003 server or that has been created by an Active Directory Users and Computers snap in extended by Exchange 2000/2003 functionality.</p>
</div>
<div class="paragraph">
<p>To make a <strong>Legacy Mailbox</strong> a <strong>User Mailbox</strong> also the Exchange Management Shell command <strong>setMailbox</strong> with the <strong>ApplyMandatoryProperties</strong> parameter can be used:</p>
</div>
<div class="paragraph">
<p><code>C:\&gt;Set-Mailbox -Identity <em>USERNAME</em> âApplyMandatoryProperties</code></p>
</div>
<div class="paragraph">
<p><strong>Configuring with C++ based AdsAgent:</strong></p>
</div>
<div class="paragraph">
<p>In the import.ini file the attributes must be set with the following types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>msExchRecipientTypeDetails=Integer</p>
</li>
<li>
<p>msExchVersion=CaseIgnoreString</p>
</li>
<li>
<p>msExchRecipientDisplayType=Integer</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Mapping with both C++-based and Java-based agent or connector:</strong></p>
</div>
<div class="paragraph">
<p>Set these attributes in the mapping to constant values:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>msExchVersion: 4535486012416 (optional)</p>
</li>
<li>
<p>msExchRecipientDisplayType: 1073741824 (optional)</p>
</li>
<li>
<p>msExchRecipientTypeDetails: 1 (mandatory)</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_dashboard_workflow"><a class="anchor" href="#_dashboard_workflow"></a><a class="link" href="#_dashboard_workflow">A.2. Dashboard Workflow</a></h3>
<div class="paragraph">
<p>The DirX Identity Dashboard workflow provisions a Dashboard target system. The following workflow is available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Ident_Dashboard_Sync</strong> - exports data from the Identity Store and imports it to the Dashboard target system and vice versa</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that the complexity of the Dashboard system requires a workflow of corresponding complexity to handle all of Dashboard&#8217;s features. The next sections provide conceptual and operational information about the Dashboard workflow.</p>
</div>
<div class="sect3">
<h4 id="_apx_dashboard_workflow_general_issues"><a class="anchor" href="#_apx_dashboard_workflow_general_issues"></a><a class="link" href="#_apx_dashboard_workflow_general_issues">A.2.1. Dashboard Workflow: General Issues</a></h4>
<div class="paragraph">
<p>DirX Identity synchronization workflows read information from the Identity Store, perform the necessary update operations in the target system, read the target system content and update the Identity Store information accordingly. This procedure sets the status information in the identity store to correct and consistent values.</p>
</div>
<div class="paragraph">
<p>Because the Dashboard system handles a set of other target systems and is not readable through its interfaces, DirX Identity uses a special procedure to handle this target system. The following figure illustrates this procedure.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/appa_depr/image1.png" alt="Dashboard Synchronization Workflow Operation">
</div>
<div class="title">Figure 115. Dashboard Synchronization Workflow Operation</div>
</div>
<div class="paragraph">
<p>As illustrated in the figure:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The first activity - the meta controller (<strong>metacp</strong>) account update - collects the account information from all associated target systems and writes it at the corresponding Dashboard account.</p>
</li>
<li>
<p>The next activity operates like workflows for other target systems. The <strong>metacp</strong> export activity reads all necessary information from the Identity Store and writes it to the data file. The target system agent (the Dashboard agent) writes this information to the target system.</p>
</li>
<li>
<p>Depending on the result of the corresponding target system interface (API) action, the Dashboard agent writes a response file that contains the distinguished names (DNs) of all accounts where the operation was successful. Other results are only documented in the trace file.</p>
</li>
<li>
<p>An additional meta controller activity - <strong>metacp</strong> <strong>import</strong> - uses this response file to update the relevant status information in the Identity Store.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The entire procedure assumes that the target system interface (API) reports correctly whether an operation was successful or not. On success, the target system agent writes the corresponding entry into the response file.</p>
</div>
</div>
<div class="sect3">
<h4 id="_apx_prerequisites_and_limitations"><a class="anchor" href="#_apx_prerequisites_and_limitations"></a><a class="link" href="#_apx_prerequisites_and_limitations">A.2.2. Prerequisites and Limitations</a></h4>
<div class="paragraph">
<p>Before you can use the Dashboard workflow, you must extend the DirX Identity Store schema with Dashboard target system-specific attributes and object classes so that the workflows can store Dashboard-specific information in the Identity Store. For instructions, see the section "Extending the Schema for the Target System Workflows".</p>
</div>
</div>
<div class="sect3">
<h4 id="_apx_dashboard_workflow_operational_features"><a class="anchor" href="#_apx_dashboard_workflow_operational_features"></a><a class="link" href="#_apx_dashboard_workflow_operational_features">A.2.3. Dashboard Workflow: Operational Features</a></h4>
<div class="paragraph">
<p>In order to understand the Dashboard workflow, you need to understand the relevant features of the Dashboard system:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Each user must have a corresponding account in the Dashboard system. The account name is necessary to authenticate to the Dashboard system.</p>
</li>
<li>
<p>The Dashboard account has a category attribute that defines the authorization to the external applications that are configured in Dashboard. A category can enable access to one or more applications. It is not possible to refine the access to specific functionality within an application.</p>
</li>
<li>
<p>One physical target system can be represented by several applications within Dashboard that model a part of the available functionality.</p>
</li>
<li>
<p>Dashboard can handle single sign-on to the external applications. To provide this feature, Dashboard keeps, for each user, the relevant account information of the external applications (username and password). Three facets exist:</p>
</li>
<li>
<p>Common account: The external application uses the same username and password that Dashboard itself uses. In this case, the account information is set to "username=<strong>" and "password=</strong>".</p>
</li>
<li>
<p>Common password: The external application uses a different username but the same password that Dashboard uses. In this case, the account information is set to "username=TSusername" and "password=*".</p>
</li>
<li>
<p>Diverse account: The external application uses a username and password that are different from the ones that Dashboard uses. In this case, the account information is set to "username=TSusername" and "password=TSpassword".</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In a DirX Identity Connectivity scenario, it only makes sense to support the first two facets. The third one is not supported.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The Dashboard system also supports several authentication types:</p>
</li>
<li>
<p>Simple type: The password is kept during the Dashboard session. If an external application entry of a Dashboard account contains an asterisk ('*'), the session password is used to log into the external application; otherwise, the stored value is used as the password for login.</p>
</li>
<li>
<p>Password-less type: Other authentication types, for example, reuse of the Windows login, cannot provide the password. Therefore the "asterisk" solution does not work. In this case, the password of the Dashboard account and all passwords of the external application entries must be set to the same value.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Dashboard&#8217;s category feature is a type of role model (with hierarchies and so on.). Users are assigned categories (for example, Physician or Nurse) to enable them to access several specific Web pages that may in turn be bound to external applications. Dashboard only handles the access to the application. It cannot handle fine granular access within the external applications.</p>
</div>
<div class="paragraph">
<p>The next figure shows the Dashboard privilege model and its relationship to external applications.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/appa_depr/image2.png" alt="Dashboard Privilege Model">
</div>
<div class="title">Figure 116. Dashboard Privilege Model</div>
</div>
<div class="paragraph">
<p>Assume a physician needs to work with the external applications Invision and Pharmacy. This access can be modeled as a Physician role that uses a Physician permission that has the following groups assigned to it:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>One or more categories in the Dashboard target system to obtain basic access to the Dashboard system (to ensure Dashboard account creation and enabling).</p>
</li>
<li>
<p>One or more groups in the Invision target system for fine granular access to Invision. This assignment creates the necessary Invision account.</p>
</li>
<li>
<p>One or more groups in any additional target systems (for example, Pharmacy) for fine granular access to these additional systems. This assignment creates the necessary target system account.</p>
</li>
<li>
<p>The target systems must be marked as Dashboard-relevant systems (The Peer Target System property must point to a Dashboard target system within DirX IdentityTS).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>With this approach, inconsistencies might occur. If a user gets an account in a target system that is not enabled (on the portal of the user) by one of the assigned Dashboard categories, the user cannot enter the application via Dashboard (but he can via the application&#8217;s native access). To ensure that the target system is accessible, you must create an "access category" for each target system that is assigned to the user via a permission if one of the groups of the target system is assigned. The advantage of this approach is that the whole access control model is visible within DirX Identity (that is, DirX Identity can ensure correct access to the target system).</p>
</div>
<div class="paragraph">
<p>To summarize the model within DirX Identity: DirX Identity contains a Dashboard target system with all necessary Dashboard accounts. The groups represent the Dashboard categories. A special attribute at the Dashboard target system object defines whether simple or password-less authentication is used.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/appa_depr/image3.png" alt="DirX Identity Dashboard Synchronization Model">
</div>
<div class="title">Figure 117. DirX Identity Dashboard Synchronization Model</div>
</div>
<div class="paragraph">
<p>DirX Identity also contains a set of Dashboard-managed target systems. These target systems have their own accounts for these users and target system-specific groups and group memberships. Such a target system can be represented as several external applications in the Dashboard system (e.g., Invision can be represented as Invision1 as Invision2). Because the name of the target system might be different from the names of the external applications which are represented by this target system in Dashboard, you can set the external application names in the Portal External Application property of each of the associated target system. The user can log in to one of the available Invision applications (Invision1 or Invision2).</p>
</div>
<div class="paragraph">
<p>The workflow works as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>To get the active relevant accounts and its names (dxmDshExternalApp) for one of the Dashboard accounts, the first workflow activity retrieves all non-deleted accounts (active or inactive) for this user from all target systems that have the Dashboard target system set as Peer Target System property. If such a target system has set several names in the Portal External Application property, each name is used as a separate external application for the Dashboard account. The external application account name is then equal to the value of the dxrName attribute of the account in the external application (target system). If the dxrName attribute is empty the attribute cn is used instead. Just one account per target system is selected (the primary one in case of multiple accounts) and is configured for all the names listed in Portal External Application property. The inactive external applications are evaluated as a complement of the currently resolved list of external applications to the list of external applications in a previous run of the workflow and are written to the dxmDshExternalAppDel attribute.<br>
<br>
Note that this activity needs to know the location of the Dashboard target system account base. This information is retrieved from the Identity Store&#8217;s account base attribute that is set automatically from the target system wizard. This concept restricts the number of Dashboard target systems per configured identity store to exactly one.</p>
</li>
<li>
<p>The second activity reads the user&#8217;s Dashboard account and all necessary account attributes. Additionally it fetches the related user&#8217;s password from the identity store as initial password (specified by the dxrUserLink attribute of the account). This assures that the actual password is taken. If the dxrUserLink attribute of the account is missing or no password for the user exists, a default value is used (configured in the post join mapping script of the second job).</p>
</li>
<li>
<p>The assigned group memberships are transferred as categories to Dashboard.</p>
</li>
<li>
<p>The workflow adds external application attributes (retrieved from the dxmDshExternalApp and dxmDshExternalAppDel attributes) to each Dashboard account entry with account name and password information.</p>
</li>
<li>
<p>If the attribute Prevent Password Synchronization of a Dashboard relevant target system is set, the workflow sets empty passwords for all the related external applications accounts. Otherwise the workflow uses the star ('*') or the value of the userâs password (according to the simple or password-less authentication type setting of the Dashboard target system).</p>
</li>
<li>
<p>All the information is transferred via the Dashboard agent to the Dashboard target system.</p>
</li>
<li>
<p>Dashboard response is joined with the Dashboard user data stored in the identity store. The relevant target system state is set.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_apx_dashboard_password_synchronization"><a class="anchor" href="#_apx_dashboard_password_synchronization"></a><a class="link" href="#_apx_dashboard_password_synchronization">A.2.4. Dashboard Password Synchronization</a></h4>
<div class="paragraph">
<p>The Dashboard password synchronization workflow that uses the Dashboard connector synchronizes the Dashboard password and all the Dashboard-related target systems that do not use empty passwords. The external applications for a Dashboard account are taken from the actual values of the attribute dxmDshExternalApp. The password for external applications is then set according to the authentication type of the Dashboard target system.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_dirx_access_workflows"><a class="anchor" href="#_dirx_access_workflows"></a><a class="link" href="#_dirx_access_workflows">A.3. DirX Access Workflows</a></h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
These workflows are no longer usable. Read the information in the chapter DirX Access Workflows to understand how DirX Identity and DirX Access can interact.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The DirX Access provisioning workflows work between a target system of type <strong>SPMLv1</strong> in the Identity Store and the corresponding connected DirX Access server with configured Provisioning Web Service.</p>
</div>
<div class="paragraph">
<p>The workflows use the SPML connector (SpmlV1SoapConnector2TS) for provisioning. This connector communicates with the DirX Access Provisioning Web Service. The following figure illustrates the DirX Access provisioning workflow architecture.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/appa_depr/image4.png" alt="DirX Access Provisioning Workflow Architecture">
</div>
<div class="title">Figure 118. DirX Access Provisioning Workflow Architecture</div>
</div>
<div class="paragraph">
<p>The workflows handle the following objects:</p>
</div>
<div class="paragraph">
<p><strong>User</strong> - the common DirX Access user.</p>
</div>
<div class="paragraph">
<p><strong>Role</strong> - the common DirX Access business role.</p>
</div>
<div class="paragraph">
<p>The delivered workflows are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Ident_DXA_Realtime</strong> - the synchronization workflow exports detected changes for user (account) and business role (group) objects from Identity Store to the DirX Access server in the first step. The second step is to validate the processed changes in the DirX Access server to the Identity Store.</p>
</li>
<li>
<p><strong>Validate_DXA_Realtime</strong> - the validation workflow imports existing DirX Access users and business roles with role assignment from the DirX Access server to the Identity Store.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_apx_dirx_access_prerequisites_and_limitations"><a class="anchor" href="#_apx_dirx_access_prerequisites_and_limitations"></a><a class="link" href="#_apx_dirx_access_prerequisites_and_limitations">A.3.1. DirX Access Prerequisites and Limitations</a></h4>
<div class="paragraph">
<p>The DirX Access workflows support only DirX Access user and business role objects. They do not support password synchronization for DirX Access.</p>
</div>
</div>
<div class="sect3">
<h4 id="_apx_configuring_dirx_access_workflows"><a class="anchor" href="#_apx_configuring_dirx_access_workflows"></a><a class="link" href="#_apx_configuring_dirx_access_workflows">A.3.2. Configuring DirX Access Workflows</a></h4>
<div class="paragraph">
<p>To configure the connection to DirX Access:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Specify the <strong>IP address</strong> and the <strong>Data Port</strong> of the DirX Access SPML v1 Provisioning Web Service. Use the corresponding DirX Access service object which is the part of the connected DirX Access system.</p>
</li>
<li>
<p>You can configure the <strong>URL Path</strong> and <strong>Socket Timeout</strong> at the target system port of the appropriate workflow object. (See the DirX Access provisioning workflows configuration in the <strong>Expert View</strong> in the <strong>Connectivity</strong> part in the <strong>DirX Manager</strong>.) You can change the <strong>URL Path</strong> according to real deployment of the DirX Access Provisioning Web Service. You can increase the timeout value (in seconds) in the <strong>Socket Timeout</strong> if necessary.</p>
</li>
<li>
<p>Set up the bind credentials of the connected DirX Access system. Use the correct credentials with sufficient rights.</p>
</li>
<li>
<p>Check the provisioning settings used by the connected DirX Access system. Specify them according to real values for your provisioned DirX Access target system.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_apx_configuring_the_dirx_access_target_system"><a class="anchor" href="#_apx_configuring_the_dirx_access_target_system"></a><a class="link" href="#_apx_configuring_the_dirx_access_target_system">A.3.3. Configuring the DirX Access Target System</a></h4>
<div class="paragraph">
<p>The DirX Access target system requires the following layout:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Accounts</strong> - all DirX Access users are located in a subfolder <strong>Accounts</strong>.</p>
</li>
<li>
<p><strong>Groups</strong> - all DirX Access business role objects are located in a subfolder <strong>Groups</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The attribute <strong>dxrPrimaryKey</strong> of accounts and groups contains the PSO Identifier of these objects in the connected DirX Access system. (See the SPMLv2 specification for more details about PSO Identifiers.)</p>
</div>
<div class="paragraph">
<p>The business role (group) membership is stored at the user (account) object and references the <strong>dxrPrimaryKey</strong> attribute of business role (group) objects.</p>
</div>
</div>
<div class="sect3">
<h4 id="_apx_dirx_access_workflows_and_activities"><a class="anchor" href="#_apx_dirx_access_workflows_and_activities"></a><a class="link" href="#_apx_dirx_access_workflows_and_activities">A.3.4. DirX Access Workflows and Activities</a></h4>
<div class="paragraph">
<p>The following figure shows the layout of the channels that are used by the UNIX-PAM workflow&#8217;s join activity:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/appa_depr/image5.png" alt="DirX Access Provisioning Workflow Channels and Objects">
</div>
<div class="title">Figure 119. DirX Access Provisioning Workflow Channels and Objects</div>
</div>
<div class="paragraph">
<p>The DirX Access users (with membership) and business roles are synchronized via a pair of channels (one channel per direction).</p>
</div>
</div>
<div class="sect3">
<h4 id="_apx_dirx_access_ports"><a class="anchor" href="#_apx_dirx_access_ports"></a><a class="link" href="#_apx_dirx_access_ports">A.3.5. DirX Access Ports</a></h4>
<div class="paragraph">
<p>This section describes the DirX Access ports.</p>
</div>
<div class="paragraph">
<p>TS Port</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>CF - Crypt Filter</strong><br>
A DirX Access filter is configured implicitly. It is used to send the decrypted password attribute p<strong>assword</strong> to DirX Access.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_apx_dirx_access_channels"><a class="anchor" href="#_apx_dirx_access_channels"></a><a class="link" href="#_apx_dirx_access_channels">A.3.6. DirX Access Channels</a></h4>
<div class="paragraph">
<p>This section provides information about DirX Access channels.</p>
</div>
<div class="sect4">
<h5 id="_apx_common_aspects"><a class="anchor" href="#_apx_common_aspects"></a><a class="link" href="#_apx_common_aspects">A.3.6.1. Common Aspects</a></h5>
<div class="paragraph">
<p>Direction: Identity Store &#8594; DirX Access</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>enabled</strong> - the attribute used for disabling of the user object in DirX Access. The correct value is derived from the <strong>dxrState</strong> attribute of the corresponding account object in the Identity Store.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Direction: DirX Access &#8594; Identity Store</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>CommonProcsDxa.calculateIdInIdentity</strong> - calculates the ID.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_apx_accounts"><a class="anchor" href="#_apx_accounts"></a><a class="link" href="#_apx_accounts">A.3.6.2. Accounts</a></h5>
<div class="paragraph">
<p>Direction: Identity Store &#8594; DirX Access</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ID: <strong>dxrPrimaryKey</strong></p>
</li>
<li>
<p>Join: <strong>${source.dxrPrimaryKey}</strong> or <strong>${source.dxrName}</strong> identical to <strong>loginName</strong></p>
</li>
<li>
<p>DirX Access requires some mandatory attributes. Mandatory attributes are mapped mostly in a common way, some are mapped as constants.</p>
</li>
<li>
<p>The <strong>roles</strong> attribute holds the business group membership.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Direction: DirX Access &#8594; Identity Store</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Join via the <strong>dxrName</strong> attribute that is mapped identically to the <strong>loginName</strong> attribute.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_apx_groups"><a class="anchor" href="#_apx_groups"></a><a class="link" href="#_apx_groups">A.3.6.3. Groups</a></h5>
<div class="paragraph">
<p>Direction: Identity Store &#8594; DirX Access</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ID: <strong>dxrPrimaryKey</strong></p>
</li>
<li>
<p>Join: <strong>${source.dxrPrimaryKey}</strong></p>
</li>
<li>
<p>DirX Access requires some mandatory attributes. Mandatory attributes are mapped mostly in a common way, and some are mapped as constants.</p>
</li>
<li>
<p>The <strong>mode</strong> attribute must be set to <strong>1</strong> for business roles.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Direction: DirX Access &#8594; Identity Store</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Join via the <strong>dxrName</strong> attribute that is mapped identically to the <strong>name</strong> attribute.</p>
</li>
<li>
<p>Post-mapping removes all administrative roles from the imported DirX Access roles (it simply omits the roles with the <strong>mode</strong> attribute set to <strong>0</strong>).</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_jdbc_provisioning_workflows"><a class="anchor" href="#_jdbc_provisioning_workflows"></a><a class="link" href="#_jdbc_provisioning_workflows">A.4. JDBC Provisioning Workflows</a></h3>
<div class="paragraph">
<p>The DirX Identity JDBC workflows provision a JDBC target system. The following workflows are available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>JDBC2Ident_Validation</strong> - performs initial loads or validations from the JDBC target system</p>
</li>
<li>
<p><strong>Ident_JDBC_Sync</strong> - synchronizes between the JDBC target system within DirX Identity and the real JDBC target system.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The next sections provide information about JDBC workflow implementation.</p>
</div>
<div class="sect3">
<h4 id="_apx_general_information_about_the_jdbc_workflows"><a class="anchor" href="#_apx_general_information_about_the_jdbc_workflows"></a><a class="link" href="#_apx_general_information_about_the_jdbc_workflows">A.4.1. General Information about the JDBC Workflows</a></h4>
<div class="paragraph">
<p>Because the JDBC workflows assume the same database structure as the ODBC workflows, the workflow structure is also the same. They also use the ODBC Tcl scripts, especially the ODBC profile script.</p>
</div>
<div class="paragraph">
<p>Because JDBC workflows use the JDBC agent, joins are configured here in a special view section. The join feature is not needed in all JDBC jobs, but all jobs are configured the same way.</p>
</div>
<div class="paragraph">
<p>The JDBC agent is always run in full mode (a delta filter feature is not yet available). As a result, deleted records in the JDBC database are never exported. As a result, the TSState attribute in the identity store cannot be updated for deleted accounts or groups. Use the validation workflow to perform this task.</p>
</div>
</div>
<div class="sect3">
<h4 id="_apx_jdbc_system_table_layout"><a class="anchor" href="#_apx_jdbc_system_table_layout"></a><a class="link" href="#_apx_jdbc_system_table_layout">A.4.2. JDBC System Table Layout</a></h4>
<div class="paragraph">
<p>The JDBC workflows assume the following table layout in the JDBC target system:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A table of groups, where each row represents one group</p>
</li>
<li>
<p>A table of accounts, where each row represents one account</p>
</li>
<li>
<p>A table of memberships, where each row represents a membership of one account in one group</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_apx_jdbc_workflow_configuration"><a class="anchor" href="#_apx_jdbc_workflow_configuration"></a><a class="link" href="#_apx_jdbc_workflow_configuration">A.4.3. JDBC Workflow Configuration</a></h4>
<div class="paragraph">
<p>The JDBC agent&#8217;s import and export configuration files are stored under the JDBC connected directory. As in the attribute configuration, the database schema is described here. Each JDBC export job uses this configuration.</p>
</div>
<div class="paragraph">
<p>For searchRequest for exports, the JDBC2Ident_SyncGroup_JDBCExport and JDBC2Ident_SyncGroup_JDBCExport jobs use their own searchRequest files because they use special anchor values to find the selected attributes. All other JDBC export jobs use the standard searchRequest file.</p>
</div>
</div>
<div class="sect3">
<h4 id="_apx_jdbc_agent_operations"><a class="anchor" href="#_apx_jdbc_agent_operations"></a><a class="link" href="#_apx_jdbc_agent_operations">A.4.4. JDBC Agent Operations</a></h4>
<div class="paragraph">
<p>For JDBC agent import:</p>
</div>
<div class="paragraph">
<p>An LDIF change file is generated by the preceding <strong>metacp</strong> job:</p>
</div>
<div class="paragraph">
<p>Dn: consists of: identifying attribute(s), table=tablename</p>
</div>
<div class="paragraph">
<p>A specific group:<br>
<code>dn:DxrGroupName=verynew,table=Groups</code></p>
</div>
<div class="paragraph">
<p>or a specific membership:<br>
<code>dn:MembershipGroupID=1,MembershipAccountID=26,table=Memberships</code></p>
</div>
<div class="paragraph">
<p>For JDBC agent export:</p>
</div>
<div class="paragraph">
<p>An LDIF content file is generated:</p>
</div>
<div class="paragraph">
<p>A specific group with its memberships:<br>
<code>
dn: groupid=1,view=members<br>
groupdesc: xx<br>
groupdxrname: ODBCall<br>
groupid: 1<br>
groupodbcname: all<br>
accountdxrname: bj099999
</code></p>
</div>
</div>
<div class="sect3">
<h4 id="_apx_adddelete_membership_lists"><a class="anchor" href="#_apx_adddelete_membership_lists"></a><a class="link" href="#_apx_adddelete_membership_lists">A.4.5. Add/Delete Membership Lists</a></h4>
<div class="paragraph">
<p>Because the JDBC agent cannot currently run in delta mode, the JDBC workflow (<strong>JDBC2Ident_SyncGroup_MetaCP</strong> job) cannot generate "add" and "delete" member lists. Instead, the workflow accumulates all memberships in the <strong>accountDxrName</strong> attribute and synchronizes back the complete member list with the common <strong>modGroupInRole</strong> routine. This operation is different from the ODBC workflow and will be changed when the delta feature is available.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ldap_provisioning_workflows"><a class="anchor" href="#_ldap_provisioning_workflows"></a><a class="link" href="#_ldap_provisioning_workflows">A.5. LDAP Provisioning Workflows</a></h3>
<div class="paragraph">
<p>The following LDAP workflows to provision any LDAP directory are available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>LDAP2_Ident_Validation</strong> - performs initial load or validation from an LDAP directory</p>
</li>
<li>
<p><strong>Ident_LDAP_Sync</strong> - synchronizes between the Identity Store and an LDAP directory</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_apx_ldap_provisioning_workflow_concepts"><a class="anchor" href="#_apx_ldap_provisioning_workflow_concepts"></a><a class="link" href="#_apx_ldap_provisioning_workflow_concepts">A.5.1. LDAP Provisioning Workflow Concepts</a></h4>
<div class="paragraph">
<p>This chapter defines concepts that are necessary to understand the operation of the LDAP workflows. Per default the workflow assumes <strong>groupOfNames</strong> at the target system side.</p>
</div>
<div class="sect4">
<h5 id="_apx_empty_groups"><a class="anchor" href="#_apx_empty_groups"></a><a class="link" href="#_apx_empty_groups">A.5.1.1. Empty Groups</a></h5>
<div class="paragraph">
<p>LDAP groups contain a member or uniqueMember attribute that cannot be empty (it is mandatory and must have a value). This is handled differently on the DirX Identity and the target system side:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In the DirX Identity target system the group is empty. Note that the uniqueMember attribute contains the domain name to fulfill the LDAP requirement that empty groups cannot exist (cn=<em>domainName</em>). The dxrGroupMemberOK, dxrGroupMemberAdd and dxrGroupMember attributes are empty.</p>
</li>
<li>
<p>To overcome the problem on the target system side, the LDAP workflow fills empty groups with a customizable value (default is 'cn=no_member'). For configuration of this feature see the next chapter.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_apx_enable_disable_of_accounts"><a class="anchor" href="#_apx_enable_disable_of_accounts"></a><a class="link" href="#_apx_enable_disable_of_accounts">A.5.1.2. Enable / Disable of Accounts</a></h5>
<div class="paragraph">
<p>The workflow supports enable and disable. The status attribute of DirX Identity is mapped to a freely definable attribute in the target system (default: employeeType). For configuration of this feature see the next chapter.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_apx_ldap_provisioning_workflow_configuration"><a class="anchor" href="#_apx_ldap_provisioning_workflow_configuration"></a><a class="link" href="#_apx_ldap_provisioning_workflow_configuration">A.5.2. LDAP Provisioning Workflow Configuration</a></h4>
<div class="paragraph">
<p>This chapter explains how you can customize specific issues of the LDAP workflows.</p>
</div>
<div class="sect4">
<h5 id="_apx_empty_groups_2"><a class="anchor" href="#_apx_empty_groups_2"></a><a class="link" href="#_apx_empty_groups_2">A.5.2.1. Empty Groups</a></h5>
<div class="paragraph">
<p>Open the User Hooks script of the Identity_LDAP_Sync activity for group synchronization. Adapt the default statement in the Preprocessing section:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-tcl hljs" data-lang="tcl">set fixGroupMember "cn=no_members"</code></pre>
</div>
</div>
<div class="paragraph">
<p>This distinguished name is entered into empty groups on the target system side. If your directory or your applications cannot handle a value that points to nowhere, create an entry in an area that is not synchronized by DirX Identity (to overcome the problem that this entry is synchronized) and set the fixGroupMember value to point to this entry.</p>
</div>
</div>
<div class="sect4">
<h5 id="_apx_enable_disable_of_accounts_2"><a class="anchor" href="#_apx_enable_disable_of_accounts_2"></a><a class="link" href="#_apx_enable_disable_of_accounts_2">A.5.2.2. Enable / Disable of Accounts</a></h5>
<div class="paragraph">
<p>To change the default attribute employeeType to another attribute, perform these steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Open the User Hooks script for the account activity of the Identity_LDAP_Sync workflow.</p>
</li>
<li>
<p>Select the attribute in the output channel&#8217;s Selected Attributes.</p>
</li>
<li>
<p>Edit the statement in the Preprocessing section:<br>
set dxrTSStateAttr "employeeType"</p>
</li>
<li>
<p>Open the User Hooks script for the account activity of the Ident2LDAP_Validation workflow.</p>
</li>
<li>
<p>Select the attribute in the input channel&#8217;s Selected Attributes.</p>
</li>
<li>
<p>Edit the statement in the Preprocessing section:<br>
set dxrTSStateAttr "employeeType"</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ldap_xxl_provisioning_workflows"><a class="anchor" href="#_ldap_xxl_provisioning_workflows"></a><a class="link" href="#_ldap_xxl_provisioning_workflows">A.6. LDAP XXL Provisioning Workflows</a></h3>
<div class="paragraph">
<p>Group-side storage of memberships in DirX Identity can cause performance problems when large groups (hundred thousands to millions of members) must be handled. One solution is to store the membership at the account instead of at the groups because the number of memberships for accounts typically does not exceed 1000. If the real target system needs group-side membership storage, DirX Identity can nevertheless store the memberships account-side, which significantly improves all internal service handling. DirX Identity&#8217;s LDAP XXL workflows support LDAP target systems with this model.</p>
</div>
<div class="paragraph">
<p>The following LDAP XXL workflows are available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>LDAPXXL2_Ident_Validation</strong> - performs initial load or validation from an LDAP directory</p>
</li>
<li>
<p><strong>Ident_LDAPXXL_Sync</strong> - synchronizes between the Identity Store and an LDAP directory</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_apx_ldap_xxl_general_information"><a class="anchor" href="#_apx_ldap_xxl_general_information"></a><a class="link" href="#_apx_ldap_xxl_general_information">A.6.1. LDAP XXL General Information</a></h4>
<div class="paragraph">
<p>The LDAP XXL workflows operate differently from the standard LDAP workflow, as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The validation workflow&#8217;s account job reads memberships from the target system and merges them to the identity store accounts. Its group job does not handle memberships.</p>
</li>
<li>
<p>The synchronization workflow&#8217;s group job reads memberships from the Identity Store via extra searches and merges them with the groups in the target system. Its account job reads memberships in the target system via extra searches and synchronizes the membership back to the accounts in the Identity Store.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Unlike the standard LDAP workflow, the synchronization workflow&#8217;s group job uses the following optimizations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It does not read the member attribute in the LDAP target system into memory (avoids large memory lists)</p>
</li>
<li>
<p>It does not use the Tcl <strong>lappend</strong> command for large lists (slow function)</p>
</li>
<li>
<p>It does not use the <strong>rh</strong> arrays (slow Tcl behavior). Instead they build obj modify/create strings</p>
</li>
<li>
<p>It appends/creates members in portions (blocks)</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_apx_ldapxxl_workflow_concepts"><a class="anchor" href="#_apx_ldapxxl_workflow_concepts"></a><a class="link" href="#_apx_ldapxxl_workflow_concepts">A.6.2. LDAPXXL Workflow Concepts</a></h4>
<div class="paragraph">
<p>This section explains LDAPXXL workflow implementation concepts.</p>
</div>
<div class="sect4">
<h5 id="_apx_new_common_procedures"><a class="anchor" href="#_apx_new_common_procedures"></a><a class="link" href="#_apx_new_common_procedures">A.6.2.1. New Common Procedures</a></h5>
<div class="paragraph">
<p>The two new common procedures are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>modGroupStatesInRole</p>
</li>
<li>
<p>addGroupStatesInRole</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These procedures handle the states but do not handle the memberships as in the mod/addGroupInRole procedures.</p>
</div>
</div>
<div class="sect4">
<h5 id="_apx_workflow_integration"><a class="anchor" href="#_apx_workflow_integration"></a><a class="link" href="#_apx_workflow_integration">A.6.2.2. Workflow Integration</a></h5>
<div class="paragraph">
<p>Uniquemember is no longer in the target selected attribute list, which prevents it from being read during the join operation.</p>
</div>
<div class="paragraph">
<p><strong>PostmappingAdd:</strong></p>
</div>
<div class="paragraph">
<p>The PostmappingAdd: routine:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Creates the group via the <strong>obj</strong> <strong>create</strong> command. It generates an attribute string for the command from the mapped tgt attributes, and assumes that Abbreviation and Name are identical.</p>
</li>
<li>
<p>Searches the "add" members and appends the first portion of members to the command.</p>
</li>
<li>
<p>Adds all other add members in portions via an <strong>obj</strong> <strong>modify -addattr</strong> command.</p>
</li>
<li>
<p>Sets the action to none (because add is already done) and sets a special switch <strong>restore_action</strong>.</p>
</li>
<li>
<p>Restores the action in loopextraFunction so that backward synchronization of the states can be performed for ADD.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>PostmappingMod:</strong></p>
</div>
<div class="paragraph">
<p>The PostmappingMod: routine:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Searches for the members to be deleted.</p>
</li>
<li>
<p>For every member, searches the target system to determine whether or not a delete attribute operation needs to be performed. If it does, the routine builds the list of attributes to be deleted.</p>
</li>
<li>
<p>If a given block size is reached, performs an <strong>obj modify -delattr</strong> with <em>block_size</em> members.</p>
</li>
<li>
<p>Handles add members analog. Block size is configured at the job (specific attribute block_size defaults to 100).</p>
</li>
<li>
<p>Instead of having a large Tcl (result) list of members, uses the target system as the list. Every search in the list results in an LDAP search.</p>
</li>
<li>
<p>Modifies the other attributes with the standard script operation.</p>
</li>
<li>
<p>Creates a namespace search to handle the searches for add/delete members. It consists of a search and a get(getNextMembers) procedure. The search result is held in this namespace.</p>
</li>
<li>
<p>The get procedure returns the next number of attributes separated by â;â.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>LoopExtraFunction</strong></p>
</div>
<div class="paragraph">
<p>This routine restores the action if the restore_action switch is set.</p>
</div>
<div class="paragraph">
<p>Additional Statistics</p>
</div>
<div class="paragraph">
<p>The LDAP XXL workflows offer additional statistics. For example:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p><code>
#<br>
# Additional statistics:<br>
#==========================<br>
# Nr of groups created: 0<br>
# Nr of modifies to append members for new groups: 0<br>
# Nr of modifies to change memberships: 3<br>
# Nr of groups for which memberships have changed: 1
</code></p>
</div>
</div>
</div>
<div class="paragraph">
<p><strong>Specific Attribute block_size (Job)</strong></p>
</div>
<div class="paragraph">
<p>The job&#8217;s block_size attribute is used for creates and modifies. A single create/modify operation handles max <em>block_size</em> members.</p>
</div>
<div class="paragraph">
<p>Paged-Read Integration</p>
</div>
<div class="paragraph">
<p>The following sections provide information about paged-read integration in the LDAPXXL workflows.</p>
</div>
<div class="paragraph">
<p><strong>Group Synchronization</strong></p>
</div>
<div class="paragraph">
<p>Searches for the add/delete memberships in role may return large results. These searches should use paged read to avoid memory problems. All search functionality is extracted in a Tcl file called âPost Join Search Tcl Scriptâ. It contains three namespaces:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A namespace searchType to determine what kind of searches are supported</p>
</li>
<li>
<p>A namespace for simple paging (searchPaged) and</p>
</li>
<li>
<p>A namespace for "simple" searches (search) are provided</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Virtual list view (VLV) may be supported in a future release.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Simple Paging (paged read)</strong></p>
</div>
<div class="paragraph">
<p>The searchPaged namespace contains procedures for paged read.</p>
</div>
<div class="paragraph">
<p>Paged read requires an extra bind with a -<strong>bindid</strong> option; for users of the search functionality, this is the only difference in the interface between the several search types. As a result, searchPaged offers a bind procedure. The caller passes the bind ID and the connection parameters. The first time <strong>bind</strong> is called for the given bind ID, it performs the bind. Subsequent calls with the same bind ID do not result in another bind; the existing bind is used.</p>
</div>
<div class="paragraph">
<p>The page size can be configured at the job object:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-tcl hljs" data-lang="tcl">variable PAGESIZE &lt;?job@SpecificAttributes(page_size,$default="100")/&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Uh:: Prolog:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-tcl hljs" data-lang="tcl">set st(paged) 0
set rc [searchType::determineSearchType src_bind_id st]
set usePagedResult $st(paged)</code></pre>
</div>
</div>
<div class="paragraph">
<p>The variable of uh namespace usePagedResult is set. Here if âsimple pagingâ is possible, usePagedResult is set to 1 (it means true or yes). Otherwise, simple searches are used. If you never want to use simple paging you can hard-code it here.</p>
</div>
<div class="paragraph">
<p>A second index vlv of the st array indicates whether VLV is supported.</p>
</div>
<div class="paragraph">
<p><strong>Post-Join Mapping</strong></p>
</div>
<div class="paragraph">
<p>In postMappingAdd/Mod, the variable usePagedResult is used to determine if search procedures need to be called from search or searchPaged namespace. For usePagedResult, the bind procedure is also called:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-tcl hljs" data-lang="tcl">if {$usePagedResult == 1} {
    set rc [searchPaged::bind paged_bind_id src_conn_param]
}
...
if {$usePagedResult == 0} {
    search::SearchMembers $src_conn_param(bind_id) $role_ts_account_base ..
} else {
    searchPaged::SearchMembers paged_bind_id $role_ts_account_base ..
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Account Synchronization</strong></p>
</div>
<div class="paragraph">
<p>The search for the changed accounts in the Identity Store might return a large result. To avoid memory problems, the standard script&#8217;s paged read functionality is now used. Paged read is switched on and the page size is set in the account synchronization job&#8217;s input channel. Sorting is now disabled (because sorting DDN and paged read is not supported).</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_apx_detailed_customization"><a class="anchor" href="#_apx_detailed_customization"></a><a class="link" href="#_apx_detailed_customization">A.6.3. Detailed Customization</a></h4>
<div class="paragraph">
<p>Perform the following steps to change the Role LDAPXXL workflows from GroupOfUniqueNames to GroupOfNames.</p>
</div>
<div class="paragraph">
<p>For the validation workflow/validate accounts:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Go to the wizard step "Attribute Mapping for Accounts".</p>
</li>
<li>
<p>Edit PostJoin Mapping.</p>
</li>
<li>
<p>In PostJoinMapping Procedure GetCurrentTSMembers, replace<strong><br>
set rc [SearchMembers $bind_id $base_obj GroupOfUniqueNames uniquemember $accountdn locMembs]</strong><br>
<br>
with<strong><br>
<br>
set rc [SearchMembers $bind_id $base_obj GroupOfNames member $accountdn locMembs]</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For the validation workflow/validate groups</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Wizard step "Attribute Mapping for Groups"</p>
</li>
<li>
<p>Select InputChannel</p>
</li>
<li>
<p>Press show button in Export Properties Tab</p>
</li>
<li>
<p>Update the "Search Filter" of export properties to objectClass="groupOfNames"</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For the synchronization workflow/synchronize accounts:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In DirX Manager&#8217;s expert view: UserHook under the <strong>Role_LDAPXXL_SyncAccount_MetaCP</strong> job<br>
uh: ModifyRoleEntry procedure:<br>
<br>
replace<strong><br>
set rc [SearchMembers $bind_id $base_obj GroupOfUniqueNames uniquemember $accountdn DDN currTSMembs]</strong><br>
<br>
with<strong><br>
<br>
set rc [SearchMembers $bind_id $base_obj GroupOfNames member $accountdn DDN currTSMembs]</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For the synchronization workflow/synchronize groups:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Go to the wizard step "Target Selected Attributes for Groups": Replace<strong><br>
uniqueMember replace-all</strong><br>
<br>
with<strong><br>
<br>
member replace-all</strong></p>
</li>
<li>
<p>Go to the wizard step "Import Properties for Groups". In Join Expression,<br>
change <strong>GroupOfUniqueNames</strong> to <strong>GroupOfNames</strong></p>
</li>
<li>
<p>Go to the wizard step "Attribute Mapping for Groups": Edit PostJoin Mapping:<br>
<br>
postMappingAdd:<br>
<br>
Change<strong><br>
set tgt(objectClass) "GroupOfUniqueNames top"</strong><br>
to<strong><br>
set tgt(objectClass) "GroupOfNames top"</strong><br>
<br>
Change<strong><br>
set tgt(uniqueMember) $add_member</strong><br>
to<strong><br>
set tgt(member) $add_member</strong><br>
<br>
postMappingMod:<br>
<br>
Change<strong><br>
set members $found_entry(uniqueMember)</strong><br>
to<strong><br>
set members $found_entry(member)</strong><br>
<br>
Change<strong><br>
set tgt(uniqueMember) $members</strong><br>
to<strong><br>
set tgt(member) $members</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the connected directory LDAPXXL:</p>
</div>
<div class="paragraph">
<p>Configure LDAP TS in Hub:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Go to the wizard step "Operational Attributes".</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In ObjectClasses Groups, change <strong>GroupOfUniqueNames</strong> to <strong>GroupOfNames</strong></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_lotus_notes_provisioning_workflows"><a class="anchor" href="#_lotus_notes_provisioning_workflows"></a><a class="link" href="#_lotus_notes_provisioning_workflows">A.7. Lotus Notes Provisioning Workflows</a></h3>
<div class="paragraph">
<p>This section comprises all Lotus Notes-specific information for Tcl-based workflows.</p>
</div>
<div class="sect3">
<h4 id="_apx_tcl_based_lotus_notes_provisioning_workflows"><a class="anchor" href="#_apx_tcl_based_lotus_notes_provisioning_workflows"></a><a class="link" href="#_apx_tcl_based_lotus_notes_provisioning_workflows">A.7.1. Tcl-based Lotus Notes Provisioning Workflows</a></h4>
<div class="paragraph">
<p>The DirX Identity Tcl-based Lotus Notes workflows provision a Lotus Notes target system. Two workflows are available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Notes2Ident_Validation</strong> - performs initial load or validation from a Lotus Notes target system</p>
</li>
<li>
<p><strong>Ident_Notes_Sync</strong> - synchronizes between the Identity Store and a Lotus Notes target system</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Configuration notes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The parameter "Account Root in TS" of the target system object (in the Provisioning view) must contain a structure element like '/o=mycompany' which must match with the one contained in the cert.id file, because the Notes Server creates the fullname of the user by concatenating givenName, surname and this structure part contained in the cert.id file. This fullname also is used in the member attributes of groups in Notes. As a consequence the cn of a Notes target system account in Provisioning is generated like the fullname in Notes to be able to assign group members to accounts in the Provisioning view.</p>
</li>
<li>
<p>The parameter "Group Root in TS" must be left empty, because groups are kept flat in Notes and not in the kind of structure like users.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Deletion of accounts in Lotus Notes is a specific procedure:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The workflow cannot delete accounts directly. Instead it marks an account for deletion in the Lotus Notes system.</p>
</li>
<li>
<p>You can define in the Notes server the time after which an account is physically deleted from the address book (for example, two minutes) and the time after which the mail file is deleted.</p>
</li>
<li>
<p>This feature implies that the dxrTSstate is not set correctly during this run of the synchronization workflow. As a result, the next synchronization workflow will try to delete the same entries again. This action does not result in a warning state. Instead, one of the next synchronization workflows or a validation workflow will set the dxrTS flag accordingly.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_unix_pam_provisioning_workflows"><a class="anchor" href="#_unix_pam_provisioning_workflows"></a><a class="link" href="#_unix_pam_provisioning_workflows">A.8. UNIX PAM Provisioning Workflows</a></h3>
<div class="paragraph">
<p>A Pluggable Authentication Module (PAM) is a method that allows you to provide the authentication for system and other services (login, su, sshdâ¦) using other services (LDAPâ¦). Today the support for PAM is included in most of the common UNIX distributions. PAM was originally developed by Sun Microsystems. The topics in this section describe how PAM works and how to set up PAM Provisioning workflows.</p>
</div>
<div class="sect3">
<h4 id="_apx_how_pam_works"><a class="anchor" href="#_apx_how_pam_works"></a><a class="link" href="#_apx_how_pam_works">A.8.1. How PAM Works</a></h4>
<div class="paragraph">
<p>The basic idea of the PAM system are pluggable authentication modules - shared object files that are typically located in the /lib/security directory. Applications use for access to these modules two interfaces. The first is a system library attached to the application that allows the application to access the application authentication services directly. The second layer is the system configuration - the administrator specifies here the authentication rules for an application as desired.</p>
</div>
<div class="paragraph">
<p>PAM is used in four areas: user authentication, account control, session management and password change. The PAM modules process control or executive functions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>User authentication</strong> checks the identity of the user: password check, Kerberos authentication etc.</p>
</li>
<li>
<p><strong>Account control</strong> processes some verification which is not directly related to user identity: limited access time for a user, limited number of concurrently logged users etc.</p>
</li>
<li>
<p><strong>Session management</strong> is activated before and after service execution: sets the environment variables, execution of chroot, enables network disk connections etc.</p>
</li>
<li>
<p>The <strong>control flag</strong> describes how to work with the PAM module. The possible values are required, requisite, sufficient and optional.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_apx_setting_up_pam_provisioning_workflows"><a class="anchor" href="#_apx_setting_up_pam_provisioning_workflows"></a><a class="link" href="#_apx_setting_up_pam_provisioning_workflows">A.8.2. Setting Up PAM Provisioning Workflows</a></h4>
<div class="paragraph">
<p>Provisioning of PAM requires the following setup steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Install an LDAP directory that you can use for PAM. See the specific vender documentation how to perform this task.</p>
</li>
<li>
<p>Install and configure PAM for your UNIX system. See the specific vendor documentation. This includes a setup of the PAM LDAP schema. Important part of the schema are the object classes <strong>posixAccount</strong> and <strong>posixGroup</strong>.</p>
</li>
<li>
<p>Check that PAM is working. Create for example an account and a group that allows access to read a file and check that this account can read the file.</p>
</li>
<li>
<p>Create a UNIX PAM target system in the Provisioning view group with Identity Manager. This includes creation of a UNIX PAM LDAP connected directory and the related workflows.</p>
</li>
<li>
<p>Note: the target system wizard copies only the Tcl-based workflows. If you want to use real-time provisioning, copy the relevant workflows in the Connectivity view group as is described in the DirX Identity Connectivity Administration Guide.</p>
</li>
<li>
<p>Test your scenario thoroughly.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_unix_pam_workflows"><a class="anchor" href="#_unix_pam_workflows"></a><a class="link" href="#_unix_pam_workflows">A.9. UNIX-PAM Workflows</a></h3>
<div class="paragraph">
<p>The UNIX-PAM Provisioning workflows operate between a target system of type <strong>LDAP</strong> in the Identity Store and the corresponding connected LDAP server that is configured for use with UNIX-PAM (see RFC 2307).</p>
</div>
<div class="paragraph">
<p>The workflows use the standard LDAP connector (LdapConnector) for provisioning. This connector communicates with the LDAP server across the native LDAP protocol. (See the section "LDAP Workflows" for more information). The following figure illustrates the UNIX-PAM Provisioning workflow architecture.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/appa_depr/image6.png" alt="UNIX-PAM Workflow Architecture">
</div>
<div class="title">Figure 120. UNIX-PAM Workflow Architecture</div>
</div>
<div class="paragraph">
<p>The workflows handle the following UNIX objects:</p>
</div>
<div class="paragraph">
<p><strong>Account</strong> - the common UNIX accounts (object classes <strong>posixUser</strong> and <strong>shadowUser</strong> according to RFC 2307).</p>
</div>
<div class="paragraph">
<p><strong>Group</strong> - the common UNIX groups (object classes <strong>posixGroup</strong> according to RFC 2307).</p>
</div>
<div class="paragraph">
<p>The delivered workflows are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Ident_UNIX-PAM_Realtime</strong> - the synchronization workflow that exports detected changes for account and group objects from Identity Store to the LDAP server and then validates the processed changes in the LDAP server to the Identity Store.</p>
</li>
<li>
<p><strong>Validate_UNIX-PAM_Realtime</strong> - the validation workflow that imports existing UNIX accounts and groups with group assignment from the LDAP server to the Identity Store.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_apx_unix_pam_workflow_prerequisites_and_limitations"><a class="anchor" href="#_apx_unix_pam_workflow_prerequisites_and_limitations"></a><a class="link" href="#_apx_unix_pam_workflow_prerequisites_and_limitations">A.9.1. UNIX-PAM Workflow Prerequisites and Limitations</a></h4>
<div class="paragraph">
<p>The UNIX-PAM workflows have the following prerequisites and limitations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Before you can use the workflows, you must extend the DirX Identity Store schema with UNIX-PAM target system-specific attributes and object classes so that the workflows can store UNIX-PAM-specific information in the Identity Store. For instructions, see the section "Extending the Schema for the Target System Workflows".</p>
</li>
<li>
<p>The workflows support only the object classes <strong>posixAccount</strong>, <strong>shadowAccount</strong> and <strong>posixGroup</strong> defined by RFC 2307.</p>
</li>
<li>
<p>The workflows as delivered do not support password synchronization for UNIX-PAM. (See the section "LDAP Workflows" for an example of a password synchronization workflow for a UNIX-PAM (LDAP-based) connected directory.)</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_apx_configuring_unix_pam_workflows"><a class="anchor" href="#_apx_configuring_unix_pam_workflows"></a><a class="link" href="#_apx_configuring_unix_pam_workflows">A.9.2. Configuring UNIX-PAM Workflows</a></h4>
<div class="paragraph">
<p>To configure the connection to UNIX-PAM:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Specify the IP address and the data port of the LDAP server that is configured for use with UNIX-PAM. Use the corresponding UNIX-PAM service object that is the part of the connected UNIX-PAM LDAP directory. Use correct port numbers according to your LDAP server settings. You can also set the usage of secure connection (SSL) or enable client authentication.</p>
</li>
<li>
<p>Set up the bind credentials of the connected LDAP directory representing UNIX-PAM. Use the correct credentials (with sufficient rights). These are the credentials used for administration of the LDAP server. Use the valid DN syntax for the user name.</p>
</li>
<li>
<p>Check the provisioning settings used by the connected UNIX-PAM system. Specify them according to real values for your provisioned UNIX-PAM target system.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_apx_configuring_the_unix_pam_target_system"><a class="anchor" href="#_apx_configuring_the_unix_pam_target_system"></a><a class="link" href="#_apx_configuring_the_unix_pam_target_system">A.9.3. Configuring the UNIX-PAM Target System</a></h4>
<div class="paragraph">
<p>The UNIX-PAM target system requires the following layout:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Accounts</strong> - all UNIX accounts are located in a subfolder <strong>Accounts</strong>.</p>
</li>
<li>
<p><strong>Groups</strong> - all UNIX groups are located in a subfolder <strong>Groups</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The attribute <strong>dxrPrimaryKey</strong> of accounts and groups contains the DN of these objects in the connected system.</p>
</div>
<div class="paragraph">
<p>The standard JavaScript dxrNameForAccounts.js generates the attribute <strong>uid</strong> for the UNIX account.</p>
</div>
<div class="paragraph">
<p>The UNIX-PAM specific JavaScript uniqueNumber.js generates the attributes <strong>uidNumber</strong> and <strong>gidNumber</strong> for the UNIX account.</p>
</div>
<div class="paragraph">
<p>The attribute gidNumber for the UNIX account (refers to the primary UNIX group of the account) is by default automatically chosen as one of the assigned UNIX groups. It uses the obligation mechanism (see group objects) and the UNIX-PAM specific JavaScript AccountGidNumber.js. The JavaScript updates the <strong>gidNumber</strong> when necessary. You can change the primary group manually at the account object.</p>
</div>
<div class="paragraph">
<p>The group object stores the group membership and references the <strong>uid</strong> attribute of the account objects.</p>
</div>
</div>
<div class="sect3">
<h4 id="_apx_unix_pam_workflow_and_activities"><a class="anchor" href="#_apx_unix_pam_workflow_and_activities"></a><a class="link" href="#_apx_unix_pam_workflow_and_activities">A.9.4. UNIX-PAM Workflow and Activities</a></h4>
<div class="paragraph">
<p>The following figure shows the layout of the channels that are used by the UNIX-PAM workflow&#8217;s join activity:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/appa_depr/image7.png" alt="UNIX-PAM Provisioning Workflow Channels and Objects">
</div>
<div class="title">Figure 121. UNIX-PAM Provisioning Workflow Channels and Objects</div>
</div>
<div class="paragraph">
<p>The UNIX objects account and group (and membership) are synchronized via a pair of channels (one channel per direction).</p>
</div>
</div>
<div class="sect3">
<h4 id="_apx_unix_pam_ports"><a class="anchor" href="#_apx_unix_pam_ports"></a><a class="link" href="#_apx_unix_pam_ports">A.9.5. UNIX-PAM Ports</a></h4>
<div class="paragraph">
<p>This section describes the UNIX-PAM ports.</p>
</div>
<div class="paragraph">
<p>TS Port</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>CF - Crypt Filter</strong><br>
A UNIX-PAM filter is implicitly configured. It is used to send the decrypted password attribute <strong>userPassword</strong> to the LDAP server.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_apx_unix_pam_channels"><a class="anchor" href="#_apx_unix_pam_channels"></a><a class="link" href="#_apx_unix_pam_channels">A.9.6. UNIX-PAM Channels</a></h4>
<div class="paragraph">
<p>This section provides information about UNIX-PAM channels.</p>
</div>
<div class="sect4">
<h5 id="_apx_common_aspects_2"><a class="anchor" href="#_apx_common_aspects_2"></a><a class="link" href="#_apx_common_aspects_2">A.9.6.1. Common Aspects</a></h5>
<div class="paragraph">
<p>Direction: Identity Store &#8594; UNIX-PAM</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>shadowFlag</strong> - the attribute used for disabling of the account object in the connected LDAP directory (used for UNIX-PAM). The correct value is derived from the <strong>dxrState</strong> attribute of the corresponding account object in the Identity Store. This is an experimental setting and must be supported by the relevant UNIX-PAM implementation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Direction: UNIX PAM &#8594; Identity Store</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>CommonProcsUnixPam.calculateIdInIdentity</strong> - calculates the Id.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_apx_accounts_2"><a class="anchor" href="#_apx_accounts_2"></a><a class="link" href="#_apx_accounts_2">A.9.6.2. Accounts</a></h5>
<div class="paragraph">
<p>Direction: Identity Store &#8594; UNIX-PAM</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ID: <strong>dxrPrimaryKey</strong></p>
</li>
<li>
<p>Join: <strong>${source.dxrPrimaryKey}</strong> or <strong>${source.uidNumber}</strong></p>
</li>
<li>
<p>UNIX-PAM requires some mandatory attributes. (See RFC 2307 for details.) Mandatory attributes are mapped in a common way.</p>
</li>
<li>
<p>The <strong>gidNumber</strong> attribute holds the primary group membership.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Direction: UNIX-PAM &#8594; Identity Store</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Join via the <strong>dxrName</strong> attribute that is mapped identically to the <strong>uidNumber</strong> attribute.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_apx_groups_2"><a class="anchor" href="#_apx_groups_2"></a><a class="link" href="#_apx_groups_2">A.9.6.3. Groups</a></h5>
<div class="paragraph">
<p>Direction: Identity Store &#8594; UNIX-PAM</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ID: <strong>dxrPrimaryKey</strong></p>
</li>
<li>
<p>Join: <strong>${source.dxrPrimaryKey}</strong> or <strong>{source.gidNumber}</strong></p>
</li>
<li>
<p>UNIX-PAM requires some mandatory attributes. (See RFC 2307 for details.) Mandatory attributes are mapped in a common way.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Direction: UNIX-PAM &#8594; Identity Store</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Join via the <strong>dxrName</strong> attribute that is mapped identically to the <strong>gidNumber</strong> attribute.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>DirX is a registered trademark Â© Copyright 2024, Eviden SAS â All rights reserved.</p>
  <p>The UI for this site is derived from the Antora default UI and is licensed under the MPL-2.0 license.
    Several icons used are provided by Google and are licensed under the
    <a href="http://www.apache.org/licenses/LICENSE-2.0.txt">Apache License Version 2.0</a>.
  </p>
</footer>
<script id="site-script" src="../../../../_/js/site.js" data-ui-root-path="../../../../_"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>
<script src="../../../../_/js/vendor/lunr.js"></script>
<script src="../../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../../.." data-snippet-length="100" data-stylesheet="../../../../_/css/search.css"></script>
<script async src="../../../../search-index.js"></script>
  </body>
</html>
